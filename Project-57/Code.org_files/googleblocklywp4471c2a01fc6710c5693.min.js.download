(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{10:function(t,e,o){var g=o(38),f=o(73),T=o(136),v=o(123),E=o(169),y="prototype",m=function(t,e,o){var n,i,r,s,a=t&m.F,l=t&m.G,c=t&m.S,u=t&m.P,h=t&m.B,p=l?g:c?g[e]||(g[e]={}):(g[e]||{})[y],_=l?f:f[e]||(f[e]={}),d=_[y]||(_[y]={});for(n in l&&(o=e),o)r=((i=!a&&p&&void 0!==p[n])?p:o)[n],s=h&&i?E(r,g):u&&"function"==typeof r?E(Function.call,r):r,p&&v(p,n,r,t&m.U),_[n]!=r&&T(_,n,s),u&&d[n]!=r&&(d[n]=r)};g.core=f,m.F=1,m.G=2,m.S=4,m.P=8,m.B=16,m.W=32,m.U=64,m.R=128,t.exports=m},100:function(t,e,o){var n=o(204);t.exports=function(t){return Object(n(t))}},11:function(t,i,r){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.isSubsequence=function(t,e){var o=0,n=0;for(;n<e.length;){for(;o<t.length&&e[n]!==t[o];)o++;if(o>=t.length)return!1;n++,o++}return!0},i.shallowCopy=function(t){var e={};for(var o in t)e[o]=t[o];return e},i.cloneWithoutFunctions=function(t){return JSON.parse(JSON.stringify(t))},i.quote=function(t){return'"'+t+'"'},i.extend=function(t,e){var o=i.shallowCopy(t);for(var n in e)o[n]=e[n];return o},i.escapeHtml=function(t){return t?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/\//g,"&#47;"):""},i.mod=function(t,e){return(t%e+e)%e},i.range=function(t,e){for(var o=[],n=t;n<=e;n++)o.push(n);return o},i.executeIfConditional=function(t,e){return function(){if(t())return e.apply(this,arguments)}},i.stripQuotes=function(t){return t.replace(/["']/g,"")},i.wrapNumberValidatorsForLevelBuilder=function(){var e=Blockly.FieldTextInput.nonnegativeIntegerValidator,o=Blockly.FieldTextInput.numberValidator;Blockly.FieldTextInput.nonnegativeIntegerValidator=function(t){return"???"===t?t:e(t)},Blockly.FieldTextInput.numberValidator=function(t){return"???"===t?t:o(t)}},i.randomValue=u,i.randomKey=function(t){return u(Object.keys(t))},i.createUuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,o="x"===t?e:3&e|8;return o.toString(16)})},i.fireResizeEvent=function(){var t=document.createEvent("Event");t.initEvent("resize",!0,!0),window.dispatchEvent(t)},i.valueOr=function(t,e){return void 0===t?e:t},i.isInfiniteRecursionError=function(t){if(t instanceof RangeError&&/^Maximum call stack size exceeded/.test(t.message))return!0;if("undefined"!=typeof InternalError&&t instanceof InternalError&&"too much recursion"===t.message)return!0;if(t instanceof Error&&"Out of stack space"===t.message)return!0;return!1},i.unescapeText=function(t){var e=t;return e=(e=(e=(e=(e=(e=e.replace(/(?!^)<div[^>]*>/gi,"\n")).replace(/<[^>]+>/gi,"")).replace(/&nbsp;/gi," ")).replace(/&gt;/gi,">")).replace(/&lt;/gi,"<")).replace(/&amp;/gi,"&")},i.escapeText=function(t){var e=t.toString(),o=(e=(e=(e=(e=e.replace(/&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/ {2}/g," &nbsp;")).split("\n"),n=o[0],i=o.slice(1);0===n.length&&1<o.length&&(n="<br>");return n+i.map(function(t){return"<div>"+(t.length?t:"<br>")+"</div>"}).join("")},i.showGenericQtip=h,i.showUnusedBlockQtip=function(t){var e=r(3),o=e.unattachedBlockTipTitle(),n=e.unattachedBlockTipBody();h(t,o,n,{my:"bottom left",at:"top right"})},i.tryGetLocalStorage=function(t,e){if(void 0===e)throw"tryGetLocalStorage requires defaultValue";var o=e;try{o=localStorage.getItem(t)}catch(t){}return o},i.trySetLocalStorage=function(t,e){try{return localStorage.setItem(t,e),!0}catch(t){return!1}},i.tryGetSessionStorage=p,i.trySetSessionStorage=_,i.makeEnum=function(){for(var t,e={},o=0;o<arguments.length;o++){if(t=String(arguments[o]),e[t])throw new Error('Key "'+t+'" occurred twice while constructing enum');e[t]=t}Object.freeze&&Object.freeze(e);return e},i.ellipsify=function(t,e){if(t&&t.length>e)return t.substr(0,e-3)+"...";return t||""},i.deepMergeConcatArrays=function(t,e){return a.default.fromJS(t).mergeWith(function t(e,o){var n=a.default.List.isList;if(n(e)&&n(o))return e.concat(o);if(e&&e.mergeWith)return e.mergeWith(t,o);return o},e).toJS()},i.createEvent=function(e){var o,n=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=2<arguments.length&&void 0!==arguments[2]&&arguments[2];try{o=new Event(e,{bubbles:n,cancelable:i})}catch(t){(o=document.createEvent("Event")).initEvent(e,n,i)}return o},i.normalize=function(t){var e=Math.sqrt(t.x*t.x+t.y*t.y);return 0!==e?{x:t.x/e,y:t.y/e}:t},i.xFromPosition=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;switch(t){case n.Position.OUTTOPOUTLEFT:case n.Position.TOPOUTLEFT:case n.Position.MIDDLEOUTLEFT:case n.Position.BOTTOMOUTLEFT:case n.Position.OUTBOTTOMOUTLEFT:return-o;case n.Position.OUTTOPLEFT:case n.Position.TOPLEFT:case n.Position.MIDDLELEFT:case n.Position.BOTTOMLEFT:case n.Position.OUTBOTTOMLEFT:return 0;case n.Position.OUTTOPCENTER:case n.Position.TOPCENTER:case n.Position.MIDDLECENTER:case n.Position.BOTTOMCENTER:case n.Position.OUTBOTTOMCENTER:return(e-o)/2;case n.Position.OUTTOPRIGHT:case n.Position.TOPRIGHT:case n.Position.MIDDLERIGHT:case n.Position.BOTTOMRIGHT:case n.Position.OUTBOTTOMRIGHT:return e-o;case n.Position.OUTTOPOUTRIGHT:case n.Position.TOPOUTRIGHT:case n.Position.MIDDLEOUTRIGHT:case n.Position.BOTTOMOUTRIGHT:case n.Position.OUTBOTTOMOUTRIGHT:return e}},i.yFromPosition=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;switch(t){case n.Position.OUTTOPOUTLEFT:case n.Position.OUTTOPLEFT:case n.Position.OUTTOPCENTER:case n.Position.OUTTOPRIGHT:case n.Position.OUTTOPOUTRIGHT:return-o;case n.Position.TOPOUTLEFT:case n.Position.TOPLEFT:case n.Position.TOPCENTER:case n.Position.TOPRIGHT:case n.Position.TOPOUTRIGHT:return 0;case n.Position.MIDDLEOUTLEFT:case n.Position.MIDDLELEFT:case n.Position.MIDDLECENTER:case n.Position.MIDDLERIGHT:case n.Position.MIDDLEOUTRIGHT:return(e-o)/2;case n.Position.BOTTOMOUTLEFT:case n.Position.BOTTOMLEFT:case n.Position.BOTTOMCENTER:case n.Position.BOTTOMRIGHT:case n.Position.BOTTOMOUTRIGHT:return e-o;case n.Position.OUTBOTTOMOUTLEFT:case n.Position.OUTBOTTOMLEFT:case n.Position.OUTBOTTOMCENTER:case n.Position.OUTBOTTOMRIGHT:case n.Position.OUTBOTTOMOUTRIGHT:return e}},i.levenshtein=function(t,e){if(!t||!e)return(t||e).length;for(var o=[],n=0;n<=e.length;n++)if(o[n]=[n],0!==n)for(var i=0;i<=t.length;i++)0!==(o[0][i]=i)&&(o[n][i]=e.charAt(n-1)===t.charAt(i-1)?o[n-1][i-1]:Math.min(o[n-1][i-1]+1,o[n][i-1]+1,o[n-1][i]+1));return o[e.length][t.length]},i.bisect=function(t,e){var o=t.filter(function(t){return e(t)}),n=t.filter(function(t){return!e(t)});return[o,n]},i.flatten=function o(t){return t.reduce(function(t,e){return t.concat(Array.isArray(e)?o(e):e)},[])},i.reload=function(){window.location.reload()},i.currentLocation=function(){return window.location},i.windowOpen=function(){var t;return(t=window).open.apply(t,arguments)},i.navigateToHref=function(t){window.location.href=t},i.stringifyQueryParams=function(e){if(!e)return"";var t=Object.keys(e);return t.length?"?"+t.map(function(t){return"".concat(t,"=").concat(e[t])}).join("&"):""},i.resetAniGif=function(t){if(!t)return;var e=t.src;t.src="#",setTimeout(function(){return t.src=e},0)},i.interpolateColors=function(t,e,o){var n=new l.default(t),i=new l.default(e),r=n.r*(1-o)+i.r*o,s=n.g*(1-o)+i.g*o,a=n.b*(1-o)+i.b*o;return"rgb(".concat(r,", ").concat(s,", ").concat(a,")")},i.getTabId=function(){var t=p("tabId",!1);if(t)return t;return _("tabId",Math.random()+""),p("tabId",!1)},i.createHiddenPrintWindow=function(t){(0,o.dataURIFromURI)(t).then(function(t){var e=(0,s.default)('<iframe style="position: absolute; visibility: hidden;"></iframe>');e.appendTo("body"),e[0].contentWindow.document.write('<img src="'.concat(t,'" style="border: 1px solid #000;" onload="if (document.execCommand(\'print\', false, null)) {  } else { window.print(); }"/>'))})},i.calculateOffsetCoordinates=function(t,e,o){var n=t.getBoundingClientRect();return{x:Math.round((e-n.left)*t.offsetWidth/n.width),y:Math.round((o-n.top)*t.offsetHeight/n.height)}},i.escapeRegExp=function(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},i.hashString=function(t){return(0,e.default)(t).toString()},i.findProfanity=void 0;var s=c(r(9)),a=c(r(99)),e=c(r(160)),l=c(r(256)),n=r(33),o=r(149);function c(t){return t&&t.__esModule?t:{default:t}}function u(t){return t[Math.floor(Math.random()*t.length)]}function h(t,e,o,n){(0,s.default)(t).qtip({content:{text:"\n        <h4>".concat(e,"</h4>\n        <p>").concat(o,"</p>\n      "),title:{button:(0,s.default)('<div class="tooltip-x-close"/>')}},position:n,style:{classes:"cdo-qtips",tip:{width:20,height:20}},hide:{event:"unfocus"},show:!1}).qtip("show")}function p(t,e){if(void 0===e)throw"tryGetSessionStorage requires defaultValue";var o=e;try{o=sessionStorage.getItem(t)}catch(t){}return o}function _(t,e){try{return sessionStorage.setItem(t,e),!0}catch(t){if("QuotaExceededError"!==t.name)throw t;return!1}}r(199),Function.prototype.inherits=function(t){this.prototype=Object.create(t.prototype),(this.prototype.constructor=this).superPrototype=t.prototype};i.findProfanity=function(t,e){return s.default.ajax({url:"/profanity/find",method:"POST",contentType:"application/json;charset=UTF-8",data:JSON.stringify({text:t,locale:e})})}},1130:function(t,e,o){t.exports=!o(78)&&!o(39)(function(){return 7!=Object.defineProperty(o(873)("div"),"a",{get:function(){return 7}}).a})},1131:function(t,e,o){var n=o(38),i=o(73),r=o(306),s=o(874),a=o(79).f;t.exports=function(t){var e=i.Symbol||(i.Symbol=r?{}:n.Symbol||{});"_"==t.charAt(0)||t in e||a(e,t,{value:s.f(t)})}},1132:function(t,e,o){var s=o(135),a=o(137),l=o(618)(!1),c=o(875)("IE_PROTO");t.exports=function(t,e){var o,n=a(t),i=0,r=[];for(o in n)o!=c&&s(n,o)&&r.push(o);for(;e.length>i;)s(n,o=e[i++])&&(~l(r,o)||r.push(o));return r}},1133:function(t,e,o){var s=o(79),a=o(40),l=o(307);t.exports=o(78)?Object.defineProperties:function(t,e){a(t);for(var o,n=l(e),i=n.length,r=0;r<i;)s.f(t,o=n[r++],e[o]);return t}},1134:function(t,e,o){var n=o(137),i=o(310).f,r={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return s&&"[object Window]"==r.call(t)?function(t){try{return i(t)}catch(t){return s.slice()}}(t):i(n(t))}},1135:function(t,e,o){"use strict";var p=o(78),_=o(307),d=o(619),g=o(482),f=o(100),T=o(481),i=Object.assign;t.exports=!i||o(39)(function(){var t={},e={},o=Symbol(),n="abcdefghijklmnopqrst";return t[o]=7,n.split("").forEach(function(t){e[t]=t}),7!=i({},t)[o]||Object.keys(i({},e)).join("")!=n})?function(t,e){for(var o=f(t),n=arguments.length,i=1,r=d.f,s=g.f;i<n;)for(var a,l=T(arguments[i++]),c=r?_(l).concat(r(l)):_(l),u=c.length,h=0;h<u;)a=c[h++],p&&!s.call(l,a)||(o[a]=l[a]);return o}:i},1136:function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},1137:function(t,e,o){"use strict";var r=o(170),s=o(41),a=o(1138),l=[].slice,c={};t.exports=Function.bind||function(e){var o=r(this),n=l.call(arguments,1),i=function(){var t=n.concat(l.call(arguments));return this instanceof i?function(t,e,o){if(!(e in c)){for(var n=[],i=0;i<e;i++)n[i]="a["+i+"]";c[e]=Function("F,a","return new F("+n.join(",")+")")}return c[e](t,o)}(o,t.length,t):a(o,t,e)};return s(o.prototype)&&(i.prototype=o.prototype),i}},1138:function(t,e){t.exports=function(t,e,o){var n=void 0===o;switch(e.length){case 0:return n?t():t.call(o);case 1:return n?t(e[0]):t.call(o,e[0]);case 2:return n?t(e[0],e[1]):t.call(o,e[0],e[1]);case 3:return n?t(e[0],e[1],e[2]):t.call(o,e[0],e[1],e[2]);case 4:return n?t(e[0],e[1],e[2],e[3]):t.call(o,e[0],e[1],e[2],e[3])}return t.apply(o,e)}},1139:function(t,e,o){var n=o(38).parseInt,i=o(346).trim,r=o(879),s=/^[-+]?0[xX]/;t.exports=8!==n(r+"08")||22!==n(r+"0x16")?function(t,e){var o=i(String(t),3);return n(o,e>>>0||(s.test(o)?16:10))}:n},114:function(t,e,o){o(1581)},1140:function(t,e,o){var n=o(38).parseFloat,i=o(346).trim;t.exports=1/n(o(879)+"-0")!=-1/0?function(t){var e=i(String(t),3),o=n(e);return 0===o&&"-"==e.charAt(0)?-0:o}:n},1141:function(t,e,o){var n=o(203);t.exports=function(t,e){if("number"!=typeof t&&"Number"!=n(t))throw TypeError(e);return+t}},1142:function(t,e,o){var n=o(41),i=Math.floor;t.exports=function(t){return!n(t)&&isFinite(t)&&i(t)===t}},1143:function(t,e){t.exports=Math.log1p||function(t){return-1e-8<(t=+t)&&t<1e-8?t-t*t/2:Math.log(1+t)}},1144:function(t,e,o){"use strict";var n=o(309),i=o(304),r=o(345),s={};o(136)(s,o(50)("iterator"),function(){return this}),t.exports=function(t,e,o){t.prototype=n(s,{next:i(1,o)}),r(t,e+" Iterator")}},1145:function(t,e,o){var r=o(40);t.exports=function(e,t,o,n){try{return n?t(r(o)[0],o[1]):t(o)}catch(t){var i=e.return;throw void 0!==i&&r(i.call(e)),t}}},1146:function(t,e,o){var n=o(1674);t.exports=function(t,e){return new(n(t))(e)}},1147:function(t,e,o){var u=o(170),h=o(100),p=o(481),_=o(59);t.exports=function(t,e,o,n,i){u(e);var r=h(t),s=p(r),a=_(r.length),l=i?a-1:0,c=i?-1:1;if(o<2)for(;;){if(l in s){n=s[l],l+=c;break}if(l+=c,i?l<0:a<=l)throw TypeError("Reduce of empty array with no initial value")}for(;i?0<=l:l<a;l+=c)l in s&&(n=e(n,s[l],l,r));return n}},1148:function(t,e,o){"use strict";var c=o(100),u=o(308),h=o(59);t.exports=[].copyWithin||function(t,e){var o=c(this),n=h(o.length),i=u(t,n),r=u(e,n),s=2<arguments.length?arguments[2]:void 0,a=Math.min((void 0===s?n:u(s,n))-r,n-i),l=1;for(r<i&&i<r+a&&(l=-1,r+=a-1,i+=a-1);0<a--;)r in o?o[i]=o[r]:delete o[i],i+=l,r+=l;return o}},1149:function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},1150:function(t,e,o){"use strict";var n=o(894);o(10)({target:"RegExp",proto:!0,forced:n!==/./.exec},{exec:n})},1151:function(t,e,o){o(78)&&"g"!=/./g.flags&&o(79).f(RegExp.prototype,"flags",{configurable:!0,get:o(622)})},1152:function(t,e,o){"use strict";var n,i,r,s,a=o(306),l=o(38),c=o(169),u=o(483),h=o(10),p=o(41),_=o(170),d=o(349),g=o(625),f=o(484),T=o(896).set,v=o(1694)(),E=o(1153),y=o(1695),m=o(626),b=o(1154),S="Promise",I=l.TypeError,R=l.process,C=R&&R.versions,k=C&&C.v8||"",O=l[S],A="process"==u(R),D=function(){},w=i=E.f,N=!!function(){try{var t=O.resolve(1),e=(t.constructor={})[o(50)("species")]=function(t){t(D,D)};return(A||"function"==typeof PromiseRejectionEvent)&&t.then(D)instanceof e&&0!==k.indexOf("6.6")&&-1===m.indexOf("Chrome/66")}catch(t){}}(),M=function(t){var e;return!(!p(t)||"function"!=typeof(e=t.then))&&e},L=function(u,o){if(!u._n){u._n=!0;var n=u._c;v(function(){for(var l=u._v,c=1==u._s,t=0,e=function(t){var e,o,n,i=c?t.ok:t.fail,r=t.resolve,s=t.reject,a=t.domain;try{i?(c||(2==u._h&&x(u),u._h=1),!0===i?e=l:(a&&a.enter(),e=i(l),a&&(a.exit(),n=!0)),e===t.promise?s(I("Promise-chain cycle")):(o=M(e))?o.call(e,r,s):r(e)):s(l)}catch(t){a&&!n&&a.exit(),s(t)}};n.length>t;)e(n[t++]);u._c=[],u._n=!1,o&&!u._h&&P(u)})}},P=function(r){T.call(l,function(){var t,e,o,n=r._v,i=B(r);if(i&&(t=y(function(){A?R.emit("unhandledRejection",n,r):(e=l.onunhandledrejection)?e({promise:r,reason:n}):(o=l.console)&&o.error&&o.error("Unhandled promise rejection",n)}),r._h=A||B(r)?2:1),r._a=void 0,i&&t.e)throw t.v})},B=function(t){return 1!==t._h&&0===(t._a||t._c).length},x=function(e){T.call(l,function(){var t;A?R.emit("rejectionHandled",e):(t=l.onrejectionhandled)&&t({promise:e,reason:e._v})})},F=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),L(e,!0))},U=function(t){var o,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw I("Promise can't be resolved itself");(o=M(t))?v(function(){var e={_w:n,_d:!1};try{o.call(t,c(U,e,1),c(F,e,1))}catch(t){F.call(e,t)}}):(n._v=t,n._s=1,L(n,!1))}catch(t){F.call({_w:n,_d:!1},t)}}};N||(O=function(t){d(this,O,S,"_h"),_(t),n.call(this);try{t(c(U,this,1),c(F,this,1))}catch(t){F.call(this,t)}},(n=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=o(350)(O.prototype,{then:function(t,e){var o=w(f(this,O));return o.ok="function"!=typeof t||t,o.fail="function"==typeof e&&e,o.domain=A?R.domain:void 0,this._c.push(o),this._a&&this._a.push(o),this._s&&L(this,!1),o.promise},catch:function(t){return this.then(void 0,t)}}),r=function(){var t=new n;this.promise=t,this.resolve=c(U,t,1),this.reject=c(F,t,1)},E.f=w=function(t){return t===O||t===s?new r(t):i(t)}),h(h.G+h.W+h.F*!N,{Promise:O}),o(345)(O,S),o(348)(S),s=o(73)[S],h(h.S+h.F*!N,S,{reject:function(t){var e=w(this);return(0,e.reject)(t),e.promise}}),h(h.S+h.F*(a||!N),S,{resolve:function(t){return b(a&&this===s?O:this,t)}}),h(h.S+h.F*!(N&&o(621)(function(t){O.all(t).catch(D)})),S,{all:function(t){var s=this,e=w(s),a=e.resolve,l=e.reject,o=y(function(){var n=[],i=0,r=1;g(t,!1,function(t){var e=i++,o=!1;n.push(void 0),r++,s.resolve(t).then(function(t){o||(o=!0,n[e]=t,--r||a(n))},l)}),--r||a(n)});return o.e&&l(o.v),e.promise},race:function(t){var e=this,o=w(e),n=o.reject,i=y(function(){g(t,!1,function(t){e.resolve(t).then(o.resolve,n)})});return i.e&&n(i.v),o.promise}})},1153:function(t,e,o){"use strict";var i=o(170);function n(t){var o,n;this.promise=new t(function(t,e){if(void 0!==o||void 0!==n)throw TypeError("Bad Promise constructor");o=t,n=e}),this.resolve=i(o),this.reject=i(n)}t.exports.f=function(t){return new n(t)}},1154:function(t,e,o){var n=o(40),i=o(41),r=o(1153);t.exports=function(t,e){if(n(t),i(e)&&e.constructor===t)return e;var o=r.f(t);return(0,o.resolve)(e),o.promise}},1155:function(t,e,o){"use strict";var s=o(79).f,a=o(309),l=o(350),c=o(169),u=o(349),h=o(625),n=o(885),i=o(1149),r=o(348),p=o(78),_=o(258).fastKey,d=o(313),g=p?"_s":"size",f=function(t,e){var o,n=_(e);if("F"!==n)return t._i[n];for(o=t._f;o;o=o.n)if(o.k==e)return o};t.exports={getConstructor:function(t,r,o,n){var i=t(function(t,e){u(t,i,r,"_i"),t._t=r,t._i=a(null),t._f=void 0,t._l=void 0,t[g]=0,null!=e&&h(e,o,t[n],t)});return l(i.prototype,{clear:function(){for(var t=d(this,r),e=t._i,o=t._f;o;o=o.n)o.r=!0,o.p&&(o.p=o.p.n=void 0),delete e[o.i];t._f=t._l=void 0,t[g]=0},delete:function(t){var e=d(this,r),o=f(e,t);if(o){var n=o.n,i=o.p;delete e._i[o.i],o.r=!0,i&&(i.n=n),n&&(n.p=i),e._f==o&&(e._f=n),e._l==o&&(e._l=i),e[g]--}return!!o},forEach:function(t){d(this,r);for(var e,o=c(t,1<arguments.length?arguments[1]:void 0,3);e=e?e.n:this._f;)for(o(e.v,e.k,this);e&&e.r;)e=e.p},has:function(t){return!!f(d(this,r),t)}}),p&&s(i.prototype,"size",{get:function(){return d(this,r)[g]}}),i},def:function(t,e,o){var n,i,r=f(t,e);return r?r.v=o:(t._l=r={i:i=_(e,!0),k:e,v:o,p:n=t._l,n:void 0,r:!1},t._f||(t._f=r),n&&(n.n=r),t[g]++,"F"!==i&&(t._i[i]=r)),t},getEntry:f,setStrong:function(t,o,e){n(t,o,function(t,e){this._t=d(t,o),this._k=e,this._l=void 0},function(){for(var t=this,e=t._k,o=t._l;o&&o.r;)o=o.p;return t._t&&(t._l=o=o?o.n:t._t._f)?i(0,"keys"==e?o.k:"values"==e?o.v:[o.k,o.v]):(t._t=void 0,i(1))},e?"entries":"values",!e,!0),r(o)}}},1156:function(t,e,o){"use strict";var s=o(350),a=o(258).getWeak,i=o(40),l=o(41),c=o(349),u=o(625),n=o(174),h=o(135),p=o(313),r=n(5),_=n(6),d=0,g=function(t){return t._l||(t._l=new f)},f=function(){this.a=[]},T=function(t,e){return r(t.a,function(t){return t[0]===e})};f.prototype={get:function(t){var e=T(this,t);if(e)return e[1]},has:function(t){return!!T(this,t)},set:function(t,e){var o=T(this,t);o?o[1]=e:this.a.push([t,e])},delete:function(e){var t=_(this.a,function(t){return t[0]===e});return~t&&this.a.splice(t,1),!!~t}},t.exports={getConstructor:function(t,o,n,i){var r=t(function(t,e){c(t,r,o,"_i"),t._t=o,t._i=d++,t._l=void 0,null!=e&&u(e,n,t[i],t)});return s(r.prototype,{delete:function(t){if(!l(t))return!1;var e=a(t);return!0===e?g(p(this,o)).delete(t):e&&h(e,this._i)&&delete e[this._i]},has:function(t){if(!l(t))return!1;var e=a(t);return!0===e?g(p(this,o)).has(t):e&&h(e,this._i)}}),r},def:function(t,e,o){var n=a(i(e),!0);return!0===n?g(t).set(e,o):n[t._i]=o,t},ufstore:g}},1157:function(t,e,o){var n=o(171),i=o(59);t.exports=function(t){if(void 0===t)return 0;var e=n(t),o=i(e);if(e!==o)throw RangeError("Wrong length!");return o}},1158:function(t,e,o){var n=o(310),i=o(619),r=o(40),s=o(38).Reflect;t.exports=s&&s.ownKeys||function(t){var e=n.f(r(t)),o=i.f;return o?e.concat(o(t)):e}},1159:function(t,e,o){var u=o(59),h=o(881),p=o(204);t.exports=function(t,e,o,n){var i=String(p(t)),r=i.length,s=void 0===o?" ":String(o),a=u(e);if(a<=r||""==s)return i;var l=a-r,c=h.call(s,Math.ceil(l/s.length));return c.length>l&&(c=c.slice(0,l)),n?c+i:i+c}},1160:function(t,e,o){var l=o(78),c=o(307),u=o(137),h=o(482).f;t.exports=function(a){return function(t){for(var e,o=u(t),n=c(o),i=n.length,r=0,s=[];r<i;)e=n[r++],l&&!h.call(o,e)||s.push(a?[e,o[e]]:o[e]);return s}}},123:function(t,e,o){var r=o(38),s=o(136),a=o(135),l=o(305)("src"),n=o(1584),i="toString",c=(""+n).split(i);o(73).inspectSource=function(t){return n.call(t)},(t.exports=function(t,e,o,n){var i="function"==typeof o;i&&(a(o,"name")||s(o,"name",e)),t[e]!==o&&(i&&(a(o,l)||s(o,l,t[e]?""+t[e]:c.join(String(e)))),t===r?t[e]=o:n?t[e]?t[e]=o:s(t,e,o):(delete t[e],s(t,e,o)))})(Function.prototype,i,function(){return"function"==typeof this&&this[l]||n.call(this)})},124:function(t,e,o){var n=o(10),i=o(39),s=o(204),a=/"/g,r=function(t,e,o,n){var i=String(s(t)),r="<"+e;return""!==o&&(r+=" "+o+'="'+String(n).replace(a,"&quot;")+'"'),r+">"+i+"</"+e+">"};t.exports=function(e,t){var o={};o[e]=t(r),n(n.P+n.F*i(function(){var t=""[e]('"');return t!==t.toLowerCase()||3<t.split('"').length}),"String",o)}},126:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return window.locales&&window.locales[t]?window.locales[t]:(console.warn("Translations must be loaded into the global scope before access. Falling back on an empty translation object. This page may break due to missing translations."),{})},t.exports=e.default},127:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(n,i){if(!r.default.isEnabled(r.default.I18N_TRACKING))return n;var e={};return Object.keys(n).forEach(function(o,t){e[o]=function(t){var e=n[o](t);return function(t,e){t&&e&&(0,s.getI18nStringTrackerWorker)().log(t,e)}(o,i),e}}),e};var n,r=(n=o(49))&&n.__esModule?n:{default:n},s=o(269);t.exports=e.default},132:function(n,i,r){var s,a;
/*!
 * JavaScript Cookie v2.1.3
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */!function(t){if(void 0===(a="function"==typeof(s=t)?s.call(i,r,i,n):s)||(n.exports=a),!0,n.exports=t(),!!0){var e=window.Cookies,o=window.Cookies=t();o.noConflict=function(){return window.Cookies=e,o}}}(function(){function _(){for(var t=0,e={};t<arguments.length;t++){var o=arguments[t];for(var n in o)e[n]=o[n]}return e}return function t(h){function p(t,e,o){var n;if("undefined"!=typeof document){if(1<arguments.length){if("number"==typeof(o=_({path:"/"},p.defaults,o)).expires){var i=new Date;i.setMilliseconds(i.getMilliseconds()+864e5*o.expires),o.expires=i}try{n=JSON.stringify(e),/^[\{\[]/.test(n)&&(e=n)}catch(t){}return e=h.write?h.write(e,t):encodeURIComponent(String(e)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=(t=(t=encodeURIComponent(String(t))).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape),document.cookie=[t,"=",e,o.expires?"; expires="+o.expires.toUTCString():"",o.path?"; path="+o.path:"",o.domain?"; domain="+o.domain:"",o.secure?"; secure":""].join("")}t||(n={});for(var r=document.cookie?document.cookie.split("; "):[],s=/(%[0-9A-Z]{2})+/g,a=0;a<r.length;a++){var l=r[a].split("="),c=l.slice(1).join("=");'"'===c.charAt(0)&&(c=c.slice(1,-1));try{var u=l[0].replace(s,decodeURIComponent);if(c=h.read?h.read(c,u):h(c,u)||c.replace(s,decodeURIComponent),this.json)try{c=JSON.parse(c)}catch(t){}if(t===u){n=c;break}t||(n[u]=c)}catch(t){}}return n}}return(p.set=p).get=function(t){return p.call(p,t)},p.getJSON=function(){return p.apply({json:!0},[].slice.call(arguments))},p.defaults={},p.remove=function(t,e){p(t,"",_(e,{expires:-1}))},p.withConverter=t,p}(function(){})})},135:function(t,e){var o={}.hasOwnProperty;t.exports=function(t,e){return o.call(t,e)}},136:function(t,e,o){var n=o(79),i=o(304);t.exports=o(78)?function(t,e,o){return n.f(t,e,i(1,o))}:function(t,e,o){return t[e]=o,t}},137:function(t,e,o){var n=o(481),i=o(204);t.exports=function(t){return n(i(t))}},147:function(t,e){t.exports={"workspace-headers-height":30,"resize-bar-width":13,"delete-opacity":"0.5","content-width":970}},149:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.fetchURLAsBlob=function(e,o){var t=new XMLHttpRequest;t.open("GET",e,!0),t.responseType="blob",t.onload=function(t){200===t.target.status?o(null,t.target.response):o(new Error("URL ".concat(e," responded with code ").concat(t.target.status)))},t.onerror=function(t){return o(new Error("Error ".concat(t.target.status," occurred while receiving the document.")))},t.send()},e.blobToDataURI=function(t,e){var o=new FileReader;o.onload=function(t){return e(t.target.result)},o.readAsDataURL(t)},e.dataURIToSourceSize=function(t){return a(t).then(function(t){return{x:t.width,y:t.height}})},e.dataURIFromURI=function(e){var o;return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(l(e));case 2:return o=t.sent,t.abrupt("return",o.toDataURL());case 4:case"end":return t.stop()}})},e.URIFromImageData=function(t){var e=document.createElement("canvas");return e.width=t.width,e.height=t.height,e.getContext("2d").putImageData(t,0,0),e.toDataURL()},e.dataURIToFramedBlob=function(t,o){var n=new Image,i=new Image;i.src=t,n.onload=function(){var t=document.createElement("canvas");t.width=n.width,t.height=n.height;var e=t.getContext("2d");e.drawImage(n,0,0),e.drawImage(i,175,52,154,154),t.toBlob&&t.toBlob(o)},n.src=r.default},e.svgToDataURI=function(e){var o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"image/png",n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return new Promise(function(t){i.e(8).then(i.t.bind(null,644,7)).then(function(){e.toDataURL(o,function(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{},n=Object.keys(Object(o));"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(o).filter(function(t){return Object.getOwnPropertyDescriptor(o,t).enumerable}))),n.forEach(function(t){s(e,t,o[t])})}return e}({},n,{callback:t}))})})},e.canvasToBlob=n,e.dataURIToBlob=function(e){var o;return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(l(e));case 2:return o=t.sent,t.next=5,regeneratorRuntime.awrap(n(o));case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}})},e.toImage=a,e.toCanvas=l,e.toImageData=function(e){var o;return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:if(e instanceof ImageData)return t.abrupt("return",e);t.next=2;break;case 2:return t.prev=2,t.next=5,regeneratorRuntime.awrap(l(e));case 5:return o=t.sent,t.abrupt("return",o.getContext("2d").getImageData(0,0,o.width,o.height));case 9:throw t.prev=9,t.t0=t.catch(2),new Error("Unable to convert input to ImageData: "+t.t0);case 12:case"end":return t.stop()}},null,null,[[2,9]])};var o,r=(o=i(268))&&o.__esModule?o:{default:o};function s(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function n(e){return new Promise(function(t){e.toBlob(t)})}function a(e){var n,i;return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:if(e instanceof HTMLImageElement)return t.abrupt("return",e);t.next=2;break;case 2:if(i=function(){},!(e instanceof Blob)){t.next=8;break}n=URL.createObjectURL(e),i=function(){return URL.revokeObjectURL(e)},t.next=13;break;case 8:if("string"!=typeof e){t.next=12;break}n=e,t.next=13;break;case 12:throw new Error("Unable to convert input to image");case 13:return t.abrupt("return",new Promise(function(t,e){var o=new Image;o.onload=function(){i(),t(o)},o.onerror=function(t){i(),e(t)},o.src=n}));case 14:case"end":return t.stop()}})}function l(e){var o,n;return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:if(e instanceof HTMLCanvasElement)return t.abrupt("return",e);t.next=2;break;case 2:return t.prev=2,t.next=5,regeneratorRuntime.awrap(a(e));case 5:return o=t.sent,(n=document.createElement("canvas")).width=o.width,n.height=o.height,n.getContext("2d").drawImage(o,0,0),t.abrupt("return",n);case 14:throw t.prev=14,t.t0=t.catch(2),new Error("Unable to convert input to canvas: "+t.t0);case 17:case"end":return t.stop()}},null,null,[[2,14]])}},150:function(t,e,o){"use strict";var n=o(39);t.exports=function(t,e){return!!t&&n(function(){e?t.call(null,function(){},1):t.call(null)})}},1581:function(t,e,o){"use strict";o(1582),o(1725),o(1727),o(1730),o(1732),o(1734),o(1736),o(1738),o(1740),o(1742),o(1744),o(1746),o(1748),o(1752)},1582:function(t,e,o){o(1583),o(1586),o(1587),o(1588),o(1589),o(1590),o(1591),o(1592),o(1593),o(1594),o(1595),o(1596),o(1597),o(1598),o(1599),o(1600),o(1601),o(1602),o(1603),o(1604),o(1605),o(1606),o(1607),o(1608),o(1609),o(1610),o(1611),o(1612),o(1613),o(1614),o(1615),o(1616),o(1617),o(1618),o(1619),o(1620),o(1621),o(1622),o(1623),o(1624),o(1625),o(1626),o(1627),o(1629),o(1630),o(1631),o(1632),o(1633),o(1634),o(1635),o(1636),o(1637),o(1638),o(1639),o(1640),o(1641),o(1642),o(1643),o(1644),o(1645),o(1646),o(1647),o(1648),o(1649),o(1650),o(1651),o(1652),o(1653),o(1654),o(1655),o(1656),o(1657),o(1658),o(1659),o(1660),o(1661),o(1662),o(1664),o(1665),o(1667),o(1668),o(1669),o(1670),o(1671),o(1672),o(1673),o(1675),o(1676),o(1677),o(1678),o(1679),o(1680),o(1681),o(1682),o(1683),o(1684),o(1685),o(1686),o(1687),o(893),o(1688),o(1150),o(1689),o(1151),o(1690),o(1691),o(1692),o(1693),o(1152),o(1696),o(1697),o(1698),o(1699),o(1700),o(1701),o(1702),o(1703),o(1704),o(1705),o(1706),o(1707),o(1708),o(1709),o(1710),o(1711),o(1712),o(1713),o(1714),o(1715),o(1716),o(1717),o(1718),o(1719),o(1720),o(1721),o(1722),o(1723),o(1724),t.exports=o(73)},1583:function(t,e,o){"use strict";var n=o(38),s=o(135),i=o(78),r=o(10),a=o(123),l=o(258).KEY,c=o(39),u=o(617),h=o(345),p=o(305),_=o(50),d=o(874),g=o(1131),f=o(1585),T=o(620),v=o(40),E=o(41),y=o(100),m=o(137),b=o(257),S=o(304),I=o(309),R=o(1134),C=o(172),k=o(619),O=o(79),A=o(307),D=C.f,w=O.f,N=R.f,M=n.Symbol,L=n.JSON,P=L&&L.stringify,B="prototype",x=_("_hidden"),F=_("toPrimitive"),U={}.propertyIsEnumerable,H=u("symbol-registry"),G=u("symbols"),W=u("op-symbols"),V=Object[B],X="function"==typeof M&&!!k.f,Y=n.QObject,z=!Y||!Y[B]||!Y[B].findChild,J=i&&c(function(){return 7!=I(w({},"a",{get:function(){return w(this,"a",{value:7}).a}})).a})?function(t,e,o){var n=D(V,e);n&&delete V[e],w(t,e,o),n&&t!==V&&w(V,e,n)}:w,K=function(t){var e=G[t]=I(M[B]);return e._k=t,e},j=X&&"symbol"==typeof M.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof M},q=function(t,e,o){return t===V&&q(W,e,o),v(t),e=b(e,!0),v(o),s(G,e)?(o.enumerable?(s(t,x)&&t[x][e]&&(t[x][e]=!1),o=I(o,{enumerable:S(0,!1)})):(s(t,x)||w(t,x,S(1,{})),t[x][e]=!0),J(t,e,o)):w(t,e,o)},Z=function(t,e){v(t);for(var o,n=f(e=m(e)),i=0,r=n.length;i<r;)q(t,o=n[i++],e[o]);return t},Q=function(t){var e=U.call(this,t=b(t,!0));return!(this===V&&s(G,t)&&!s(W,t))&&(!(e||!s(this,t)||!s(G,t)||s(this,x)&&this[x][t])||e)},$=function(t,e){if(t=m(t),e=b(e,!0),t!==V||!s(G,e)||s(W,e)){var o=D(t,e);return!o||!s(G,e)||s(t,x)&&t[x][e]||(o.enumerable=!0),o}},tt=function(t){for(var e,o=N(m(t)),n=[],i=0;o.length>i;)s(G,e=o[i++])||e==x||e==l||n.push(e);return n},et=function(t){for(var e,o=t===V,n=N(o?W:m(t)),i=[],r=0;n.length>r;)!s(G,e=n[r++])||o&&!s(V,e)||i.push(G[e]);return i};X||(a((M=function(){if(this instanceof M)throw TypeError("Symbol is not a constructor!");var e=p(0<arguments.length?arguments[0]:void 0),o=function(t){this===V&&o.call(W,t),s(this,x)&&s(this[x],e)&&(this[x][e]=!1),J(this,e,S(1,t))};return i&&z&&J(V,e,{configurable:!0,set:o}),K(e)})[B],"toString",function(){return this._k}),C.f=$,O.f=q,o(310).f=R.f=tt,o(482).f=Q,k.f=et,i&&!o(306)&&a(V,"propertyIsEnumerable",Q,!0),d.f=function(t){return K(_(t))}),r(r.G+r.W+r.F*!X,{Symbol:M});for(var ot="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),nt=0;ot.length>nt;)_(ot[nt++]);for(var it=A(_.store),rt=0;it.length>rt;)g(it[rt++]);r(r.S+r.F*!X,"Symbol",{for:function(t){return s(H,t+="")?H[t]:H[t]=M(t)},keyFor:function(t){if(!j(t))throw TypeError(t+" is not a symbol!");for(var e in H)if(H[e]===t)return e},useSetter:function(){z=!0},useSimple:function(){z=!1}}),r(r.S+r.F*!X,"Object",{create:function(t,e){return void 0===e?I(t):Z(I(t),e)},defineProperty:q,defineProperties:Z,getOwnPropertyDescriptor:$,getOwnPropertyNames:tt,getOwnPropertySymbols:et});var st=c(function(){k.f(1)});r(r.S+r.F*st,"Object",{getOwnPropertySymbols:function(t){return k.f(y(t))}}),L&&r(r.S+r.F*(!X||c(function(){var t=M();return"[null]"!=P([t])||"{}"!=P({a:t})||"{}"!=P(Object(t))})),"JSON",{stringify:function(t){for(var e,o,n=[t],i=1;arguments.length>i;)n.push(arguments[i++]);if(o=e=n[1],(E(e)||void 0!==t)&&!j(t))return T(e)||(e=function(t,e){if("function"==typeof o&&(e=o.call(this,t,e)),!j(e))return e}),n[1]=e,P.apply(L,n)}}),M[B][F]||o(136)(M[B],F,M[B].valueOf),h(M,"Symbol"),h(Math,"Math",!0),h(n.JSON,"JSON",!0)},1584:function(t,e,o){t.exports=o(617)("native-function-to-string",Function.toString)},1585:function(t,e,o){var a=o(307),l=o(619),c=o(482);t.exports=function(t){var e=a(t),o=l.f;if(o)for(var n,i=o(t),r=c.f,s=0;i.length>s;)r.call(t,n=i[s++])&&e.push(n);return e}},1586:function(t,e,o){var n=o(10);n(n.S,"Object",{create:o(309)})},1587:function(t,e,o){var n=o(10);n(n.S+n.F*!o(78),"Object",{defineProperty:o(79).f})},1588:function(t,e,o){var n=o(10);n(n.S+n.F*!o(78),"Object",{defineProperties:o(1133)})},1589:function(t,e,o){var n=o(137),i=o(172).f;o(173)("getOwnPropertyDescriptor",function(){return function(t,e){return i(n(t),e)}})},1590:function(t,e,o){var n=o(100),i=o(311);o(173)("getPrototypeOf",function(){return function(t){return i(n(t))}})},1591:function(t,e,o){var n=o(100),i=o(307);o(173)("keys",function(){return function(t){return i(n(t))}})},1592:function(t,e,o){o(173)("getOwnPropertyNames",function(){return o(1134).f})},1593:function(t,e,o){var n=o(41),i=o(258).onFreeze;o(173)("freeze",function(e){return function(t){return e&&n(t)?e(i(t)):t}})},1594:function(t,e,o){var n=o(41),i=o(258).onFreeze;o(173)("seal",function(e){return function(t){return e&&n(t)?e(i(t)):t}})},1595:function(t,e,o){var n=o(41),i=o(258).onFreeze;o(173)("preventExtensions",function(e){return function(t){return e&&n(t)?e(i(t)):t}})},1596:function(t,e,o){var n=o(41);o(173)("isFrozen",function(e){return function(t){return!n(t)||!!e&&e(t)}})},1597:function(t,e,o){var n=o(41);o(173)("isSealed",function(e){return function(t){return!n(t)||!!e&&e(t)}})},1598:function(t,e,o){var n=o(41);o(173)("isExtensible",function(e){return function(t){return!!n(t)&&(!e||e(t))}})},1599:function(t,e,o){var n=o(10);n(n.S+n.F,"Object",{assign:o(1135)})},160:function(t,e,o){var s;t.exports=(s=o(264),function(u){var t=s,e=t.lib,o=e.WordArray,n=e.Hasher,i=t.algo,C=[];!function(){for(var t=0;t<64;t++)C[t]=4294967296*u.abs(u.sin(t+1))|0}();var r=i.MD5=n.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,e){for(var o=0;o<16;o++){var n=e+o,i=t[n];t[n]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var r=this._hash.words,s=t[e+0],a=t[e+1],l=t[e+2],c=t[e+3],u=t[e+4],h=t[e+5],p=t[e+6],_=t[e+7],d=t[e+8],g=t[e+9],f=t[e+10],T=t[e+11],v=t[e+12],E=t[e+13],y=t[e+14],m=t[e+15],b=r[0],S=r[1],I=r[2],R=r[3];S=D(S=D(S=D(S=D(S=A(S=A(S=A(S=A(S=O(S=O(S=O(S=O(S=k(S=k(S=k(S=k(S,I=k(I,R=k(R,b=k(b,S,I,R,s,7,C[0]),S,I,a,12,C[1]),b,S,l,17,C[2]),R,b,c,22,C[3]),I=k(I,R=k(R,b=k(b,S,I,R,u,7,C[4]),S,I,h,12,C[5]),b,S,p,17,C[6]),R,b,_,22,C[7]),I=k(I,R=k(R,b=k(b,S,I,R,d,7,C[8]),S,I,g,12,C[9]),b,S,f,17,C[10]),R,b,T,22,C[11]),I=k(I,R=k(R,b=k(b,S,I,R,v,7,C[12]),S,I,E,12,C[13]),b,S,y,17,C[14]),R,b,m,22,C[15]),I=O(I,R=O(R,b=O(b,S,I,R,a,5,C[16]),S,I,p,9,C[17]),b,S,T,14,C[18]),R,b,s,20,C[19]),I=O(I,R=O(R,b=O(b,S,I,R,h,5,C[20]),S,I,f,9,C[21]),b,S,m,14,C[22]),R,b,u,20,C[23]),I=O(I,R=O(R,b=O(b,S,I,R,g,5,C[24]),S,I,y,9,C[25]),b,S,c,14,C[26]),R,b,d,20,C[27]),I=O(I,R=O(R,b=O(b,S,I,R,E,5,C[28]),S,I,l,9,C[29]),b,S,_,14,C[30]),R,b,v,20,C[31]),I=A(I,R=A(R,b=A(b,S,I,R,h,4,C[32]),S,I,d,11,C[33]),b,S,T,16,C[34]),R,b,y,23,C[35]),I=A(I,R=A(R,b=A(b,S,I,R,a,4,C[36]),S,I,u,11,C[37]),b,S,_,16,C[38]),R,b,f,23,C[39]),I=A(I,R=A(R,b=A(b,S,I,R,E,4,C[40]),S,I,s,11,C[41]),b,S,c,16,C[42]),R,b,p,23,C[43]),I=A(I,R=A(R,b=A(b,S,I,R,g,4,C[44]),S,I,v,11,C[45]),b,S,m,16,C[46]),R,b,l,23,C[47]),I=D(I,R=D(R,b=D(b,S,I,R,s,6,C[48]),S,I,_,10,C[49]),b,S,y,15,C[50]),R,b,h,21,C[51]),I=D(I,R=D(R,b=D(b,S,I,R,v,6,C[52]),S,I,c,10,C[53]),b,S,f,15,C[54]),R,b,a,21,C[55]),I=D(I,R=D(R,b=D(b,S,I,R,d,6,C[56]),S,I,m,10,C[57]),b,S,p,15,C[58]),R,b,E,21,C[59]),I=D(I,R=D(R,b=D(b,S,I,R,u,6,C[60]),S,I,T,10,C[61]),b,S,l,15,C[62]),R,b,g,21,C[63]),r[0]=r[0]+b|0,r[1]=r[1]+S|0,r[2]=r[2]+I|0,r[3]=r[3]+R|0},_doFinalize:function(){var t=this._data,e=t.words,o=8*this._nDataBytes,n=8*t.sigBytes;e[n>>>5]|=128<<24-n%32;var i=u.floor(o/4294967296),r=o;e[15+(64+n>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),e[14+(64+n>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),t.sigBytes=4*(e.length+1),this._process();for(var s=this._hash,a=s.words,l=0;l<4;l++){var c=a[l];a[l]=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8)}return s},clone:function(){var t=n.clone.call(this);return t._hash=this._hash.clone(),t}});function k(t,e,o,n,i,r,s){var a=t+(e&o|~e&n)+i+s;return(a<<r|a>>>32-r)+e}function O(t,e,o,n,i,r,s){var a=t+(e&n|o&~n)+i+s;return(a<<r|a>>>32-r)+e}function A(t,e,o,n,i,r,s){var a=t+(e^o^n)+i+s;return(a<<r|a>>>32-r)+e}function D(t,e,o,n,i,r,s){var a=t+(o^(e|~n))+i+s;return(a<<r|a>>>32-r)+e}t.MD5=n._createHelper(r),t.HmacMD5=n._createHmacHelper(r)}(Math),s.MD5)},1600:function(t,e,o){var n=o(10);n(n.S,"Object",{is:o(1136)})},1601:function(t,e,o){var n=o(10);n(n.S,"Object",{setPrototypeOf:o(878).set})},1602:function(t,e,o){"use strict";var n=o(483),i={};i[o(50)("toStringTag")]="z",i+""!="[object z]"&&o(123)(Object.prototype,"toString",function(){return"[object "+n(this)+"]"},!0)},1603:function(t,e,o){var n=o(10);n(n.P,"Function",{bind:o(1137)})},1604:function(t,e,o){var n=o(79).f,i=Function.prototype,r=/^\s*function ([^ (]*)/;"name"in i||o(78)&&n(i,"name",{configurable:!0,get:function(){try{return(""+this).match(r)[1]}catch(t){return""}}})},1605:function(t,e,o){"use strict";var n=o(41),i=o(311),r=o(50)("hasInstance"),s=Function.prototype;r in s||o(79).f(s,r,{value:function(t){if("function"!=typeof this||!n(t))return!1;if(!n(this.prototype))return t instanceof this;for(;t=i(t);)if(this.prototype===t)return!0;return!1}})},1606:function(t,e,o){var n=o(10),i=o(1139);n(n.G+n.F*(parseInt!=i),{parseInt:i})},1607:function(t,e,o){var n=o(10),i=o(1140);n(n.G+n.F*(parseFloat!=i),{parseFloat:i})},1608:function(t,e,o){"use strict";var n=o(38),i=o(135),r=o(203),s=o(880),u=o(257),a=o(39),l=o(310).f,c=o(172).f,h=o(79).f,p=o(346).trim,_="Number",d=n[_],g=d,f=d.prototype,T=r(o(309)(f))==_,v="trim"in String.prototype,E=function(t){var e=u(t,!1);if("string"==typeof e&&2<e.length){var o,n,i,r=(e=v?e.trim():p(e,3)).charCodeAt(0);if(43===r||45===r){if(88===(o=e.charCodeAt(2))||120===o)return NaN}else if(48===r){switch(e.charCodeAt(1)){case 66:case 98:n=2,i=49;break;case 79:case 111:n=8,i=55;break;default:return+e}for(var s,a=e.slice(2),l=0,c=a.length;l<c;l++)if((s=a.charCodeAt(l))<48||i<s)return NaN;return parseInt(a,n)}}return+e};if(!d(" 0o1")||!d("0b1")||d("+0x1")){d=function(t){var e=arguments.length<1?0:t,o=this;return o instanceof d&&(T?a(function(){f.valueOf.call(o)}):r(o)!=_)?s(new g(E(e)),o,d):E(e)};for(var y,m=o(78)?l(g):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),b=0;m.length>b;b++)i(g,y=m[b])&&!i(d,y)&&h(d,y,c(g,y));(d.prototype=f).constructor=d,o(123)(n,_,d)}},1609:function(t,e,o){"use strict";var n=o(10),c=o(171),u=o(1141),h=o(881),i=1..toFixed,r=Math.floor,s=[0,0,0,0,0,0],p="Number.toFixed: incorrect invocation!",_=function(t,e){for(var o=-1,n=e;++o<6;)n+=t*s[o],s[o]=n%1e7,n=r(n/1e7)},d=function(t){for(var e=6,o=0;0<=--e;)o+=s[e],s[e]=r(o/t),o=o%t*1e7},g=function(){for(var t=6,e="";0<=--t;)if(""!==e||0===t||0!==s[t]){var o=String(s[t]);e=""===e?o:e+h.call("0",7-o.length)+o}return e},f=function(t,e,o){return 0===e?o:e%2==1?f(t,e-1,o*t):f(t*t,e/2,o)};n(n.P+n.F*(!!i&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!o(39)(function(){i.call({})})),"Number",{toFixed:function(t){var e,o,n,i,r=u(this,p),s=c(t),a="",l="0";if(s<0||20<s)throw RangeError(p);if(r!=r)return"NaN";if(r<=-1e21||1e21<=r)return String(r);if(r<0&&(a="-",r=-r),1e-21<r)if(o=(e=function(t){for(var e=0,o=t;4096<=o;)e+=12,o/=4096;for(;2<=o;)e+=1,o/=2;return e}(r*f(2,69,1))-69)<0?r*f(2,-e,1):r/f(2,e,1),o*=4503599627370496,0<(e=52-e)){for(_(0,o),n=s;7<=n;)_(1e7,0),n-=7;for(_(f(10,n,1),0),n=e-1;23<=n;)d(1<<23),n-=23;d(1<<n),_(1,1),d(2),l=g()}else _(0,o),_(1<<-e,0),l=g()+h.call("0",s);return l=0<s?a+((i=l.length)<=s?"0."+h.call("0",s-i)+l:l.slice(0,i-s)+"."+l.slice(i-s)):a+l}})},1610:function(t,e,o){"use strict";var n=o(10),i=o(39),r=o(1141),s=1..toPrecision;n(n.P+n.F*(i(function(){return"1"!==s.call(1,void 0)})||!i(function(){s.call({})})),"Number",{toPrecision:function(t){var e=r(this,"Number#toPrecision: incorrect invocation!");return void 0===t?s.call(e):s.call(e,t)}})},1611:function(t,e,o){var n=o(10);n(n.S,"Number",{EPSILON:Math.pow(2,-52)})},1612:function(t,e,o){var n=o(10),i=o(38).isFinite;n(n.S,"Number",{isFinite:function(t){return"number"==typeof t&&i(t)}})},1613:function(t,e,o){var n=o(10);n(n.S,"Number",{isInteger:o(1142)})},1614:function(t,e,o){var n=o(10);n(n.S,"Number",{isNaN:function(t){return t!=t}})},1615:function(t,e,o){var n=o(10),i=o(1142),r=Math.abs;n(n.S,"Number",{isSafeInteger:function(t){return i(t)&&r(t)<=9007199254740991}})},1616:function(t,e,o){var n=o(10);n(n.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},1617:function(t,e,o){var n=o(10);n(n.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},1618:function(t,e,o){var n=o(10),i=o(1140);n(n.S+n.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},1619:function(t,e,o){var n=o(10),i=o(1139);n(n.S+n.F*(Number.parseInt!=i),"Number",{parseInt:i})},1620:function(t,e,o){var n=o(10),i=o(1143),r=Math.sqrt,s=Math.acosh;n(n.S+n.F*!(s&&710==Math.floor(s(Number.MAX_VALUE))&&s(1/0)==1/0),"Math",{acosh:function(t){return(t=+t)<1?NaN:94906265.62425156<t?Math.log(t)+Math.LN2:i(t-1+r(t-1)*r(t+1))}})},1621:function(t,e,o){var n=o(10),i=Math.asinh;n(n.S+n.F*!(i&&0<1/i(0)),"Math",{asinh:function t(e){return isFinite(e=+e)&&0!=e?e<0?-t(-e):Math.log(e+Math.sqrt(e*e+1)):e}})},1622:function(t,e,o){var n=o(10),i=Math.atanh;n(n.S+n.F*!(i&&1/i(-0)<0),"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},1623:function(t,e,o){var n=o(10),i=o(882);n(n.S,"Math",{cbrt:function(t){return i(t=+t)*Math.pow(Math.abs(t),1/3)}})},1624:function(t,e,o){var n=o(10);n(n.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},1625:function(t,e,o){var n=o(10),i=Math.exp;n(n.S,"Math",{cosh:function(t){return(i(t=+t)+i(-t))/2}})},1626:function(t,e,o){var n=o(10),i=o(883);n(n.S+n.F*(i!=Math.expm1),"Math",{expm1:i})},1627:function(t,e,o){var n=o(10);n(n.S,"Math",{fround:o(1628)})},1628:function(t,e,o){var r=o(882),n=Math.pow,s=n(2,-52),a=n(2,-23),l=n(2,127)*(2-a),c=n(2,-126);t.exports=Math.fround||function(t){var e,o,n=Math.abs(t),i=r(t);return n<c?i*function(t){return t+1/s-1/s}(n/c/a)*c*a:l<(o=(e=(1+a/s)*n)-(e-n))||o!=o?i*(1/0):i*o}},1629:function(t,e,o){var n=o(10),l=Math.abs;n(n.S,"Math",{hypot:function(t,e){for(var o,n,i=0,r=0,s=arguments.length,a=0;r<s;)a<(o=l(arguments[r++]))?(i=i*(n=a/o)*n+1,a=o):i+=0<o?(n=o/a)*n:o;return a===1/0?1/0:a*Math.sqrt(i)}})},1630:function(t,e,o){var n=o(10),i=Math.imul;n(n.S+n.F*o(39)(function(){return-5!=i(4294967295,5)||2!=i.length}),"Math",{imul:function(t,e){var o=65535,n=+t,i=+e,r=o&n,s=o&i;return 0|r*s+((o&n>>>16)*s+r*(o&i>>>16)<<16>>>0)}})},1631:function(t,e,o){var n=o(10);n(n.S,"Math",{log10:function(t){return Math.log(t)*Math.LOG10E}})},1632:function(t,e,o){var n=o(10);n(n.S,"Math",{log1p:o(1143)})},1633:function(t,e,o){var n=o(10);n(n.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},1634:function(t,e,o){var n=o(10);n(n.S,"Math",{sign:o(882)})},1635:function(t,e,o){var n=o(10),i=o(883),r=Math.exp;n(n.S+n.F*o(39)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(i(t)-i(-t))/2:(r(t-1)-r(-t-1))*(Math.E/2)}})},1636:function(t,e,o){var n=o(10),i=o(883),r=Math.exp;n(n.S,"Math",{tanh:function(t){var e=i(t=+t),o=i(-t);return e==1/0?1:o==1/0?-1:(e-o)/(r(t)+r(-t))}})},1637:function(t,e,o){var n=o(10);n(n.S,"Math",{trunc:function(t){return(0<t?Math.floor:Math.ceil)(t)}})},1638:function(t,e,o){var n=o(10),r=o(308),s=String.fromCharCode,i=String.fromCodePoint;n(n.S+n.F*(!!i&&1!=i.length),"String",{fromCodePoint:function(t){for(var e,o=[],n=arguments.length,i=0;i<n;){if(e=+arguments[i++],r(e,1114111)!==e)throw RangeError(e+" is not a valid code point");o.push(e<65536?s(e):s(55296+((e-=65536)>>10),e%1024+56320))}return o.join("")}})},1639:function(t,e,o){var n=o(10),s=o(137),a=o(59);n(n.S,"String",{raw:function(t){for(var e=s(t.raw),o=a(e.length),n=arguments.length,i=[],r=0;r<o;)i.push(String(e[r++])),r<n&&i.push(String(arguments[r]));return i.join("")}})},1640:function(t,e,o){"use strict";o(346)("trim",function(t){return function(){return t(this,3)}})},1641:function(t,e,o){"use strict";var n=o(884)(!0);o(885)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,o=this._i;return o>=e.length?{value:void 0,done:!0}:(t=n(e,o),this._i+=t.length,{value:t,done:!1})})},1642:function(t,e,o){"use strict";var n=o(10),i=o(884)(!1);n(n.P,"String",{codePointAt:function(t){return i(this,t)}})},1643:function(t,e,o){"use strict";var n=o(10),s=o(59),a=o(886),l="endsWith",c=""[l];n(n.P+n.F*o(888)(l),"String",{endsWith:function(t){var e=a(this,t,l),o=1<arguments.length?arguments[1]:void 0,n=s(e.length),i=void 0===o?n:Math.min(s(o),n),r=String(t);return c?c.call(e,r,i):e.slice(i-r.length,i)===r}})},1644:function(t,e,o){"use strict";var n=o(10),i=o(886),r="includes";n(n.P+n.F*o(888)(r),"String",{includes:function(t){return!!~i(this,t,r).indexOf(t,1<arguments.length?arguments[1]:void 0)}})},1645:function(t,e,o){var n=o(10);n(n.P,"String",{repeat:o(881)})},1646:function(t,e,o){"use strict";var n=o(10),i=o(59),r=o(886),s="startsWith",a=""[s];n(n.P+n.F*o(888)(s),"String",{startsWith:function(t){var e=r(this,t,s),o=i(Math.min(1<arguments.length?arguments[1]:void 0,e.length)),n=String(t);return a?a.call(e,n,o):e.slice(o,o+n.length)===n}})},1647:function(t,e,o){"use strict";o(124)("anchor",function(e){return function(t){return e(this,"a","name",t)}})},1648:function(t,e,o){"use strict";o(124)("big",function(t){return function(){return t(this,"big","","")}})},1649:function(t,e,o){"use strict";o(124)("blink",function(t){return function(){return t(this,"blink","","")}})},1650:function(t,e,o){"use strict";o(124)("bold",function(t){return function(){return t(this,"b","","")}})},1651:function(t,e,o){"use strict";o(124)("fixed",function(t){return function(){return t(this,"tt","","")}})},1652:function(t,e,o){"use strict";o(124)("fontcolor",function(e){return function(t){return e(this,"font","color",t)}})},1653:function(t,e,o){"use strict";o(124)("fontsize",function(e){return function(t){return e(this,"font","size",t)}})},1654:function(t,e,o){"use strict";o(124)("italics",function(t){return function(){return t(this,"i","","")}})},1655:function(t,e,o){"use strict";o(124)("link",function(e){return function(t){return e(this,"a","href",t)}})},1656:function(t,e,o){"use strict";o(124)("small",function(t){return function(){return t(this,"small","","")}})},1657:function(t,e,o){"use strict";o(124)("strike",function(t){return function(){return t(this,"strike","","")}})},1658:function(t,e,o){"use strict";o(124)("sub",function(t){return function(){return t(this,"sub","","")}})},1659:function(t,e,o){"use strict";o(124)("sup",function(t){return function(){return t(this,"sup","","")}})},1660:function(t,e,o){var n=o(10);n(n.S,"Date",{now:function(){return(new Date).getTime()}})},1661:function(t,e,o){"use strict";var n=o(10),i=o(100),r=o(257);n(n.P+n.F*o(39)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(t){var e=i(this),o=r(e);return"number"!=typeof o||isFinite(o)?e.toISOString():null}})},1662:function(t,e,o){var n=o(10),i=o(1663);n(n.P+n.F*(Date.prototype.toISOString!==i),"Date",{toISOString:i})},1663:function(t,e,o){"use strict";var n=o(39),i=Date.prototype.getTime,r=Date.prototype.toISOString,s=function(t){return 9<t?t:"0"+t};t.exports=n(function(){return"0385-07-25T07:06:39.999Z"!=r.call(new Date(-5e13-1))})||!n(function(){r.call(new Date(NaN))})?function(){if(!isFinite(i.call(this)))throw RangeError("Invalid time value");var t=this,e=t.getUTCFullYear(),o=t.getUTCMilliseconds(),n=e<0?"-":9999<e?"+":"";return n+("00000"+Math.abs(e)).slice(n?-6:-4)+"-"+s(t.getUTCMonth()+1)+"-"+s(t.getUTCDate())+"T"+s(t.getUTCHours())+":"+s(t.getUTCMinutes())+":"+s(t.getUTCSeconds())+"."+(99<o?o:"0"+s(o))+"Z"}:r},1664:function(t,e,o){var n=Date.prototype,i="Invalid Date",r="toString",s=n[r],a=n.getTime;new Date(NaN)+""!=i&&o(123)(n,r,function(){var t=a.call(this);return t==t?s.call(this):i})},1665:function(t,e,o){var n=o(50)("toPrimitive"),i=Date.prototype;n in i||o(136)(i,n,o(1666))},1666:function(t,e,o){"use strict";var n=o(40),i=o(257);t.exports=function(t){if("string"!==t&&"number"!==t&&"default"!==t)throw TypeError("Incorrect hint");return i(n(this),"number"!=t)}},1667:function(t,e,o){var n=o(10);n(n.S,"Array",{isArray:o(620)})},1668:function(t,e,o){"use strict";var p=o(169),n=o(10),_=o(100),d=o(1145),g=o(889),f=o(59),T=o(890),v=o(891);n(n.S+n.F*!o(621)(function(t){Array.from(t)}),"Array",{from:function(t){var e,o,n,i,r=_(t),s="function"==typeof this?this:Array,a=arguments.length,l=1<a?arguments[1]:void 0,c=void 0!==l,u=0,h=v(r);if(c&&(l=p(l,2<a?arguments[2]:void 0,2)),null==h||s==Array&&g(h))for(o=new s(e=f(r.length));u<e;u++)T(o,u,c?l(r[u],u):r[u]);else for(i=h.call(r),o=new s;!(n=i.next()).done;u++)T(o,u,c?d(i,l,[n.value,u],!0):n.value);return o.length=u,o}})},1669:function(t,e,o){"use strict";var n=o(10),i=o(890);n(n.S+n.F*o(39)(function(){function t(){}return!(Array.of.call(t)instanceof t)}),"Array",{of:function(){for(var t=0,e=arguments.length,o=new("function"==typeof this?this:Array)(e);t<e;)i(o,t,arguments[t++]);return o.length=e,o}})},1670:function(t,e,o){"use strict";var n=o(10),i=o(137),r=[].join;n(n.P+n.F*(o(481)!=Object||!o(150)(r)),"Array",{join:function(t){return r.call(i(this),void 0===t?",":t)}})},1671:function(t,e,o){"use strict";var n=o(10),i=o(877),c=o(203),u=o(308),h=o(59),p=[].slice;n(n.P+n.F*o(39)(function(){i&&p.call(i)}),"Array",{slice:function(t,e){var o=h(this.length),n=c(this);if(e=void 0===e?o:e,"Array"==n)return p.call(this,t,e);for(var i=u(t,o),r=u(e,o),s=h(r-i),a=new Array(s),l=0;l<s;l++)a[l]="String"==n?this.charAt(i+l):this[i+l];return a}})},1672:function(t,e,o){"use strict";var n=o(10),i=o(170),r=o(100),s=o(39),a=[].sort,l=[1,2,3];n(n.P+n.F*(s(function(){l.sort(void 0)})||!s(function(){l.sort(null)})||!o(150)(a)),"Array",{sort:function(t){return void 0===t?a.call(r(this)):a.call(r(this),i(t))}})},1673:function(t,e,o){"use strict";var n=o(10),i=o(174)(0),r=o(150)([].forEach,!0);n(n.P+n.F*!r,"Array",{forEach:function(t){return i(this,t,arguments[1])}})},1674:function(t,e,o){var n=o(41),i=o(620),r=o(50)("species");t.exports=function(t){var e;return i(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!i(e.prototype)||(e=void 0),n(e)&&null===(e=e[r])&&(e=void 0)),void 0===e?Array:e}},1675:function(t,e,o){"use strict";var n=o(10),i=o(174)(1);n(n.P+n.F*!o(150)([].map,!0),"Array",{map:function(t){return i(this,t,arguments[1])}})},1676:function(t,e,o){"use strict";var n=o(10),i=o(174)(2);n(n.P+n.F*!o(150)([].filter,!0),"Array",{filter:function(t){return i(this,t,arguments[1])}})},1677:function(t,e,o){"use strict";var n=o(10),i=o(174)(3);n(n.P+n.F*!o(150)([].some,!0),"Array",{some:function(t){return i(this,t,arguments[1])}})},1678:function(t,e,o){"use strict";var n=o(10),i=o(174)(4);n(n.P+n.F*!o(150)([].every,!0),"Array",{every:function(t){return i(this,t,arguments[1])}})},1679:function(t,e,o){"use strict";var n=o(10),i=o(1147);n(n.P+n.F*!o(150)([].reduce,!0),"Array",{reduce:function(t){return i(this,t,arguments.length,arguments[1],!1)}})},1680:function(t,e,o){"use strict";var n=o(10),i=o(1147);n(n.P+n.F*!o(150)([].reduceRight,!0),"Array",{reduceRight:function(t){return i(this,t,arguments.length,arguments[1],!0)}})},1681:function(t,e,o){"use strict";var n=o(10),i=o(618)(!1),r=[].indexOf,s=!!r&&1/[1].indexOf(1,-0)<0;n(n.P+n.F*(s||!o(150)(r)),"Array",{indexOf:function(t){return s?r.apply(this,arguments)||0:i(this,t,arguments[1])}})},1682:function(t,e,o){"use strict";var n=o(10),i=o(137),r=o(171),s=o(59),a=[].lastIndexOf,l=!!a&&1/[1].lastIndexOf(1,-0)<0;n(n.P+n.F*(l||!o(150)(a)),"Array",{lastIndexOf:function(t){if(l)return a.apply(this,arguments)||0;var e=i(this),o=s(e.length),n=o-1;for(1<arguments.length&&(n=Math.min(n,r(arguments[1]))),n<0&&(n=o+n);0<=n;n--)if(n in e&&e[n]===t)return n||0;return-1}})},1683:function(t,e,o){var n=o(10);n(n.P,"Array",{copyWithin:o(1148)}),o(312)("copyWithin")},1684:function(t,e,o){var n=o(10);n(n.P,"Array",{fill:o(892)}),o(312)("fill")},1685:function(t,e,o){"use strict";var n=o(10),i=o(174)(5),r="find",s=!0;r in[]&&Array(1)[r](function(){s=!1}),n(n.P+n.F*s,"Array",{find:function(t){return i(this,t,1<arguments.length?arguments[1]:void 0)}}),o(312)(r)},1686:function(t,e,o){"use strict";var n=o(10),i=o(174)(6),r="findIndex",s=!0;r in[]&&Array(1)[r](function(){s=!1}),n(n.P+n.F*s,"Array",{findIndex:function(t){return i(this,t,1<arguments.length?arguments[1]:void 0)}}),o(312)(r)},1687:function(t,e,o){o(348)("Array")},1688:function(t,e,o){var n=o(38),r=o(880),i=o(79).f,s=o(310).f,a=o(887),l=o(622),c=n.RegExp,u=c,h=c.prototype,p=/a/g,_=/a/g,d=new c(p)!==p;if(o(78)&&(!d||o(39)(function(){return _[o(50)("match")]=!1,c(p)!=p||c(_)==_||"/a/i"!=c(p,"i")}))){c=function(t,e){var o=this instanceof c,n=a(t),i=void 0===e;return!o&&n&&t.constructor===c&&i?t:r(d?new u(n&&!i?t.source:t,e):u((n=t instanceof c)?t.source:t,n&&i?l.call(t):e),o?this:h,c)};for(var g=function(e){e in c||i(c,e,{configurable:!0,get:function(){return u[e]},set:function(t){u[e]=t}})},f=s(u),T=0;f.length>T;)g(f[T++]);(h.constructor=c).prototype=h,o(123)(n,"RegExp",c)}o(348)("RegExp")},1689:function(t,e,o){"use strict";o(1151);var n=o(40),i=o(622),r=o(78),s="toString",a=/./[s],l=function(t){o(123)(RegExp.prototype,s,t,!0)};o(39)(function(){return"/a/b"!=a.call({source:"a",flags:"b"})})?l(function(){var t=n(this);return"/".concat(t.source,"/","flags"in t?t.flags:!r&&t instanceof RegExp?i.call(t):void 0)}):a.name!=s&&l(function(){return a.call(this)})},169:function(t,e,o){var r=o(170);t.exports=function(n,i,t){if(r(n),void 0===i)return n;switch(t){case 1:return function(t){return n.call(i,t)};case 2:return function(t,e){return n.call(i,t,e)};case 3:return function(t,e,o){return n.call(i,t,e,o)}}return function(){return n.apply(i,arguments)}}},1690:function(t,e,o){"use strict";var h=o(40),p=o(59),_=o(895),d=o(623);o(624)("match",1,function(n,i,c,u){return[function(t){var e=n(this),o=null==t?void 0:t[i];return void 0!==o?o.call(t,e):new RegExp(t)[i](String(e))},function(t){var e=u(c,t,this);if(e.done)return e.value;var o=h(t),n=String(this);if(!o.global)return d(o,n);for(var i,r=o.unicode,s=[],a=o.lastIndex=0;null!==(i=d(o,n));){var l=String(i[0]);""===(s[a]=l)&&(o.lastIndex=_(n,p(o.lastIndex),r)),a++}return 0===a?null:s}]})},1691:function(t,e,o){"use strict";var I=o(40),n=o(100),R=o(59),C=o(171),k=o(895),O=o(623),A=Math.max,D=Math.min,p=Math.floor,_=/\$([$&`']|\d\d?|<[^>]*>)/g,d=/\$([$&`']|\d\d?)/g;o(624)("replace",2,function(i,r,m,b){return[function(t,e){var o=i(this),n=null==t?void 0:t[r];return void 0!==n?n.call(t,o,e):m.call(String(o),t,e)},function(t,e){var o=b(m,t,this,e);if(o.done)return o.value;var n=I(t),i=String(this),r="function"==typeof e;r||(e=String(e));var s=n.global;if(s){var a=n.unicode;n.lastIndex=0}for(var l=[];;){var c=O(n,i);if(null===c)break;if(l.push(c),!s)break;""===String(c[0])&&(n.lastIndex=k(i,R(n.lastIndex),a))}for(var u,h="",p=0,_=0;_<l.length;_++){c=l[_];for(var d=String(c[0]),g=A(D(C(c.index),i.length),0),f=[],T=1;T<c.length;T++)f.push(void 0===(u=c[T])?u:String(u));var v=c.groups;if(r){var E=[d].concat(f,g,i);void 0!==v&&E.push(v);var y=String(e.apply(void 0,E))}else y=S(d,i,g,f,v,e);p<=g&&(h+=i.slice(p,g)+y,p=g+d.length)}return h+i.slice(p)}];function S(r,s,a,l,c,t){var u=a+r.length,h=l.length,e=d;return void 0!==c&&(c=n(c),e=_),m.call(t,e,function(t,e){var o;switch(e.charAt(0)){case"$":return"$";case"&":return r;case"`":return s.slice(0,a);case"'":return s.slice(u);case"<":o=c[e.slice(1,-1)];break;default:var n=+e;if(0==n)return t;if(h<n){var i=p(n/10);return 0===i?t:i<=h?void 0===l[i-1]?e.charAt(1):l[i-1]+e.charAt(1):t}o=l[n-1]}return void 0===o?"":o})}})},1692:function(t,e,o){"use strict";var l=o(40),c=o(1136),u=o(623);o(624)("search",1,function(n,i,s,a){return[function(t){var e=n(this),o=null==t?void 0:t[i];return void 0!==o?o.call(t,e):new RegExp(t)[i](String(e))},function(t){var e=a(s,t,this);if(e.done)return e.value;var o=l(t),n=String(this),i=o.lastIndex;c(i,0)||(o.lastIndex=0);var r=u(o,n);return c(o.lastIndex,i)||(o.lastIndex=i),null===r?-1:r.index}]})},1693:function(t,e,o){"use strict";var h=o(887),E=o(40),y=o(484),m=o(895),b=o(59),S=o(623),p=o(894),n=o(39),I=Math.min,_=[].push,s="split",d="length",g="lastIndex",R=4294967295,C=!n(function(){RegExp(R,"y")});o(624)("split",2,function(i,r,f,T){var v;return v="c"=="abbc"[s](/(b)*/)[1]||4!="test"[s](/(?:)/,-1)[d]||2!="ab"[s](/(?:ab)*/)[d]||4!="."[s](/(.?)(.?)/)[d]||1<"."[s](/()()/)[d]||""[s](/.?/)[d]?function(t,e){var o=String(this);if(void 0===t&&0===e)return[];if(!h(t))return f.call(o,t,e);for(var n,i,r,s=[],a=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),l=0,c=void 0===e?R:e>>>0,u=new RegExp(t.source,a+"g");(n=p.call(u,o))&&!(l<(i=u[g])&&(s.push(o.slice(l,n.index)),1<n[d]&&n.index<o[d]&&_.apply(s,n.slice(1)),r=n[0][d],l=i,s[d]>=c));)u[g]===n.index&&u[g]++;return l===o[d]?!r&&u.test("")||s.push(""):s.push(o.slice(l)),s[d]>c?s.slice(0,c):s}:"0"[s](void 0,0)[d]?function(t,e){return void 0===t&&0===e?[]:f.call(this,t,e)}:f,[function(t,e){var o=i(this),n=null==t?void 0:t[r];return void 0!==n?n.call(t,o,e):v.call(String(o),t,e)},function(t,e){var o=T(v,t,this,e,v!==f);if(o.done)return o.value;var n=E(t),i=String(this),r=y(n,RegExp),s=n.unicode,a=(n.ignoreCase?"i":"")+(n.multiline?"m":"")+(n.unicode?"u":"")+(C?"y":"g"),l=new r(C?n:"^(?:"+n.source+")",a),c=void 0===e?R:e>>>0;if(0==c)return[];if(0===i.length)return null===S(l,i)?[i]:[];for(var u=0,h=0,p=[];h<i.length;){l.lastIndex=C?h:0;var _,d=S(l,C?i:i.slice(h));if(null===d||(_=I(b(l.lastIndex+(C?0:h)),i.length))===u)h=m(i,h,s);else{if(p.push(i.slice(u,h)),p.length===c)return p;for(var g=1;g<=d.length-1;g++)if(p.push(d[g]),p.length===c)return p;h=u=_}}return p.push(i.slice(u)),p}]})},1694:function(t,e,o){var a=o(38),l=o(896).set,c=a.MutationObserver||a.WebKitMutationObserver,u=a.process,h=a.Promise,p="process"==o(203)(u);t.exports=function(){var o,n,i,t=function(){var t,e;for(p&&(t=u.domain)&&t.exit();o;){e=o.fn,o=o.next;try{e()}catch(t){throw o?i():n=void 0,t}}n=void 0,t&&t.enter()};if(p)i=function(){u.nextTick(t)};else if(!c||a.navigator&&a.navigator.standalone)if(h&&h.resolve){var e=h.resolve(void 0);i=function(){e.then(t)}}else i=function(){l.call(a,t)};else{var r=!0,s=document.createTextNode("");new c(t).observe(s,{characterData:!0}),i=function(){s.data=r=!r}}return function(t){var e={fn:t,next:void 0};n&&(n.next=e),o||(o=e,i()),n=e}}},1695:function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},1696:function(t,e,o){"use strict";var n=o(1155),i=o(313);t.exports=o(627)("Map",function(t){return function(){return t(this,0<arguments.length?arguments[0]:void 0)}},{get:function(t){var e=n.getEntry(i(this,"Map"),t);return e&&e.v},set:function(t,e){return n.def(i(this,"Map"),0===t?0:t,e)}},n,!0)},1697:function(t,e,o){"use strict";var n=o(1155),i=o(313);t.exports=o(627)("Set",function(t){return function(){return t(this,0<arguments.length?arguments[0]:void 0)}},{add:function(t){return n.def(i(this,"Set"),t=0===t?0:t,t)}},n)},1698:function(t,e,o){"use strict";var r,n=o(38),i=o(174)(0),s=o(123),a=o(258),l=o(1135),c=o(1156),u=o(41),h=o(313),p=o(313),_=!n.ActiveXObject&&"ActiveXObject"in n,d="WeakMap",g=a.getWeak,f=Object.isExtensible,T=c.ufstore,v=function(t){return function(){return t(this,0<arguments.length?arguments[0]:void 0)}},E={get:function(t){if(u(t)){var e=g(t);return!0===e?T(h(this,d)).get(t):e?e[this._i]:void 0}},set:function(t,e){return c.def(h(this,d),t,e)}},y=t.exports=o(627)(d,v,E,c,!0,!0);p&&_&&(l((r=c.getConstructor(v,d)).prototype,E),a.NEED=!0,i(["delete","has","get","set"],function(n){var t=y.prototype,i=t[n];s(t,n,function(t,e){if(!u(t)||f(t))return i.call(this,t,e);this._f||(this._f=new r);var o=this._f[n](t,e);return"set"==n?this:o})}))},1699:function(t,e,o){"use strict";var n=o(1156),i=o(313),r="WeakSet";o(627)(r,function(t){return function(){return t(this,0<arguments.length?arguments[0]:void 0)}},{add:function(t){return n.def(i(this,r),t,!0)}},n,!1,!0)},170:function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},1700:function(t,e,o){"use strict";var n=o(10),i=o(628),r=o(897),c=o(40),u=o(308),h=o(59),s=o(41),a=o(38).ArrayBuffer,p=o(484),_=r.ArrayBuffer,d=r.DataView,l=i.ABV&&a.isView,g=_.prototype.slice,f=i.VIEW,T="ArrayBuffer";n(n.G+n.W+n.F*(a!==_),{ArrayBuffer:_}),n(n.S+n.F*!i.CONSTR,T,{isView:function(t){return l&&l(t)||s(t)&&f in t}}),n(n.P+n.U+n.F*o(39)(function(){return!new _(2).slice(1,void 0).byteLength}),T,{slice:function(t,e){if(void 0!==g&&void 0===e)return g.call(c(this),t);for(var o=c(this).byteLength,n=u(t,o),i=u(void 0===e?o:e,o),r=new(p(this,_))(h(i-n)),s=new d(this),a=new d(r),l=0;n<i;)a.setUint8(l++,s.getUint8(n++));return r}}),o(348)(T)},1701:function(t,e,o){var n=o(10);n(n.G+n.W+n.F*!o(628).ABV,{DataView:o(897).DataView})},1702:function(t,e,o){o(205)("Int8",1,function(n){return function(t,e,o){return n(this,t,e,o)}})},1703:function(t,e,o){o(205)("Uint8",1,function(n){return function(t,e,o){return n(this,t,e,o)}})},1704:function(t,e,o){o(205)("Uint8",1,function(n){return function(t,e,o){return n(this,t,e,o)}},!0)},1705:function(t,e,o){o(205)("Int16",2,function(n){return function(t,e,o){return n(this,t,e,o)}})},1706:function(t,e,o){o(205)("Uint16",2,function(n){return function(t,e,o){return n(this,t,e,o)}})},1707:function(t,e,o){o(205)("Int32",4,function(n){return function(t,e,o){return n(this,t,e,o)}})},1708:function(t,e,o){o(205)("Uint32",4,function(n){return function(t,e,o){return n(this,t,e,o)}})},1709:function(t,e,o){o(205)("Float32",4,function(n){return function(t,e,o){return n(this,t,e,o)}})},171:function(t,e){var o=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(0<t?n:o)(t)}},1710:function(t,e,o){o(205)("Float64",8,function(n){return function(t,e,o){return n(this,t,e,o)}})},1711:function(t,e,o){var n=o(10),r=o(170),s=o(40),a=(o(38).Reflect||{}).apply,l=Function.apply;n(n.S+n.F*!o(39)(function(){a(function(){})}),"Reflect",{apply:function(t,e,o){var n=r(t),i=s(o);return a?a(n,e,i):l.call(n,e,i)}})},1712:function(t,e,o){var n=o(10),a=o(309),l=o(170),c=o(40),u=o(41),i=o(39),h=o(1137),p=(o(38).Reflect||{}).construct,_=i(function(){function t(){}return!(p(function(){},[],t)instanceof t)}),d=!i(function(){p(function(){})});n(n.S+n.F*(_||d),"Reflect",{construct:function(t,e){l(t),c(e);var o=arguments.length<3?t:l(arguments[2]);if(d&&!_)return p(t,e,o);if(t==o){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var n=[null];return n.push.apply(n,e),new(h.apply(t,n))}var i=o.prototype,r=a(u(i)?i:Object.prototype),s=Function.apply.call(t,r,e);return u(s)?s:r}})},1713:function(t,e,o){var n=o(79),i=o(10),r=o(40),s=o(257);i(i.S+i.F*o(39)(function(){Reflect.defineProperty(n.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(t,e,o){r(t),e=s(e,!0),r(o);try{return n.f(t,e,o),!0}catch(t){return!1}}})},1714:function(t,e,o){var n=o(10),i=o(172).f,r=o(40);n(n.S,"Reflect",{deleteProperty:function(t,e){var o=i(r(t),e);return!(o&&!o.configurable)&&delete t[e]}})},1715:function(t,e,o){"use strict";var n=o(10),i=o(40),r=function(t){this._t=i(t),this._i=0;var e,o=this._k=[];for(e in t)o.push(e)};o(1144)(r,"Object",function(){var t,e=this._k;do{if(this._i>=e.length)return{value:void 0,done:!0}}while(!((t=e[this._i++])in this._t));return{value:t,done:!1}}),n(n.S,"Reflect",{enumerate:function(t){return new r(t)}})},1716:function(t,e,o){var s=o(172),a=o(311),l=o(135),n=o(10),c=o(41),u=o(40);n(n.S,"Reflect",{get:function t(e,o){var n,i,r=arguments.length<3?e:arguments[2];return u(e)===r?e[o]:(n=s.f(e,o))?l(n,"value")?n.value:void 0!==n.get?n.get.call(r):void 0:c(i=a(e))?t(i,o,r):void 0}})},1717:function(t,e,o){var n=o(172),i=o(10),r=o(40);i(i.S,"Reflect",{getOwnPropertyDescriptor:function(t,e){return n.f(r(t),e)}})},1718:function(t,e,o){var n=o(10),i=o(311),r=o(40);n(n.S,"Reflect",{getPrototypeOf:function(t){return i(r(t))}})},1719:function(t,e,o){var n=o(10);n(n.S,"Reflect",{has:function(t,e){return e in t}})},172:function(t,e,o){var n=o(482),i=o(304),r=o(137),s=o(257),a=o(135),l=o(1130),c=Object.getOwnPropertyDescriptor;e.f=o(78)?c:function(t,e){if(t=r(t),e=s(e,!0),l)try{return c(t,e)}catch(t){}if(a(t,e))return i(!n.f.call(t,e),t[e])}},1720:function(t,e,o){var n=o(10),i=o(40),r=Object.isExtensible;n(n.S,"Reflect",{isExtensible:function(t){return i(t),!r||r(t)}})},1721:function(t,e,o){var n=o(10);n(n.S,"Reflect",{ownKeys:o(1158)})},1722:function(t,e,o){var n=o(10),i=o(40),r=Object.preventExtensions;n(n.S,"Reflect",{preventExtensions:function(t){i(t);try{return r&&r(t),!0}catch(t){return!1}}})},1723:function(t,e,o){var l=o(79),c=o(172),u=o(311),h=o(135),n=o(10),p=o(304),_=o(40),d=o(41);n(n.S,"Reflect",{set:function t(e,o,n){var i,r,s=arguments.length<4?e:arguments[3],a=c.f(_(e),o);if(!a){if(d(r=u(e)))return t(r,o,n,s);a=p(0)}if(h(a,"value")){if(!1===a.writable||!d(s))return!1;if(i=c.f(s,o)){if(i.get||i.set||!1===i.writable)return!1;i.value=n,l.f(s,o,i)}else l.f(s,o,p(0,n));return!0}return void 0!==a.set&&(a.set.call(s,n),!0)}})},1724:function(t,e,o){var n=o(10),i=o(878);i&&n(n.S,"Reflect",{setPrototypeOf:function(t,e){i.check(t,e);try{return i.set(t,e),!0}catch(t){return!1}}})},1725:function(t,e,o){o(1726),t.exports=o(73).Array.includes},1726:function(t,e,o){"use strict";var n=o(10),i=o(618)(!0);n(n.P,"Array",{includes:function(t){return i(this,t,1<arguments.length?arguments[1]:void 0)}}),o(312)("includes")},1727:function(t,e,o){o(1728),t.exports=o(73).Array.flatMap},1728:function(t,e,o){"use strict";var n=o(10),i=o(1729),r=o(100),s=o(59),a=o(170),l=o(1146);n(n.P,"Array",{flatMap:function(t){var e,o,n=r(this);return a(t),e=s(n.length),o=l(n,0),i(o,n,n,e,0,1,t,arguments[1]),o}}),o(312)("flatMap")},1729:function(t,e,o){"use strict";var d=o(620),g=o(41),f=o(59),T=o(169),v=o(50)("isConcatSpreadable");t.exports=function t(e,o,n,i,r,s,a,l){for(var c,u,h=r,p=0,_=!!a&&T(a,l,3);p<i;){if(p in n){if(c=_?_(n[p],p,o):n[p],u=!1,g(c)&&(u=void 0!==(u=c[v])?!!u:d(c)),u&&0<s)h=t(e,o,c,f(c.length),h,s-1)-1;else{if(9007199254740991<=h)throw TypeError();e[h]=c}h++}p++}return h}},173:function(t,e,o){var i=o(10),r=o(73),s=o(39);t.exports=function(t,e){var o=(r.Object||{})[t]||Object[t],n={};n[t]=e(o),i(i.S+i.F*s(function(){o(1)}),"Object",n)}},1730:function(t,e,o){o(1731),t.exports=o(73).String.padStart},1731:function(t,e,o){"use strict";var n=o(10),i=o(1159),r=o(626),s=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(r);n(n.P+n.F*s,"String",{padStart:function(t){return i(this,t,1<arguments.length?arguments[1]:void 0,!0)}})},1732:function(t,e,o){o(1733),t.exports=o(73).String.padEnd},1733:function(t,e,o){"use strict";var n=o(10),i=o(1159),r=o(626),s=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(r);n(n.P+n.F*s,"String",{padEnd:function(t){return i(this,t,1<arguments.length?arguments[1]:void 0,!1)}})},1734:function(t,e,o){o(1735),t.exports=o(73).String.trimLeft},1735:function(t,e,o){"use strict";o(346)("trimLeft",function(t){return function(){return t(this,1)}},"trimStart")},1736:function(t,e,o){o(1737),t.exports=o(73).String.trimRight},1737:function(t,e,o){"use strict";o(346)("trimRight",function(t){return function(){return t(this,2)}},"trimEnd")},1738:function(t,e,o){o(1739),t.exports=o(874).f("asyncIterator")},1739:function(t,e,o){o(1131)("asyncIterator")},174:function(t,e,o){var E=o(169),y=o(481),m=o(100),b=o(59),n=o(1146);t.exports=function(h,t){var p=1==h,_=2==h,d=3==h,g=4==h,f=6==h,T=5==h||f,v=t||n;return function(t,e,o){for(var n,i,r=m(t),s=y(r),a=E(e,o,3),l=b(s.length),c=0,u=p?v(t,l):_?v(t,0):void 0;c<l;c++)if((T||c in s)&&(i=a(n=s[c],c,r),h))if(p)u[c]=i;else if(i)switch(h){case 3:return!0;case 5:return n;case 6:return c;case 2:u.push(n)}else if(g)return!1;return f?-1:d||g?g:u}}},1740:function(t,e,o){o(1741),t.exports=o(73).Object.getOwnPropertyDescriptors},1741:function(t,e,o){var n=o(10),l=o(1158),c=o(137),u=o(172),h=o(890);n(n.S,"Object",{getOwnPropertyDescriptors:function(t){for(var e,o,n=c(t),i=u.f,r=l(n),s={},a=0;r.length>a;)void 0!==(o=i(n,e=r[a++]))&&h(s,e,o);return s}})},1742:function(t,e,o){o(1743),t.exports=o(73).Object.values},1743:function(t,e,o){var n=o(10),i=o(1160)(!1);n(n.S,"Object",{values:function(t){return i(t)}})},1744:function(t,e,o){o(1745),t.exports=o(73).Object.entries},1745:function(t,e,o){var n=o(10),i=o(1160)(!0);n(n.S,"Object",{entries:function(t){return i(t)}})},1746:function(t,e,o){"use strict";o(1152),o(1747),t.exports=o(73).Promise.finally},1747:function(t,e,o){"use strict";var n=o(10),i=o(73),r=o(38),s=o(484),a=o(1154);n(n.P+n.R,"Promise",{finally:function(e){var o=s(this,i.Promise||r.Promise),t="function"==typeof e;return this.then(t?function(t){return a(o,e()).then(function(){return t})}:e,t?function(t){return a(o,e()).then(function(){throw t})}:e)}})},1748:function(t,e,o){o(1749),o(1750),o(1751),t.exports=o(73)},1749:function(t,e,o){var n=o(38),i=o(10),r=o(626),s=[].slice,a=/MSIE .\./.test(r),l=function(i){return function(t,e){var o=2<arguments.length,n=o&&s.call(arguments,2);return i(o?function(){("function"==typeof t?t:Function(t)).apply(this,n)}:t,e)}};i(i.G+i.B+i.F*a,{setTimeout:l(n.setTimeout),setInterval:l(n.setInterval)})},1750:function(t,e,o){var n=o(10),i=o(896);n(n.G+n.B,{setImmediate:i.set,clearImmediate:i.clear})},1751:function(t,e,o){for(var n=o(893),i=o(307),r=o(123),s=o(38),a=o(136),l=o(347),c=o(50),u=c("iterator"),h=c("toStringTag"),p=l.Array,_={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},d=i(_),g=0;g<d.length;g++){var f,T=d[g],v=_[T],E=s[T],y=E&&E.prototype;if(y&&(y[u]||a(y,u,p),y[h]||a(y,h,T),l[T]=p,v))for(f in n)y[f]||r(y,f,n[f],!0)}},1752:function(t,e,o){var n=function(r){"use strict";var l,t=Object.prototype,c=t.hasOwnProperty,e="function"==typeof Symbol?Symbol:{},i=e.iterator||"@@iterator",o=e.asyncIterator||"@@asyncIterator",n=e.toStringTag||"@@toStringTag";function s(t,e,o,n){var i=e&&e.prototype instanceof a?e:a,r=Object.create(i.prototype),s=new k(n||[]);return r._invoke=function(r,s,a){var l=h;return function(t,e){if(l===_)throw new Error("Generator is already running");if(l===d){if("throw"===t)throw e;return A()}for(a.method=t,a.arg=e;;){var o=a.delegate;if(o){var n=I(o,a);if(n){if(n===g)continue;return n}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(l===h)throw l=d,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);l=_;var i=u(r,s,a);if("normal"===i.type){if(l=a.done?d:p,i.arg===g)continue;return{value:i.arg,done:a.done}}"throw"===i.type&&(l=d,a.method="throw",a.arg=i.arg)}}}(t,o,s),r}function u(t,e,o){try{return{type:"normal",arg:t.call(e,o)}}catch(t){return{type:"throw",arg:t}}}r.wrap=s;var h="suspendedStart",p="suspendedYield",_="executing",d="completed",g={};function a(){}function f(){}function T(){}var v={};v[i]=function(){return this};var E=Object.getPrototypeOf,y=E&&E(E(O([])));y&&y!==t&&c.call(y,i)&&(v=y);var m=T.prototype=a.prototype=Object.create(v);function b(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function S(l){var e;this._invoke=function(o,n){function t(){return new Promise(function(t,e){!function e(t,o,n,i){var r=u(l[t],l,o);if("throw"!==r.type){var s=r.arg,a=s.value;return a&&"object"==typeof a&&c.call(a,"__await")?Promise.resolve(a.__await).then(function(t){e("next",t,n,i)},function(t){e("throw",t,n,i)}):Promise.resolve(a).then(function(t){s.value=t,n(s)},function(t){return e("throw",t,n,i)})}i(r.arg)}(o,n,t,e)})}return e=e?e.then(t,t):t()}}function I(t,e){var o=t.iterator[e.method];if(o===l){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=l,I(t,e),"throw"===e.method))return g;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var n=u(o,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,g;var i=n.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=l),e.delegate=null,g):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,g)}function R(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(R,this),this.reset(!0)}function O(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,n=function t(){for(;++o<e.length;)if(c.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=l,t.done=!0,t};return n.next=n}}return{next:A}}function A(){return{value:l,done:!0}}return f.prototype=m.constructor=T,T.constructor=f,T[n]=f.displayName="GeneratorFunction",r.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,T):(t.__proto__=T,n in t||(t[n]="GeneratorFunction")),t.prototype=Object.create(m),t},r.awrap=function(t){return{__await:t}},b(S.prototype),S.prototype[o]=function(){return this},r.AsyncIterator=S,r.async=function(t,e,o,n){var i=new S(s(t,e,o,n));return r.isGeneratorFunction(e)?i:i.next().then(function(t){return t.done?t.value:i.next()})},b(m),m[n]="Generator",m[i]=function(){return this},m.toString=function(){return"[object Generator]"},r.keys=function(o){var n=[];for(var t in o)n.push(t);return n.reverse(),function t(){for(;n.length;){var e=n.pop();if(e in o)return t.value=e,t.done=!1,t}return t.done=!0,t}},r.values=O,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=l,this.done=!1,this.delegate=null,this.method="next",this.arg=l,this.tryEntries.forEach(C),!t)for(var e in this)"t"===e.charAt(0)&&c.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=l)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(o){if(this.done)throw o;var n=this;function t(t,e){return r.type="throw",r.arg=o,n.next=t,e&&(n.method="next",n.arg=l),!!e}for(var e=this.tryEntries.length-1;0<=e;--e){var i=this.tryEntries[e],r=i.completion;if("root"===i.tryLoc)return t("end");if(i.tryLoc<=this.prev){var s=c.call(i,"catchLoc"),a=c.call(i,"finallyLoc");if(s&&a){if(this.prev<i.catchLoc)return t(i.catchLoc,!0);if(this.prev<i.finallyLoc)return t(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return t(i.catchLoc,!0)}else{if(!a)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return t(i.finallyLoc)}}}},abrupt:function(t,e){for(var o=this.tryEntries.length-1;0<=o;--o){var n=this.tryEntries[o];if(n.tryLoc<=this.prev&&c.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var r=i?i.completion:{};return r.type=t,r.arg=e,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(r)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var o=this.tryEntries[e];if(o.finallyLoc===t)return this.complete(o.completion,o.afterLoc),C(o),g}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var o=this.tryEntries[e];if(o.tryLoc===t){var n=o.completion;if("throw"===n.type){var i=n.arg;C(o)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,o){return this.delegate={iterator:O(t),resultName:e,nextLoc:o},"next"===this.method&&(this.arg=l),g}},r}(t.exports);try{regeneratorRuntime=n}catch(t){Function("r","regeneratorRuntime = r")(n)}},199:function(t,e,o){"use strict";o(629);var n,i=(n=o(630))&&n.__esModule?n:{default:n};HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(t,e,o){for(var n=atob(this.toDataURL(e,o).split(",")[1]),i=new Uint8Array(n.length),r=0;r<n.length;r++)i[r]=n.charCodeAt(r);t(new Blob([i],{type:e||"image/png"}))}}),void 0===SVGElement.prototype.getElementsByClassName&&(SVGElement.prototype.getElementsByClassName=function(t){return this.querySelectorAll("."+t)}),document.evaluate||i.default.install(window)},203:function(t,e){var o={}.toString;t.exports=function(t){return o.call(t).slice(8,-1)}},204:function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},205:function(t,e,o){"use strict";if(o(78)){var T=o(306),v=o(38),E=o(39),y=o(10),m=o(628),n=o(897),p=o(169),b=o(349),i=o(304),S=o(136),r=o(350),s=o(171),I=o(59),R=o(1157),a=o(308),l=o(257),c=o(135),C=o(483),k=o(41),_=o(100),d=o(889),O=o(309),A=o(311),D=o(310).f,g=o(891),u=o(305),h=o(50),f=o(174),w=o(618),N=o(484),M=o(893),L=o(347),P=o(621),B=o(348),x=o(892),F=o(1148),U=o(79),H=o(172),G=U.f,W=H.f,V=v.RangeError,X=v.TypeError,Y=v.Uint8Array,z="ArrayBuffer",J="Shared"+z,K="BYTES_PER_ELEMENT",j="prototype",q=Array[j],Z=n.ArrayBuffer,Q=n.DataView,$=f(0),tt=f(2),et=f(3),ot=f(4),nt=f(5),it=f(6),rt=w(!0),st=w(!1),at=M.values,lt=M.keys,ct=M.entries,ut=q.lastIndexOf,ht=q.reduce,pt=q.reduceRight,_t=q.join,dt=q.sort,gt=q.slice,ft=q.toString,Tt=q.toLocaleString,vt=h("iterator"),Et=h("toStringTag"),yt=u("typed_constructor"),mt=u("def_constructor"),bt=m.CONSTR,St=m.TYPED,It=m.VIEW,Rt="Wrong length!",Ct=f(1,function(t,e){return wt(N(t,t[mt]),e)}),kt=E(function(){return 1===new Y(new Uint16Array([1]).buffer)[0]}),Ot=!!Y&&!!Y[j].set&&E(function(){new Y(1).set({})}),At=function(t,e){var o=s(t);if(o<0||o%e)throw V("Wrong offset!");return o},Dt=function(t){if(k(t)&&St in t)return t;throw X(t+" is not a typed array!")},wt=function(t,e){if(!(k(t)&&yt in t))throw X("It is not a typed array constructor!");return new t(e)},Nt=function(t,e){return Mt(N(t,t[mt]),e)},Mt=function(t,e){for(var o=0,n=e.length,i=wt(t,n);o<n;)i[o]=e[o++];return i},Lt=function(t,e,o){G(t,e,{get:function(){return this._d[o]}})},Pt=function(t){var e,o,n,i,r,s,a=_(t),l=arguments.length,c=1<l?arguments[1]:void 0,u=void 0!==c,h=g(a);if(null!=h&&!d(h)){for(s=h.call(a),n=[],e=0;!(r=s.next()).done;e++)n.push(r.value);a=n}for(u&&2<l&&(c=p(c,arguments[2],2)),e=0,o=I(a.length),i=wt(this,o);e<o;e++)i[e]=u?c(a[e],e):a[e];return i},Bt=function(){for(var t=0,e=arguments.length,o=wt(this,e);t<e;)o[t]=arguments[t++];return o},xt=!!Y&&E(function(){Tt.call(new Y(1))}),Ft=function(){return Tt.apply(xt?gt.call(Dt(this)):Dt(this),arguments)},Ut={copyWithin:function(t,e){return F.call(Dt(this),t,e,2<arguments.length?arguments[2]:void 0)},every:function(t){return ot(Dt(this),t,1<arguments.length?arguments[1]:void 0)},fill:function(t){return x.apply(Dt(this),arguments)},filter:function(t){return Nt(this,tt(Dt(this),t,1<arguments.length?arguments[1]:void 0))},find:function(t){return nt(Dt(this),t,1<arguments.length?arguments[1]:void 0)},findIndex:function(t){return it(Dt(this),t,1<arguments.length?arguments[1]:void 0)},forEach:function(t){$(Dt(this),t,1<arguments.length?arguments[1]:void 0)},indexOf:function(t){return st(Dt(this),t,1<arguments.length?arguments[1]:void 0)},includes:function(t){return rt(Dt(this),t,1<arguments.length?arguments[1]:void 0)},join:function(t){return _t.apply(Dt(this),arguments)},lastIndexOf:function(t){return ut.apply(Dt(this),arguments)},map:function(t){return Ct(Dt(this),t,1<arguments.length?arguments[1]:void 0)},reduce:function(t){return ht.apply(Dt(this),arguments)},reduceRight:function(t){return pt.apply(Dt(this),arguments)},reverse:function(){for(var t,e=this,o=Dt(e).length,n=Math.floor(o/2),i=0;i<n;)t=e[i],e[i++]=e[--o],e[o]=t;return e},some:function(t){return et(Dt(this),t,1<arguments.length?arguments[1]:void 0)},sort:function(t){return dt.call(Dt(this),t)},subarray:function(t,e){var o=Dt(this),n=o.length,i=a(t,n);return new(N(o,o[mt]))(o.buffer,o.byteOffset+i*o.BYTES_PER_ELEMENT,I((void 0===e?n:a(e,n))-i))}},Ht=function(t,e){return Nt(this,gt.call(Dt(this),t,e))},Gt=function(t){Dt(this);var e=At(arguments[1],1),o=this.length,n=_(t),i=I(n.length),r=0;if(o<i+e)throw V(Rt);for(;r<i;)this[e+r]=n[r++]},Wt={entries:function(){return ct.call(Dt(this))},keys:function(){return lt.call(Dt(this))},values:function(){return at.call(Dt(this))}},Vt=function(t,e){return k(t)&&t[St]&&"symbol"!=typeof e&&e in t&&String(+e)==String(e)},Xt=function(t,e){return Vt(t,e=l(e,!0))?i(2,t[e]):W(t,e)},Yt=function(t,e,o){return!(Vt(t,e=l(e,!0))&&k(o)&&c(o,"value"))||c(o,"get")||c(o,"set")||o.configurable||c(o,"writable")&&!o.writable||c(o,"enumerable")&&!o.enumerable?G(t,e,o):(t[e]=o.value,t)};bt||(H.f=Xt,U.f=Yt),y(y.S+y.F*!bt,"Object",{getOwnPropertyDescriptor:Xt,defineProperty:Yt}),E(function(){ft.call({})})&&(ft=Tt=function(){return _t.call(this)});var zt=r({},Ut);r(zt,Wt),S(zt,vt,Wt.values),r(zt,{slice:Ht,set:Gt,constructor:function(){},toString:ft,toLocaleString:Ft}),Lt(zt,"buffer","b"),Lt(zt,"byteOffset","o"),Lt(zt,"byteLength","l"),Lt(zt,"length","e"),G(zt,Et,{get:function(){return this[St]}}),t.exports=function(t,h,e,i){var p=t+((i=!!i)?"Clamped":"")+"Array",n="get"+t,r="set"+t,_=v[p],s=_||{},o=_&&A(_),a=!_||!m.ABV,l={},c=_&&_[j],d=function(t,e){G(t,e,{get:function(){return function(t,e){var o=t._d;return o.v[n](e*h+o.o,kt)}(this,e)},set:function(t){return function(t,e,o){var n=t._d;i&&(o=(o=Math.round(o))<0?0:255<o?255:255&o),n.v[r](e*h+n.o,o,kt)}(this,e,t)},enumerable:!0})};a?(_=e(function(t,e,o,n){b(t,_,p,"_d");var i,r,s,a,l=0,c=0;if(k(e)){if(!(e instanceof Z||(a=C(e))==z||a==J))return St in e?Mt(_,e):Pt.call(_,e);i=e,c=At(o,h);var u=e.byteLength;if(void 0===n){if(u%h)throw V(Rt);if((r=u-c)<0)throw V(Rt)}else if(u<(r=I(n)*h)+c)throw V(Rt);s=r/h}else s=R(e),i=new Z(r=s*h);for(S(t,"_d",{b:i,o:c,l:r,e:s,v:new Q(i)});l<s;)d(t,l++)}),c=_[j]=O(zt),S(c,"constructor",_)):E(function(){_(1)})&&E(function(){new _(-1)})&&P(function(t){new _,new _(null),new _(1.5),new _(t)},!0)||(_=e(function(t,e,o,n){var i;return b(t,_,p),k(e)?e instanceof Z||(i=C(e))==z||i==J?void 0!==n?new s(e,At(o,h),n):void 0!==o?new s(e,At(o,h)):new s(e):St in e?Mt(_,e):Pt.call(_,e):new s(R(e))}),$(o!==Function.prototype?D(s).concat(D(o)):D(s),function(t){t in _||S(_,t,s[t])}),_[j]=c,T||(c.constructor=_));var u=c[vt],g=!!u&&("values"==u.name||null==u.name),f=Wt.values;S(_,yt,!0),S(c,St,p),S(c,It,!0),S(c,mt,_),(i?new _(1)[Et]==p:Et in c)||G(c,Et,{get:function(){return p}}),l[p]=_,y(y.G+y.W+y.F*(_!=s),l),y(y.S,p,{BYTES_PER_ELEMENT:h}),y(y.S+y.F*E(function(){s.of.call(_,1)}),p,{from:Pt,of:Bt}),K in c||S(c,K,h),y(y.P,p,Ut),B(p),y(y.P+y.F*Ot,p,{set:Gt}),y(y.P+y.F*!g,p,Wt),T||c.toString==ft||(c.toString=ft),y(y.P+y.F*E(function(){new _(1).slice()}),p,{slice:Ht}),y(y.P+y.F*(E(function(){return[1,2].toLocaleString()!=new _([1,2]).toLocaleString()})||!E(function(){c.toLocaleString.call([1,2])})),p,{toLocaleString:Ft}),L[p]=g?u:f,T||g||S(c,vt,f)}}else t.exports=function(){}},238:function(t,e,o){"use strict";t.exports=function(t){return encodeURIComponent(t).replace(/[!'()*]/g,function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()})}},2464:function(t,e,o){var n,i,r;i=[o(4599)],void 0===(r="function"==typeof(n=function(o){
/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
"use strict";return o.setLocale=function(e){o.Msg=o.Msg||{},Object.keys(e).forEach(function(t){o.Msg[t]=e[t]})},o})?n.apply(e,i):n)||(t.exports=r)},256:function(t,e){t.exports=function(t){this.ok=!1,this.alpha=1,"#"==t.charAt(0)&&(t=t.substr(1,6)),t=(t=t.replace(/ /g,"")).toLowerCase();var u={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};t=u[t]||t;for(var h=[{re:/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*((?:\d?\.)?\d)\)$/,example:["rgba(123, 234, 45, 0.8)","rgba(255,234,245,1.0)"],process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3]),parseFloat(t[4])]}},{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}}],e=0;e<h.length;e++){var o=h[e].re,n=h[e].process,i=o.exec(t);if(i){var r=n(i);this.r=r[0],this.g=r[1],this.b=r[2],3<r.length&&(this.alpha=r[3]),this.ok=!0}}this.r=this.r<0||isNaN(this.r)?0:255<this.r?255:this.r,this.g=this.g<0||isNaN(this.g)?0:255<this.g?255:this.g,this.b=this.b<0||isNaN(this.b)?0:255<this.b?255:this.b,this.alpha=this.alpha<0?0:1<this.alpha||isNaN(this.alpha)?1:this.alpha,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toRGBA=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+this.alpha+")"},this.toHex=function(){var t=this.r.toString(16),e=this.g.toString(16),o=this.b.toString(16);return 1==t.length&&(t="0"+t),1==e.length&&(e="0"+e),1==o.length&&(o="0"+o),"#"+t+e+o},this.getHelpXML=function(){for(var t=new Array,e=0;e<h.length;e++)for(var o=h[e].example,n=0;n<o.length;n++)t[t.length]=o[n];for(var i in u)t[t.length]=i;var r=document.createElement("ul");r.setAttribute("id","rgbcolor-examples");for(e=0;e<t.length;e++)try{var s=document.createElement("li"),a=new RGBColor(t[e]),l=document.createElement("div");l.style.cssText="margin: 3px; border: 1px solid black; background:"+a.toHex()+"; color:"+a.toHex(),l.appendChild(document.createTextNode("test"));var c=document.createTextNode(" "+t[e]+" -> "+a.toRGB()+" -> "+a.toHex());s.appendChild(l),s.appendChild(c),r.appendChild(s)}catch(t){}return r}}},257:function(t,e,o){var i=o(41);t.exports=function(t,e){if(!i(t))return t;var o,n;if(e&&"function"==typeof(o=t.toString)&&!i(n=o.call(t)))return n;if("function"==typeof(o=t.valueOf)&&!i(n=o.call(t)))return n;if(!e&&"function"==typeof(o=t.toString)&&!i(n=o.call(t)))return n;throw TypeError("Can't convert object to primitive value")}},258:function(t,e,o){var n=o(305)("meta"),i=o(41),r=o(135),s=o(79).f,a=0,l=Object.isExtensible||function(){return!0},c=!o(39)(function(){return l(Object.preventExtensions({}))}),u=function(t){s(t,n,{value:{i:"O"+ ++a,w:{}}})},h=t.exports={KEY:n,NEED:!1,fastKey:function(t,e){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!r(t,n)){if(!l(t))return"F";if(!e)return"E";u(t)}return t[n].i},getWeak:function(t,e){if(!r(t,n)){if(!l(t))return!0;if(!e)return!1;u(t)}return t[n].w},onFreeze:function(t){return c&&h.NEED&&l(t)&&!r(t,n)&&u(t),t}}},264:function(t,e,o){var n;t.exports=(n=n||function(h,t){var o=Object.create||function(){function o(){}return function(t){var e;return o.prototype=t,e=new o,o.prototype=null,e}}(),e={},n=e.lib={},i=n.Base={extend:function(t){var e=o(this);return t&&e.mixIn(t),e.hasOwnProperty("init")&&this.init!==e.init||(e.init=function(){e.$super.init.apply(this,arguments)}),(e.init.prototype=e).$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},p=n.WordArray=i.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||s).stringify(this)},concat:function(t){var e=this.words,o=t.words,n=this.sigBytes,i=t.sigBytes;if(this.clamp(),n%4)for(var r=0;r<i;r++){var s=o[r>>>2]>>>24-r%4*8&255;e[n+r>>>2]|=s<<24-(n+r)%4*8}else for(var r=0;r<i;r+=4)e[n+r>>>2]=o[r>>>2];return this.sigBytes+=i,this},clamp:function(){var t=this.words,e=this.sigBytes;t[e>>>2]&=4294967295<<32-e%4*8,t.length=h.ceil(e/4)},clone:function(){var t=i.clone.call(this);return t.words=this.words.slice(0),t},random:function(t){for(var e,o=[],n=function(e){var e=e,o=987654321,n=4294967295;return function(){var t=((o=36969*(65535&o)+(o>>16)&n)<<16)+(e=18e3*(65535&e)+(e>>16)&n)&n;return t/=4294967296,(t+=.5)*(.5<h.random()?1:-1)}},i=0;i<t;i+=4){var r=n(4294967296*(e||h.random()));e=987654071*r(),o.push(4294967296*r()|0)}return new p.init(o,t)}}),r=e.enc={},s=r.Hex={stringify:function(t){for(var e=t.words,o=t.sigBytes,n=[],i=0;i<o;i++){var r=e[i>>>2]>>>24-i%4*8&255;n.push((r>>>4).toString(16)),n.push((15&r).toString(16))}return n.join("")},parse:function(t){for(var e=t.length,o=[],n=0;n<e;n+=2)o[n>>>3]|=parseInt(t.substr(n,2),16)<<24-n%8*4;return new p.init(o,e/2)}},a=r.Latin1={stringify:function(t){for(var e=t.words,o=t.sigBytes,n=[],i=0;i<o;i++){var r=e[i>>>2]>>>24-i%4*8&255;n.push(String.fromCharCode(r))}return n.join("")},parse:function(t){for(var e=t.length,o=[],n=0;n<e;n++)o[n>>>2]|=(255&t.charCodeAt(n))<<24-n%4*8;return new p.init(o,e)}},l=r.Utf8={stringify:function(t){try{return decodeURIComponent(escape(a.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return a.parse(unescape(encodeURIComponent(t)))}},c=n.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new p.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=l.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(t){var e=this._data,o=e.words,n=e.sigBytes,i=this.blockSize,r=4*i,s=n/r,a=(s=t?h.ceil(s):h.max((0|s)-this._minBufferSize,0))*i,l=h.min(4*a,n);if(a){for(var c=0;c<a;c+=i)this._doProcessBlock(o,c);var u=o.splice(0,a);e.sigBytes-=l}return new p.init(u,l)},clone:function(){var t=i.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),u=(n.Hasher=c.extend({cfg:i.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){c.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){t&&this._append(t);var e=this._doFinalize();return e},blockSize:16,_createHelper:function(o){return function(t,e){return new o.init(e).finalize(t)}},_createHmacHelper:function(o){return function(t,e){return new u.HMAC.init(o,e).finalize(t)}}}),e.algo={});return e}(Math),n)},268:function(t,e,o){t.exports=o.p+"blank_sharing_drawingwpae53b62a1609cbbb425574e45b37b837.png"},269:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getI18nStringTrackerWorker=function(){return new n},o(48);var n=function(){function t(){var t=this.constructor.instance;if(t)return t;(this.constructor.instance=this).buffer={}}var e=t.prototype;return e.log=function(t,e){var o=this;t&&e&&(this.buffer[e]=this.buffer[e]||new Set,this.buffer[e].add(t),this.pendingFlush||(this.pendingFlush=setTimeout(function(){return o.flush()},3e3)))},e.flush=function(){if(0!==Object.keys(this.buffer).length){var t=this.buffer;this.buffer={},this.pendingFlush=null,function(i){var r=window.location.origin+window.location.pathname;Object.keys(i).forEach(function(t){for(var e=Array.from(i[t]),o=0;o<e.length;o+=s){var n=e.slice(o,s);fetch("/i18n/track_string_usage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:r,source:t,string_keys:n})})}})}(t)}},t}(),s=500},3:function(t,e,o){"use strict";var n=r(o(126)),i=r(o(127));function r(t){return t&&t.__esModule?t:{default:t}}var s=(0,n.default)("common_locale");s=(0,i.default)(s,"common_locale"),t.exports=s},304:function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},305:function(t,e){var o=0,n=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++o+n).toString(36))}},306:function(t,e){t.exports=!1},307:function(t,e,o){var n=o(1132),i=o(876);t.exports=Object.keys||function(t){return n(t,i)}},308:function(t,e,o){var n=o(171),i=Math.max,r=Math.min;t.exports=function(t,e){return(t=n(t))<0?i(t+e,0):r(t,e)}},309:function(t,e,n){var i=n(40),r=n(1133),s=n(876),a=n(875)("IE_PROTO"),l=function(){},c="prototype",u=function(){var t,e=n(873)("iframe"),o=s.length;for(e.style.display="none",n(877).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),u=t.F;o--;)delete u[c][s[o]];return u()};t.exports=Object.create||function(t,e){var o;return null!==t?(l[c]=i(t),o=new l,l[c]=null,o[a]=t):o=u(),void 0===e?o:r(o,e)}},31:function(t,e){var o;o=function(){return this}();try{o=o||new Function("return this")()}catch(t){"object"==typeof window&&(o=window)}t.exports=o},310:function(t,e,o){var n=o(1132),i=o(876).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return n(t,i)}},311:function(t,e,o){var n=o(135),i=o(100),r=o(875)("IE_PROTO"),s=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),n(t,r)?t[r]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?s:null}},312:function(t,e,o){var n=o(50)("unscopables"),i=Array.prototype;null==i[n]&&o(136)(i,n,{}),t.exports=function(t){i[n][t]=!0}},313:function(t,e,o){var n=o(41);t.exports=function(t,e){if(!n(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},33:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BlocklyVersion=e.NOTIFICATION_ALERT_TYPE=e.PROFANITY_FOUND=e.TOOLBOX_EDIT_MODE=e.BASE_DIALOG_WIDTH=e.EXPO_SESSION_SECRET=e.CIPHER=e.ALPHABET=e.SVG_NS=e.Position=e.KeyCodes=e.HarvesterTerminationValue=e.BeeTerminationValue=e.TestResults=e.ResultType=void 0;e.ResultType={UNSET:0,SUCCESS:1,FAILURE:-1,TIMEOUT:2,ERROR:-2};var n={FAILURE:!(e.TestResults={NO_TESTS_RUN:-1,GENERIC_FAIL:0,EMPTY_BLOCK_FAIL:1,TOO_FEW_BLOCKS_FAIL:2,LEVEL_INCOMPLETE_FAIL:3,MISSING_BLOCK_UNFINISHED:4,EXTRA_TOP_BLOCKS_FAIL:5,RUNTIME_ERROR_FAIL:6,SYNTAX_ERROR_FAIL:7,MISSING_BLOCK_FINISHED:10,APP_SPECIFIC_FAIL:11,EMPTY_FUNCTION_BLOCK_FAIL:12,UNUSED_PARAM:13,UNUSED_FUNCTION:14,PARAM_INPUT_UNATTACHED:15,INCOMPLETE_BLOCK_IN_FUNCTION:16,QUESTION_MARKS_IN_NUMBER_FIELD:17,EMPTY_FUNCTIONAL_BLOCK:18,EXAMPLE_FAILED:19,NESTED_FOR_SAME_VARIABLE:-2,EMPTY_FUNCTION_NAME:-3,MISSING_RECOMMENDED_BLOCK_UNFINISHED:-4,EXTRA_FUNCTION_FAIL:-5,LOCAL_FUNCTION_FAIL:-6,GENERIC_LINT_FAIL:-7,LOG_CONDITION_FAIL:-8,BLOCK_LIMIT_FAIL:-9,FREE_PLAY_UNCHANGED_FAIL:-10,UNSUBMITTED_ATTEMPT:-50,SKIPPED:-100,LEVEL_STARTED:-150,MINIMUM_PASS_RESULT:20,TOO_MANY_BLOCKS_FAIL:20,APP_SPECIFIC_ACCEPTABLE_FAIL:21,MISSING_RECOMMENDED_BLOCK_FINISHED:22,MINIMUM_OPTIMAL_RESULT:30,FREE_PLAY:30,PASS_WITH_EXTRA_TOP_BLOCKS:31,APP_SPECIFIC_IMPERFECT_PASS:32,EDIT_BLOCKS:70,MANUAL_PASS:90,ALL_PASS:100,CONTAINED_LEVEL_RESULT:101,BETTER_THAN_IDEAL:102,SUBMITTED_RESULT:1e3,LOCKED_RESULT:1001,READONLY_SUBMISSION_RESULT:1002,REVIEW_REJECTED_RESULT:1500,REVIEW_ACCEPTED_RESULT:2e3}),SUCCESS:!0,INFINITE_LOOP:1/0,NOT_AT_FLOWER:1,FLOWER_EMPTY:2,NOT_AT_HONEYCOMB:3,HONEYCOMB_FULL:4,UNCHECKED_CLOUD:5,UNCHECKED_PURPLE:6,INSUFFICIENT_NECTAR:7,INSUFFICIENT_HONEY:8,DID_NOT_COLLECT_EVERYTHING:9};e.BeeTerminationValue=n;e.HarvesterTerminationValue={WRONG_CROP:1,EMPTY_CROP:2,DID_NOT_COLLECT_EVERYTHING:3};e.KeyCodes={BACKSPACE:8,ENTER:13,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,COPY:67,PASTE:86,DELETE:127};e.Position={OUTTOPOUTLEFT:1,OUTTOPLEFT:2,OUTTOPCENTER:3,OUTTOPRIGHT:4,OUTTOPOUTRIGHT:5,TOPOUTLEFT:6,TOPLEFT:7,TOPCENTER:8,TOPRIGHT:9,TOPOUTRIGHT:10,MIDDLEOUTLEFT:11,MIDDLELEFT:12,MIDDLECENTER:13,MIDDLERIGHT:14,MIDDLEOUTRIGHT:15,BOTTOMOUTLEFT:16,BOTTOMLEFT:17,BOTTOMCENTER:18,BOTTOMRIGHT:19,BOTTOMOUTRIGHT:20,OUTBOTTOMOUTLEFT:21,OUTBOTTOMLEFT:22,OUTBOTTOMCENTER:23,OUTBOTTOMRIGHT:24,OUTBOTTOMOUTRIGHT:25};e.SVG_NS="http://www.w3.org/2000/svg";e.ALPHABET="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";e.CIPHER="Iq61F8kiaUHPGcsY7DgX4yAu3LwtWhnCmeR5pVrJoKfQZMx0BSdlOjEv2TbN9z";e.EXPO_SESSION_SECRET='{"id":"fakefake-67ec-4314-a438-60589b9c0fa2","version":1,"expires_at":2000000000000}';e.BASE_DIALOG_WIDTH=700;e.TOOLBOX_EDIT_MODE="toolbox_blocks";e.PROFANITY_FOUND="profanity_found";e.NOTIFICATION_ALERT_TYPE="notification";e.BlocklyVersion={CDO:"CDO",GOOGLE:"Google"}},3367:function(i,r,t){(function(t){var e,o,n;o=[],void 0===(n="function"==typeof(e=function(){"use strict";var E={constants:{},LINE_MODE_MULTIPLIER:40,PAGE_MODE_MULTIPLIER:125,DRAG_RADIUS:5,FLYOUT_DRAG_RADIUS:10,SNAP_RADIUS:28};return E.CONNECTING_SNAP_RADIUS=E.SNAP_RADIUS,E.CURRENT_CONNECTION_PREFERENCE=8,E.BUMP_DELAY=250,E.BUMP_RANDOMNESS=10,E.COLLAPSE_CHARS=30,E.LONGPRESS=750,E.SOUND_LIMIT=100,E.DRAG_STACK=!0,E.HSV_SATURATION=.45,E.HSV_VALUE=.65,E.SPRITE={width:96,height:124,url:"sprites.png"},E.INPUT_VALUE=1,E.OUTPUT_VALUE=2,E.NEXT_STATEMENT=3,E.PREVIOUS_STATEMENT=4,E.DUMMY_INPUT=5,E.ALIGN_LEFT=-1,E.ALIGN_CENTRE=0,E.ALIGN_RIGHT=1,E.DRAG_NONE=0,E.DRAG_STICKY=1,E.DRAG_BEGIN=1,E.DRAG_FREE=2,E.OPPOSITE_TYPE=[],E.OPPOSITE_TYPE[E.INPUT_VALUE]=E.OUTPUT_VALUE,E.OPPOSITE_TYPE[E.OUTPUT_VALUE]=E.INPUT_VALUE,E.OPPOSITE_TYPE[E.NEXT_STATEMENT]=E.PREVIOUS_STATEMENT,E.OPPOSITE_TYPE[E.PREVIOUS_STATEMENT]=E.NEXT_STATEMENT,E.TOOLBOX_AT_TOP=0,E.TOOLBOX_AT_BOTTOM=1,E.TOOLBOX_AT_LEFT=2,E.TOOLBOX_AT_RIGHT=3,E.DELETE_AREA_NONE=null,E.DELETE_AREA_TRASH=1,E.DELETE_AREA_TOOLBOX=2,E.VARIABLE_CATEGORY_NAME="VARIABLE",E.VARIABLE_DYNAMIC_CATEGORY_NAME="VARIABLE_DYNAMIC",E.PROCEDURE_CATEGORY_NAME="PROCEDURE",E.RENAME_VARIABLE_ID="RENAME_VARIABLE_ID",E.DELETE_VARIABLE_ID="DELETE_VARIABLE_ID",E.registry={},E.registry.typeMap_={},E.registry.DEFAULT="default",E.registry.Type=function(t){this.name_=t},E.registry.Type.prototype.toString=function(){return this.name_},E.registry.Type.CONNECTION_CHECKER=new E.registry.Type("connectionChecker"),E.registry.Type.EVENT=new E.registry.Type("event"),E.registry.Type.FIELD=new E.registry.Type("field"),E.registry.Type.RENDERER=new E.registry.Type("renderer"),E.registry.Type.TOOLBOX=new E.registry.Type("toolbox"),E.registry.Type.THEME=new E.registry.Type("theme"),E.registry.Type.TOOLBOX_ITEM=new E.registry.Type("toolboxItem"),E.registry.Type.FLYOUTS_VERTICAL_TOOLBOX=new E.registry.Type("flyoutsVerticalToolbox"),E.registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX=new E.registry.Type("flyoutsHorizontalToolbox"),E.registry.register=function(t,e,o,n){if(!(t instanceof E.registry.Type)&&"string"!=typeof t||""==String(t).trim())throw Error('Invalid type "'+t+'". The type must be a non-empty string or a Blockly.registry.Type.');if(t=String(t).toLowerCase(),"string"!=typeof e||""==e.trim())throw Error('Invalid name "'+e+'". The name must be a non-empty string.');if(e=e.toLowerCase(),!o)throw Error("Can not register a null value");var i=E.registry.typeMap_[t];if(i||(i=E.registry.typeMap_[t]={}),E.registry.validate_(t,o),!n&&i[e])throw Error('Name "'+e+'" with type "'+t+'" already registered.');i[e]=o},E.registry.validate_=function(t,e){switch(t){case String(E.registry.Type.FIELD):if("function"!=typeof e.fromJson)throw Error('Type "'+t+'" must have a fromJson function')}},E.registry.unregister=function(t,e){t=String(t).toLowerCase(),e=e.toLowerCase();var o=E.registry.typeMap_[t];o?o[e]?delete E.registry.typeMap_[t][e]:console.warn('No name "'+e+'" with type "'+t+'" found'):console.warn('No type "'+t+'" found')},E.registry.getItem_=function(t,e){t=String(t).toLowerCase(),e=e.toLowerCase();var o=E.registry.typeMap_[t];return o?o[e]?o[e]:(console.warn('No name "'+e+'" with type "'+t+'" found'),null):(console.warn('No type "'+t+'" found'),null)},E.registry.hasItem=function(t,e){return t=String(t).toLowerCase(),e=e.toLowerCase(),!!(t=E.registry.typeMap_[t])&&!!t[e]},E.registry.getClass=function(t,e){return E.registry.getItem_(t,e)},E.registry.getObject=function(t,e){return E.registry.getItem_(t,e)},E.registry.getClassFromOptions=function(t,e){return"function"==typeof(e=e.plugins[t.toString()]||E.registry.DEFAULT)?e:E.registry.getClass(t,e)},E.utils={},E.utils.global=function(){return"object"==typeof self?self:"object"==typeof window?window:"object"==typeof t?t:this}(),E.Msg={},E.utils.global.Blockly||(E.utils.global.Blockly={}),E.utils.global.Blockly.Msg||(E.utils.global.Blockly.Msg=E.Msg),E.utils.colour={},E.utils.colour.parse=function(t){t=String(t).toLowerCase().trim();var e=E.utils.colour.names[t];if(e)return e;if(e="#"==(e="0x"==t.substring(0,2)?"#"+t.substring(2):t)[0]?e:"#"+e,/^#[0-9a-f]{6}$/.test(e))return e;if(/^#[0-9a-f]{3}$/.test(e))return["#",e[1],e[1],e[2],e[2],e[3],e[3]].join("");var o=t.match(/^(?:rgb)?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/);return o&&(t=Number(o[1]),e=Number(o[2]),o=Number(o[3]),0<=t&&t<256&&0<=e&&e<256&&0<=o&&o<256)?E.utils.colour.rgbToHex(t,e,o):null},E.utils.colour.rgbToHex=function(t,e,o){return e=t<<16|e<<8|o,t<16?"#"+(16777216|e).toString(16).substr(1):"#"+e.toString(16)},E.utils.colour.hexToRgb=function(t){return(t=E.utils.colour.parse(t))?[(t=parseInt(t.substr(1),16))>>16,t>>8&255,255&t]:[0,0,0]},E.utils.colour.hsvToHex=function(t,e,o){var n=0,i=0,r=0;if(0==e)r=i=n=o;else{var s=Math.floor(t/60),a=t/60-s;t=o*(1-e);var l=o*(1-e*a);switch(e=o*(1-e*(1-a)),s){case 1:n=l,i=o,r=t;break;case 2:n=t,i=o,r=e;break;case 3:n=t,i=l,r=o;break;case 4:n=e,i=t,r=o;break;case 5:n=o,i=t,r=l;break;case 6:case 0:n=o,i=e,r=t}}return E.utils.colour.rgbToHex(Math.floor(n),Math.floor(i),Math.floor(r))},E.utils.colour.blend=function(t,e,o){return(t=E.utils.colour.parse(t))&&(e=E.utils.colour.parse(e))?(t=E.utils.colour.hexToRgb(t),e=E.utils.colour.hexToRgb(e),E.utils.colour.rgbToHex(Math.round(e[0]+o*(t[0]-e[0])),Math.round(e[1]+o*(t[1]-e[1])),Math.round(e[2]+o*(t[2]-e[2])))):null},E.utils.colour.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"},E.utils.Coordinate=function(t,e){this.x=t,this.y=e},E.utils.Coordinate.equals=function(t,e){return t==e||!(!t||!e)&&t.x==e.x&&t.y==e.y},E.utils.Coordinate.distance=function(t,e){var o=t.x-e.x;return t=t.y-e.y,Math.sqrt(o*o+t*t)},E.utils.Coordinate.magnitude=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},E.utils.Coordinate.difference=function(t,e){return new E.utils.Coordinate(t.x-e.x,t.y-e.y)},E.utils.Coordinate.sum=function(t,e){return new E.utils.Coordinate(t.x+e.x,t.y+e.y)},E.utils.Coordinate.prototype.scale=function(t){return this.x*=t,this.y*=t,this},E.utils.Coordinate.prototype.translate=function(t,e){return this.x+=t,this.y+=e,this},E.utils.Rect=function(t,e,o,n){this.top=t,this.bottom=e,this.left=o,this.right=n},E.utils.Rect.prototype.contains=function(t,e){return t>=this.left&&t<=this.right&&e>=this.top&&e<=this.bottom},E.utils.string={},E.utils.string.startsWith=function(t,e){return 0==t.lastIndexOf(e,0)},E.utils.string.shortestStringLength=function(t){return t.length?t.reduce(function(t,e){return t.length<e.length?t:e}).length:0},E.utils.string.commonWordPrefix=function(t,e){if(!t.length)return 0;if(1==t.length)return t[0].length;var o=0;e=e||E.utils.string.shortestStringLength(t);for(var n=0;n<e;n++){for(var i=t[0][n],r=1;r<t.length;r++)if(i!=t[r][n])return o;" "==i&&(o=n+1)}for(r=1;r<t.length;r++)if((i=t[r][n])&&" "!=i)return o;return e},E.utils.string.commonWordSuffix=function(t,e){if(!t.length)return 0;if(1==t.length)return t[0].length;var o=0;e=e||E.utils.string.shortestStringLength(t);for(var n=0;n<e;n++){for(var i=t[0].substr(-n-1,1),r=1;r<t.length;r++)if(i!=t[r].substr(-n-1,1))return o;" "==i&&(o=n+1)}for(r=1;r<t.length;r++)if((i=t[r].charAt(t[r].length-n-1))&&" "!=i)return o;return e},E.utils.string.wrap=function(t,e){t=t.split("\n");for(var o=0;o<t.length;o++)t[o]=E.utils.string.wrapLine_(t[o],e);return t.join("\n")},E.utils.string.wrapLine_=function(t,e){if(t.length<=e)return t;for(var o=t.trim().split(/\s+/),n=0;n<o.length;n++)o[n].length>e&&(e=o[n].length);n=-1/0;var i=1;do{var r=n,s=t;t=[];var a=o.length/i,l=1;for(n=0;n<o.length-1;n++)l<(n+1.5)/a?(l++,t[n]=!0):t[n]=!1;t=E.utils.string.wrapMutate_(o,t,e),n=E.utils.string.wrapScore_(o,t,e),t=E.utils.string.wrapToText_(o,t),i++}while(r<n);return s},E.utils.string.wrapScore_=function(t,e,o){for(var n=[0],i=[],r=0;r<t.length;r++)n[n.length-1]+=t[r].length,!0===e[r]?(n.push(0),i.push(t[r].charAt(t[r].length-1))):!1===e[r]&&n[n.length-1]++;for(t=Math.max.apply(Math,n),r=e=0;r<n.length;r++)e-=2*Math.pow(Math.abs(o-n[r]),1.5),e-=Math.pow(t-n[r],1.5),-1!=".?!".indexOf(i[r])?e+=o/3:-1!=",;)]}".indexOf(i[r])&&(e+=o/4);return 1<n.length&&n[n.length-1]<=n[n.length-2]&&(e+=.5),e},E.utils.string.wrapMutate_=function(t,e,o){for(var n,i=E.utils.string.wrapScore_(t,e,o),r=0;r<e.length-1;r++)if(e[r]!=e[r+1]){var s=[].concat(e);s[r]=!s[r],s[r+1]=!s[r+1];var a=E.utils.string.wrapScore_(t,s,o);i<a&&(i=a,n=s)}return n?E.utils.string.wrapMutate_(t,n,o):e},E.utils.string.wrapToText_=function(t,e){for(var o=[],n=0;n<t.length;n++)o.push(t[n]),void 0!==e[n]&&o.push(e[n]?"\n":" ");return o.join("")},E.utils.Size=function(t,e){this.width=t,this.height=e},E.utils.Size.equals=function(t,e){return t==e||!(!t||!e)&&t.width==e.width&&t.height==e.height},E.utils.style={},E.utils.style.getSize=function(t){if("none"!=E.utils.style.getStyle_(t,"display"))return E.utils.style.getSizeWithDisplay_(t);var e=t.style,o=e.display,n=e.visibility,i=e.position;e.visibility="hidden",e.position="absolute",e.display="inline";var r=t.offsetWidth;return t=t.offsetHeight,e.display=o,e.position=i,e.visibility=n,new E.utils.Size(r,t)},E.utils.style.getSizeWithDisplay_=function(t){return new E.utils.Size(t.offsetWidth,t.offsetHeight)},E.utils.style.getStyle_=function(t,e){return E.utils.style.getComputedStyle(t,e)||E.utils.style.getCascadedStyle(t,e)||t.style&&t.style[e]},E.utils.style.getComputedStyle=function(t,e){return document.defaultView&&document.defaultView.getComputedStyle&&(t=document.defaultView.getComputedStyle(t,null))&&(t[e]||t.getPropertyValue(e))||""},E.utils.style.getCascadedStyle=function(t,e){return t.currentStyle?t.currentStyle[e]:null},E.utils.style.getPageOffset=function(t){var e=new E.utils.Coordinate(0,0);t=t.getBoundingClientRect();var o=document.documentElement;return o=new E.utils.Coordinate(window.pageXOffset||o.scrollLeft,window.pageYOffset||o.scrollTop),e.x=t.left+o.x,e.y=t.top+o.y,e},E.utils.style.getViewportPageOffset=function(){var t=document.body,e=document.documentElement;return new E.utils.Coordinate(t.scrollLeft||e.scrollLeft,t.scrollTop||e.scrollTop)},E.utils.style.setElementShown=function(t,e){t.style.display=e?"":"none"},E.utils.style.isRightToLeft=function(t){return"rtl"==E.utils.style.getStyle_(t,"direction")},E.utils.style.getBorderBox=function(t){var e=E.utils.style.getComputedStyle(t,"borderLeftWidth"),o=E.utils.style.getComputedStyle(t,"borderRightWidth"),n=E.utils.style.getComputedStyle(t,"borderTopWidth");return t=E.utils.style.getComputedStyle(t,"borderBottomWidth"),{top:parseFloat(n),right:parseFloat(o),bottom:parseFloat(t),left:parseFloat(e)}},E.utils.style.scrollIntoContainerView=function(t,e,o){t=E.utils.style.getContainerOffsetToScrollInto(t,e,o),e.scrollLeft=t.x,e.scrollTop=t.y},E.utils.style.getContainerOffsetToScrollInto=function(t,e,o){var n=E.utils.style.getPageOffset(t),i=E.utils.style.getPageOffset(e),r=E.utils.style.getBorderBox(e),s=n.x-i.x-r.left;return n=n.y-i.y-r.top,i=E.utils.style.getSizeWithDisplay_(t),t=e.clientWidth-i.width,i=e.clientHeight-i.height,r=e.scrollLeft,e=e.scrollTop,o?(r+=s-t/2,e+=n-i/2):(r+=Math.min(s,Math.max(s-t,0)),e+=Math.min(n,Math.max(n-i,0))),new E.utils.Coordinate(r,e)},E.utils.userAgent={},function(t){function e(t){return-1!=o.indexOf(t.toUpperCase())}E.utils.userAgent.raw=t;var o=E.utils.userAgent.raw.toUpperCase();E.utils.userAgent.IE=e("Trident")||e("MSIE"),E.utils.userAgent.EDGE=e("Edge"),E.utils.userAgent.JAVA_FX=e("JavaFX"),E.utils.userAgent.CHROME=(e("Chrome")||e("CriOS"))&&!E.utils.userAgent.EDGE,E.utils.userAgent.WEBKIT=e("WebKit")&&!E.utils.userAgent.EDGE,E.utils.userAgent.GECKO=e("Gecko")&&!E.utils.userAgent.WEBKIT&&!E.utils.userAgent.IE&&!E.utils.userAgent.EDGE,E.utils.userAgent.ANDROID=e("Android"),E.utils.userAgent.IPAD=e("iPad"),E.utils.userAgent.IPOD=e("iPod"),E.utils.userAgent.IPHONE=e("iPhone")&&!E.utils.userAgent.IPAD&&!E.utils.userAgent.IPOD,E.utils.userAgent.MAC=e("Macintosh"),E.utils.userAgent.TABLET=E.utils.userAgent.IPAD||E.utils.userAgent.ANDROID&&!e("Mobile")||e("Silk"),E.utils.userAgent.MOBILE=!E.utils.userAgent.TABLET&&(E.utils.userAgent.IPOD||E.utils.userAgent.IPHONE||E.utils.userAgent.ANDROID||e("IEMobile"))}(E.utils.global.navigator&&E.utils.global.navigator.userAgent||""),E.utils.noEvent=function(t){t.preventDefault(),t.stopPropagation()},E.utils.isTargetInput=function(t){return"textarea"==t.target.type||"text"==t.target.type||"number"==t.target.type||"email"==t.target.type||"password"==t.target.type||"search"==t.target.type||"tel"==t.target.type||"url"==t.target.type||t.target.isContentEditable||t.target.dataset&&"true"==t.target.dataset.isTextInput},E.utils.getRelativeXY=function(t){var e=new E.utils.Coordinate(0,0),o=t.getAttribute("x");return o&&(e.x=parseInt(o,10)),(o=t.getAttribute("y"))&&(e.y=parseInt(o,10)),(o=(o=t.getAttribute("transform"))&&o.match(E.utils.getRelativeXY.XY_REGEX_))&&(e.x+=Number(o[1]),o[3]&&(e.y+=Number(o[3]))),(t=t.getAttribute("style"))&&-1<t.indexOf("translate")&&(t=t.match(E.utils.getRelativeXY.XY_STYLE_REGEX_))&&(e.x+=Number(t[1]),t[3]&&(e.y+=Number(t[3]))),e},E.utils.getInjectionDivXY_=function(t){for(var e=0,o=0;t;){var n=E.utils.getRelativeXY(t);if(e+=n.x,o+=n.y,-1!=(" "+(t.getAttribute("class")||"")+" ").indexOf(" injectionDiv "))break;t=t.parentNode}return new E.utils.Coordinate(e,o)},E.utils.getRelativeXY.XY_REGEX_=/translate\(\s*([-+\d.e]+)([ ,]\s*([-+\d.e]+)\s*)?/,E.utils.getRelativeXY.XY_STYLE_REGEX_=/transform:\s*translate(?:3d)?\(\s*([-+\d.e]+)\s*px([ ,]\s*([-+\d.e]+)\s*px)?/,E.utils.isRightButton=function(t){return!(!t.ctrlKey||!E.utils.userAgent.MAC)||2==t.button},E.utils.mouseToSvg=function(t,e,o){var n=e.createSVGPoint();return n.x=t.clientX,n.y=t.clientY,o||(o=e.getScreenCTM().inverse()),n.matrixTransform(o)},E.utils.getScrollDeltaPixels=function(t){switch(t.deltaMode){default:return{x:t.deltaX,y:t.deltaY};case 1:return{x:t.deltaX*E.LINE_MODE_MULTIPLIER,y:t.deltaY*E.LINE_MODE_MULTIPLIER};case 2:return{x:t.deltaX*E.PAGE_MODE_MULTIPLIER,y:t.deltaY*E.PAGE_MODE_MULTIPLIER}}},E.utils.tokenizeInterpolation=function(t){return E.utils.tokenizeInterpolation_(t,!0)},E.utils.replaceMessageReferences=function(t){return"string"!=typeof t?t:(t=E.utils.tokenizeInterpolation_(t,!1)).length?String(t[0]):""},E.utils.checkMessageReferences=function(t){for(var e=!0,o=E.Msg,n=t.match(/%{BKY_[A-Z]\w*}/gi),i=0;i<n.length;i++)null==o[n[i].toUpperCase().slice(6,-1)]&&(console.warn("No message string for "+n[i]+" in "+t),e=!1);return e},E.utils.tokenizeInterpolation_=function(t,e){var o=[],n=t.split("");n.push("");var i=0;t=[];for(var r=null,s=0;s<n.length;s++){var a=n[s];0==i?"%"==a?((a=t.join(""))&&o.push(a),t.length=0,i=1):t.push(a):1==i?"%"==a?(t.push(a),i=0):e&&"0"<=a&&a<="9"?(i=2,r=a,(a=t.join(""))&&o.push(a),t.length=0):i="{"==a?3:(t.push("%",a),0):2==i?"0"<=a&&a<="9"?r+=a:(o.push(parseInt(r,10)),s--,i=0):3==i&&(""==a?(t.splice(0,0,"%{"),s--,i=0):"}"!=a?t.push(a):(i=t.join(""),/[A-Z]\w*/i.test(i)?(a=i.toUpperCase(),(a=E.utils.string.startsWith(a,"BKY_")?a.substring(4):null)&&a in E.Msg?"string"==typeof(i=E.Msg[a])?Array.prototype.push.apply(o,E.utils.tokenizeInterpolation_(i,e)):e?o.push(String(i)):o.push(i):o.push("%{"+i+"}")):o.push("%{"+i+"}"),i=t.length=0))}for((a=t.join(""))&&o.push(a),e=[],s=t.length=0;s<o.length;++s)"string"==typeof o[s]?t.push(o[s]):((a=t.join(""))&&e.push(a),t.length=0,e.push(o[s]));return(a=t.join(""))&&e.push(a),t.length=0,e},E.utils.genUid=function(){for(var t=E.utils.genUid.soup_.length,e=[],o=0;o<20;o++)e[o]=E.utils.genUid.soup_.charAt(Math.random()*t);return e.join("")},E.utils.genUid.soup_="!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",E.utils.is3dSupported=function(){if(void 0!==E.utils.is3dSupported.cached_)return E.utils.is3dSupported.cached_;if(!E.utils.global.getComputedStyle)return!1;var t=document.createElement("p"),e="none",o={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};for(var n in document.body.insertBefore(t,null),o)if(void 0!==t.style[n]){if(t.style[n]="translate3d(1px,1px,1px)",!(e=E.utils.global.getComputedStyle(t)))return document.body.removeChild(t),!1;e=e.getPropertyValue(o[n])}return document.body.removeChild(t),E.utils.is3dSupported.cached_="none"!==e,E.utils.is3dSupported.cached_},E.utils.runAfterPageLoad=function(t){if("object"!=typeof document)throw Error("Blockly.utils.runAfterPageLoad() requires browser document.");if("complete"==document.readyState)t();else var e=setInterval(function(){"complete"==document.readyState&&(clearInterval(e),t())},10)},E.utils.getViewportBBox=function(){var t=E.utils.style.getViewportPageOffset();return new E.utils.Rect(t.y,document.documentElement.clientHeight+t.y,t.x,document.documentElement.clientWidth+t.x)},E.utils.arrayRemove=function(t,e){return-1!=(e=t.indexOf(e))&&(t.splice(e,1),!0)},E.utils.getDocumentScroll=function(){var t=document.documentElement,e=window;return E.utils.userAgent.IE&&e.pageYOffset!=t.scrollTop?new E.utils.Coordinate(t.scrollLeft,t.scrollTop):new E.utils.Coordinate(e.pageXOffset||t.scrollLeft,e.pageYOffset||t.scrollTop)},E.utils.getBlockTypeCounts=function(t,e){var o=Object.create(null),n=t.getDescendants(!0);for(e&&(t=t.getNextBlock())&&(t=n.indexOf(t),n.splice(t,n.length-t)),t=0;e=n[t];t++)o[e.type]?o[e.type]++:o[e.type]=1;return o},E.utils.screenToWsCoordinates=function(t,e){var o=e.x;e=e.y;var n=t.getInjectionDiv().getBoundingClientRect();return o=new E.utils.Coordinate(o-n.left,e-n.top),e=t.getOriginOffsetInPixels(),E.utils.Coordinate.difference(o,e).scale(1/t.scale)},E.utils.parseBlockColour=function(t){var e="string"==typeof t?E.utils.replaceMessageReferences(t):t,o=Number(e);if(!isNaN(o)&&0<=o&&o<=360)return{hue:o,hex:E.utils.colour.hsvToHex(o,E.HSV_SATURATION,255*E.HSV_VALUE)};if(o=E.utils.colour.parse(e))return{hue:null,hex:o};throw o='Invalid colour: "'+e+'"',t!=e&&(o+=' (from "'+t+'")'),Error(o)},E.Events={},E.Events.group_="",E.Events.recordUndo=!0,E.Events.disabled_=0,E.Events.CREATE="create",E.Events.BLOCK_CREATE=E.Events.CREATE,E.Events.DELETE="delete",E.Events.BLOCK_DELETE=E.Events.DELETE,E.Events.CHANGE="change",E.Events.BLOCK_CHANGE=E.Events.CHANGE,E.Events.MOVE="move",E.Events.BLOCK_MOVE=E.Events.MOVE,E.Events.VAR_CREATE="var_create",E.Events.VAR_DELETE="var_delete",E.Events.VAR_RENAME="var_rename",E.Events.UI="ui",E.Events.COMMENT_CREATE="comment_create",E.Events.COMMENT_DELETE="comment_delete",E.Events.COMMENT_CHANGE="comment_change",E.Events.COMMENT_MOVE="comment_move",E.Events.FINISHED_LOADING="finished_loading",E.Events.BUMP_EVENTS=[E.Events.BLOCK_CREATE,E.Events.BLOCK_MOVE,E.Events.COMMENT_CREATE,E.Events.COMMENT_MOVE],E.Events.FIRE_QUEUE_=[],E.Events.fire=function(t){E.Events.isEnabled()&&(E.Events.FIRE_QUEUE_.length||setTimeout(E.Events.fireNow_,0),E.Events.FIRE_QUEUE_.push(t))},E.Events.fireNow_=function(){for(var t,e=E.Events.filter(E.Events.FIRE_QUEUE_,!0),o=E.Events.FIRE_QUEUE_.length=0;t=e[o];o++)if(t.workspaceId){var n=E.Workspace.getById(t.workspaceId);n&&n.fireChangeListener(t)}},E.Events.filter=function(t,e){t=t.slice(),e||t.reverse();for(var o,n=[],i=Object.create(null),r=0;o=t[r];r++)if(!o.isNull()){var s=[o.type,o.blockId,o.workspaceId].join(" "),a=i[s],l=a?a.event:null;a?o.type==E.Events.MOVE&&a.index==r-1?(l.newParentId=o.newParentId,l.newInputName=o.newInputName,l.newCoordinate=o.newCoordinate,a.index=r):o.type==E.Events.CHANGE&&o.element==l.element&&o.name==l.name?l.newValue=o.newValue:(o.type!=E.Events.UI||"click"!=o.element||"commentOpen"!=l.element&&"mutatorOpen"!=l.element&&"warningOpen"!=l.element)&&(i[s]={event:o,index:1},n.push(o)):(i[s]={event:o,index:r},n.push(o))}for(t=n.filter(function(t){return!t.isNull()}),e||t.reverse(),r=1;o=t[r];r++)o.type==E.Events.CHANGE&&"mutation"==o.element&&t.unshift(t.splice(r,1)[0]);return t},E.Events.clearPendingUndo=function(){for(var t,e=0;t=E.Events.FIRE_QUEUE_[e];e++)t.recordUndo=!1},E.Events.disable=function(){E.Events.disabled_++},E.Events.enable=function(){E.Events.disabled_--},E.Events.isEnabled=function(){return 0==E.Events.disabled_},E.Events.getGroup=function(){return E.Events.group_},E.Events.setGroup=function(t){E.Events.group_="boolean"==typeof t?t?E.utils.genUid():"":t},E.Events.getDescendantIds=function(t){var e=[];t=t.getDescendants(!1);for(var o,n=0;o=t[n];n++)e[n]=o.id;return e},E.Events.fromJson=function(t,e){var o=E.registry.getClass(E.registry.Type.EVENT,t.type);if(!o)throw Error("Unknown event type.");return(o=new o).fromJson(t),o.workspaceId=e.id,o},E.Events.disableOrphans=function(t){if((t.type==E.Events.MOVE||t.type==E.Events.CREATE)&&t.workspaceId){var e=E.Workspace.getById(t.workspaceId);if(t=e.getBlockById(t.blockId)){var o=t.getParent();if(o&&o.isEnabled())for(e=t.getDescendants(!1),t=0;o=e[t];t++)o.setEnabled(!0);else if((t.outputConnection||t.previousConnection)&&!e.isDragging())for(;t.setEnabled(!1),t=t.getNextBlock(););}}},E.Events.Abstract=function(){this.isBlank=null,this.workspaceId=void 0,this.group=E.Events.getGroup(),this.recordUndo=E.Events.recordUndo},E.Events.Abstract.prototype.toJson=function(){var t={type:this.type};return this.group&&(t.group=this.group),t},E.Events.Abstract.prototype.fromJson=function(t){this.isBlank=!1,this.group=t.group},E.Events.Abstract.prototype.isNull=function(){return!1},E.Events.Abstract.prototype.run=function(t){},E.Events.Abstract.prototype.getEventWorkspace_=function(){if(this.workspaceId)var t=E.Workspace.getById(this.workspaceId);if(!t)throw Error("Workspace is null. Event must have been generated from real Blockly events.");return t},E.utils.object={},E.utils.object.inherits=function(t,e){t.superClass_=e.prototype,t.prototype=Object.create(e.prototype),t.prototype.constructor=t},E.utils.object.mixin=function(t,e){for(var o in e)t[o]=e[o]},E.utils.object.deepMerge=function(t,e){for(var o in e)t[o]=null!=e[o]&&"object"==typeof e[o]?E.utils.object.deepMerge(t[o]||Object.create(null),e[o]):e[o];return t},E.utils.object.values=function(e){return Object.values?Object.values(e):Object.keys(e).map(function(t){return e[t]})},E.Events.Ui=function(t,e,o,n){E.Events.Ui.superClass_.constructor.call(this),this.isBlank=void 0===t,this.blockId=t?t.id:null,this.workspaceId=t?t.workspace.id:void 0,this.element=void 0===e?"":e,this.oldValue=void 0===o?"":o,this.newValue=void 0===n?"":n,this.recordUndo=!1},E.utils.object.inherits(E.Events.Ui,E.Events.Abstract),E.Events.Ui.prototype.type=E.Events.UI,E.Events.Ui.prototype.toJson=function(){var t=E.Events.Ui.superClass_.toJson.call(this);return t.element=this.element,void 0!==this.newValue&&(t.newValue=this.newValue),this.blockId&&(t.blockId=this.blockId),t},E.Events.Ui.prototype.fromJson=function(t){E.Events.Ui.superClass_.fromJson.call(this,t),this.element=t.element,this.newValue=t.newValue,this.blockId=t.blockId},E.registry.register(E.registry.Type.EVENT,E.Events.UI,E.Events.Ui),E.utils.Svg=function(t){this.tagName_=t},E.utils.Svg.prototype.toString=function(){return this.tagName_},E.utils.Svg.ANIMATE=new E.utils.Svg("animate"),E.utils.Svg.CIRCLE=new E.utils.Svg("circle"),E.utils.Svg.CLIPPATH=new E.utils.Svg("clipPath"),E.utils.Svg.DEFS=new E.utils.Svg("defs"),E.utils.Svg.FECOMPOSITE=new E.utils.Svg("feComposite"),E.utils.Svg.FECOMPONENTTRANSFER=new E.utils.Svg("feComponentTransfer"),E.utils.Svg.FEFLOOD=new E.utils.Svg("feFlood"),E.utils.Svg.FEFUNCA=new E.utils.Svg("feFuncA"),E.utils.Svg.FEGAUSSIANBLUR=new E.utils.Svg("feGaussianBlur"),E.utils.Svg.FEPOINTLIGHT=new E.utils.Svg("fePointLight"),E.utils.Svg.FESPECULARLIGHTING=new E.utils.Svg("feSpecularLighting"),E.utils.Svg.FILTER=new E.utils.Svg("filter"),E.utils.Svg.FOREIGNOBJECT=new E.utils.Svg("foreignObject"),E.utils.Svg.G=new E.utils.Svg("g"),E.utils.Svg.IMAGE=new E.utils.Svg("image"),E.utils.Svg.LINE=new E.utils.Svg("line"),E.utils.Svg.PATH=new E.utils.Svg("path"),E.utils.Svg.PATTERN=new E.utils.Svg("pattern"),E.utils.Svg.POLYGON=new E.utils.Svg("polygon"),E.utils.Svg.RECT=new E.utils.Svg("rect"),E.utils.Svg.SVG=new E.utils.Svg("svg"),E.utils.Svg.TEXT=new E.utils.Svg("text"),E.utils.Svg.TSPAN=new E.utils.Svg("tspan"),E.utils.dom={},E.utils.dom.SVG_NS="http://www.w3.org/2000/svg",E.utils.dom.HTML_NS="http://www.w3.org/1999/xhtml",E.utils.dom.XLINK_NS="http://www.w3.org/1999/xlink",E.utils.dom.NodeType={ELEMENT_NODE:1,TEXT_NODE:3,COMMENT_NODE:8,DOCUMENT_POSITION_CONTAINED_BY:16},E.utils.dom.cacheWidths_=null,E.utils.dom.cacheReference_=0,E.utils.dom.canvasContext_=null,E.utils.dom.createSvgElement=function(t,e,o){for(var n in t=document.createElementNS(E.utils.dom.SVG_NS,String(t)),e)t.setAttribute(n,e[n]);return document.body.runtimeStyle&&(t.runtimeStyle=t.currentStyle=t.style),o&&o.appendChild(t),t},E.utils.dom.addClass=function(t,e){var o=t.getAttribute("class")||"";return-1==(" "+o+" ").indexOf(" "+e+" ")&&(o&&(o+=" "),t.setAttribute("class",o+e),!0)},E.utils.dom.removeClasses=function(t,e){e=e.split(" ");for(var o=0;o<e.length;o++)E.utils.dom.removeClass(t,e[o])},E.utils.dom.removeClass=function(t,e){var o=t.getAttribute("class");if(-1==(" "+o+" ").indexOf(" "+e+" "))return!1;o=o.split(/\s+/);for(var n=0;n<o.length;n++)o[n]&&o[n]!=e||(o.splice(n,1),n--);return o.length?t.setAttribute("class",o.join(" ")):t.removeAttribute("class"),!0},E.utils.dom.hasClass=function(t,e){return-1!=(" "+t.getAttribute("class")+" ").indexOf(" "+e+" ")},E.utils.dom.removeNode=function(t){return t&&t.parentNode?t.parentNode.removeChild(t):null},E.utils.dom.insertAfter=function(t,e){var o=e.nextSibling;if(!(e=e.parentNode))throw Error("Reference node has no parent.");o?e.insertBefore(t,o):e.appendChild(t)},E.utils.dom.containsNode=function(t,e){return!!(t.compareDocumentPosition(e)&E.utils.dom.NodeType.DOCUMENT_POSITION_CONTAINED_BY)},E.utils.dom.setCssTransform=function(t,e){t.style.transform=e,t.style["-webkit-transform"]=e},E.utils.dom.startTextWidthCache=function(){E.utils.dom.cacheReference_++,E.utils.dom.cacheWidths_||(E.utils.dom.cacheWidths_={})},E.utils.dom.stopTextWidthCache=function(){E.utils.dom.cacheReference_--,E.utils.dom.cacheReference_||(E.utils.dom.cacheWidths_=null)},E.utils.dom.getTextWidth=function(e){var t,o=e.textContent+"\n"+e.className.baseVal;if(E.utils.dom.cacheWidths_&&(t=E.utils.dom.cacheWidths_[o]))return t;try{t=E.utils.userAgent.IE||E.utils.userAgent.EDGE?e.getBBox().width:e.getComputedTextLength()}catch(t){return 8*e.textContent.length}return E.utils.dom.cacheWidths_&&(E.utils.dom.cacheWidths_[o]=t),t},E.utils.dom.getFastTextWidth=function(t,e,o,n){return E.utils.dom.getFastTextWidthWithSizeString(t,e+"pt",o,n)},E.utils.dom.getFastTextWidthWithSizeString=function(t,e,o,n){var i,r=t.textContent;return t=r+"\n"+t.className.baseVal,E.utils.dom.cacheWidths_&&(i=E.utils.dom.cacheWidths_[t])||(E.utils.dom.canvasContext_||((i=document.createElement("canvas")).className="blocklyComputeCanvas",document.body.appendChild(i),E.utils.dom.canvasContext_=i.getContext("2d")),E.utils.dom.canvasContext_.font=o+" "+e+" "+n,i=E.utils.dom.canvasContext_.measureText(r).width,E.utils.dom.cacheWidths_&&(E.utils.dom.cacheWidths_[t]=i)),i},E.utils.dom.measureFontMetrics=function(t,e,o,n){var i=document.createElement("span");i.style.font=o+" "+e+" "+n,i.textContent=t,(t=document.createElement("div")).style.width="1px",t.style.height="0px",(e=document.createElement("div")).setAttribute("style","position: fixed; top: 0; left: 0; display: flex;"),e.appendChild(i),e.appendChild(t),document.body.appendChild(e);try{o={},e.style.alignItems="baseline",o.baseline=t.offsetTop-i.offsetTop,e.style.alignItems="flex-end",o.height=t.offsetTop-i.offsetTop}finally{document.body.removeChild(e)}return o},E.BlockDragSurfaceSvg=function(t){this.container_=t,this.createDom()},E.BlockDragSurfaceSvg.prototype.SVG_=null,E.BlockDragSurfaceSvg.prototype.dragGroup_=null,E.BlockDragSurfaceSvg.prototype.container_=null,E.BlockDragSurfaceSvg.prototype.scale_=1,E.BlockDragSurfaceSvg.prototype.surfaceXY_=null,E.BlockDragSurfaceSvg.prototype.createDom=function(){this.SVG_||(this.SVG_=E.utils.dom.createSvgElement(E.utils.Svg.SVG,{xmlns:E.utils.dom.SVG_NS,"xmlns:html":E.utils.dom.HTML_NS,"xmlns:xlink":E.utils.dom.XLINK_NS,version:"1.1",class:"blocklyBlockDragSurface"},this.container_),this.dragGroup_=E.utils.dom.createSvgElement(E.utils.Svg.G,{},this.SVG_))},E.BlockDragSurfaceSvg.prototype.setBlocksAndShow=function(t){if(this.dragGroup_.childNodes.length)throw Error("Already dragging a block.");this.dragGroup_.appendChild(t),this.SVG_.style.display="block",this.surfaceXY_=new E.utils.Coordinate(0,0)},E.BlockDragSurfaceSvg.prototype.translateAndScaleGroup=function(t,e,o){this.scale_=o,t=t.toFixed(0),e=e.toFixed(0),this.dragGroup_.setAttribute("transform","translate("+t+","+e+") scale("+o+")")},E.BlockDragSurfaceSvg.prototype.translateSurfaceInternal_=function(){var t=this.surfaceXY_.x,e=this.surfaceXY_.y;t=t.toFixed(0),e=e.toFixed(0),this.SVG_.style.display="block",E.utils.dom.setCssTransform(this.SVG_,"translate3d("+t+"px, "+e+"px, 0px)")},E.BlockDragSurfaceSvg.prototype.translateSurface=function(t,e){this.surfaceXY_=new E.utils.Coordinate(t*this.scale_,e*this.scale_),this.translateSurfaceInternal_()},E.BlockDragSurfaceSvg.prototype.getSurfaceTranslation=function(){var t=E.utils.getRelativeXY(this.SVG_);return new E.utils.Coordinate(t.x/this.scale_,t.y/this.scale_)},E.BlockDragSurfaceSvg.prototype.getGroup=function(){return this.dragGroup_},E.BlockDragSurfaceSvg.prototype.getCurrentBlock=function(){return this.dragGroup_.firstChild},E.BlockDragSurfaceSvg.prototype.clearAndHide=function(t){if(t?t.appendChild(this.getCurrentBlock()):this.dragGroup_.removeChild(this.getCurrentBlock()),this.SVG_.style.display="none",this.dragGroup_.childNodes.length)throw Error("Drag group was not cleared.");this.surfaceXY_=null},E.utils.IdGenerator={},E.utils.IdGenerator.nextId_=0,E.utils.IdGenerator.getNextUniqueId=function(){return"blockly-"+(E.utils.IdGenerator.nextId_++).toString(36)},E.Component=function(){this.rightToLeft_=E.Component.defaultRightToLeft,this.id_=null,this.inDocument_=!1,this.parent_=this.element_=null,this.children_=[],this.childIndex_={},this.disposed_=!1},E.Component.defaultRightToLeft=!1,E.Component.Error={ALREADY_RENDERED:"Component already rendered",PARENT_UNABLE_TO_BE_SET:"Unable to set parent component",CHILD_INDEX_OUT_OF_BOUNDS:"Child component index out of bounds",ABSTRACT_METHOD:"Unimplemented abstract method"},E.Component.prototype.getId=function(){return this.id_||(this.id_=E.utils.IdGenerator.getNextUniqueId())},E.Component.prototype.getElement=function(){return this.element_},E.Component.prototype.setElementInternal=function(t){this.element_=t},E.Component.prototype.setParent=function(t){if(this==t)throw Error(E.Component.Error.PARENT_UNABLE_TO_BE_SET);if(t&&this.parent_&&this.id_&&this.parent_.getChild(this.id_)&&this.parent_!=t)throw Error(E.Component.Error.PARENT_UNABLE_TO_BE_SET);this.parent_=t},E.Component.prototype.getParent=function(){return this.parent_},E.Component.prototype.isInDocument=function(){return this.inDocument_},E.Component.prototype.createDom=function(){throw Error(E.Component.Error.ABSTRACT_METHOD)},E.Component.prototype.render=function(t){this.render_(t)},E.Component.prototype.render_=function(t,e){if(this.inDocument_)throw Error(E.Component.Error.ALREADY_RENDERED);this.element_||this.createDom(),t?t.insertBefore(this.element_,e||null):document.body.appendChild(this.element_),this.parent_&&!this.parent_.isInDocument()||this.enterDocument()},E.Component.prototype.enterDocument=function(){this.inDocument_=!0,this.forEachChild(function(t){!t.isInDocument()&&t.getElement()&&t.enterDocument()})},E.Component.prototype.exitDocument=function(){this.forEachChild(function(t){t.isInDocument()&&t.exitDocument()}),this.inDocument_=!1},E.Component.prototype.dispose=function(){this.disposed_||(this.disposed_=!0,this.disposeInternal())},E.Component.prototype.disposeInternal=function(){this.inDocument_&&this.exitDocument(),this.forEachChild(function(t){t.dispose()}),this.element_&&E.utils.dom.removeNode(this.element_),this.parent_=this.element_=this.childIndex_=this.children_=null},E.Component.prototype.addChild=function(t,e){this.addChildAt(t,this.getChildCount(),e)},E.Component.prototype.addChildAt=function(t,e,o){if(t.inDocument_&&(o||!this.inDocument_))throw Error(E.Component.Error.ALREADY_RENDERED);if(e<0||e>this.getChildCount())throw Error(E.Component.Error.CHILD_INDEX_OUT_OF_BOUNDS);if((this.childIndex_[t.getId()]=t).getParent()==this){var n=this.children_.indexOf(t);-1<n&&this.children_.splice(n,1)}t.setParent(this),this.children_.splice(e,0,t),t.inDocument_&&this.inDocument_&&t.getParent()==this?(e=(o=this.getContentElement()).childNodes[e]||null)!=t.getElement()&&o.insertBefore(t.getElement(),e):o?(this.element_||this.createDom(),e=this.getChildAt(e+1),t.render_(this.getContentElement(),e?e.element_:null)):this.inDocument_&&!t.inDocument_&&t.element_&&t.element_.parentNode&&t.element_.parentNode.nodeType==E.utils.dom.NodeType.ELEMENT_NODE&&t.enterDocument()},E.Component.prototype.getContentElement=function(){return this.element_},E.Component.prototype.hasChildren=function(){return 0!=this.children_.length},E.Component.prototype.getChildCount=function(){return this.children_.length},E.Component.prototype.getChild=function(t){return t&&this.childIndex_[t]||null},E.Component.prototype.getChildAt=function(t){return this.children_[t]||null},E.Component.prototype.forEachChild=function(t,e){for(var o=0;o<this.children_.length;o++)t.call(e,this.children_[o],o)},E.Css={},E.Css.injected_=!1,E.Css.register=function(t){if(E.Css.injected_)throw Error("CSS already injected");Array.prototype.push.apply(E.Css.CONTENT,t),t.length=0},E.Css.inject=function(t,e){if(!E.Css.injected_){E.Css.injected_=!0;var o=E.Css.CONTENT.join("\n");E.Css.CONTENT.length=0,t&&(t=e.replace(/[\\/]$/,""),o=o.replace(/<<<PATH>>>/g,t),(t=document.createElement("style")).id="blockly-common-style",o=document.createTextNode(o),t.appendChild(o),document.head.insertBefore(t,document.head.firstChild))}},E.Css.CONTENT=[".blocklySvg {","background-color: #fff;","outline: none;","overflow: hidden;","position: absolute;","display: block;","}",".blocklyWidgetDiv {","display: none;","position: absolute;","z-index: 99999;","}",".injectionDiv {","height: 100%;","position: relative;","overflow: hidden;","touch-action: none;","}",".blocklyNonSelectable {","user-select: none;","-ms-user-select: none;","-webkit-user-select: none;","}",".blocklyWsDragSurface {","display: none;","position: absolute;","top: 0;","left: 0;","}",".blocklyWsDragSurface.blocklyOverflowVisible {","overflow: visible;","}",".blocklyBlockDragSurface {","display: none;","position: absolute;","top: 0;","left: 0;","right: 0;","bottom: 0;","overflow: visible !important;","z-index: 50;","}",".blocklyBlockCanvas.blocklyCanvasTransitioning,",".blocklyBubbleCanvas.blocklyCanvasTransitioning {","transition: transform .5s;","}",".blocklyTooltipDiv {","background-color: #ffffc7;","border: 1px solid #ddc;","box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);","color: #000;","display: none;","font: 9pt sans-serif;","opacity: .9;","padding: 2px;","position: absolute;","z-index: 100000;","}",".blocklyDropDownDiv {","position: absolute;","left: 0;","top: 0;","z-index: 1000;","display: none;","border: 1px solid;","border-color: #dadce0;","background-color: #fff;","border-radius: 2px;","padding: 4px;","box-shadow: 0 0 3px 1px rgba(0,0,0,.3);","}",".blocklyDropDownDiv.blocklyFocused {","box-shadow: 0 0 6px 1px rgba(0,0,0,.3);","}",".blocklyDropDownContent {","max-height: 300px;","overflow: auto;","overflow-x: hidden;","position: relative;","}",".blocklyDropDownArrow {","position: absolute;","left: 0;","top: 0;","width: 16px;","height: 16px;","z-index: -1;","background-color: inherit;","border-color: inherit;","}",".blocklyDropDownButton {","display: inline-block;","float: left;","padding: 0;","margin: 4px;","border-radius: 4px;","outline: none;","border: 1px solid;","transition: box-shadow .1s;","cursor: pointer;","}",".blocklyArrowTop {","border-top: 1px solid;","border-left: 1px solid;","border-top-left-radius: 4px;","border-color: inherit;","}",".blocklyArrowBottom {","border-bottom: 1px solid;","border-right: 1px solid;","border-bottom-right-radius: 4px;","border-color: inherit;","}",".blocklyResizeSE {","cursor: se-resize;","fill: #aaa;","}",".blocklyResizeSW {","cursor: sw-resize;","fill: #aaa;","}",".blocklyResizeLine {","stroke: #515A5A;","stroke-width: 1;","}",".blocklyHighlightedConnectionPath {","fill: none;","stroke: #fc3;","stroke-width: 4px;","}",".blocklyPathLight {","fill: none;","stroke-linecap: round;","stroke-width: 1;","}",".blocklySelected>.blocklyPathLight {","display: none;","}",".blocklyDraggable {",'cursor: url("<<<PATH>>>/handopen.cur"), auto;',"cursor: grab;","cursor: -webkit-grab;","}",".blocklyDragging {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyDraggable:active {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyBlockDragSurface .blocklyDraggable {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyDragging.blocklyDraggingDelete {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyDragging>.blocklyPath,",".blocklyDragging>.blocklyPathLight {","fill-opacity: .8;","stroke-opacity: .8;","}",".blocklyDragging>.blocklyPathDark {","display: none;","}",".blocklyDisabled>.blocklyPath {","fill-opacity: .5;","stroke-opacity: .5;","}",".blocklyDisabled>.blocklyPathLight,",".blocklyDisabled>.blocklyPathDark {","display: none;","}",".blocklyInsertionMarker>.blocklyPath,",".blocklyInsertionMarker>.blocklyPathLight,",".blocklyInsertionMarker>.blocklyPathDark {","fill-opacity: .2;","stroke: none;","}",".blocklyMultilineText {","font-family: monospace;","}",".blocklyNonEditableText>text {","pointer-events: none;","}",".blocklyFlyout {","position: absolute;","z-index: 20;","}",".blocklyText text {","cursor: default;","}",".blocklySvg text,",".blocklyBlockDragSurface text {","user-select: none;","-ms-user-select: none;","-webkit-user-select: none;","cursor: inherit;","}",".blocklyHidden {","display: none;","}",".blocklyFieldDropdown:not(.blocklyHidden) {","display: block;","}",".blocklyIconGroup {","cursor: default;","}",".blocklyIconGroup:not(:hover),",".blocklyIconGroupReadonly {","opacity: .6;","}",".blocklyIconShape {","fill: #00f;","stroke: #fff;","stroke-width: 1px;","}",".blocklyIconSymbol {","fill: #fff;","}",".blocklyMinimalBody {","margin: 0;","padding: 0;","}",".blocklyHtmlInput {","border: none;","border-radius: 4px;","height: 100%;","margin: 0;","outline: none;","padding: 0;","width: 100%;","text-align: center;","display: block;","box-sizing: border-box;","}",".blocklyHtmlInput::-ms-clear {","display: none;","}",".blocklyMainBackground {","stroke-width: 1;","stroke: #c6c6c6;","}",".blocklyMutatorBackground {","fill: #fff;","stroke: #ddd;","stroke-width: 1;","}",".blocklyFlyoutBackground {","fill: #ddd;","fill-opacity: .8;","}",".blocklyMainWorkspaceScrollbar {","z-index: 20;","}",".blocklyFlyoutScrollbar {","z-index: 30;","}",".blocklyScrollbarHorizontal,",".blocklyScrollbarVertical {","position: absolute;","outline: none;","}",".blocklyScrollbarBackground {","opacity: 0;","}",".blocklyScrollbarHandle {","fill: #ccc;","}",".blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,",".blocklyScrollbarHandle:hover {","fill: #bbb;","}",".blocklyFlyout .blocklyScrollbarHandle {","fill: #bbb;","}",".blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,",".blocklyFlyout .blocklyScrollbarHandle:hover {","fill: #aaa;","}",".blocklyInvalidInput {","background: #faa;","}",".blocklyVerticalMarker {","stroke-width: 3px;","fill: rgba(255,255,255,.5);","pointer-events: none;","}",".blocklyComputeCanvas {","position: absolute;","width: 0;","height: 0;","}",".blocklyNoPointerEvents {","pointer-events: none;","}",".blocklyContextMenu {","border-radius: 4px;","max-height: 100%;","}",".blocklyDropdownMenu {","border-radius: 2px;","padding: 0 !important;","}",".blocklyDropdownMenu .blocklyMenuItem {","padding-left: 28px;","}",".blocklyDropdownMenu .blocklyMenuItemRtl {","padding-left: 5px;","padding-right: 28px;","}",".blocklyWidgetDiv .blocklyMenu {","background: #fff;","border: 1px solid transparent;","box-shadow: 0 0 3px 1px rgba(0,0,0,.3);","font: normal 13px Arial, sans-serif;","margin: 0;","outline: none;","padding: 4px 0;","position: absolute;","overflow-y: auto;","overflow-x: hidden;","max-height: 100%;","z-index: 20000;","}",".blocklyWidgetDiv .blocklyMenu.blocklyFocused {","box-shadow: 0 0 6px 1px rgba(0,0,0,.3);","}",".blocklyDropDownDiv .blocklyMenu {",'font: normal 13px "Helvetica Neue", Helvetica, sans-serif;',"outline: none;","z-index: 20000;","}",".blocklyMenuItem {","border: none;","color: #000;","cursor: pointer;","list-style: none;","margin: 0;","min-width: 7em;","padding: 6px 15px;","white-space: nowrap;","}",".blocklyMenuItemDisabled {","color: #ccc;","cursor: inherit;","}",".blocklyMenuItemHighlight {","background-color: rgba(0,0,0,.1);","}",".blocklyMenuItemCheckbox {","height: 16px;","position: absolute;","width: 16px;","}",".blocklyMenuItemSelected .blocklyMenuItemCheckbox {","background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px;","float: left;","margin-left: -24px;","position: static;","}",".blocklyMenuItemRtl .blocklyMenuItemCheckbox {","float: right;","margin-right: -24px;","}"],E.utils.math={},E.utils.math.toRadians=function(t){return t*Math.PI/180},E.utils.math.toDegrees=function(t){return 180*t/Math.PI},E.utils.math.clamp=function(t,e,o){if(o<t){var n=o;o=t,t=n}return Math.max(t,Math.min(e,o))},E.DropDownDiv=function(){},E.DropDownDiv.boundsElement_=null,E.DropDownDiv.owner_=null,E.DropDownDiv.positionToField_=null,E.DropDownDiv.ARROW_SIZE=16,E.DropDownDiv.BORDER_SIZE=1,E.DropDownDiv.ARROW_HORIZONTAL_PADDING=12,E.DropDownDiv.PADDING_Y=16,E.DropDownDiv.ANIMATION_TIME=.25,E.DropDownDiv.animateOutTimer_=null,E.DropDownDiv.onHide_=null,E.DropDownDiv.rendererClassName_="",E.DropDownDiv.themeClassName_="",E.DropDownDiv.createDom=function(){if(!E.DropDownDiv.DIV_){var t=document.createElement("div");t.className="blocklyDropDownDiv",(E.parentContainer||document.body).appendChild(t),E.DropDownDiv.DIV_=t;var e=document.createElement("div");e.className="blocklyDropDownContent",t.appendChild(e),E.DropDownDiv.content_=e,(e=document.createElement("div")).className="blocklyDropDownArrow",t.appendChild(e),E.DropDownDiv.arrow_=e,E.DropDownDiv.DIV_.style.opacity=0,E.DropDownDiv.DIV_.style.transition="transform "+E.DropDownDiv.ANIMATION_TIME+"s, opacity "+E.DropDownDiv.ANIMATION_TIME+"s",t.addEventListener("focusin",function(){E.utils.dom.addClass(t,"blocklyFocused")}),t.addEventListener("focusout",function(){E.utils.dom.removeClass(t,"blocklyFocused")})}},E.DropDownDiv.setBoundsElement=function(t){E.DropDownDiv.boundsElement_=t},E.DropDownDiv.getContentDiv=function(){return E.DropDownDiv.content_},E.DropDownDiv.clearContent=function(){E.DropDownDiv.content_.textContent="",E.DropDownDiv.content_.style.width=""},E.DropDownDiv.setColour=function(t,e){E.DropDownDiv.DIV_.style.backgroundColor=t,E.DropDownDiv.DIV_.style.borderColor=e},E.DropDownDiv.showPositionedByBlock=function(t,e,o,n){return E.DropDownDiv.showPositionedByRect_(E.DropDownDiv.getScaledBboxOfBlock_(e),t,o,n)},E.DropDownDiv.showPositionedByField=function(t,e,o){return E.DropDownDiv.positionToField_=!0,E.DropDownDiv.showPositionedByRect_(E.DropDownDiv.getScaledBboxOfField_(t),t,e,o)},E.DropDownDiv.getScaledBboxOfBlock_=function(t){var e=t.getSvgRoot(),o=e.getBBox(),n=t.workspace.scale;return t=o.height*n,o=o.width*n,e=E.utils.style.getPageOffset(e),new E.utils.Rect(e.y,e.y+t,e.x,e.x+o)},E.DropDownDiv.getScaledBboxOfField_=function(t){return t=t.getScaledBBox(),new E.utils.Rect(t.top,t.bottom,t.left,t.right)},E.DropDownDiv.showPositionedByRect_=function(t,e,o,n){var i=t.left+(t.right-t.left)/2,r=t.bottom;t=t.top,n&&(t+=n);for(var s=(n=e.getSourceBlock()).workspace;s.options.parentWorkspace;)s=s.options.parentWorkspace;return E.DropDownDiv.setBoundsElement(s.getParentSvg().parentNode),E.DropDownDiv.show(e,n.RTL,i,r,i,t,o)},E.DropDownDiv.show=function(t,e,o,n,i,r,s){return E.DropDownDiv.owner_=t,E.DropDownDiv.onHide_=s||null,(t=E.DropDownDiv.DIV_).style.direction=e?"rtl":"ltr",e=E.getMainWorkspace(),E.DropDownDiv.rendererClassName_=e.getRenderer().getClassName(),E.DropDownDiv.themeClassName_=e.getTheme().getClassName(),E.utils.dom.addClass(t,E.DropDownDiv.rendererClassName_),E.utils.dom.addClass(t,E.DropDownDiv.themeClassName_),E.DropDownDiv.positionInternal_(o,n,i,r)},E.DropDownDiv.getBoundsInfo_=function(){var t=E.utils.style.getPageOffset(E.DropDownDiv.boundsElement_),e=E.utils.style.getSize(E.DropDownDiv.boundsElement_);return{left:t.x,right:t.x+e.width,top:t.y,bottom:t.y+e.height,width:e.width,height:e.height}},E.DropDownDiv.getPositionMetrics_=function(t,e,o,n){var i=E.DropDownDiv.getBoundsInfo_(),r=E.utils.style.getSize(E.DropDownDiv.DIV_);return e+r.height<i.bottom?E.DropDownDiv.getPositionBelowMetrics_(t,e,i,r):n-r.height>i.top?E.DropDownDiv.getPositionAboveMetrics_(o,n,i,r):e+r.height<document.documentElement.clientHeight?E.DropDownDiv.getPositionBelowMetrics_(t,e,i,r):n-r.height>document.documentElement.clientTop?E.DropDownDiv.getPositionAboveMetrics_(o,n,i,r):E.DropDownDiv.getPositionTopOfPageMetrics_(t,i,r)},E.DropDownDiv.getPositionBelowMetrics_=function(t,e,o,n){return{initialX:(t=E.DropDownDiv.getPositionX(t,o.left,o.right,n.width)).divX,initialY:e,finalX:t.divX,finalY:e+E.DropDownDiv.PADDING_Y,arrowX:t.arrowX,arrowY:-(E.DropDownDiv.ARROW_SIZE/2+E.DropDownDiv.BORDER_SIZE),arrowAtTop:!0,arrowVisible:!0}},E.DropDownDiv.getPositionAboveMetrics_=function(t,e,o,n){return{initialX:(t=E.DropDownDiv.getPositionX(t,o.left,o.right,n.width)).divX,initialY:e-n.height,finalX:t.divX,finalY:e-n.height-E.DropDownDiv.PADDING_Y,arrowX:t.arrowX,arrowY:n.height-2*E.DropDownDiv.BORDER_SIZE-E.DropDownDiv.ARROW_SIZE/2,arrowAtTop:!1,arrowVisible:!0}},E.DropDownDiv.getPositionTopOfPageMetrics_=function(t,e,o){return{initialX:(t=E.DropDownDiv.getPositionX(t,e.left,e.right,o.width)).divX,initialY:0,finalX:t.divX,finalY:0,arrowAtTop:null,arrowX:null,arrowY:null,arrowVisible:!1}},E.DropDownDiv.getPositionX=function(t,e,o,n){var i=t;return t=E.utils.math.clamp(e,t-n/2,o-n),i-=E.DropDownDiv.ARROW_SIZE/2,e=E.DropDownDiv.ARROW_HORIZONTAL_PADDING,{arrowX:n=E.utils.math.clamp(e,i-t,n-e-E.DropDownDiv.ARROW_SIZE),divX:t}},E.DropDownDiv.isVisible=function(){return!!E.DropDownDiv.owner_},E.DropDownDiv.hideIfOwner=function(t,e){return E.DropDownDiv.owner_===t&&(e?E.DropDownDiv.hideWithoutAnimation():E.DropDownDiv.hide(),!0)},E.DropDownDiv.hide=function(){var t=E.DropDownDiv.DIV_;t.style.transform="translate(0, 0)",t.style.opacity=0,E.DropDownDiv.animateOutTimer_=setTimeout(function(){E.DropDownDiv.hideWithoutAnimation()},1e3*E.DropDownDiv.ANIMATION_TIME),E.DropDownDiv.onHide_&&(E.DropDownDiv.onHide_(),E.DropDownDiv.onHide_=null)},E.DropDownDiv.hideWithoutAnimation=function(){if(E.DropDownDiv.isVisible()){E.DropDownDiv.animateOutTimer_&&clearTimeout(E.DropDownDiv.animateOutTimer_);var t=E.DropDownDiv.DIV_;t.style.transform="",t.style.left="",t.style.top="",t.style.opacity=0,t.style.display="none",t.style.backgroundColor="",t.style.borderColor="",E.DropDownDiv.onHide_&&(E.DropDownDiv.onHide_(),E.DropDownDiv.onHide_=null),E.DropDownDiv.clearContent(),E.DropDownDiv.owner_=null,E.DropDownDiv.rendererClassName_&&(E.utils.dom.removeClass(t,E.DropDownDiv.rendererClassName_),E.DropDownDiv.rendererClassName_=""),E.DropDownDiv.themeClassName_&&(E.utils.dom.removeClass(t,E.DropDownDiv.themeClassName_),E.DropDownDiv.themeClassName_=""),E.getMainWorkspace().markFocused()}},E.DropDownDiv.positionInternal_=function(t,e,o,n){(t=E.DropDownDiv.getPositionMetrics_(t,e,o,n)).arrowVisible?(E.DropDownDiv.arrow_.style.display="",E.DropDownDiv.arrow_.style.transform="translate("+t.arrowX+"px,"+t.arrowY+"px) rotate(45deg)",E.DropDownDiv.arrow_.setAttribute("class",t.arrowAtTop?"blocklyDropDownArrow blocklyArrowTop":"blocklyDropDownArrow blocklyArrowBottom")):E.DropDownDiv.arrow_.style.display="none",e=Math.floor(t.initialX),o=Math.floor(t.initialY),n=Math.floor(t.finalX);var i=Math.floor(t.finalY),r=E.DropDownDiv.DIV_;return r.style.left=e+"px",r.style.top=o+"px",r.style.display="block",r.style.opacity=1,r.style.transform="translate("+(n-e)+"px,"+(i-o)+"px)",!!t.arrowAtTop},E.DropDownDiv.repositionForWindowResize=function(){if(E.DropDownDiv.owner_){var t=E.DropDownDiv.owner_,e=t.getSourceBlock();e=(t=E.DropDownDiv.positionToField_?E.DropDownDiv.getScaledBboxOfField_(t):E.DropDownDiv.getScaledBboxOfBlock_(e)).left+(t.right-t.left)/2,E.DropDownDiv.positionInternal_(e,t.bottom,e,t.top)}else E.DropDownDiv.hide()},E.Grid=function(t,e){this.gridPattern_=t,this.spacing_=e.spacing,this.length_=e.length,this.line2_=(this.line1_=t.firstChild)&&this.line1_.nextSibling,this.snapToGrid_=e.snap},E.Grid.prototype.scale_=1,E.Grid.prototype.dispose=function(){this.gridPattern_=null},E.Grid.prototype.shouldSnap=function(){return this.snapToGrid_},E.Grid.prototype.getSpacing=function(){return this.spacing_},E.Grid.prototype.getPatternId=function(){return this.gridPattern_.id},E.Grid.prototype.update=function(t){this.scale_=t;var e=this.spacing_*t||100;this.gridPattern_.setAttribute("width",e),this.gridPattern_.setAttribute("height",e);var o=(e=Math.floor(this.spacing_/2)+.5)-this.length_/2,n=e+this.length_/2;e*=t,o*=t,n*=t,this.setLineAttributes_(this.line1_,t,o,n,e,e),this.setLineAttributes_(this.line2_,t,e,e,o,n)},E.Grid.prototype.setLineAttributes_=function(t,e,o,n,i,r){t&&(t.setAttribute("stroke-width",e),t.setAttribute("x1",o),t.setAttribute("y1",i),t.setAttribute("x2",n),t.setAttribute("y2",r))},E.Grid.prototype.moveTo=function(t,e){this.gridPattern_.setAttribute("x",t),this.gridPattern_.setAttribute("y",e),(E.utils.userAgent.IE||E.utils.userAgent.EDGE)&&this.update(this.scale_)},E.Grid.createDom=function(t,e,o){return t=E.utils.dom.createSvgElement(E.utils.Svg.PATTERN,{id:"blocklyGridPattern"+t,patternUnits:"userSpaceOnUse"},o),0<e.length&&0<e.spacing?(E.utils.dom.createSvgElement(E.utils.Svg.LINE,{stroke:e.colour},t),1<e.length&&E.utils.dom.createSvgElement(E.utils.Svg.LINE,{stroke:e.colour},t)):E.utils.dom.createSvgElement(E.utils.Svg.LINE,{},t),t},E.Theme=function(t,e,o,n){this.name=t,this.blockStyles=e||Object.create(null),this.categoryStyles=o||Object.create(null),this.componentStyles=n||Object.create(null),this.fontStyle=Object.create(null),this.startHats=null,E.registry.register(E.registry.Type.THEME,t,this)},E.Theme.prototype.getClassName=function(){return this.name+"-theme"},E.Theme.prototype.setBlockStyle=function(t,e){this.blockStyles[t]=e},E.Theme.prototype.setCategoryStyle=function(t,e){this.categoryStyles[t]=e},E.Theme.prototype.getComponentStyle=function(t){return(t=this.componentStyles[t])&&"string"==typeof t&&this.getComponentStyle(t)?this.getComponentStyle(t):t?String(t):null},E.Theme.prototype.setComponentStyle=function(t,e){this.componentStyles[t]=e},E.Theme.prototype.setFontStyle=function(t){this.fontStyle=t},E.Theme.prototype.setStartHats=function(t){this.startHats=t},E.Theme.defineTheme=function(t,e){var o=new E.Theme(t),n=e.base;return n&&("string"==typeof n&&(n=E.registry.getObject(E.registry.Type.THEME,n)),n instanceof E.Theme&&(E.utils.object.deepMerge(o,n),o.name=t)),E.utils.object.deepMerge(o.blockStyles,e.blockStyles),E.utils.object.deepMerge(o.categoryStyles,e.categoryStyles),E.utils.object.deepMerge(o.componentStyles,e.componentStyles),E.utils.object.deepMerge(o.fontStyle,e.fontStyle),null!=e.startHats&&(o.startHats=e.startHats),o},E.Themes={},E.Themes.Classic={},E.Themes.Classic.defaultBlockStyles={colour_blocks:{colourPrimary:"20"},list_blocks:{colourPrimary:"260"},logic_blocks:{colourPrimary:"210"},loop_blocks:{colourPrimary:"120"},math_blocks:{colourPrimary:"230"},procedure_blocks:{colourPrimary:"290"},text_blocks:{colourPrimary:"160"},variable_blocks:{colourPrimary:"330"},variable_dynamic_blocks:{colourPrimary:"310"},hat_blocks:{colourPrimary:"330",hat:"cap"}},E.Themes.Classic.categoryStyles={colour_category:{colour:"20"},list_category:{colour:"260"},logic_category:{colour:"210"},loop_category:{colour:"120"},math_category:{colour:"230"},procedure_category:{colour:"290"},text_category:{colour:"160"},variable_category:{colour:"330"},variable_dynamic_category:{colour:"310"}},E.Themes.Classic=new E.Theme("classic",E.Themes.Classic.defaultBlockStyles,E.Themes.Classic.categoryStyles),E.utils.KeyCodes={WIN_KEY_FF_LINUX:0,MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PLUS_SIGN:43,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,FF_SEMICOLON:59,FF_EQUALS:61,FF_DASH:173,FF_HASH:163,QUESTION_MARK:63,AT_SIGN:64,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SCROLL_LOCK:145,FIRST_MEDIA_KEY:166,LAST_MEDIA_KEY:183,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,TILDE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,MAC_WK_CMD_LEFT:91,MAC_WK_CMD_RIGHT:93,WIN_IME:229,VK_NONAME:252,PHANTOM:255},E.user={},E.user.keyMap={},E.user.keyMap.map_={},E.user.keyMap.modifierKeys={SHIFT:"Shift",CONTROL:"Control",ALT:"Alt",META:"Meta"},E.user.keyMap.setActionForKey=function(t,e){var o=E.user.keyMap.getKeyByAction(e);o&&delete E.user.keyMap.map_[o],E.user.keyMap.map_[t]=e},E.user.keyMap.setKeyMap=function(t){E.user.keyMap.map_=t},E.user.keyMap.getKeyMap=function(){var t={};return E.utils.object.mixin(t,E.user.keyMap.map_),t},E.user.keyMap.getActionByKeyCode=function(t){return E.user.keyMap.map_[t]},E.user.keyMap.getKeyByAction=function(t){for(var e,o=Object.keys(E.user.keyMap.map_),n=0;e=o[n];n++)if(E.user.keyMap.map_[e].name===t.name)return e;return null},E.user.keyMap.serializeKeyEvent=function(t){for(var e,o=E.utils.object.values(E.user.keyMap.modifierKeys),n="",i=0;e=o[i];i++)t.getModifierState(e)&&(n+=e);return n+t.keyCode},E.user.keyMap.checkModifiers_=function(t,e){for(var o,n=0;o=t[n];n++)if(e.indexOf(o)<0)throw Error(o+" is not a valid modifier key.")},E.user.keyMap.createSerializedKey=function(t,e){var o="",n=E.utils.object.values(E.user.keyMap.modifierKeys);E.user.keyMap.checkModifiers_(e,n);for(var i,r=0;i=n[r];r++)-1<e.indexOf(i)&&(o+=i);return o+t},E.user.keyMap.createDefaultKeyMap=function(){var t={},e=E.user.keyMap.createSerializedKey(E.utils.KeyCodes.K,[E.user.keyMap.modifierKeys.CONTROL,E.user.keyMap.modifierKeys.SHIFT]),o=E.user.keyMap.createSerializedKey(E.utils.KeyCodes.W,[E.user.keyMap.modifierKeys.SHIFT]),n=E.user.keyMap.createSerializedKey(E.utils.KeyCodes.A,[E.user.keyMap.modifierKeys.SHIFT]),i=E.user.keyMap.createSerializedKey(E.utils.KeyCodes.S,[E.user.keyMap.modifierKeys.SHIFT]),r=E.user.keyMap.createSerializedKey(E.utils.KeyCodes.D,[E.user.keyMap.modifierKeys.SHIFT]);return t[E.utils.KeyCodes.W]=E.navigation.ACTION_PREVIOUS,t[E.utils.KeyCodes.A]=E.navigation.ACTION_OUT,t[E.utils.KeyCodes.S]=E.navigation.ACTION_NEXT,t[E.utils.KeyCodes.D]=E.navigation.ACTION_IN,t[E.utils.KeyCodes.I]=E.navigation.ACTION_INSERT,t[E.utils.KeyCodes.ENTER]=E.navigation.ACTION_MARK,t[E.utils.KeyCodes.X]=E.navigation.ACTION_DISCONNECT,t[E.utils.KeyCodes.T]=E.navigation.ACTION_TOOLBOX,t[E.utils.KeyCodes.E]=E.navigation.ACTION_EXIT,t[E.utils.KeyCodes.ESC]=E.navigation.ACTION_EXIT,t[e]=E.navigation.ACTION_TOGGLE_KEYBOARD_NAV,t[o]=E.navigation.ACTION_MOVE_WS_CURSOR_UP,t[n]=E.navigation.ACTION_MOVE_WS_CURSOR_LEFT,t[i]=E.navigation.ACTION_MOVE_WS_CURSOR_DOWN,t[r]=E.navigation.ACTION_MOVE_WS_CURSOR_RIGHT,t},E.utils.Metrics=function(){},E.utils.toolbox={},E.utils.toolbox.CATEGORY_TOOLBOX_KIND="categoryToolbox",E.utils.toolbox.FLYOUT_TOOLBOX_KIND="flyoutToolbox",E.utils.toolbox.Position={TOP:E.TOOLBOX_AT_TOP,BOTTOM:E.TOOLBOX_AT_BOTTOM,LEFT:E.TOOLBOX_AT_LEFT,RIGHT:E.TOOLBOX_AT_RIGHT},E.utils.toolbox.convertToolboxDefToJson=function(t){return t?((t instanceof Element||"string"==typeof t)&&(t=E.utils.toolbox.parseToolboxTree(t),t=E.utils.toolbox.convertToToolboxJson_(t)),E.utils.toolbox.validateToolbox_(t),t):null},E.utils.toolbox.validateToolbox_=function(t){var e=t.kind;if(t=t.contents,e&&e!=E.utils.toolbox.FLYOUT_TOOLBOX_KIND&&e!=E.utils.toolbox.CATEGORY_TOOLBOX_KIND)throw Error("Invalid toolbox kind "+e+". Please supply either "+E.utils.toolbox.FLYOUT_TOOLBOX_KIND+" or "+E.utils.toolbox.CATEGORY_TOOLBOX_KIND);if(!t)throw Error("Toolbox must have a contents attribute.")},E.utils.toolbox.convertFlyoutDefToJsonArray=function(t){return t?t.contents?t.contents:Array.isArray(t)&&0<t.length&&!t[0].nodeType?t:E.utils.toolbox.xmlToJsonArray_(t):[]},E.utils.toolbox.hasCategories=function(t){if(!t)return!1;var e=t.kind;return e?e==E.utils.toolbox.CATEGORY_TOOLBOX_KIND:!!t.contents.filter(function(t){return"CATEGORY"==t.kind.toUpperCase()}).length},E.utils.toolbox.isCategoryCollapsible=function(t){return!(!t||!t.contents||!t.contents.filter(function(t){return"CATEGORY"==t.kind.toUpperCase()}).length)},E.utils.toolbox.convertToToolboxJson_=function(t){var e={contents:E.utils.toolbox.xmlToJsonArray_(t)};return t instanceof Node&&E.utils.toolbox.addAttributes_(t,e),e},E.utils.toolbox.xmlToJsonArray_=function(t){var e,o=[],n=t.childNodes;for(n||(n=t),t=0;e=n[t];t++)if(e.tagName){var i={},r=e.tagName.toUpperCase();"BLOCK"==(i.kind=r)?i.blockxml=e:"CATEGORY"==r&&(i.contents=E.utils.toolbox.xmlToJsonArray_(e)),E.utils.toolbox.addAttributes_(e,i),o.push(i)}return o},E.utils.toolbox.addAttributes_=function(t,e){for(var o=0;o<t.attributes.length;o++){var n=t.attributes[o];-1<n.nodeName.indexOf("css-")?(e.cssconfig=e.cssconfig||{},e.cssconfig[n.nodeName.replace("css-","")]=n.value):e[n.nodeName]=n.value}},E.utils.toolbox.parseToolboxTree=function(t){if(t){if("string"!=typeof t&&(E.utils.userAgent.IE&&t.outerHTML?t=t.outerHTML:t instanceof Element||(t=null)),"string"==typeof t&&"xml"!=(t=E.Xml.textToDom(t)).nodeName.toLowerCase())throw TypeError("Toolbox should be an <xml> document.")}else t=null;return t},E.utils.xml={},E.utils.xml.NAME_SPACE="https://developers.google.com/blockly/xml",E.utils.xml.document=function(){return document},E.utils.xml.createElement=function(t){return E.utils.xml.document().createElementNS(E.utils.xml.NAME_SPACE,t)},E.utils.xml.createTextNode=function(t){return E.utils.xml.document().createTextNode(t)},E.utils.xml.textToDomDocument=function(t){return(new DOMParser).parseFromString(t,"text/xml")},E.utils.xml.domToText=function(t){return(new XMLSerializer).serializeToString(t)},E.Events.BlockBase=function(t){E.Events.BlockBase.superClass_.constructor.call(this),this.blockId=(this.isBlank=void 0===t)?"":t.id,this.workspaceId=this.isBlank?"":t.workspace.id},E.utils.object.inherits(E.Events.BlockBase,E.Events.Abstract),E.Events.BlockBase.prototype.toJson=function(){var t=E.Events.BlockBase.superClass_.toJson.call(this);return t.blockId=this.blockId,t},E.Events.BlockBase.prototype.fromJson=function(t){E.Events.BlockBase.superClass_.fromJson.call(this,t),this.blockId=t.blockId},E.Events.Change=function(t,e,o,n,i){E.Events.Change.superClass_.constructor.call(this,t),t&&(this.element=void 0===e?"":e,this.name=void 0===o?"":o,this.oldValue=void 0===n?"":n,this.newValue=void 0===i?"":i)},E.utils.object.inherits(E.Events.Change,E.Events.BlockBase),E.Events.BlockChange=E.Events.Change,E.Events.Change.prototype.type=E.Events.CHANGE,E.Events.Change.prototype.toJson=function(){var t=E.Events.Change.superClass_.toJson.call(this);return t.element=this.element,this.name&&(t.name=this.name),t.newValue=this.newValue,t},E.Events.Change.prototype.fromJson=function(t){E.Events.Change.superClass_.fromJson.call(this,t),this.element=t.element,this.name=t.name,this.newValue=t.newValue},E.Events.Change.prototype.isNull=function(){return this.oldValue==this.newValue},E.Events.Change.prototype.run=function(t){var e=this.getEventWorkspace_().getBlockById(this.blockId);if(e)switch(e.mutator&&e.mutator.setVisible(!1),t=t?this.newValue:this.oldValue,this.element){case"field":(e=e.getField(this.name))?e.setValue(t):console.warn("Can't set non-existent field: "+this.name);break;case"comment":e.setCommentText(t||null);break;case"collapsed":e.setCollapsed(!!t);break;case"disabled":e.setEnabled(!t);break;case"inline":e.setInputsInline(!!t);break;case"mutation":var o="";if(e.mutationToDom&&(o=(o=e.mutationToDom())&&E.Xml.domToText(o)),e.domToMutation){var n=E.Xml.textToDom(t||"<mutation/>");e.domToMutation(n)}E.Events.fire(new E.Events.Change(e,"mutation",null,o,t));break;default:console.warn("Unknown change type: "+this.element)}else console.warn("Can't change non-existent block: "+this.blockId)},E.Events.Create=function(t){E.Events.Create.superClass_.constructor.call(this,t),t&&(t.isShadow()&&(this.recordUndo=!1),this.xml=t.workspace.rendered?E.Xml.blockToDomWithXY(t):E.Xml.blockToDom(t),this.ids=E.Events.getDescendantIds(t))},E.utils.object.inherits(E.Events.Create,E.Events.BlockBase),E.Events.BlockCreate=E.Events.Create,E.Events.Create.prototype.type=E.Events.CREATE,E.Events.Create.prototype.toJson=function(){var t=E.Events.Create.superClass_.toJson.call(this);return t.xml=E.Xml.domToText(this.xml),t.ids=this.ids,t},E.Events.Create.prototype.fromJson=function(t){E.Events.Create.superClass_.fromJson.call(this,t),this.xml=E.Xml.textToDom(t.xml),this.ids=t.ids},E.Events.Create.prototype.run=function(t){var e=this.getEventWorkspace_();if(t)(t=E.utils.xml.createElement("xml")).appendChild(this.xml),E.Xml.domToWorkspace(t,e);else{t=0;for(var o;o=this.ids[t];t++){var n=e.getBlockById(o);n?n.dispose(!1):o==this.blockId&&console.warn("Can't uncreate non-existent block: "+o)}}},E.Events.Delete=function(t){if(E.Events.Delete.superClass_.constructor.call(this,t),t){if(t.getParent())throw Error("Connected blocks cannot be deleted.");t.isShadow()&&(this.recordUndo=!1),this.oldXml=t.workspace.rendered?E.Xml.blockToDomWithXY(t):E.Xml.blockToDom(t),this.ids=E.Events.getDescendantIds(t)}},E.utils.object.inherits(E.Events.Delete,E.Events.BlockBase),E.Events.BlockDelete=E.Events.Delete,E.Events.Delete.prototype.type=E.Events.DELETE,E.Events.Delete.prototype.toJson=function(){var t=E.Events.Delete.superClass_.toJson.call(this);return t.ids=this.ids,t},E.Events.Delete.prototype.fromJson=function(t){E.Events.Delete.superClass_.fromJson.call(this,t),this.ids=t.ids},E.Events.Delete.prototype.run=function(t){var e=this.getEventWorkspace_();if(t){t=0;for(var o;o=this.ids[t];t++){var n=e.getBlockById(o);n?n.dispose(!1):o==this.blockId&&console.warn("Can't delete non-existent block: "+o)}}else(t=E.utils.xml.createElement("xml")).appendChild(this.oldXml),E.Xml.domToWorkspace(t,e)},E.Events.Move=function(t){E.Events.Move.superClass_.constructor.call(this,t),t&&(t.isShadow()&&(this.recordUndo=!1),t=this.currentLocation_(),this.oldParentId=t.parentId,this.oldInputName=t.inputName,this.oldCoordinate=t.coordinate)},E.utils.object.inherits(E.Events.Move,E.Events.BlockBase),E.Events.BlockMove=E.Events.Move,E.Events.Move.prototype.type=E.Events.MOVE,E.Events.Move.prototype.toJson=function(){var t=E.Events.Move.superClass_.toJson.call(this);return this.newParentId&&(t.newParentId=this.newParentId),this.newInputName&&(t.newInputName=this.newInputName),this.newCoordinate&&(t.newCoordinate=Math.round(this.newCoordinate.x)+","+Math.round(this.newCoordinate.y)),t},E.Events.Move.prototype.fromJson=function(t){E.Events.Move.superClass_.fromJson.call(this,t),this.newParentId=t.newParentId,this.newInputName=t.newInputName,t.newCoordinate&&(t=t.newCoordinate.split(","),this.newCoordinate=new E.utils.Coordinate(Number(t[0]),Number(t[1])))},E.Events.Move.prototype.recordNew=function(){var t=this.currentLocation_();this.newParentId=t.parentId,this.newInputName=t.inputName,this.newCoordinate=t.coordinate},E.Events.Move.prototype.currentLocation_=function(){var t=this.getEventWorkspace_().getBlockById(this.blockId),e={},o=t.getParent();return o?(e.parentId=o.id,(t=o.getInputWithBlock(t))&&(e.inputName=t.name)):e.coordinate=t.getRelativeToSurfaceXY(),e},E.Events.Move.prototype.isNull=function(){return this.oldParentId==this.newParentId&&this.oldInputName==this.newInputName&&E.utils.Coordinate.equals(this.oldCoordinate,this.newCoordinate)},E.Events.Move.prototype.run=function(t){var e=this.getEventWorkspace_(),o=e.getBlockById(this.blockId);if(o){var n=t?this.newParentId:this.oldParentId,i=t?this.newInputName:this.oldInputName;t=t?this.newCoordinate:this.oldCoordinate;var r=null;if(n&&!(r=e.getBlockById(n)))return void console.warn("Can't connect to non-existent block: "+n);if(o.getParent()&&o.unplug(),t)i=o.getRelativeToSurfaceXY(),o.moveBy(t.x-i.x,t.y-i.y);else{if(o=o.outputConnection||o.previousConnection,i){if(e=r.getInput(i))var s=e.connection}else o.type==E.PREVIOUS_STATEMENT&&(s=r.nextConnection);s?o.connect(s):console.warn("Can't connect to non-existent input: "+i)}}else console.warn("Can't move non-existent block: "+this.blockId)},E.registry.register(E.registry.Type.EVENT,E.Events.CREATE,E.Events.Create),E.registry.register(E.registry.Type.EVENT,E.Events.DELETE,E.Events.Delete),E.registry.register(E.registry.Type.EVENT,E.Events.CHANGE,E.Events.Change),E.registry.register(E.registry.Type.EVENT,E.Events.MOVE,E.Events.Move),E.Events.FinishedLoading=function(t){this.isBlank=void 0===t,this.workspaceId=t?t.id:"",this.group=E.Events.getGroup(),this.recordUndo=!1},E.utils.object.inherits(E.Events.FinishedLoading,E.Events.Ui),E.Events.FinishedLoading.prototype.type=E.Events.FINISHED_LOADING,E.Events.FinishedLoading.prototype.toJson=function(){var t={type:this.type};return this.group&&(t.group=this.group),this.workspaceId&&(t.workspaceId=this.workspaceId),t},E.Events.FinishedLoading.prototype.fromJson=function(t){this.isBlank=!1,this.workspaceId=t.workspaceId,this.group=t.group},E.registry.register(E.registry.Type.EVENT,E.Events.FINISHED_LOADING,E.Events.FinishedLoading),E.Events.VarBase=function(t){E.Events.VarBase.superClass_.constructor.call(this),this.varId=(this.isBlank=void 0===t)?"":t.getId(),this.workspaceId=this.isBlank?"":t.workspace.id},E.utils.object.inherits(E.Events.VarBase,E.Events.Abstract),E.Events.VarBase.prototype.toJson=function(){var t=E.Events.VarBase.superClass_.toJson.call(this);return t.varId=this.varId,t},E.Events.VarBase.prototype.fromJson=function(t){E.Events.VarBase.superClass_.toJson.call(this),this.varId=t.varId},E.Events.VarCreate=function(t){E.Events.VarCreate.superClass_.constructor.call(this,t),t&&(this.varType=t.type,this.varName=t.name)},E.utils.object.inherits(E.Events.VarCreate,E.Events.VarBase),E.Events.VarCreate.prototype.type=E.Events.VAR_CREATE,E.Events.VarCreate.prototype.toJson=function(){var t=E.Events.VarCreate.superClass_.toJson.call(this);return t.varType=this.varType,t.varName=this.varName,t},E.Events.VarCreate.prototype.fromJson=function(t){E.Events.VarCreate.superClass_.fromJson.call(this,t),this.varType=t.varType,this.varName=t.varName},E.Events.VarCreate.prototype.run=function(t){var e=this.getEventWorkspace_();t?e.createVariable(this.varName,this.varType,this.varId):e.deleteVariableById(this.varId)},E.Events.VarDelete=function(t){E.Events.VarDelete.superClass_.constructor.call(this,t),t&&(this.varType=t.type,this.varName=t.name)},E.utils.object.inherits(E.Events.VarDelete,E.Events.VarBase),E.Events.VarDelete.prototype.type=E.Events.VAR_DELETE,E.Events.VarDelete.prototype.toJson=function(){var t=E.Events.VarDelete.superClass_.toJson.call(this);return t.varType=this.varType,t.varName=this.varName,t},E.Events.VarDelete.prototype.fromJson=function(t){E.Events.VarDelete.superClass_.fromJson.call(this,t),this.varType=t.varType,this.varName=t.varName},E.Events.VarDelete.prototype.run=function(t){var e=this.getEventWorkspace_();t?e.deleteVariableById(this.varId):e.createVariable(this.varName,this.varType,this.varId)},E.Events.VarRename=function(t,e){E.Events.VarRename.superClass_.constructor.call(this,t),t&&(this.oldName=t.name,this.newName=void 0===e?"":e)},E.utils.object.inherits(E.Events.VarRename,E.Events.VarBase),E.Events.VarRename.prototype.type=E.Events.VAR_RENAME,E.Events.VarRename.prototype.toJson=function(){var t=E.Events.VarRename.superClass_.toJson.call(this);return t.oldName=this.oldName,t.newName=this.newName,t},E.Events.VarRename.prototype.fromJson=function(t){E.Events.VarRename.superClass_.fromJson.call(this,t),this.oldName=t.oldName,this.newName=t.newName},E.Events.VarRename.prototype.run=function(t){var e=this.getEventWorkspace_();t?e.renameVariableById(this.varId,this.newName):e.renameVariableById(this.varId,this.oldName)},E.registry.register(E.registry.Type.EVENT,E.Events.VAR_CREATE,E.Events.VarCreate),E.registry.register(E.registry.Type.EVENT,E.Events.VAR_DELETE,E.Events.VarDelete),E.registry.register(E.registry.Type.EVENT,E.Events.VAR_RENAME,E.Events.VarRename),E.Xml={},E.Xml.workspaceToDom=function(t,e){var o=E.utils.xml.createElement("xml"),n=E.Xml.variablesToDom(E.Variables.allUsedVarModels(t));n.hasChildNodes()&&o.appendChild(n);var i,r=t.getTopComments(!0);for(n=0;i=r[n];n++)o.appendChild(i.toXmlWithXY(e));for(t=t.getTopBlocks(!0),n=0;r=t[n];n++)o.appendChild(E.Xml.blockToDomWithXY(r,e));return o},E.Xml.variablesToDom=function(t){for(var e,o=E.utils.xml.createElement("variables"),n=0;e=t[n];n++){var i=E.utils.xml.createElement("variable");i.appendChild(E.utils.xml.createTextNode(e.name)),e.type&&i.setAttribute("type",e.type),i.id=e.getId(),o.appendChild(i)}return o},E.Xml.blockToDomWithXY=function(t,e){if(t.isInsertionMarker()&&!(t=t.getChildren(!1)[0]))return new DocumentFragment;var o;t.workspace.RTL&&(o=t.workspace.getWidth()),e=E.Xml.blockToDom(t,e);var n=t.getRelativeToSurfaceXY();return e.setAttribute("x",Math.round(t.workspace.RTL?o-n.x:n.x)),e.setAttribute("y",Math.round(n.y)),e},E.Xml.fieldToDom_=function(t){if(t.isSerializable()){var e=E.utils.xml.createElement("field");return e.setAttribute("name",t.name||""),t.toXml(e)}return null},E.Xml.allFieldsToDom_=function(t,e){for(var o,n=0;o=t.inputList[n];n++)for(var i,r=0;i=o.fieldRow[r];r++)(i=E.Xml.fieldToDom_(i))&&e.appendChild(i)},E.Xml.blockToDom=function(t,e){if(t.isInsertionMarker())return(t=t.getChildren(!1)[0])?E.Xml.blockToDom(t):new DocumentFragment;var o=E.utils.xml.createElement(t.isShadow()?"shadow":"block");if(o.setAttribute("type",t.type),e||o.setAttribute("id",t.id),t.mutationToDom){var n=t.mutationToDom();n&&(n.hasChildNodes()||n.hasAttributes())&&o.appendChild(n)}if(E.Xml.allFieldsToDom_(t,o),n=t.getCommentText()){var i=t.commentModel.size,r=t.commentModel.pinned,s=E.utils.xml.createElement("comment");s.appendChild(E.utils.xml.createTextNode(n)),s.setAttribute("pinned",r),s.setAttribute("h",i.height),s.setAttribute("w",i.width),o.appendChild(s)}for(t.data&&((n=E.utils.xml.createElement("data")).appendChild(E.utils.xml.createTextNode(t.data)),o.appendChild(n)),n=0;i=t.inputList[n];n++){var a;if(r=!0,i.type!=E.DUMMY_INPUT){var l=i.connection.targetBlock();i.type==E.INPUT_VALUE?a=E.utils.xml.createElement("value"):i.type==E.NEXT_STATEMENT&&(a=E.utils.xml.createElement("statement")),!(s=i.connection.getShadowDom())||l&&l.isShadow()||a.appendChild(E.Xml.cloneShadow_(s,e)),l&&(s=E.Xml.blockToDom(l,e)).nodeType==E.utils.dom.NodeType.ELEMENT_NODE&&(a.appendChild(s),r=!1),a.setAttribute("name",i.name),r||o.appendChild(a)}}return null!=t.inputsInline&&t.inputsInline!=t.inputsInlineDefault&&o.setAttribute("inline",t.inputsInline),t.isCollapsed()&&o.setAttribute("collapsed",!0),t.isEnabled()||o.setAttribute("disabled",!0),t.isDeletable()||t.isShadow()||o.setAttribute("deletable",!1),t.isMovable()||t.isShadow()||o.setAttribute("movable",!1),t.isEditable()||o.setAttribute("editable",!1),(n=t.getNextBlock())&&(s=E.Xml.blockToDom(n,e)).nodeType==E.utils.dom.NodeType.ELEMENT_NODE&&((a=E.utils.xml.createElement("next")).appendChild(s),o.appendChild(a)),!(s=t.nextConnection&&t.nextConnection.getShadowDom())||n&&n.isShadow()||a.appendChild(E.Xml.cloneShadow_(s,e)),o},E.Xml.cloneShadow_=function(t,e){for(var o,n=t=t.cloneNode(!0);n;)if(e&&"shadow"==n.nodeName&&n.removeAttribute("id"),n.firstChild)n=n.firstChild;else{for(;n&&!n.nextSibling;)n=(o=n).parentNode,o.nodeType==E.utils.dom.NodeType.TEXT_NODE&&""==o.data.trim()&&n.firstChild!=o&&E.utils.dom.removeNode(o);n&&(n=(o=n).nextSibling,o.nodeType==E.utils.dom.NodeType.TEXT_NODE&&""==o.data.trim()&&E.utils.dom.removeNode(o))}return t},E.Xml.domToText=function(t){return E.utils.xml.domToText(t).replace(/<(\w+)([^<]*)\/>/g,"<$1$2></$1>")},E.Xml.domToPrettyText=function(t){t=E.Xml.domToText(t).split("<");for(var e="",o=1;o<t.length;o++){var n=t[o];"/"==n[0]&&(e=e.substring(2)),t[o]=e+"<"+n,"/"!=n[0]&&"/>"!=n.slice(-2)&&(e+="  ")}return(t=(t=t.join("\n")).replace(/(<(\w+)\b[^>]*>[^\n]*)\n *<\/\2>/g,"$1</$2>")).replace(/^\n/,"")},E.Xml.textToDom=function(t){var e=E.utils.xml.textToDomDocument(t);if(!e||!e.documentElement||e.getElementsByTagName("parsererror").length)throw Error("textToDom was unable to parse: "+t);return e.documentElement},E.Xml.clearWorkspaceAndLoadFromXml=function(t,e){return e.setResizesEnabled(!1),e.clear(),t=E.Xml.domToWorkspace(t,e),e.setResizesEnabled(!0),t},E.Xml.domToWorkspace=function(t,e){if(t instanceof E.Workspace){var o=t;t=e,e=o,console.warn("Deprecated call to Blockly.Xml.domToWorkspace, swap the arguments.")}var n;e.RTL&&(n=e.getWidth()),o=[],E.utils.dom.startTextWidthCache();var i=E.Events.getGroup();i||E.Events.setGroup(!0),e.setResizesEnabled&&e.setResizesEnabled(!1);var r=!0;try{for(var s,a=0;s=t.childNodes[a];a++){var l=s.nodeName.toLowerCase(),c=s;if("block"==l||"shadow"==l&&!E.Events.recordUndo){var u=E.Xml.domToBlock(c,e);o.push(u.id);var h=c.hasAttribute("x")?parseInt(c.getAttribute("x"),10):10,p=c.hasAttribute("y")?parseInt(c.getAttribute("y"),10):10;isNaN(h)||isNaN(p)||u.moveBy(e.RTL?n-h:h,p),r=!1}else{if("shadow"==l)throw TypeError("Shadow block cannot be a top-level block.");if("comment"==l)e.rendered?E.WorkspaceCommentSvg?E.WorkspaceCommentSvg.fromXml(c,e,n):console.warn("Missing require for Blockly.WorkspaceCommentSvg, ignoring workspace comment."):E.WorkspaceComment?E.WorkspaceComment.fromXml(c,e):console.warn("Missing require for Blockly.WorkspaceComment, ignoring workspace comment.");else if("variables"==l){if(!r)throw Error("'variables' tag must exist once before block and shadow tag elements in the workspace XML, but it was found in another location.");E.Xml.domToVariables(c,e),r=!1}}}}finally{i||E.Events.setGroup(!1),E.utils.dom.stopTextWidthCache()}return e.setResizesEnabled&&e.setResizesEnabled(!0),E.Events.fire(new E.Events.FinishedLoading(e)),o},E.Xml.appendDomToWorkspace=function(t,e){var o;if(Object.prototype.hasOwnProperty.call(e,"scale")&&(o=e.getBlocksBoundingBox()),t=E.Xml.domToWorkspace(t,e),o&&o.top!=o.bottom){var n=o.bottom,i=e.RTL?o.right:o.left,r=1/0,s=-1/0,a=1/0;for(o=0;o<t.length;o++){var l=e.getBlockById(t[o]).getRelativeToSurfaceXY();l.y<a&&(a=l.y),l.x<r&&(r=l.x),l.x>s&&(s=l.x)}for(n=n-a+10,i=e.RTL?i-s:i-r,o=0;o<t.length;o++)e.getBlockById(t[o]).moveBy(i,n)}return t},E.Xml.domToBlock=function(t,e){if(t instanceof E.Workspace){var o=t;t=e,e=o,console.warn("Deprecated call to Blockly.Xml.domToBlock, swap the arguments.")}E.Events.disable(),o=e.getAllVariables();try{var n=E.Xml.domToBlockHeadless_(t,e),i=n.getDescendants(!1);if(e.rendered){n.setConnectionTracking(!1);for(var r=i.length-1;0<=r;r--)i[r].initSvg();for(r=i.length-1;0<=r;r--)i[r].render(!1);setTimeout(function(){n.disposed||n.setConnectionTracking(!0)},1),n.updateDisabled(),e.resizeContents()}else for(r=i.length-1;0<=r;r--)i[r].initModel()}finally{E.Events.enable()}if(E.Events.isEnabled()){for(t=E.Variables.getAddedVariables(e,o),r=0;r<t.length;r++)E.Events.fire(new E.Events.VarCreate(t[r]));E.Events.fire(new E.Events.BlockCreate(n))}return n},E.Xml.domToVariables=function(t,e){for(var o,n=0;o=t.childNodes[n];n++)if(o.nodeType==E.utils.dom.NodeType.ELEMENT_NODE){var i=o.getAttribute("type"),r=o.getAttribute("id");e.createVariable(o.textContent,i,r)}},E.Xml.domToBlockHeadless_=function(t,e){var o=null,n=t.getAttribute("type");if(!n)throw TypeError("Block type unspecified: "+t.outerHTML);var i=t.getAttribute("id");o=e.newBlock(n,i);var r,s=null;for(i=0;r=t.childNodes[i];i++)if(r.nodeType!=E.utils.dom.NodeType.TEXT_NODE){for(var a,l=s=null,c=0;a=r.childNodes[c];c++)a.nodeType==E.utils.dom.NodeType.ELEMENT_NODE&&("block"==a.nodeName.toLowerCase()?s=a:"shadow"==a.nodeName.toLowerCase()&&(l=a));c=!1;var u=r.getAttribute("name");switch((a=r).nodeName.toLowerCase()){case"mutation":o.domToMutation&&(o.domToMutation(a),o.initSvg&&(c=!0));break;case"comment":if(!E.Comment){console.warn("Missing require for Blockly.Comment, ignoring block comment.");break}l=a.textContent,s="true"==a.getAttribute("pinned"),r=parseInt(a.getAttribute("w"),10),a=parseInt(a.getAttribute("h"),10),o.setCommentText(l),o.commentModel.pinned=s,isNaN(r)||isNaN(a)||(o.commentModel.size=new E.utils.Size(r,a)),s&&o.getCommentIcon&&!o.isInFlyout&&setTimeout(function(){o.getCommentIcon().setVisible(!0)},1);break;case"data":o.data=r.textContent;break;case"title":case"field":E.Xml.domToField_(o,u,a);break;case"value":case"statement":if(!(a=o.getInput(u))){console.warn("Ignoring non-existent input "+u+" in block "+n);break}if(s)if((s=E.Xml.domToBlockHeadless_(s,e)).outputConnection)a.connection.connect(s.outputConnection);else{if(!s.previousConnection)throw TypeError("Child block does not have output or previous statement.");a.connection.connect(s.previousConnection)}l&&a.connection.setShadowDom(l);break;case"next":if(s){if(!o.nextConnection)throw TypeError("Next statement does not exist.");if(o.nextConnection.isConnected())throw TypeError("Next statement is already connected.");if(!(s=E.Xml.domToBlockHeadless_(s,e)).previousConnection)throw TypeError("Next block does not have previous statement.");o.nextConnection.connect(s.previousConnection)}l&&o.nextConnection&&o.nextConnection.setShadowDom(l);break;default:console.warn("Ignoring unknown tag: "+r.nodeName)}}if(c&&o.initSvg(),(i=t.getAttribute("inline"))&&o.setInputsInline("true"==i),(i=t.getAttribute("disabled"))&&o.setEnabled("true"!=i&&"disabled"!=i),(i=t.getAttribute("deletable"))&&o.setDeletable("true"==i),(i=t.getAttribute("movable"))&&o.setMovable("true"==i),(i=t.getAttribute("editable"))&&o.setEditable("true"==i),(i=t.getAttribute("collapsed"))&&o.setCollapsed("true"==i),"shadow"==t.nodeName.toLowerCase()){for(t=o.getChildren(!1),i=0;e=t[i];i++)if(!e.isShadow())throw TypeError("Shadow block not allowed non-shadow child.");if(o.getVarModels().length)throw TypeError("Shadow blocks cannot have variable references.");o.setShadow(!0)}return o},E.Xml.domToField_=function(t,e,o){var n=t.getField(e);n?n.fromXml(o):console.warn("Ignoring non-existent field "+e+" in block "+t.type)},E.Xml.deleteNext=function(t){for(var e,o=0;e=t.childNodes[o];o++)if("next"==e.nodeName.toLowerCase()){t.removeChild(e);break}},E.Options=function(t){var e=!!t.readOnly;if(e)var o=null,n=!1,i=!1,r=!1,s=!1,a=!1,l=!1;else{o=E.utils.toolbox.convertToolboxDefToJson(t.toolbox),n=E.utils.toolbox.hasCategories(o),void 0===(i=t.trashcan)&&(i=n);var c=t.maxTrashcanContents;i?void 0===c&&(c=32):c=0,void 0===(r=t.collapse)&&(r=n),void 0===(s=t.comments)&&(s=n),void 0===(a=t.disable)&&(a=n),void 0===(l=t.sounds)&&(l=!0)}var u=!!t.rtl,h=t.horizontalLayout;void 0===h&&(h=!1);var p=t.toolboxPosition;p="end"!==p,p=h?p?E.utils.toolbox.Position.TOP:E.utils.toolbox.Position.BOTTOM:p==u?E.utils.toolbox.Position.RIGHT:E.utils.toolbox.Position.LEFT;var _=t.css;void 0===_&&(_=!0);var d="https://blockly-demo.appspot.com/static/media/";t.media?d=t.media:t.path&&(d=t.path+"media/");var g=void 0===t.oneBasedIndex||!!t.oneBasedIndex,f=t.keyMap||E.user.keyMap.createDefaultKeyMap(),T=t.renderer||"geras",v=t.plugins||{};this.RTL=u,this.oneBasedIndex=g,this.collapse=r,this.comments=s,this.disable=a,this.readOnly=e,this.maxBlocks=t.maxBlocks||1/0,this.maxInstances=t.maxInstances,this.pathToMedia=d,this.hasCategories=n,this.moveOptions=E.Options.parseMoveOptions_(t,n),this.hasScrollbars=this.moveOptions.scrollbars,this.hasTrashcan=i,this.maxTrashcanContents=c,this.hasSounds=l,this.hasCss=_,this.horizontalLayout=h,this.languageTree=o,this.gridOptions=E.Options.parseGridOptions_(t),this.zoomOptions=E.Options.parseZoomOptions_(t),this.toolboxPosition=p,this.theme=E.Options.parseThemeOptions_(t),this.keyMap=f,this.renderer=T,this.rendererOverrides=t.rendererOverrides,this.gridPattern=null,this.parentWorkspace=t.parentWorkspace,this.plugins=v},E.BlocklyOptions=function(){},E.Options.parseMoveOptions_=function(t,e){var o=t.move||{},n={};return n.scrollbars=void 0===o.scrollbars&&void 0===t.scrollbars?e:!!o.scrollbars||!!t.scrollbars,n.wheel=!(!n.scrollbars||void 0===o.wheel||!o.wheel),n.drag=!(!n.scrollbars||void 0!==o.drag&&!o.drag),n},E.Options.parseZoomOptions_=function(t){t=t.zoom||{};var e={};return e.controls=void 0!==t.controls&&!!t.controls,e.wheel=void 0!==t.wheel&&!!t.wheel,e.startScale=void 0===t.startScale?1:Number(t.startScale),e.maxScale=void 0===t.maxScale?3:Number(t.maxScale),e.minScale=void 0===t.minScale?.3:Number(t.minScale),e.scaleSpeed=void 0===t.scaleSpeed?1.2:Number(t.scaleSpeed),e.pinch=void 0===t.pinch?e.wheel||e.controls:!!t.pinch,e},E.Options.parseGridOptions_=function(t){t=t.grid||{};var e={};return e.spacing=Number(t.spacing)||0,e.colour=t.colour||"#888",e.length=void 0===t.length?1:Number(t.length),e.snap=0<e.spacing&&!!t.snap,e},E.Options.parseThemeOptions_=function(t){return"string"==typeof(t=t.theme||E.Themes.Classic)?E.registry.getObject(E.registry.Type.THEME,t):t instanceof E.Theme?t:E.Theme.defineTheme(t.name||"builtin"+E.utils.IdGenerator.getNextUniqueId(),t)},E.Options.parseToolboxTree=function(t){return E.utils.deprecation.warn("Blockly.Options.parseToolboxTree","September 2020","September 2021","Blockly.utils.toolbox.parseToolboxTree"),E.utils.toolbox.parseToolboxTree(t)},E.Touch={},E.Touch.TOUCH_ENABLED="ontouchstart"in E.utils.global||!!(E.utils.global.document&&document.documentElement&&"ontouchstart"in document.documentElement)||!(!E.utils.global.navigator||!E.utils.global.navigator.maxTouchPoints&&!E.utils.global.navigator.msMaxTouchPoints),E.Touch.touchIdentifier_=null,E.Touch.TOUCH_MAP={},E.utils.global.PointerEvent?E.Touch.TOUCH_MAP={mousedown:["pointerdown"],mouseenter:["pointerenter"],mouseleave:["pointerleave"],mousemove:["pointermove"],mouseout:["pointerout"],mouseover:["pointerover"],mouseup:["pointerup","pointercancel"],touchend:["pointerup"],touchcancel:["pointercancel"]}:E.Touch.TOUCH_ENABLED&&(E.Touch.TOUCH_MAP={mousedown:["touchstart"],mousemove:["touchmove"],mouseup:["touchend","touchcancel"]}),E.longPid_=0,E.longStart=function(t,e){E.longStop_(),t.changedTouches&&1!=t.changedTouches.length||(E.longPid_=setTimeout(function(){t.changedTouches&&(t.button=2,t.clientX=t.changedTouches[0].clientX,t.clientY=t.changedTouches[0].clientY),e&&e.handleRightClick(t)},E.LONGPRESS))},E.longStop_=function(){E.longPid_&&(clearTimeout(E.longPid_),E.longPid_=0)},E.Touch.clearTouchIdentifier=function(){E.Touch.touchIdentifier_=null},E.Touch.shouldHandleEvent=function(t){return!E.Touch.isMouseOrTouchEvent(t)||E.Touch.checkTouchIdentifier(t)},E.Touch.getTouchIdentifierFromEvent=function(t){return null!=t.pointerId?t.pointerId:t.changedTouches&&t.changedTouches[0]&&void 0!==t.changedTouches[0].identifier&&null!==t.changedTouches[0].identifier?t.changedTouches[0].identifier:"mouse"},E.Touch.checkTouchIdentifier=function(t){var e=E.Touch.getTouchIdentifierFromEvent(t);return void 0!==E.Touch.touchIdentifier_&&null!==E.Touch.touchIdentifier_?E.Touch.touchIdentifier_==e:("mousedown"==t.type||"touchstart"==t.type||"pointerdown"==t.type)&&(E.Touch.touchIdentifier_=e,!0)},E.Touch.setClientFromTouch=function(t){if(E.utils.string.startsWith(t.type,"touch")){var e=t.changedTouches[0];t.clientX=e.clientX,t.clientY=e.clientY}},E.Touch.isMouseOrTouchEvent=function(t){return E.utils.string.startsWith(t.type,"touch")||E.utils.string.startsWith(t.type,"mouse")||E.utils.string.startsWith(t.type,"pointer")},E.Touch.isTouchEvent=function(t){return E.utils.string.startsWith(t.type,"touch")||E.utils.string.startsWith(t.type,"pointer")},E.Touch.splitEventByTouches=function(t){var e=[];if(t.changedTouches)for(var o=0;o<t.changedTouches.length;o++)e[o]={type:t.type,changedTouches:[t.changedTouches[o]],target:t.target,stopPropagation:function(){t.stopPropagation()},preventDefault:function(){t.preventDefault()}};else e.push(t);return e},E.ScrollbarPair=function(t){this.workspace_=t,this.hScroll=new E.Scrollbar(t,!0,!0,"blocklyMainWorkspaceScrollbar"),this.vScroll=new E.Scrollbar(t,!1,!0,"blocklyMainWorkspaceScrollbar"),this.corner_=E.utils.dom.createSvgElement(E.utils.Svg.RECT,{height:E.Scrollbar.scrollbarThickness,width:E.Scrollbar.scrollbarThickness,class:"blocklyScrollbarBackground"},null),E.utils.dom.insertAfter(this.corner_,t.getBubbleCanvas()),this.oldHostMetrics_=null},E.ScrollbarPair.prototype.dispose=function(){E.utils.dom.removeNode(this.corner_),this.oldHostMetrics_=this.workspace_=this.corner_=null,this.hScroll.dispose(),this.hScroll=null,this.vScroll.dispose(),this.vScroll=null},E.ScrollbarPair.prototype.resize=function(){var t=this.workspace_.getMetrics();if(t){var e=!1,o=!1;if(this.oldHostMetrics_&&this.oldHostMetrics_.viewWidth==t.viewWidth&&this.oldHostMetrics_.viewHeight==t.viewHeight&&this.oldHostMetrics_.absoluteTop==t.absoluteTop&&this.oldHostMetrics_.absoluteLeft==t.absoluteLeft?(this.oldHostMetrics_&&this.oldHostMetrics_.contentWidth==t.contentWidth&&this.oldHostMetrics_.viewLeft==t.viewLeft&&this.oldHostMetrics_.contentLeft==t.contentLeft||(e=!0),this.oldHostMetrics_&&this.oldHostMetrics_.contentHeight==t.contentHeight&&this.oldHostMetrics_.viewTop==t.viewTop&&this.oldHostMetrics_.contentTop==t.contentTop||(o=!0)):o=e=!0,e||o){try{E.Events.disable(),e&&this.hScroll.resize(t),o&&this.vScroll.resize(t)}finally{E.Events.enable()}this.workspace_.maybeFireViewportChangeEvent()}this.oldHostMetrics_&&this.oldHostMetrics_.viewWidth==t.viewWidth&&this.oldHostMetrics_.absoluteLeft==t.absoluteLeft||this.corner_.setAttribute("x",this.vScroll.position.x),this.oldHostMetrics_&&this.oldHostMetrics_.viewHeight==t.viewHeight&&this.oldHostMetrics_.absoluteTop==t.absoluteTop||this.corner_.setAttribute("y",this.hScroll.position.y),this.oldHostMetrics_=t}},E.ScrollbarPair.prototype.set=function(t,e){var o={};t*=this.hScroll.ratio,e*=this.vScroll.ratio;var n=this.vScroll.scrollViewSize_;o.x=this.getRatio_(t,this.hScroll.scrollViewSize_),o.y=this.getRatio_(e,n),this.workspace_.setMetrics(o),this.hScroll.setHandlePosition(t),this.vScroll.setHandlePosition(e)},E.ScrollbarPair.prototype.getRatio_=function(t,e){return t/=e,isNaN(t)?0:t},E.Scrollbar=function(t,e,o,n){this.workspace_=t,this.pair_=o||!1,this.horizontal_=e,this.ratio=this.oldHostMetrics_=null,this.createDom_(n),this.position=new E.utils.Coordinate(0,0),t=E.Scrollbar.scrollbarThickness,e?(this.svgBackground_.setAttribute("height",t),this.outerSvg_.setAttribute("height",t),this.svgHandle_.setAttribute("height",t-5),this.svgHandle_.setAttribute("y",2.5),this.lengthAttribute_="width",this.positionAttribute_="x"):(this.svgBackground_.setAttribute("width",t),this.outerSvg_.setAttribute("width",t),this.svgHandle_.setAttribute("width",t-5),this.svgHandle_.setAttribute("x",2.5),this.lengthAttribute_="height",this.positionAttribute_="y"),this.onMouseDownBarWrapper_=E.bindEventWithChecks_(this.svgBackground_,"mousedown",this,this.onMouseDownBar_),this.onMouseDownHandleWrapper_=E.bindEventWithChecks_(this.svgHandle_,"mousedown",this,this.onMouseDownHandle_)},E.Scrollbar.prototype.origin_=new E.utils.Coordinate(0,0),E.Scrollbar.prototype.startDragMouse_=0,E.Scrollbar.prototype.scrollViewSize_=0,E.Scrollbar.prototype.handleLength_=0,E.Scrollbar.prototype.handlePosition_=0,E.Scrollbar.prototype.isVisible_=!0,E.Scrollbar.prototype.containerVisible_=!0,E.Scrollbar.scrollbarThickness=15,E.Touch.TOUCH_ENABLED&&(E.Scrollbar.scrollbarThickness=25),E.Scrollbar.metricsAreEquivalent_=function(t,e){return!(!t||!e||t.viewWidth!=e.viewWidth||t.viewHeight!=e.viewHeight||t.viewLeft!=e.viewLeft||t.viewTop!=e.viewTop||t.absoluteTop!=e.absoluteTop||t.absoluteLeft!=e.absoluteLeft||t.contentWidth!=e.contentWidth||t.contentHeight!=e.contentHeight||t.contentLeft!=e.contentLeft||t.contentTop!=e.contentTop)},E.Scrollbar.prototype.dispose=function(){this.cleanUp_(),E.unbindEvent_(this.onMouseDownBarWrapper_),this.onMouseDownBarWrapper_=null,E.unbindEvent_(this.onMouseDownHandleWrapper_),this.onMouseDownHandleWrapper_=null,E.utils.dom.removeNode(this.outerSvg_),this.svgBackground_=this.svgGroup_=this.outerSvg_=null,this.svgHandle_&&(this.workspace_.getThemeManager().unsubscribe(this.svgHandle_),this.svgHandle_=null),this.workspace_=null},E.Scrollbar.prototype.setHandleLength_=function(t){this.handleLength_=t,this.svgHandle_.setAttribute(this.lengthAttribute_,this.handleLength_)},E.Scrollbar.prototype.setHandlePosition=function(t){this.handlePosition_=t,this.svgHandle_.setAttribute(this.positionAttribute_,this.handlePosition_)},E.Scrollbar.prototype.setScrollViewSize_=function(t){this.scrollViewSize_=t,this.outerSvg_.setAttribute(this.lengthAttribute_,this.scrollViewSize_),this.svgBackground_.setAttribute(this.lengthAttribute_,this.scrollViewSize_)},E.ScrollbarPair.prototype.setContainerVisible=function(t){this.hScroll.setContainerVisible(t),this.vScroll.setContainerVisible(t)},E.Scrollbar.prototype.setPosition=function(t,e){this.position.x=t,this.position.y=e,E.utils.dom.setCssTransform(this.outerSvg_,"translate("+(this.position.x+this.origin_.x)+"px,"+(this.position.y+this.origin_.y)+"px)")},E.Scrollbar.prototype.resize=function(t){(t||(t=this.workspace_.getMetrics()))&&(E.Scrollbar.metricsAreEquivalent_(t,this.oldHostMetrics_)||(this.oldHostMetrics_=t,this.horizontal_?this.resizeHorizontal_(t):this.resizeVertical_(t),this.onScroll_()))},E.Scrollbar.prototype.resizeHorizontal_=function(t){this.resizeViewHorizontal(t)},E.Scrollbar.prototype.resizeViewHorizontal=function(t){var e=t.viewWidth-1;this.pair_&&(e-=E.Scrollbar.scrollbarThickness),this.setScrollViewSize_(Math.max(0,e)),e=t.absoluteLeft+.5,this.pair_&&this.workspace_.RTL&&(e+=E.Scrollbar.scrollbarThickness),this.setPosition(e,t.absoluteTop+t.viewHeight-E.Scrollbar.scrollbarThickness-.5),this.resizeContentHorizontal(t)},E.Scrollbar.prototype.resizeContentHorizontal=function(t){this.pair_||this.setVisible(this.scrollViewSize_<t.contentWidth),this.ratio=this.scrollViewSize_/t.contentWidth,(-1/0==this.ratio||1/0==this.ratio||isNaN(this.ratio))&&(this.ratio=0),this.setHandleLength_(Math.max(0,t.viewWidth*this.ratio)),this.setHandlePosition(this.constrainHandle_((t.viewLeft-t.contentLeft)*this.ratio))},E.Scrollbar.prototype.resizeVertical_=function(t){this.resizeViewVertical(t)},E.Scrollbar.prototype.resizeViewVertical=function(t){var e=t.viewHeight-1;this.pair_&&(e-=E.Scrollbar.scrollbarThickness),this.setScrollViewSize_(Math.max(0,e)),e=t.absoluteLeft+.5,this.workspace_.RTL||(e+=t.viewWidth-E.Scrollbar.scrollbarThickness-1),this.setPosition(e,t.absoluteTop+.5),this.resizeContentVertical(t)},E.Scrollbar.prototype.resizeContentVertical=function(t){this.pair_||this.setVisible(this.scrollViewSize_<t.contentHeight),this.ratio=this.scrollViewSize_/t.contentHeight,(-1/0==this.ratio||1/0==this.ratio||isNaN(this.ratio))&&(this.ratio=0),this.setHandleLength_(Math.max(0,t.viewHeight*this.ratio)),this.setHandlePosition(this.constrainHandle_((t.viewTop-t.contentTop)*this.ratio))},E.Scrollbar.prototype.createDom_=function(t){var e="blocklyScrollbar"+(this.horizontal_?"Horizontal":"Vertical");t&&(e+=" "+t),this.outerSvg_=E.utils.dom.createSvgElement(E.utils.Svg.SVG,{class:e},null),this.svgGroup_=E.utils.dom.createSvgElement(E.utils.Svg.G,{},this.outerSvg_),this.svgBackground_=E.utils.dom.createSvgElement(E.utils.Svg.RECT,{class:"blocklyScrollbarBackground"},this.svgGroup_),t=Math.floor((E.Scrollbar.scrollbarThickness-5)/2),this.svgHandle_=E.utils.dom.createSvgElement(E.utils.Svg.RECT,{class:"blocklyScrollbarHandle",rx:t,ry:t},this.svgGroup_),this.workspace_.getThemeManager().subscribe(this.svgHandle_,"scrollbarColour","fill"),this.workspace_.getThemeManager().subscribe(this.svgHandle_,"scrollbarOpacity","fill-opacity"),E.utils.dom.insertAfter(this.outerSvg_,this.workspace_.getParentSvg())},E.Scrollbar.prototype.isVisible=function(){return this.isVisible_},E.Scrollbar.prototype.setContainerVisible=function(t){var e=t!=this.containerVisible_;this.containerVisible_=t,e&&this.updateDisplay_()},E.Scrollbar.prototype.setVisible=function(t){var e=t!=this.isVisible();if(this.pair_)throw Error("Unable to toggle visibility of paired scrollbars.");this.isVisible_=t,e&&this.updateDisplay_()},E.Scrollbar.prototype.updateDisplay_=function(){this.containerVisible_&&this.isVisible()?this.outerSvg_.setAttribute("display","block"):this.outerSvg_.setAttribute("display","none")},E.Scrollbar.prototype.onMouseDownBar_=function(t){if(this.workspace_.markFocused(),E.Touch.clearTouchIdentifier(),this.cleanUp_(),E.utils.isRightButton(t))t.stopPropagation();else{var e=E.utils.mouseToSvg(t,this.workspace_.getParentSvg(),this.workspace_.getInverseScreenCTM());e=this.horizontal_?e.x:e.y;var o=E.utils.getInjectionDivXY_(this.svgHandle_);o=this.horizontal_?o.x:o.y;var n=this.handlePosition_,i=.95*this.handleLength_;e<=o?n-=i:e>=o+this.handleLength_&&(n+=i),this.setHandlePosition(this.constrainHandle_(n)),this.onScroll_(),t.stopPropagation(),t.preventDefault()}},E.Scrollbar.prototype.onMouseDownHandle_=function(t){this.workspace_.markFocused(),this.cleanUp_(),E.utils.isRightButton(t)?t.stopPropagation():(this.startDragHandle=this.handlePosition_,this.workspace_.setupDragSurface(),this.startDragMouse_=this.horizontal_?t.clientX:t.clientY,E.Scrollbar.onMouseUpWrapper_=E.bindEventWithChecks_(document,"mouseup",this,this.onMouseUpHandle_),E.Scrollbar.onMouseMoveWrapper_=E.bindEventWithChecks_(document,"mousemove",this,this.onMouseMoveHandle_),t.stopPropagation(),t.preventDefault())},E.Scrollbar.prototype.onMouseMoveHandle_=function(t){this.setHandlePosition(this.constrainHandle_(this.startDragHandle+((this.horizontal_?t.clientX:t.clientY)-this.startDragMouse_))),this.onScroll_()},E.Scrollbar.prototype.onMouseUpHandle_=function(){this.workspace_.resetDragSurface(),E.Touch.clearTouchIdentifier(),this.cleanUp_()},E.Scrollbar.prototype.cleanUp_=function(){E.hideChaff(!0),E.Scrollbar.onMouseUpWrapper_&&(E.unbindEvent_(E.Scrollbar.onMouseUpWrapper_),E.Scrollbar.onMouseUpWrapper_=null),E.Scrollbar.onMouseMoveWrapper_&&(E.unbindEvent_(E.Scrollbar.onMouseMoveWrapper_),E.Scrollbar.onMouseMoveWrapper_=null)},E.Scrollbar.prototype.constrainHandle_=function(t){return t<=0||isNaN(t)||this.scrollViewSize_<this.handleLength_?0:Math.min(t,this.scrollViewSize_-this.handleLength_)},E.Scrollbar.prototype.onScroll_=function(){var t=this.handlePosition_/this.scrollViewSize_;isNaN(t)&&(t=0);var e={};this.horizontal_?e.x=t:e.y=t,this.workspace_.setMetrics(e)},E.Scrollbar.prototype.set=function(t){this.setHandlePosition(this.constrainHandle_(t*this.ratio)),this.onScroll_()},E.Scrollbar.prototype.setOrigin=function(t,e){this.origin_=new E.utils.Coordinate(t,e)},E.Tooltip={},E.Tooltip.visible=!1,E.Tooltip.blocked_=!1,E.Tooltip.LIMIT=50,E.Tooltip.mouseOutPid_=0,E.Tooltip.showPid_=0,E.Tooltip.lastX_=0,E.Tooltip.lastY_=0,E.Tooltip.element_=null,E.Tooltip.poisonedElement_=null,E.Tooltip.OFFSET_X=0,E.Tooltip.OFFSET_Y=10,E.Tooltip.RADIUS_OK=10,E.Tooltip.HOVER_MS=750,E.Tooltip.MARGINS=5,E.Tooltip.DIV=null,E.Tooltip.getTooltipOfObject=function(t){if(t=E.Tooltip.getTargetObject_(t)){for(t=t.tooltip;"function"==typeof t;)t=t();if("string"!=typeof t)throw Error("Tooltip function must return a string.");return t}return""},E.Tooltip.getTargetObject_=function(t){for(;t&&t.tooltip;){if("string"==typeof t.tooltip||"function"==typeof t.tooltip)return t;t=t.tooltip}return null},E.Tooltip.createDom=function(){E.Tooltip.DIV||(E.Tooltip.DIV=document.createElement("div"),E.Tooltip.DIV.className="blocklyTooltipDiv",(E.parentContainer||document.body).appendChild(E.Tooltip.DIV))},E.Tooltip.bindMouseEvents=function(t){t.mouseOverWrapper_=E.bindEvent_(t,"mouseover",null,E.Tooltip.onMouseOver_),t.mouseOutWrapper_=E.bindEvent_(t,"mouseout",null,E.Tooltip.onMouseOut_),t.addEventListener("mousemove",E.Tooltip.onMouseMove_,!1)},E.Tooltip.unbindMouseEvents=function(t){t&&(E.unbindEvent_(t.mouseOverWrapper_),E.unbindEvent_(t.mouseOutWrapper_),t.removeEventListener("mousemove",E.Tooltip.onMouseMove_))},E.Tooltip.onMouseOver_=function(t){E.Tooltip.blocked_||(t=E.Tooltip.getTargetObject_(t.currentTarget),E.Tooltip.element_!=t&&(E.Tooltip.hide(),E.Tooltip.poisonedElement_=null,E.Tooltip.element_=t),clearTimeout(E.Tooltip.mouseOutPid_))},E.Tooltip.onMouseOut_=function(t){E.Tooltip.blocked_||(E.Tooltip.mouseOutPid_=setTimeout(function(){E.Tooltip.element_=null,E.Tooltip.poisonedElement_=null,E.Tooltip.hide()},1),clearTimeout(E.Tooltip.showPid_))},E.Tooltip.onMouseMove_=function(t){if(E.Tooltip.element_&&E.Tooltip.element_.tooltip&&!E.Tooltip.blocked_)if(E.Tooltip.visible){var e=E.Tooltip.lastX_-t.pageX;t=E.Tooltip.lastY_-t.pageY,Math.sqrt(e*e+t*t)>E.Tooltip.RADIUS_OK&&E.Tooltip.hide()}else E.Tooltip.poisonedElement_!=E.Tooltip.element_&&(clearTimeout(E.Tooltip.showPid_),E.Tooltip.lastX_=t.pageX,E.Tooltip.lastY_=t.pageY,E.Tooltip.showPid_=setTimeout(E.Tooltip.show_,E.Tooltip.HOVER_MS))},E.Tooltip.dispose=function(){E.Tooltip.element_=null,E.Tooltip.poisonedElement_=null,E.Tooltip.hide()},E.Tooltip.hide=function(){E.Tooltip.visible&&(E.Tooltip.visible=!1,E.Tooltip.DIV&&(E.Tooltip.DIV.style.display="none")),E.Tooltip.showPid_&&clearTimeout(E.Tooltip.showPid_)},E.Tooltip.block=function(){E.Tooltip.hide(),E.Tooltip.blocked_=!0},E.Tooltip.unblock=function(){E.Tooltip.blocked_=!1},E.Tooltip.show_=function(){if(!E.Tooltip.blocked_&&(E.Tooltip.poisonedElement_=E.Tooltip.element_,E.Tooltip.DIV)){E.Tooltip.DIV.textContent="";var t=E.Tooltip.getTooltipOfObject(E.Tooltip.element_);t=(t=E.utils.string.wrap(t,E.Tooltip.LIMIT)).split("\n");for(var e=0;e<t.length;e++){var o=document.createElement("div");o.appendChild(document.createTextNode(t[e])),E.Tooltip.DIV.appendChild(o)}t=E.Tooltip.element_.RTL,e=document.documentElement.clientWidth,o=document.documentElement.clientHeight,E.Tooltip.DIV.style.direction=t?"rtl":"ltr",E.Tooltip.DIV.style.display="block",E.Tooltip.visible=!0;var n=E.Tooltip.lastX_;n=t?n-(E.Tooltip.OFFSET_X+E.Tooltip.DIV.offsetWidth):n+E.Tooltip.OFFSET_X;var i=E.Tooltip.lastY_+E.Tooltip.OFFSET_Y;i+E.Tooltip.DIV.offsetHeight>o+window.scrollY&&(i-=E.Tooltip.DIV.offsetHeight+2*E.Tooltip.OFFSET_Y),t?n=Math.max(E.Tooltip.MARGINS-window.scrollX,n):n+E.Tooltip.DIV.offsetWidth>e+window.scrollX-2*E.Tooltip.MARGINS&&(n=e-E.Tooltip.DIV.offsetWidth-2*E.Tooltip.MARGINS),E.Tooltip.DIV.style.top=i+"px",E.Tooltip.DIV.style.left=n+"px"}},E.WorkspaceDragSurfaceSvg=function(t){this.container_=t,this.createDom()},E.WorkspaceDragSurfaceSvg.prototype.SVG_=null,E.WorkspaceDragSurfaceSvg.prototype.container_=null,E.WorkspaceDragSurfaceSvg.prototype.createDom=function(){this.SVG_||(this.SVG_=E.utils.dom.createSvgElement(E.utils.Svg.SVG,{xmlns:E.utils.dom.SVG_NS,"xmlns:html":E.utils.dom.HTML_NS,"xmlns:xlink":E.utils.dom.XLINK_NS,version:"1.1",class:"blocklyWsDragSurface blocklyOverflowVisible"},null),this.container_.appendChild(this.SVG_))},E.WorkspaceDragSurfaceSvg.prototype.translateSurface=function(t,e){t=t.toFixed(0),e=e.toFixed(0),this.SVG_.style.display="block",E.utils.dom.setCssTransform(this.SVG_,"translate3d("+t+"px, "+e+"px, 0px)")},E.WorkspaceDragSurfaceSvg.prototype.getSurfaceTranslation=function(){return E.utils.getRelativeXY(this.SVG_)},E.WorkspaceDragSurfaceSvg.prototype.clearAndHide=function(t){if(!t)throw Error("Couldn't clear and hide the drag surface: missing new surface.");var e=this.SVG_.childNodes[0],o=this.SVG_.childNodes[1];if(!(e&&o&&E.utils.dom.hasClass(e,"blocklyBlockCanvas")&&E.utils.dom.hasClass(o,"blocklyBubbleCanvas")))throw Error("Couldn't clear and hide the drag surface. A node was missing.");if(null!=this.previousSibling_?E.utils.dom.insertAfter(e,this.previousSibling_):t.insertBefore(e,t.firstChild),E.utils.dom.insertAfter(o,e),this.SVG_.style.display="none",this.SVG_.childNodes.length)throw Error("Drag surface was not cleared.");E.utils.dom.setCssTransform(this.SVG_,""),this.previousSibling_=null},E.WorkspaceDragSurfaceSvg.prototype.setContentsAndShow=function(t,e,o,n,i,r){if(this.SVG_.childNodes.length)throw Error("Already dragging a block.");this.previousSibling_=o,t.setAttribute("transform","translate(0, 0) scale("+r+")"),e.setAttribute("transform","translate(0, 0) scale("+r+")"),this.SVG_.setAttribute("width",n),this.SVG_.setAttribute("height",i),this.SVG_.appendChild(t),this.SVG_.appendChild(e),this.SVG_.style.display="block"},E.ASTNode=function(t,e,o){if(!e)throw Error("Cannot create a node without a location.");this.type_=t,this.isConnection_=E.ASTNode.isConnectionType_(t),this.location_=e,this.wsCoordinate_=null,this.processParams_(o||null)},E.ASTNode.types={FIELD:"field",BLOCK:"block",INPUT:"input",OUTPUT:"output",NEXT:"next",PREVIOUS:"previous",STACK:"stack",WORKSPACE:"workspace"},E.ASTNode.NAVIGATE_ALL_FIELDS=!1,E.ASTNode.DEFAULT_OFFSET_Y=-20,E.ASTNode.isConnectionType_=function(t){switch(t){case E.ASTNode.types.PREVIOUS:case E.ASTNode.types.NEXT:case E.ASTNode.types.INPUT:case E.ASTNode.types.OUTPUT:return!0}return!1},E.ASTNode.createFieldNode=function(t){return t?new E.ASTNode(E.ASTNode.types.FIELD,t):null},E.ASTNode.createConnectionNode=function(t){return t?t.type==E.INPUT_VALUE||t.type==E.NEXT_STATEMENT&&t.getParentInput()?E.ASTNode.createInputNode(t.getParentInput()):t.type==E.NEXT_STATEMENT?new E.ASTNode(E.ASTNode.types.NEXT,t):t.type==E.OUTPUT_VALUE?new E.ASTNode(E.ASTNode.types.OUTPUT,t):t.type==E.PREVIOUS_STATEMENT?new E.ASTNode(E.ASTNode.types.PREVIOUS,t):null:null},E.ASTNode.createInputNode=function(t){return t&&t.connection?new E.ASTNode(E.ASTNode.types.INPUT,t.connection):null},E.ASTNode.createBlockNode=function(t){return t?new E.ASTNode(E.ASTNode.types.BLOCK,t):null},E.ASTNode.createStackNode=function(t){return t?new E.ASTNode(E.ASTNode.types.STACK,t):null},E.ASTNode.createWorkspaceNode=function(t,e){return e&&t?new E.ASTNode(E.ASTNode.types.WORKSPACE,t,{wsCoordinate:e}):null},E.ASTNode.createTopNode=function(t){var e=t.previousConnection||t.outputConnection;return e?E.ASTNode.createConnectionNode(e):E.ASTNode.createBlockNode(t)},E.ASTNode.prototype.processParams_=function(t){t&&t.wsCoordinate&&(this.wsCoordinate_=t.wsCoordinate)},E.ASTNode.prototype.getLocation=function(){return this.location_},E.ASTNode.prototype.getType=function(){return this.type_},E.ASTNode.prototype.getWsCoordinate=function(){return this.wsCoordinate_},E.ASTNode.prototype.isConnection=function(){return this.isConnection_},E.ASTNode.prototype.findNextForInput_=function(){var t,e=this.location_.getParentInput(),o=e.getSourceBlock();for(e=o.inputList.indexOf(e)+1;t=o.inputList[e];e++){for(var n,i=t.fieldRow,r=0;n=i[r];r++)if(n.isClickable()||E.ASTNode.NAVIGATE_ALL_FIELDS)return E.ASTNode.createFieldNode(n);if(t.connection)return E.ASTNode.createInputNode(t)}return null},E.ASTNode.prototype.findNextForField_=function(){var t=this.location_,e=t.getParentInput(),o=t.getSourceBlock(),n=o.inputList.indexOf(e);for(t=e.fieldRow.indexOf(t)+1;e=o.inputList[n];n++){for(var i=e.fieldRow;t<i.length;){if(i[t].isClickable()||E.ASTNode.NAVIGATE_ALL_FIELDS)return E.ASTNode.createFieldNode(i[t]);t++}if(t=0,e.connection)return E.ASTNode.createInputNode(e)}return null},E.ASTNode.prototype.findPrevForInput_=function(){for(var t,e=this.location_.getParentInput(),o=e.getSourceBlock(),n=o.inputList.indexOf(e);t=o.inputList[n];n--){if(t.connection&&t!==e)return E.ASTNode.createInputNode(t);for(var i,r=(t=t.fieldRow).length-1;i=t[r];r--)if(i.isClickable()||E.ASTNode.NAVIGATE_ALL_FIELDS)return E.ASTNode.createFieldNode(i)}return null},E.ASTNode.prototype.findPrevForField_=function(){var t,e=this.location_,o=e.getParentInput(),n=e.getSourceBlock(),i=n.inputList.indexOf(o);for(e=o.fieldRow.indexOf(e)-1;t=n.inputList[i];i--){if(t.connection&&t!==o)return E.ASTNode.createInputNode(t);for(t=t.fieldRow;-1<e;){if(t[e].isClickable()||E.ASTNode.NAVIGATE_ALL_FIELDS)return E.ASTNode.createFieldNode(t[e]);e--}0<=i-1&&(e=n.inputList[i-1].fieldRow.length-1)}return null},E.ASTNode.prototype.navigateBetweenStacks_=function(t){var e=this.getLocation();if(e instanceof E.Block||(e=e.getSourceBlock()),!e||!e.workspace)return null;var o=e.getRootBlock();e=o.workspace.getTopBlocks(!0);for(var n,i=0;n=e[i];i++)if(o.id==n.id)return-1==(t=i+(t?1:-1))||t==e.length?null:E.ASTNode.createStackNode(e[t]);throw Error("Couldn't find "+(t?"next":"previous")+" stack?!")},E.ASTNode.prototype.findTopASTNodeForBlock_=function(t){var e=t.previousConnection||t.outputConnection;return e?E.ASTNode.createConnectionNode(e):E.ASTNode.createBlockNode(t)},E.ASTNode.prototype.getOutAstNodeForBlock_=function(t){if(!t)return null;var e=(t=t.getTopStackBlock()).previousConnection||t.outputConnection;return e&&e.targetConnection&&e.targetConnection.getParentInput()?E.ASTNode.createInputNode(e.targetConnection.getParentInput()):E.ASTNode.createStackNode(t)},E.ASTNode.prototype.findFirstFieldOrInput_=function(t){t=t.inputList;for(var e,o=0;e=t[o];o++){for(var n,i=e.fieldRow,r=0;n=i[r];r++)if(n.isClickable()||E.ASTNode.NAVIGATE_ALL_FIELDS)return E.ASTNode.createFieldNode(n);if(e.connection)return E.ASTNode.createInputNode(e)}return null},E.ASTNode.prototype.getSourceBlock=function(){return this.getType()===E.ASTNode.types.BLOCK?this.getLocation():this.getType()===E.ASTNode.types.STACK?this.getLocation():this.getType()===E.ASTNode.types.WORKSPACE?null:this.getLocation().getSourceBlock()},E.ASTNode.prototype.next=function(){switch(this.type_){case E.ASTNode.types.STACK:return this.navigateBetweenStacks_(!0);case E.ASTNode.types.OUTPUT:var t=this.location_;return E.ASTNode.createBlockNode(t.getSourceBlock());case E.ASTNode.types.FIELD:return this.findNextForField_();case E.ASTNode.types.INPUT:return this.findNextForInput_();case E.ASTNode.types.BLOCK:return E.ASTNode.createConnectionNode(this.location_.nextConnection);case E.ASTNode.types.PREVIOUS:return t=this.location_,E.ASTNode.createBlockNode(t.getSourceBlock());case E.ASTNode.types.NEXT:return t=this.location_,E.ASTNode.createConnectionNode(t.targetConnection)}return null},E.ASTNode.prototype.in=function(){switch(this.type_){case E.ASTNode.types.WORKSPACE:var t=this.location_.getTopBlocks(!0);if(0<t.length)return E.ASTNode.createStackNode(t[0]);break;case E.ASTNode.types.STACK:return t=this.location_,this.findTopASTNodeForBlock_(t);case E.ASTNode.types.BLOCK:return t=this.location_,this.findFirstFieldOrInput_(t);case E.ASTNode.types.INPUT:return E.ASTNode.createConnectionNode(this.location_.targetConnection)}return null},E.ASTNode.prototype.prev=function(){switch(this.type_){case E.ASTNode.types.STACK:return this.navigateBetweenStacks_(!1);case E.ASTNode.types.FIELD:return this.findPrevForField_();case E.ASTNode.types.INPUT:return this.findPrevForInput_();case E.ASTNode.types.BLOCK:var t=this.location_;return E.ASTNode.createConnectionNode(t.previousConnection||t.outputConnection);case E.ASTNode.types.PREVIOUS:if((t=(t=this.location_).targetConnection)&&!t.getParentInput())return E.ASTNode.createConnectionNode(t);break;case E.ASTNode.types.NEXT:return t=this.location_,E.ASTNode.createBlockNode(t.getSourceBlock())}return null},E.ASTNode.prototype.out=function(){switch(this.type_){case E.ASTNode.types.STACK:var t=this.location_,e=t.getRelativeToSurfaceXY();return e=new E.utils.Coordinate(e.x,e.y+E.ASTNode.DEFAULT_OFFSET_Y),E.ASTNode.createWorkspaceNode(t.workspace,e);case E.ASTNode.types.OUTPUT:return(e=(t=this.location_).targetConnection)?E.ASTNode.createConnectionNode(e):E.ASTNode.createStackNode(t.getSourceBlock());case E.ASTNode.types.FIELD:return E.ASTNode.createBlockNode(this.location_.getSourceBlock());case E.ASTNode.types.INPUT:return t=this.location_,E.ASTNode.createBlockNode(t.getSourceBlock());case E.ASTNode.types.BLOCK:return t=this.location_,this.getOutAstNodeForBlock_(t);case E.ASTNode.types.PREVIOUS:case E.ASTNode.types.NEXT:return t=this.location_,this.getOutAstNodeForBlock_(t.getSourceBlock())}return null},E.Blocks=Object.create(null),E.utils.deprecation={},E.utils.deprecation.warn=function(t,e,o,n){t=t+" was deprecated on "+e+" and will be deleted on "+o+".",n&&(t+="\nUse "+n+" instead."),console.warn(t)},E.Connection=function(t,e){this.sourceBlock_=t,this.type=e},E.Connection.CAN_CONNECT=0,E.Connection.REASON_SELF_CONNECTION=1,E.Connection.REASON_WRONG_TYPE=2,E.Connection.REASON_TARGET_NULL=3,E.Connection.REASON_CHECKS_FAILED=4,E.Connection.REASON_DIFFERENT_WORKSPACES=5,E.Connection.REASON_SHADOW_PARENT=6,E.Connection.REASON_DRAG_CHECKS_FAILED=7,E.Connection.prototype.targetConnection=null,E.Connection.prototype.disposed=!1,E.Connection.prototype.check_=null,E.Connection.prototype.shadowDom_=null,E.Connection.prototype.x=0,E.Connection.prototype.y=0,E.Connection.prototype.connect_=function(t){var e,o=this,n=o.getSourceBlock(),i=t.getSourceBlock();if(t.isConnected()&&t.disconnect(),o.isConnected()){var r=o.targetBlock(),s=o.getShadowDom();if(o.shadowDom_=null,r.isShadow())s=E.Xml.blockToDom(r),r.dispose(!1),r=null;else if(o.type==E.INPUT_VALUE){if(!r.outputConnection)throw Error("Orphan block does not have an output connection.");var a=E.Connection.lastConnectionInRow(i,r);a&&(r.outputConnection.connect(a),r=null)}else if(o.type==E.NEXT_STATEMENT){if(!r.previousConnection)throw Error("Orphan block does not have a previous connection.");for(a=i;a.nextConnection;){var l=a.getNextBlock();if(!l||l.isShadow()){r.workspace.connectionChecker.canConnect(r.previousConnection,a.nextConnection,!1)&&(a.nextConnection.connect(r.previousConnection),r=null);break}a=l}}if(r&&(o.disconnect(),E.Events.recordUndo)){var c=E.Events.getGroup();setTimeout(function(){r.workspace&&!r.getParent()&&(E.Events.setGroup(c),r.outputConnection?r.outputConnection.onFailedConnect(o):r.previousConnection&&r.previousConnection.onFailedConnect(o),E.Events.setGroup(!1))},E.BUMP_DELAY)}o.shadowDom_=s}E.Events.isEnabled()&&(e=new E.Events.BlockMove(i)),E.Connection.connectReciprocally_(o,t),i.setParent(n),e&&(e.recordNew(),E.Events.fire(e))},E.Connection.prototype.dispose=function(){if(this.isConnected()){this.setShadowDom(null);var t=this.targetBlock();t&&t.unplug()}this.disposed=!0},E.Connection.prototype.getSourceBlock=function(){return this.sourceBlock_},E.Connection.prototype.isSuperior=function(){return this.type==E.INPUT_VALUE||this.type==E.NEXT_STATEMENT},E.Connection.prototype.isConnected=function(){return!!this.targetConnection},E.Connection.prototype.canConnectWithReason=function(t){return E.utils.deprecation.warn("Connection.prototype.canConnectWithReason","July 2020","July 2021","the workspace's connection checker"),this.getConnectionChecker().canConnectWithReason(this,t,!1)},E.Connection.prototype.checkConnection=function(t){E.utils.deprecation.warn("Connection.prototype.checkConnection","July 2020","July 2021","the workspace's connection checker");var e=this.getConnectionChecker(),o=e.canConnectWithReason(this,t,!1);if(o!=E.Connection.CAN_CONNECT)throw Error(e.getErrorMessage(o,this,t))},E.Connection.prototype.getConnectionChecker=function(){return this.sourceBlock_.workspace.connectionChecker},E.Connection.prototype.isConnectionAllowed=function(t){return E.utils.deprecation.warn("Connection.prototype.isConnectionAllowed","July 2020","July 2021","the workspace's connection checker"),this.getConnectionChecker().canConnect(this,t,!0)},E.Connection.prototype.onFailedConnect=function(t){},E.Connection.prototype.connect=function(t){if(this.targetConnection!=t&&this.getConnectionChecker().canConnect(this,t,!1)){var e=E.Events.getGroup();e||E.Events.setGroup(!0),this.isSuperior()?this.connect_(t):t.connect_(this),e||E.Events.setGroup(!1)}},E.Connection.connectReciprocally_=function(t,e){if(!t||!e)throw Error("Cannot connect null connections.");(t.targetConnection=e).targetConnection=t},E.Connection.singleConnection_=function(t,e){var o=null;e=e.outputConnection;for(var n=0;n<t.inputList.length;n++){var i=t.inputList[n].connection,r=e.getConnectionChecker();if(i&&i.type==E.INPUT_VALUE&&r.canConnect(e,i,!1)){if(o)return null;o=i}}return o},E.Connection.lastConnectionInRow=function(t,e){for(var o;o=E.Connection.singleConnection_(t,e);)if(!(t=o.targetBlock())||t.isShadow())return o;return null},E.Connection.prototype.disconnect=function(){var t=this.targetConnection;if(!t)throw Error("Source connection not connected.");if(t.targetConnection!=this)throw Error("Target connection not connected to source connection.");if(this.isSuperior()){var e=this.sourceBlock_,o=t.getSourceBlock();t=this}else e=t.getSourceBlock(),o=this.sourceBlock_;var n=E.Events.getGroup();n||E.Events.setGroup(!0),this.disconnectInternal_(e,o),o.isShadow()||t.respawnShadow_(),n||E.Events.setGroup(!1)},E.Connection.prototype.disconnectInternal_=function(t,e){var o;E.Events.isEnabled()&&(o=new E.Events.BlockMove(e)),this.targetConnection=this.targetConnection.targetConnection=null,e.setParent(null),o&&(o.recordNew(),E.Events.fire(o))},E.Connection.prototype.respawnShadow_=function(){var t=this.getSourceBlock(),e=this.getShadowDom();if(t.workspace&&e)if((t=E.Xml.domToBlock(e,t.workspace)).outputConnection)this.connect(t.outputConnection);else{if(!t.previousConnection)throw Error("Child block does not have output or previous statement.");this.connect(t.previousConnection)}},E.Connection.prototype.targetBlock=function(){return this.isConnected()?this.targetConnection.getSourceBlock():null},E.Connection.prototype.checkType=function(t){return E.utils.deprecation.warn("Connection.prototype.checkType","October 2019","January 2021","the workspace's connection checker"),this.getConnectionChecker().canConnect(this,t,!1)},E.Connection.prototype.checkType_=function(t){return E.utils.deprecation.warn("Connection.prototype.checkType_","October 2019","January 2021","the workspace's connection checker"),this.checkType(t)},E.Connection.prototype.onCheckChanged_=function(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()},E.Connection.prototype.setCheck=function(t){return t?(Array.isArray(t)||(t=[t]),this.check_=t,this.onCheckChanged_()):this.check_=null,this},E.Connection.prototype.getCheck=function(){return this.check_},E.Connection.prototype.setShadowDom=function(t){this.shadowDom_=t,(t=this.targetBlock())?t.isShadow()&&(t.dispose(!1),this.respawnShadow_()):this.respawnShadow_()},E.Connection.prototype.getShadowDom=function(){return this.shadowDom_},E.Connection.prototype.neighbours=function(t){return[]},E.Connection.prototype.getParentInput=function(){for(var t=null,e=this.sourceBlock_,o=e.inputList,n=0;n<e.inputList.length;n++)if(o[n].connection===this){t=o[n];break}return t},E.Connection.prototype.toString=function(){var t=this.sourceBlock_;if(!t)return"Orphan Connection";if(t.outputConnection==this)var e="Output Connection of ";else if(t.previousConnection==this)e="Previous Connection of ";else if(t.nextConnection==this)e="Next Connection of ";else{e=null;for(var o,n=0;o=t.inputList[n];n++)if(o.connection==this){e=o;break}if(!e)return console.warn("Connection not actually connected to sourceBlock_"),"Orphan Connection";e='Input "'+e.name+'" connection on '}return e+t.toDevString()},E.Extensions={},E.Extensions.ALL_={},E.Extensions.register=function(t,e){if("string"!=typeof t||""==t.trim())throw Error('Error: Invalid extension name "'+t+'"');if(E.Extensions.ALL_[t])throw Error('Error: Extension "'+t+'" is already registered.');if("function"!=typeof e)throw Error('Error: Extension "'+t+'" must be a function');E.Extensions.ALL_[t]=e},E.Extensions.registerMixin=function(t,e){if(!e||"object"!=typeof e)throw Error('Error: Mixin "'+t+'" must be a object');E.Extensions.register(t,function(){this.mixin(e)})},E.Extensions.registerMutator=function(t,e,o,n){var i='Error when registering mutator "'+t+'": ';E.Extensions.checkHasFunction_(i,e.domToMutation,"domToMutation"),E.Extensions.checkHasFunction_(i,e.mutationToDom,"mutationToDom");var r=E.Extensions.checkMutatorDialog_(e,i);if(o&&"function"!=typeof o)throw Error('Extension "'+t+'" is not a function');E.Extensions.register(t,function(){if(r){if(!E.Mutator)throw Error(i+"Missing require for Blockly.Mutator");this.setMutator(new E.Mutator(n||[]))}this.mixin(e),o&&o.apply(this)})},E.Extensions.unregister=function(t){E.Extensions.ALL_[t]?delete E.Extensions.ALL_[t]:console.warn('No extension mapping for name "'+t+'" found to unregister')},E.Extensions.apply=function(t,e,o){var n=E.Extensions.ALL_[t];if("function"!=typeof n)throw Error('Error: Extension "'+t+'" not found.');if(o)E.Extensions.checkNoMutatorProperties_(t,e);else var i=E.Extensions.getMutatorProperties_(e);if(n.apply(e),o)E.Extensions.checkBlockHasMutatorProperties_('Error after applying mutator "'+t+'": ',e);else if(!E.Extensions.mutatorPropertiesMatch_(i,e))throw Error('Error when applying extension "'+t+'": mutation properties changed when applying a non-mutator extension.')},E.Extensions.checkHasFunction_=function(t,e,o){if(!e)throw Error(t+'missing required property "'+o+'"');if("function"!=typeof e)throw Error(t+'" required property "'+o+'" must be a function')},E.Extensions.checkNoMutatorProperties_=function(t,e){if(E.Extensions.getMutatorProperties_(e).length)throw Error('Error: tried to apply mutation "'+t+'" to a block that already has mutator functions.  Block id: '+e.id)},E.Extensions.checkMutatorDialog_=function(t,e){var o=void 0!==t.compose,n=void 0!==t.decompose;if(o&&n){if("function"!=typeof t.compose)throw Error(e+"compose must be a function.");if("function"!=typeof t.decompose)throw Error(e+"decompose must be a function.");return!0}if(o||n)throw Error(e+'Must have both or neither of "compose" and "decompose"');return!1},E.Extensions.checkBlockHasMutatorProperties_=function(t,e){if("function"!=typeof e.domToMutation)throw Error(t+'Applying a mutator didn\'t add "domToMutation"');if("function"!=typeof e.mutationToDom)throw Error(t+'Applying a mutator didn\'t add "mutationToDom"');E.Extensions.checkMutatorDialog_(e,t)},E.Extensions.getMutatorProperties_=function(t){var e=[];return void 0!==t.domToMutation&&e.push(t.domToMutation),void 0!==t.mutationToDom&&e.push(t.mutationToDom),void 0!==t.compose&&e.push(t.compose),void 0!==t.decompose&&e.push(t.decompose),e},E.Extensions.mutatorPropertiesMatch_=function(t,e){if((e=E.Extensions.getMutatorProperties_(e)).length!=t.length)return!1;for(var o=0;o<e.length;o++)if(t[o]!=e[o])return!1;return!0},E.Extensions.buildTooltipForDropdown=function(o,n){var i=[];return"object"==typeof document&&E.utils.runAfterPageLoad(function(){for(var t in n)E.utils.checkMessageReferences(n[t])}),function(){this.type&&-1==i.indexOf(this.type)&&(E.Extensions.checkDropdownOptionsInTable_(this,o,n),i.push(this.type)),this.setTooltip(function(){var t=String(this.getFieldValue(o)),e=n[t];return null==e?-1==i.indexOf(this.type)&&(t="No tooltip mapping for value "+t+" of field "+o,null!=this.type&&(t+=" of block type "+this.type),console.warn(t+".")):e=E.utils.replaceMessageReferences(e),e}.bind(this))}},E.Extensions.checkDropdownOptionsInTable_=function(t,e,o){var n=t.getField(e);if(!n.isOptionListDynamic()){n=n.getOptions();for(var i=0;i<n.length;++i){var r=n[i][1];null==o[r]&&console.warn("No tooltip mapping for value "+r+" of field "+e+" of block type "+t.type)}}},E.Extensions.buildTooltipWithFieldText=function(e,o){return"object"==typeof document&&E.utils.runAfterPageLoad(function(){E.utils.checkMessageReferences(e)}),function(){this.setTooltip(function(){var t=this.getField(o);return E.utils.replaceMessageReferences(e).replace("%1",t?t.getText():"")}.bind(this))}},E.Extensions.extensionParentTooltip_=function(){this.tooltipWhenNotConnected_=this.tooltip,this.setTooltip(function(){var t=this.getParent();return t&&t.getInputsInline()&&t.tooltip||this.tooltipWhenNotConnected_}.bind(this))},E.Extensions.register("parent_tooltip_when_inline",E.Extensions.extensionParentTooltip_),E.fieldRegistry={},E.fieldRegistry.register=function(t,e){E.registry.register(E.registry.Type.FIELD,t,e)},E.fieldRegistry.unregister=function(t){E.registry.unregister(E.registry.Type.FIELD,t)},E.fieldRegistry.fromJson=function(t){var e=E.registry.getObject(E.registry.Type.FIELD,t.type);return e?e.fromJson(t):(console.warn("Blockly could not create a field of type "+t.type+". The field is probably not being registered. This could be because the file is not loaded, the field does not register itself (Issue #1584), or the registration is not being reached."),null)},E.blockAnimations={},E.blockAnimations.disconnectPid_=0,E.blockAnimations.disconnectGroup_=null,E.blockAnimations.disposeUiEffect=function(t){var e=t.workspace,o=t.getSvgRoot();e.getAudioManager().play("delete"),t=e.getSvgXY(o),(o=o.cloneNode(!0)).translateX_=t.x,o.translateY_=t.y,o.setAttribute("transform","translate("+t.x+","+t.y+")"),e.getParentSvg().appendChild(o),o.bBox_=o.getBBox(),E.blockAnimations.disposeUiStep_(o,e.RTL,new Date,e.scale)},E.blockAnimations.disposeUiStep_=function(t,e,o,n){var i=(new Date-o)/150;1<i?E.utils.dom.removeNode(t):(t.setAttribute("transform","translate("+(t.translateX_+(e?-1:1)*t.bBox_.width*n/2*i)+","+(t.translateY_+t.bBox_.height*n*i)+") scale("+(1-i)*n+")"),setTimeout(E.blockAnimations.disposeUiStep_,10,t,e,o,n))},E.blockAnimations.connectionUiEffect=function(t){var e=t.workspace,o=e.scale;if(e.getAudioManager().play("click"),!(o<1)){var n=e.getSvgXY(t.getSvgRoot());t.outputConnection?(n.x+=(t.RTL?3:-3)*o,n.y+=13*o):t.previousConnection&&(n.x+=(t.RTL?-23:23)*o,n.y+=3*o),t=E.utils.dom.createSvgElement(E.utils.Svg.CIRCLE,{cx:n.x,cy:n.y,r:0,fill:"none",stroke:"#888","stroke-width":10},e.getParentSvg()),E.blockAnimations.connectionUiStep_(t,new Date,o)}},E.blockAnimations.connectionUiStep_=function(t,e,o){var n=(new Date-e)/150;1<n?E.utils.dom.removeNode(t):(t.setAttribute("r",25*n*o),t.style.opacity=1-n,E.blockAnimations.disconnectPid_=setTimeout(E.blockAnimations.connectionUiStep_,10,t,e,o))},E.blockAnimations.disconnectUiEffect=function(t){if(t.workspace.getAudioManager().play("disconnect"),!(t.workspace.scale<1)){var e=t.getHeightWidth().height;e=Math.atan(10/e)/Math.PI*180,t.RTL||(e*=-1),E.blockAnimations.disconnectUiStep_(t.getSvgRoot(),e,new Date)}},E.blockAnimations.disconnectUiStep_=function(t,e,o){var n=(new Date-o)/200;1<n?t.skew_="":(t.skew_="skewX("+Math.round(Math.sin(n*Math.PI*3)*(1-n)*e)+")",E.blockAnimations.disconnectGroup_=t,E.blockAnimations.disconnectPid_=setTimeout(E.blockAnimations.disconnectUiStep_,10,t,e,o)),t.setAttribute("transform",t.translate_+t.skew_)},E.blockAnimations.disconnectUiStop=function(){if(E.blockAnimations.disconnectGroup_){clearTimeout(E.blockAnimations.disconnectPid_);var t=E.blockAnimations.disconnectGroup_;t.skew_="",t.setAttribute("transform",t.translate_),E.blockAnimations.disconnectGroup_=null}},E.InsertionMarkerManager=function(t){this.topBlock_=E.selected=t,this.workspace_=t.workspace,this.lastMarker_=this.lastOnStack_=null,this.firstMarker_=this.createMarkerBlock_(this.topBlock_),this.localConnection_=this.closestConnection_=null,this.wouldDeleteBlock_=!1,this.fadedBlock_=this.highlightedBlock_=this.markerConnection_=null,this.availableConnections_=this.initAvailableConnections_()},E.InsertionMarkerManager.PREVIEW_TYPE={INSERTION_MARKER:0,INPUT_OUTLINE:1,REPLACEMENT_FADE:2},E.InsertionMarkerManager.prototype.dispose=function(){this.availableConnections_.length=0,E.Events.disable();try{this.firstMarker_&&this.firstMarker_.dispose(),this.lastMarker_&&this.lastMarker_.dispose()}finally{E.Events.enable()}},E.InsertionMarkerManager.prototype.updateAvailableConnections=function(){this.availableConnections_=this.initAvailableConnections_()},E.InsertionMarkerManager.prototype.wouldDeleteBlock=function(){return this.wouldDeleteBlock_},E.InsertionMarkerManager.prototype.wouldConnectBlock=function(){return!!this.closestConnection_},E.InsertionMarkerManager.prototype.applyConnections=function(){if(this.closestConnection_&&(E.Events.disable(),this.hidePreview_(),E.Events.enable(),this.localConnection_.connect(this.closestConnection_),this.topBlock_.rendered)){var t=this.localConnection_.isSuperior()?this.closestConnection_:this.localConnection_;E.blockAnimations.connectionUiEffect(t.getSourceBlock()),this.topBlock_.getRootBlock().bringToFront()}},E.InsertionMarkerManager.prototype.update=function(t,e){var o=this.getCandidate_(t);((this.wouldDeleteBlock_=this.shouldDelete_(o,e))||this.shouldUpdatePreviews_(o,t))&&(E.Events.disable(),this.maybeHidePreview_(o),this.maybeShowPreview_(o),E.Events.enable())},E.InsertionMarkerManager.prototype.createMarkerBlock_=function(t){var e=t.type;E.Events.disable();try{var o=this.workspace_.newBlock(e);if(o.setInsertionMarker(!0),t.mutationToDom){var n=t.mutationToDom();n&&o.domToMutation(n)}for(e=0;e<t.inputList.length;e++){var i=t.inputList[e];if(i.name!=E.Block.COLLAPSED_INPUT_NAME){var r=o.inputList[e];for(n=0;n<i.fieldRow.length;n++)r.fieldRow[n].setValue(i.fieldRow[n].getValue())}}o.setCollapsed(t.isCollapsed()),o.setInputsInline(t.getInputsInline()),o.initSvg(),o.getSvgRoot().setAttribute("visibility","hidden")}finally{E.Events.enable()}return o},E.InsertionMarkerManager.prototype.initAvailableConnections_=function(){var t=this.topBlock_.getConnections_(!1),e=this.topBlock_.lastConnectionInStack();if(e&&e!=this.topBlock_.nextConnection){if(t.push(e),this.lastOnStack_=e,this.lastMarker_){E.Events.disable();try{this.lastMarker_.dispose()}finally{E.Events.enable()}}this.lastMarker_=this.createMarkerBlock_(e.getSourceBlock())}return t},E.InsertionMarkerManager.prototype.shouldUpdatePreviews_=function(t,e){var o=t.local,n=t.closest;return t=t.radius,o&&n?this.localConnection_&&this.closestConnection_?!(this.closestConnection_==n&&this.localConnection_==o||(o=this.localConnection_.x+e.x-this.closestConnection_.x,e=this.localConnection_.y+e.y-this.closestConnection_.y,e=Math.sqrt(o*o+e*e),n&&t>e-E.CURRENT_CONNECTION_PREFERENCE)):((this.localConnection_||this.closestConnection_)&&(console.error("Only one of localConnection_ and closestConnection_ was set."),console.error("Returning true from shouldUpdatePreviews, but it's not clear why.")),!0):!(!this.localConnection_||!this.closestConnection_)},E.InsertionMarkerManager.prototype.getCandidate_=function(t){for(var e=this.getStartRadius_(),o=null,n=null,i=0;i<this.availableConnections_.length;i++){var r=this.availableConnections_[i],s=r.closest(e,t);s.connection&&(o=s.connection,n=r,e=s.radius)}return{closest:o,local:n,radius:e}},E.InsertionMarkerManager.prototype.getStartRadius_=function(){return this.closestConnection_&&this.localConnection_?E.CONNECTING_SNAP_RADIUS:E.SNAP_RADIUS},E.InsertionMarkerManager.prototype.shouldDelete_=function(t,e){return t=t&&!!t.closest&&e!=E.DELETE_AREA_TOOLBOX,!!e&&!this.topBlock_.getParent()&&this.topBlock_.isDeletable()&&!t},E.InsertionMarkerManager.prototype.maybeShowPreview_=function(t){if(!this.wouldDeleteBlock_){var e=t.closest;t=t.local,e&&(e==this.closestConnection_||e.getSourceBlock().isInsertionMarker()?console.log("Trying to connect to an insertion marker"):(this.closestConnection_=e,this.localConnection_=t,this.showPreview_()))}},E.InsertionMarkerManager.prototype.showPreview_=function(){var t=this.closestConnection_,e=this.workspace_.getRenderer();switch(e.getConnectionPreviewMethod(t,this.localConnection_,this.topBlock_)){case E.InsertionMarkerManager.PREVIEW_TYPE.INPUT_OUTLINE:this.showInsertionInputOutline_();break;case E.InsertionMarkerManager.PREVIEW_TYPE.INSERTION_MARKER:this.showInsertionMarker_();break;case E.InsertionMarkerManager.PREVIEW_TYPE.REPLACEMENT_FADE:this.showReplacementFade_()}t&&e.shouldHighlightConnection(t)&&t.highlight()},E.InsertionMarkerManager.prototype.maybeHidePreview_=function(t){if(t.closest){var e=this.closestConnection_!=t.closest;t=this.localConnection_!=t.local,this.closestConnection_&&this.localConnection_&&(e||t||this.wouldDeleteBlock_)&&this.hidePreview_()}else this.hidePreview_();this.localConnection_=this.closestConnection_=this.markerConnection_=null},E.InsertionMarkerManager.prototype.hidePreview_=function(){this.closestConnection_&&this.closestConnection_.targetBlock()&&this.workspace_.getRenderer().shouldHighlightConnection(this.closestConnection_)&&this.closestConnection_.unhighlight(),this.fadedBlock_?this.hideReplacementFade_():this.highlightedBlock_?this.hideInsertionInputOutline_():this.markerConnection_&&this.hideInsertionMarker_()},E.InsertionMarkerManager.prototype.showInsertionMarker_=function(){var t=this.localConnection_,e=this.closestConnection_,o=this.lastOnStack_&&t==this.lastOnStack_?this.lastMarker_:this.firstMarker_;if((t=o.getMatchingConnection(t.getSourceBlock(),t))==this.markerConnection_)throw Error("Made it to showInsertionMarker_ even though the marker isn't changing");o.render(),o.rendered=!0,o.getSvgRoot().setAttribute("visibility","visible"),t&&e&&o.positionNearConnection(t,e),e&&t.connect(e),this.markerConnection_=t},E.InsertionMarkerManager.prototype.hideInsertionMarker_=function(){if(this.markerConnection_){var t=this.markerConnection_,e=t.getSourceBlock(),o=e.nextConnection,n=e.previousConnection,i=e.outputConnection;if(i=t.type==E.INPUT_VALUE&&!(i&&i.targetConnection),!(t!=o||n&&n.targetConnection)||i?t.targetBlock().unplug(!1):t.type==E.NEXT_STATEMENT&&t!=o?((o=t.targetConnection).getSourceBlock().unplug(!1),n=n?n.targetConnection:null,e.unplug(!0),n&&n.connect(o)):e.unplug(!0),t.targetConnection)throw Error("markerConnection_ still connected at the end of disconnectInsertionMarker");this.markerConnection_=null,e.getSvgRoot().setAttribute("visibility","hidden")}else console.log("No insertion marker connection to disconnect")},E.InsertionMarkerManager.prototype.showInsertionInputOutline_=function(){var t=this.closestConnection_;this.highlightedBlock_=t.getSourceBlock(),this.highlightedBlock_.highlightShapeForInput(t,!0)},E.InsertionMarkerManager.prototype.hideInsertionInputOutline_=function(){this.highlightedBlock_.highlightShapeForInput(this.closestConnection_,!1),this.highlightedBlock_=null},E.InsertionMarkerManager.prototype.showReplacementFade_=function(){this.fadedBlock_=this.closestConnection_.targetBlock(),this.fadedBlock_.fadeForReplacement(!0)},E.InsertionMarkerManager.prototype.hideReplacementFade_=function(){this.fadedBlock_.fadeForReplacement(!1),this.fadedBlock_=null},E.InsertionMarkerManager.prototype.getInsertionMarkers=function(){var t=[];return this.firstMarker_&&t.push(this.firstMarker_),this.lastMarker_&&t.push(this.lastMarker_),t},E.BlockDragger=function(t,e){this.draggingBlock_=t,this.workspace_=e,this.draggedConnectionManager_=new E.InsertionMarkerManager(this.draggingBlock_),this.deleteArea_=null,this.wouldDeleteBlock_=!1,this.startXY_=this.draggingBlock_.getRelativeToSurfaceXY(),this.dragIconData_=E.BlockDragger.initIconData_(t)},E.BlockDragger.prototype.dispose=function(){this.dragIconData_.length=0,this.draggedConnectionManager_&&this.draggedConnectionManager_.dispose()},E.BlockDragger.initIconData_=function(t){var e=[];t=t.getDescendants(!1);for(var o,n=0;o=t[n];n++){o=o.getIcons();for(var i=0;i<o.length;i++){var r={location:o[i].getIconLocation(),icon:o[i]};e.push(r)}}return e},E.BlockDragger.prototype.startBlockDrag=function(t,e){E.Events.getGroup()||E.Events.setGroup(!0),this.fireDragStartEvent_(),this.workspace_.isMutator&&this.draggingBlock_.bringToFront(),E.utils.dom.startTextWidthCache(),this.workspace_.setResizesEnabled(!1),E.blockAnimations.disconnectUiStop(),(this.draggingBlock_.getParent()||e&&this.draggingBlock_.nextConnection&&this.draggingBlock_.nextConnection.targetBlock())&&(this.draggingBlock_.unplug(e),t=this.pixelsToWorkspaceUnits_(t),t=E.utils.Coordinate.sum(this.startXY_,t),this.draggingBlock_.translate(t.x,t.y),E.blockAnimations.disconnectUiEffect(this.draggingBlock_),this.draggedConnectionManager_.updateAvailableConnections()),this.draggingBlock_.setDragging(!0),this.draggingBlock_.moveToDragSurface(),(t=this.workspace_.getToolbox())&&"function"==typeof t.addStyle&&(e=this.draggingBlock_.isDeletable()?"blocklyToolboxDelete":"blocklyToolboxGrab",t.addStyle(e))},E.BlockDragger.prototype.fireDragStartEvent_=function(){var t=new E.Events.Ui(this.draggingBlock_,"dragStart",null,this.draggingBlock_.getDescendants(!1));E.Events.fire(t)},E.BlockDragger.prototype.dragBlock=function(t,e){e=this.pixelsToWorkspaceUnits_(e);var o=E.utils.Coordinate.sum(this.startXY_,e);this.draggingBlock_.moveDuringDrag(o),this.dragIcons_(e),this.deleteArea_=this.workspace_.isDeleteArea(t),this.draggedConnectionManager_.update(e,this.deleteArea_),this.updateCursorDuringBlockDrag_()},E.BlockDragger.prototype.endBlockDrag=function(t,e){this.dragBlock(t,e),this.dragIconData_=[],this.fireDragEndEvent_(),E.utils.dom.stopTextWidthCache(),E.blockAnimations.disconnectUiStop(),t=this.pixelsToWorkspaceUnits_(e),e=E.utils.Coordinate.sum(this.startXY_,t),this.draggingBlock_.moveOffDragSurface(e),this.maybeDeleteBlock_()||(this.draggingBlock_.moveConnections(t.x,t.y),this.draggingBlock_.setDragging(!1),this.fireMoveEvent_(),this.draggedConnectionManager_.wouldConnectBlock()?this.draggedConnectionManager_.applyConnections():this.draggingBlock_.render(),this.draggingBlock_.scheduleSnapAndBump()),this.workspace_.setResizesEnabled(!0),(t=this.workspace_.getToolbox())&&"function"==typeof t.removeStyle&&(e=this.draggingBlock_.isDeletable()?"blocklyToolboxDelete":"blocklyToolboxGrab",t.removeStyle(e)),E.Events.setGroup(!1)},E.BlockDragger.prototype.fireDragEndEvent_=function(){var t=new E.Events.Ui(this.draggingBlock_,"dragStop",this.draggingBlock_.getDescendants(!1),null);E.Events.fire(t)},E.BlockDragger.prototype.fireMoveEvent_=function(){var t=new E.Events.BlockMove(this.draggingBlock_);t.oldCoordinate=this.startXY_,t.recordNew(),E.Events.fire(t)},E.BlockDragger.prototype.maybeDeleteBlock_=function(){var t=this.workspace_.trashcan;return this.wouldDeleteBlock_?(t&&setTimeout(t.closeLid.bind(t),100),this.fireMoveEvent_(),this.draggingBlock_.dispose(!1,!0),E.draggingConnections=[]):t&&t.closeLid(),this.wouldDeleteBlock_},E.BlockDragger.prototype.updateCursorDuringBlockDrag_=function(){this.wouldDeleteBlock_=this.draggedConnectionManager_.wouldDeleteBlock();var t=this.workspace_.trashcan;this.wouldDeleteBlock_?(this.draggingBlock_.setDeleteStyle(!0),this.deleteArea_==E.DELETE_AREA_TRASH&&t&&t.setLidOpen(!0)):(this.draggingBlock_.setDeleteStyle(!1),t&&t.setLidOpen(!1))},E.BlockDragger.prototype.pixelsToWorkspaceUnits_=function(t){return t=new E.utils.Coordinate(t.x/this.workspace_.scale,t.y/this.workspace_.scale),this.workspace_.isMutator&&t.scale(1/this.workspace_.options.parentWorkspace.scale),t},E.BlockDragger.prototype.dragIcons_=function(t){for(var e=0;e<this.dragIconData_.length;e++){var o=this.dragIconData_[e];o.icon.setIconLocation(E.utils.Coordinate.sum(o.location,t))}},E.BlockDragger.prototype.getInsertionMarkers=function(){return this.draggedConnectionManager_&&this.draggedConnectionManager_.getInsertionMarkers?this.draggedConnectionManager_.getInsertionMarkers():[]},E.ConnectionChecker=function(){},E.ConnectionChecker.prototype.canConnect=function(t,e,o,n){return this.canConnectWithReason(t,e,o,n)==E.Connection.CAN_CONNECT},E.ConnectionChecker.prototype.canConnectWithReason=function(t,e,o,n){var i=this.doSafetyChecks(t,e);return i!=E.Connection.CAN_CONNECT?i:this.doTypeChecks(t,e)?o&&!this.doDragChecks(t,e,n||0)?E.Connection.REASON_DRAG_CHECKS_FAILED:E.Connection.CAN_CONNECT:E.Connection.REASON_CHECKS_FAILED},E.ConnectionChecker.prototype.getErrorMessage=function(t,e,o){switch(t){case E.Connection.REASON_SELF_CONNECTION:return"Attempted to connect a block to itself.";case E.Connection.REASON_DIFFERENT_WORKSPACES:return"Blocks not on same workspace.";case E.Connection.REASON_WRONG_TYPE:return"Attempt to connect incompatible types.";case E.Connection.REASON_TARGET_NULL:return"Target connection is null.";case E.Connection.REASON_CHECKS_FAILED:return"Connection checks failed. "+e+" expected "+e.getCheck()+", found "+o.getCheck();case E.Connection.REASON_SHADOW_PARENT:return"Connecting non-shadow to shadow block.";case E.Connection.REASON_DRAG_CHECKS_FAILED:return"Drag checks failed.";default:return"Unknown connection failure: this should never happen!"}},E.ConnectionChecker.prototype.doSafetyChecks=function(t,e){if(!t||!e)return E.Connection.REASON_TARGET_NULL;if(t.isSuperior())var o=t.getSourceBlock(),n=e.getSourceBlock();else n=t.getSourceBlock(),o=e.getSourceBlock();return o==n?E.Connection.REASON_SELF_CONNECTION:e.type!=E.OPPOSITE_TYPE[t.type]?E.Connection.REASON_WRONG_TYPE:o.workspace!==n.workspace?E.Connection.REASON_DIFFERENT_WORKSPACES:o.isShadow()&&!n.isShadow()?E.Connection.REASON_SHADOW_PARENT:E.Connection.CAN_CONNECT},E.ConnectionChecker.prototype.doTypeChecks=function(t,e){if(t=t.getCheck(),e=e.getCheck(),!t||!e)return!0;for(var o=0;o<t.length;o++)if(-1!=e.indexOf(t[o]))return!0;return!1},E.ConnectionChecker.prototype.doDragChecks=function(t,e,o){if(t.distanceFrom(e)>o||e.getSourceBlock().isInsertionMarker())return!1;switch(e.type){case E.PREVIOUS_STATEMENT:return this.canConnectToPrevious_(t,e);case E.OUTPUT_VALUE:if(e.isConnected()&&!e.targetBlock().isInsertionMarker()||t.isConnected())return!1;break;case E.INPUT_VALUE:if(e.isConnected()&&!e.targetBlock().isMovable()&&!e.targetBlock().isShadow())return!1;break;case E.NEXT_STATEMENT:if(e.isConnected()&&!t.getSourceBlock().nextConnection&&!e.targetBlock().isShadow()&&e.targetBlock().nextConnection)return!1;break;default:return!1}return-1==E.draggingConnections.indexOf(e)},E.ConnectionChecker.prototype.canConnectToPrevious_=function(t,e){return!(t.targetConnection||-1!=E.draggingConnections.indexOf(e)||e.targetConnection&&(!(t=e.targetBlock()).isInsertionMarker()||t.getPreviousBlock()))},E.registry.register(E.registry.Type.CONNECTION_CHECKER,E.registry.DEFAULT,E.ConnectionChecker),E.VariableMap=function(t){this.variableMap_=Object.create(null),this.workspace=t},E.VariableMap.prototype.clear=function(){this.variableMap_=Object.create(null)},E.VariableMap.prototype.renameVariable=function(t,e){var o=this.getVariable(e,t.type),n=this.workspace.getAllBlocks(!1);E.Events.setGroup(!0);try{o&&o.getId()!=t.getId()?this.renameVariableWithConflict_(t,e,o,n):this.renameVariableAndUses_(t,e,n)}finally{E.Events.setGroup(!1)}},E.VariableMap.prototype.renameVariableById=function(t,e){var o=this.getVariableById(t);if(!o)throw Error("Tried to rename a variable that didn't exist. ID: "+t);this.renameVariable(o,e)},E.VariableMap.prototype.renameVariableAndUses_=function(t,e,o){for(E.Events.fire(new E.Events.VarRename(t,e)),t.name=e,e=0;e<o.length;e++)o[e].updateVarName(t)},E.VariableMap.prototype.renameVariableWithConflict_=function(t,e,o,n){var i=t.type;for(e!=o.name&&this.renameVariableAndUses_(o,e,n),e=0;e<n.length;e++)n[e].renameVarById(t.getId(),o.getId());E.Events.fire(new E.Events.VarDelete(t)),t=this.getVariablesOfType(i).indexOf(t),this.variableMap_[i].splice(t,1)},E.VariableMap.prototype.createVariable=function(t,e,o){var n=this.getVariable(t,e);if(n){if(o&&n.getId()!=o)throw Error('Variable "'+t+'" is already in use and its id is "'+n.getId()+'" which conflicts with the passed in id, "'+o+'".');return n}if(o&&this.getVariableById(o))throw Error('Variable id, "'+o+'", is already in use.');return n=o||E.utils.genUid(),e=e||"",n=new E.VariableModel(this.workspace,t,e,n),(t=this.variableMap_[e]||[]).push(n),delete this.variableMap_[e],this.variableMap_[e]=t,n},E.VariableMap.prototype.deleteVariable=function(t){for(var e,o=this.variableMap_[t.type],n=0;e=o[n];n++)if(e.getId()==t.getId()){o.splice(n,1),E.Events.fire(new E.Events.VarDelete(t));break}},E.VariableMap.prototype.deleteVariableById=function(t){var e=this.getVariableById(t);if(e){var o,n=e.name,i=this.getVariableUsesById(t);for(t=0;o=i[t];t++)if("procedures_defnoreturn"==o.type||"procedures_defreturn"==o.type)return t=o.getFieldValue("NAME"),n=E.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE.replace("%1",n).replace("%2",t),void E.alert(n);var r=this;1<i.length?(n=E.Msg.DELETE_VARIABLE_CONFIRMATION.replace("%1",String(i.length)).replace("%2",n),E.confirm(n,function(t){t&&e&&r.deleteVariableInternal(e,i)})):r.deleteVariableInternal(e,i)}else console.warn("Can't delete non-existent variable: "+t)},E.VariableMap.prototype.deleteVariableInternal=function(t,e){var o=E.Events.getGroup();o||E.Events.setGroup(!0);try{for(var n=0;n<e.length;n++)e[n].dispose(!0);this.deleteVariable(t)}finally{o||E.Events.setGroup(!1)}},E.VariableMap.prototype.getVariable=function(t,e){if(e=this.variableMap_[e||""])for(var o,n=0;o=e[n];n++)if(E.Names.equals(o.name,t))return o;return null},E.VariableMap.prototype.getVariableById=function(t){for(var e=Object.keys(this.variableMap_),o=0;o<e.length;o++)for(var n,i=e[o],r=0;n=this.variableMap_[i][r];r++)if(n.getId()==t)return n;return null},E.VariableMap.prototype.getVariablesOfType=function(t){return(t=this.variableMap_[t||""])?t.slice():[]},E.VariableMap.prototype.getVariableTypes=function(t){var e={};E.utils.object.mixin(e,this.variableMap_),t&&t.getPotentialVariableMap()&&E.utils.object.mixin(e,t.getPotentialVariableMap().variableMap_),t=Object.keys(e),e=!1;for(var o=0;o<t.length;o++)""==t[o]&&(e=!0);return e||t.push(""),t},E.VariableMap.prototype.getAllVariables=function(){var t,e=[];for(t in this.variableMap_)e=e.concat(this.variableMap_[t]);return e},E.VariableMap.prototype.getAllVariableNames=function(){var t,e=[];for(t in this.variableMap_)for(var o,n=this.variableMap_[t],i=0;o=n[i];i++)e.push(o.name);return e},E.VariableMap.prototype.getVariableUsesById=function(t){for(var e=[],o=this.workspace.getAllBlocks(!1),n=0;n<o.length;n++){var i=o[n].getVarModels();if(i)for(var r=0;r<i.length;r++)i[r].getId()==t&&e.push(o[n])}return e},E.Workspace=function(t){this.id=E.utils.genUid(),(E.Workspace.WorkspaceDB_[this.id]=this).options=t||new E.Options({}),this.RTL=!!this.options.RTL,this.horizontalLayout=!!this.options.horizontalLayout,this.toolboxPosition=this.options.toolboxPosition,this.connectionChecker=new(E.registry.getClassFromOptions(E.registry.Type.CONNECTION_CHECKER,this.options))(this),this.topBlocks_=[],this.topComments_=[],this.commentDB_=Object.create(null),this.listeners_=[],this.undoStack_=[],this.redoStack_=[],this.blockDB_=Object.create(null),this.typedBlocksDB_=Object.create(null),this.variableMap_=new E.VariableMap(this),this.potentialVariableMap_=null},E.Workspace.prototype.rendered=!1,E.Workspace.prototype.isClearing=!1,E.Workspace.prototype.MAX_UNDO=1024,E.Workspace.prototype.connectionDBList=null,E.Workspace.prototype.dispose=function(){this.listeners_.length=0,this.clear(),delete E.Workspace.WorkspaceDB_[this.id]},E.Workspace.SCAN_ANGLE=3,E.Workspace.prototype.sortObjects_=function(t,e){return t=t.getRelativeToSurfaceXY(),e=e.getRelativeToSurfaceXY(),t.y+E.Workspace.prototype.sortObjects_.offset*t.x-(e.y+E.Workspace.prototype.sortObjects_.offset*e.x)},E.Workspace.prototype.addTopBlock=function(t){this.topBlocks_.push(t)},E.Workspace.prototype.removeTopBlock=function(t){if(!E.utils.arrayRemove(this.topBlocks_,t))throw Error("Block not present in workspace's list of top-most blocks.")},E.Workspace.prototype.getTopBlocks=function(t){var e=[].concat(this.topBlocks_);return t&&1<e.length&&(this.sortObjects_.offset=Math.sin(E.utils.math.toRadians(E.Workspace.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),e.sort(this.sortObjects_)),e},E.Workspace.prototype.addTypedBlock=function(t){this.typedBlocksDB_[t.type]||(this.typedBlocksDB_[t.type]=[]),this.typedBlocksDB_[t.type].push(t)},E.Workspace.prototype.removeTypedBlock=function(t){this.typedBlocksDB_[t.type].splice(this.typedBlocksDB_[t.type].indexOf(t),1),this.typedBlocksDB_[t.type].length||delete this.typedBlocksDB_[t.type]},E.Workspace.prototype.getBlocksByType=function(t,e){return this.typedBlocksDB_[t]?(t=this.typedBlocksDB_[t].slice(0),e&&1<t.length&&(this.sortObjects_.offset=Math.sin(E.utils.math.toRadians(E.Workspace.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),t.sort(this.sortObjects_)),t):[]},E.Workspace.prototype.addTopComment=function(t){this.topComments_.push(t),this.commentDB_[t.id]&&console.warn('Overriding an existing comment on this workspace, with id "'+t.id+'"'),this.commentDB_[t.id]=t},E.Workspace.prototype.removeTopComment=function(t){if(!E.utils.arrayRemove(this.topComments_,t))throw Error("Comment not present in workspace's list of top-most comments.");delete this.commentDB_[t.id]},E.Workspace.prototype.getTopComments=function(t){var e=[].concat(this.topComments_);return t&&1<e.length&&(this.sortObjects_.offset=Math.sin(E.utils.math.toRadians(E.Workspace.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),e.sort(this.sortObjects_)),e},E.Workspace.prototype.getAllBlocks=function(t){if(t){t=this.getTopBlocks(!0);for(var e=[],o=0;o<t.length;o++)e.push.apply(e,t[o].getDescendants(!0))}else for(e=this.getTopBlocks(!1),o=0;o<e.length;o++)e.push.apply(e,e[o].getChildren(!1));return e.filter(function(t){return!t.isInsertionMarker()})},E.Workspace.prototype.clear=function(){this.isClearing=!0;try{var t=E.Events.getGroup();for(t||E.Events.setGroup(!0);this.topBlocks_.length;)this.topBlocks_[0].dispose(!1);for(;this.topComments_.length;)this.topComments_[this.topComments_.length-1].dispose(!1);t||E.Events.setGroup(!1),this.variableMap_.clear(),this.potentialVariableMap_&&this.potentialVariableMap_.clear()}finally{this.isClearing=!1}},E.Workspace.prototype.renameVariableById=function(t,e){this.variableMap_.renameVariableById(t,e)},E.Workspace.prototype.createVariable=function(t,e,o){return this.variableMap_.createVariable(t,e,o)},E.Workspace.prototype.getVariableUsesById=function(t){return this.variableMap_.getVariableUsesById(t)},E.Workspace.prototype.deleteVariableById=function(t){this.variableMap_.deleteVariableById(t)},E.Workspace.prototype.getVariable=function(t,e){return this.variableMap_.getVariable(t,e)},E.Workspace.prototype.getVariableById=function(t){return this.variableMap_.getVariableById(t)},E.Workspace.prototype.getVariablesOfType=function(t){return this.variableMap_.getVariablesOfType(t)},E.Workspace.prototype.getVariableTypes=function(){return this.variableMap_.getVariableTypes(this)},E.Workspace.prototype.getAllVariables=function(){return this.variableMap_.getAllVariables()},E.Workspace.prototype.getAllVariableNames=function(){return this.variableMap_.getAllVariableNames()},E.Workspace.prototype.getWidth=function(){return 0},E.Workspace.prototype.newBlock=function(t,e){return new E.Block(this,t,e)},E.Workspace.prototype.remainingCapacity=function(){return isNaN(this.options.maxBlocks)?1/0:this.options.maxBlocks-this.getAllBlocks(!1).length},E.Workspace.prototype.remainingCapacityOfType=function(t){return this.options.maxInstances?(void 0!==this.options.maxInstances[t]?this.options.maxInstances[t]:1/0)-this.getBlocksByType(t,!1).length:1/0},E.Workspace.prototype.isCapacityAvailable=function(t){if(!this.hasBlockLimits())return!0;var e,o=0;for(e in t){if(t[e]>this.remainingCapacityOfType(e))return!1;o+=t[e]}return!(o>this.remainingCapacity())},E.Workspace.prototype.hasBlockLimits=function(){return 1/0!=this.options.maxBlocks||!!this.options.maxInstances},E.Workspace.prototype.getUndoStack=function(){return this.undoStack_},E.Workspace.prototype.getRedoStack=function(){return this.redoStack_},E.Workspace.prototype.undo=function(t){var e=t?this.redoStack_:this.undoStack_,o=t?this.undoStack_:this.redoStack_,n=e.pop();if(n){for(var i=[n];e.length&&n.group&&n.group==e[e.length-1].group;)i.push(e.pop());for(e=0;n=i[e];e++)o.push(n);i=E.Events.filter(i,t),E.Events.recordUndo=!1;try{for(e=0;n=i[e];e++)n.run(t)}finally{E.Events.recordUndo=!0}}},E.Workspace.prototype.clearUndo=function(){this.undoStack_.length=0,this.redoStack_.length=0,E.Events.clearPendingUndo()},E.Workspace.prototype.addChangeListener=function(t){return this.listeners_.push(t),t},E.Workspace.prototype.removeChangeListener=function(t){E.utils.arrayRemove(this.listeners_,t)},E.Workspace.prototype.fireChangeListener=function(t){if(t.recordUndo)for(this.undoStack_.push(t),this.redoStack_.length=0;this.undoStack_.length>this.MAX_UNDO&&0<=this.MAX_UNDO;)this.undoStack_.shift();for(var e,o=0;e=this.listeners_[o];o++)e(t)},E.Workspace.prototype.getBlockById=function(t){return this.blockDB_[t]||null},E.Workspace.prototype.setBlockById=function(t,e){this.blockDB_[t]=e},E.Workspace.prototype.removeBlockById=function(t){delete this.blockDB_[t]},E.Workspace.prototype.getCommentById=function(t){return this.commentDB_[t]||null},E.Workspace.prototype.allInputsFilled=function(t){for(var e,o=this.getTopBlocks(!1),n=0;e=o[n];n++)if(!e.allInputsFilled(t))return!1;return!0},E.Workspace.prototype.getPotentialVariableMap=function(){return this.potentialVariableMap_},E.Workspace.prototype.createPotentialVariableMap=function(){this.potentialVariableMap_=new E.VariableMap(this)},E.Workspace.prototype.getVariableMap=function(){return this.variableMap_},E.Workspace.prototype.setVariableMap=function(t){this.variableMap_=t},E.Workspace.WorkspaceDB_=Object.create(null),E.Workspace.getById=function(t){return E.Workspace.WorkspaceDB_[t]||null},E.Workspace.getAll=function(){var t,e=[];for(t in E.Workspace.WorkspaceDB_)e.push(E.Workspace.WorkspaceDB_[t]);return e},E.Bubble=function(t,e,o,n,i,r){this.workspace_=t,this.content_=e,this.shape_=o,this.onMouseDownResizeWrapper_=this.onMouseDownBubbleWrapper_=this.moveCallback_=this.resizeCallback_=null,this.disposed=!1,o=E.Bubble.ARROW_ANGLE,this.workspace_.RTL&&(o=-o),this.arrow_radians_=E.utils.math.toRadians(o),t.getBubbleCanvas().appendChild(this.createDom_(e,!(!i||!r))),this.setAnchorLocation(n),i&&r||(i=(t=this.content_.getBBox()).width+2*E.Bubble.BORDER_WIDTH,r=t.height+2*E.Bubble.BORDER_WIDTH),this.setBubbleSize(i,r),this.positionBubble_(),this.renderArrow_(),this.rendered_=!0},E.Bubble.BORDER_WIDTH=6,E.Bubble.ARROW_THICKNESS=5,E.Bubble.ARROW_ANGLE=20,E.Bubble.ARROW_BEND=4,E.Bubble.ANCHOR_RADIUS=8,E.Bubble.onMouseUpWrapper_=null,E.Bubble.onMouseMoveWrapper_=null,E.Bubble.unbindDragEvents_=function(){E.Bubble.onMouseUpWrapper_&&(E.unbindEvent_(E.Bubble.onMouseUpWrapper_),E.Bubble.onMouseUpWrapper_=null),E.Bubble.onMouseMoveWrapper_&&(E.unbindEvent_(E.Bubble.onMouseMoveWrapper_),E.Bubble.onMouseMoveWrapper_=null)},E.Bubble.bubbleMouseUp_=function(t){E.Touch.clearTouchIdentifier(),E.Bubble.unbindDragEvents_()},E.Bubble.prototype.rendered_=!1,E.Bubble.prototype.anchorXY_=null,E.Bubble.prototype.relativeLeft_=0,E.Bubble.prototype.relativeTop_=0,E.Bubble.prototype.width_=0,E.Bubble.prototype.height_=0,E.Bubble.prototype.autoLayout_=!0,E.Bubble.prototype.createDom_=function(t,e){this.bubbleGroup_=E.utils.dom.createSvgElement(E.utils.Svg.G,{},null);var o={filter:"url(#"+this.workspace_.getRenderer().getConstants().embossFilterId+")"};return E.utils.userAgent.JAVA_FX&&(o={}),o=E.utils.dom.createSvgElement(E.utils.Svg.G,o,this.bubbleGroup_),this.bubbleArrow_=E.utils.dom.createSvgElement(E.utils.Svg.PATH,{},o),this.bubbleBack_=E.utils.dom.createSvgElement(E.utils.Svg.RECT,{class:"blocklyDraggable",x:0,y:0,rx:E.Bubble.BORDER_WIDTH,ry:E.Bubble.BORDER_WIDTH},o),e?(this.resizeGroup_=E.utils.dom.createSvgElement(E.utils.Svg.G,{class:this.workspace_.RTL?"blocklyResizeSW":"blocklyResizeSE"},this.bubbleGroup_),e=2*E.Bubble.BORDER_WIDTH,E.utils.dom.createSvgElement(E.utils.Svg.POLYGON,{points:"0,x x,x x,0".replace(/x/g,e.toString())},this.resizeGroup_),E.utils.dom.createSvgElement(E.utils.Svg.LINE,{class:"blocklyResizeLine",x1:e/3,y1:e-1,x2:e-1,y2:e/3},this.resizeGroup_),E.utils.dom.createSvgElement(E.utils.Svg.LINE,{class:"blocklyResizeLine",x1:2*e/3,y1:e-1,x2:e-1,y2:2*e/3},this.resizeGroup_)):this.resizeGroup_=null,this.workspace_.options.readOnly||(this.onMouseDownBubbleWrapper_=E.bindEventWithChecks_(this.bubbleBack_,"mousedown",this,this.bubbleMouseDown_),this.resizeGroup_&&(this.onMouseDownResizeWrapper_=E.bindEventWithChecks_(this.resizeGroup_,"mousedown",this,this.resizeMouseDown_))),this.bubbleGroup_.appendChild(t),this.bubbleGroup_},E.Bubble.prototype.getSvgRoot=function(){return this.bubbleGroup_},E.Bubble.prototype.setSvgId=function(t){this.bubbleGroup_.dataset&&(this.bubbleGroup_.dataset.blockId=t)},E.Bubble.prototype.bubbleMouseDown_=function(t){var e=this.workspace_.getGesture(t);e&&e.handleBubbleStart(t,this)},E.Bubble.prototype.showContextMenu=function(t){},E.Bubble.prototype.isDeletable=function(){return!1},E.Bubble.prototype.setDeleteStyle=function(t){},E.Bubble.prototype.resizeMouseDown_=function(t){this.promote(),E.Bubble.unbindDragEvents_(),E.utils.isRightButton(t)||(this.workspace_.startDrag(t,new E.utils.Coordinate(this.workspace_.RTL?-this.width_:this.width_,this.height_)),E.Bubble.onMouseUpWrapper_=E.bindEventWithChecks_(document,"mouseup",this,E.Bubble.bubbleMouseUp_),E.Bubble.onMouseMoveWrapper_=E.bindEventWithChecks_(document,"mousemove",this,this.resizeMouseMove_),E.hideChaff()),t.stopPropagation()},E.Bubble.prototype.resizeMouseMove_=function(t){this.autoLayout_=!1,t=this.workspace_.moveDrag(t),this.setBubbleSize(this.workspace_.RTL?-t.x:t.x,t.y),this.workspace_.RTL&&this.positionBubble_()},E.Bubble.prototype.registerResizeEvent=function(t){this.resizeCallback_=t},E.Bubble.prototype.registerMoveEvent=function(t){this.moveCallback_=t},E.Bubble.prototype.promote=function(){var t=this.bubbleGroup_.parentNode;return t.lastChild!==this.bubbleGroup_&&(t.appendChild(this.bubbleGroup_),!0)},E.Bubble.prototype.setAnchorLocation=function(t){this.anchorXY_=t,this.rendered_&&this.positionBubble_()},E.Bubble.prototype.layoutBubble_=function(){var t=this.workspace_.getMetrics();t.viewLeft/=this.workspace_.scale,t.viewWidth/=this.workspace_.scale,t.viewTop/=this.workspace_.scale,t.viewHeight/=this.workspace_.scale;var e=this.getOptimalRelativeLeft_(t),o=this.getOptimalRelativeTop_(t),n=this.shape_.getBBox(),i={x:e,y:-this.height_-this.workspace_.getRenderer().getConstants().MIN_BLOCK_HEIGHT},r={x:-this.width_-30,y:o};o={x:n.width,y:o};var s={x:e,y:n.height};e=n.width<n.height?o:s,n=n.width<n.height?s:o,o=this.getOverlap_(i,t),s=this.getOverlap_(r,t);var a=this.getOverlap_(e,t);t=this.getOverlap_(n,t),o==(t=Math.max(o,s,a,t))?(this.relativeLeft_=i.x,this.relativeTop_=i.y):s==t?(this.relativeLeft_=r.x,this.relativeTop_=r.y):a==t?(this.relativeLeft_=e.x,this.relativeTop_=e.y):(this.relativeLeft_=n.x,this.relativeTop_=n.y)},E.Bubble.prototype.getOverlap_=function(t,e){var o=this.workspace_.RTL?this.anchorXY_.x-t.x-this.width_:t.x+this.anchorXY_.x;return t=t.y+this.anchorXY_.y,Math.max(0,Math.min(1,(Math.min(o+this.width_,e.viewLeft+e.viewWidth)-Math.max(o,e.viewLeft))*(Math.min(t+this.height_,e.viewTop+e.viewHeight)-Math.max(t,e.viewTop))/(this.width_*this.height_)))},E.Bubble.prototype.getOptimalRelativeLeft_=function(t){var e=-this.width_/4;if(this.width_>t.viewWidth)return e;if(this.workspace_.RTL)var o=this.anchorXY_.x-e,n=o-this.width_,i=t.viewLeft+t.viewWidth,r=t.viewLeft+E.Scrollbar.scrollbarThickness/this.workspace_.scale;else o=(n=e+this.anchorXY_.x)+this.width_,r=t.viewLeft,i=t.viewLeft+t.viewWidth-E.Scrollbar.scrollbarThickness/this.workspace_.scale;return this.workspace_.RTL?n<r?e=-(r-this.anchorXY_.x+this.width_):i<o&&(e=-(i-this.anchorXY_.x)):n<r?e=r-this.anchorXY_.x:i<o&&(e=i-this.anchorXY_.x-this.width_),e},E.Bubble.prototype.getOptimalRelativeTop_=function(t){var e=-this.height_/4;if(this.height_>t.viewHeight)return e;var o=this.anchorXY_.y+e,n=o+this.height_,i=t.viewTop;t=t.viewTop+t.viewHeight-E.Scrollbar.scrollbarThickness/this.workspace_.scale;var r=this.anchorXY_.y;return o<i?e=i-r:t<n&&(e=t-r-this.height_),e},E.Bubble.prototype.positionBubble_=function(){var t=this.anchorXY_.x;t=this.workspace_.RTL?t-(this.relativeLeft_+this.width_):t+this.relativeLeft_,this.moveTo(t,this.relativeTop_+this.anchorXY_.y)},E.Bubble.prototype.moveTo=function(t,e){this.bubbleGroup_.setAttribute("transform","translate("+t+","+e+")")},E.Bubble.prototype.setDragging=function(t){!t&&this.moveCallback_&&this.moveCallback_()},E.Bubble.prototype.getBubbleSize=function(){return new E.utils.Size(this.width_,this.height_)},E.Bubble.prototype.setBubbleSize=function(t,e){var o=2*E.Bubble.BORDER_WIDTH;t=Math.max(t,45+o),e=Math.max(e,20+o),this.width_=t,this.height_=e,this.bubbleBack_.setAttribute("width",t),this.bubbleBack_.setAttribute("height",e),this.resizeGroup_&&(this.workspace_.RTL?this.resizeGroup_.setAttribute("transform","translate("+2*E.Bubble.BORDER_WIDTH+","+(e-o)+") scale(-1 1)"):this.resizeGroup_.setAttribute("transform","translate("+(t-o)+","+(e-o)+")")),this.autoLayout_&&this.layoutBubble_(),this.positionBubble_(),this.renderArrow_(),this.resizeCallback_&&this.resizeCallback_()},E.Bubble.prototype.renderArrow_=function(){var t=[],e=this.width_/2,o=this.height_/2,n=-this.relativeLeft_,i=-this.relativeTop_;if(e==n&&o==i)t.push("M "+e+","+o);else{i-=o,n-=e,this.workspace_.RTL&&(n*=-1);var r=Math.sqrt(i*i+n*n),s=Math.acos(n/r);i<0&&(s=2*Math.PI-s);var a=s+Math.PI/2;a>2*Math.PI&&(a-=2*Math.PI);var l=Math.sin(a),c=Math.cos(a),u=this.getBubbleSize();a=(u.width+u.height)/E.Bubble.ARROW_THICKNESS,a=Math.min(a,u.width,u.height)/4,n=e+(u=1-E.Bubble.ANCHOR_RADIUS/r)*n,i=o+u*i,u=e+a*c;var h=o+a*l;e-=a*c,o-=a*l,(l=s+this.arrow_radians_)>2*Math.PI&&(l-=2*Math.PI),s=Math.sin(l)*r/E.Bubble.ARROW_BEND,r=Math.cos(l)*r/E.Bubble.ARROW_BEND,t.push("M"+u+","+h),t.push("C"+(u+r)+","+(h+s)+" "+n+","+i+" "+n+","+i),t.push("C"+n+","+i+" "+(e+r)+","+(o+s)+" "+e+","+o)}t.push("z"),this.bubbleArrow_.setAttribute("d",t.join(" "))},E.Bubble.prototype.setColour=function(t){this.bubbleBack_.setAttribute("fill",t),this.bubbleArrow_.setAttribute("fill",t)},E.Bubble.prototype.dispose=function(){this.onMouseDownBubbleWrapper_&&E.unbindEvent_(this.onMouseDownBubbleWrapper_),this.onMouseDownResizeWrapper_&&E.unbindEvent_(this.onMouseDownResizeWrapper_),E.Bubble.unbindDragEvents_(),E.utils.dom.removeNode(this.bubbleGroup_),this.disposed=!0},E.Bubble.prototype.moveDuringDrag=function(t,e){t?t.translateSurface(e.x,e.y):this.moveTo(e.x,e.y),this.relativeLeft_=this.workspace_.RTL?this.anchorXY_.x-e.x-this.width_:e.x-this.anchorXY_.x,this.relativeTop_=e.y-this.anchorXY_.y,this.renderArrow_()},E.Bubble.prototype.getRelativeToSurfaceXY=function(){return new E.utils.Coordinate(this.workspace_.RTL?-this.relativeLeft_+this.anchorXY_.x-this.width_:this.anchorXY_.x+this.relativeLeft_,this.anchorXY_.y+this.relativeTop_)},E.Bubble.prototype.setAutoLayout=function(t){this.autoLayout_=t},E.Events.CommentBase=function(t){this.commentId=(this.isBlank=void 0===t)?"":t.id,this.workspaceId=this.isBlank?"":t.workspace.id,this.group=E.Events.getGroup(),this.recordUndo=E.Events.recordUndo},E.utils.object.inherits(E.Events.CommentBase,E.Events.Abstract),E.Events.CommentBase.prototype.toJson=function(){var t=E.Events.CommentBase.superClass_.toJson.call(this);return this.commentId&&(t.commentId=this.commentId),t},E.Events.CommentBase.prototype.fromJson=function(t){E.Events.CommentBase.superClass_.fromJson.call(this,t),this.commentId=t.commentId},E.Events.CommentChange=function(t,e,o){E.Events.CommentChange.superClass_.constructor.call(this,t),t&&(this.oldContents_=void 0===e?"":e,this.newContents_=void 0===o?"":o)},E.utils.object.inherits(E.Events.CommentChange,E.Events.CommentBase),E.Events.CommentChange.prototype.type=E.Events.COMMENT_CHANGE,E.Events.CommentChange.prototype.toJson=function(){var t=E.Events.CommentChange.superClass_.toJson.call(this);return t.newContents=this.newContents_,t},E.Events.CommentChange.prototype.fromJson=function(t){E.Events.CommentChange.superClass_.fromJson.call(this,t),this.newContents_=t.newValue},E.Events.CommentChange.prototype.isNull=function(){return this.oldContents_==this.newContents_},E.Events.CommentChange.prototype.run=function(t){var e=this.getEventWorkspace_().getCommentById(this.commentId);e?e.setContent(t?this.newContents_:this.oldContents_):console.warn("Can't change non-existent comment: "+this.commentId)},E.Events.CommentCreate=function(t){E.Events.CommentCreate.superClass_.constructor.call(this,t),t&&(this.xml=t.toXmlWithXY())},E.utils.object.inherits(E.Events.CommentCreate,E.Events.CommentBase),E.Events.CommentCreate.prototype.type=E.Events.COMMENT_CREATE,E.Events.CommentCreate.prototype.toJson=function(){var t=E.Events.CommentCreate.superClass_.toJson.call(this);return t.xml=E.Xml.domToText(this.xml),t},E.Events.CommentCreate.prototype.fromJson=function(t){E.Events.CommentCreate.superClass_.fromJson.call(this,t),this.xml=E.Xml.textToDom(t.xml)},E.Events.CommentCreate.prototype.run=function(t){E.Events.CommentCreateDeleteHelper(this,t)},E.Events.CommentCreateDeleteHelper=function(t,e){var o=t.getEventWorkspace_();e?((e=E.utils.xml.createElement("xml")).appendChild(t.xml),E.Xml.domToWorkspace(e,o)):(o=o.getCommentById(t.commentId))?o.dispose(!1,!1):console.warn("Can't uncreate non-existent comment: "+t.commentId)},E.Events.CommentDelete=function(t){E.Events.CommentDelete.superClass_.constructor.call(this,t),t&&(this.xml=t.toXmlWithXY())},E.utils.object.inherits(E.Events.CommentDelete,E.Events.CommentBase),E.Events.CommentDelete.prototype.type=E.Events.COMMENT_DELETE,E.Events.CommentDelete.prototype.toJson=function(){return E.Events.CommentDelete.superClass_.toJson.call(this)},E.Events.CommentDelete.prototype.fromJson=function(t){E.Events.CommentDelete.superClass_.fromJson.call(this,t)},E.Events.CommentDelete.prototype.run=function(t){E.Events.CommentCreateDeleteHelper(this,!t)},E.Events.CommentMove=function(t){E.Events.CommentMove.superClass_.constructor.call(this,t),t&&(this.comment_=t,this.oldCoordinate_=t.getXY(),this.newCoordinate_=null)},E.utils.object.inherits(E.Events.CommentMove,E.Events.CommentBase),E.Events.CommentMove.prototype.recordNew=function(){if(!this.comment_)throw Error("Tried to record the new position of a comment on the same event twice.");this.newCoordinate_=this.comment_.getXY(),this.comment_=null},E.Events.CommentMove.prototype.type=E.Events.COMMENT_MOVE,E.Events.CommentMove.prototype.setOldCoordinate=function(t){this.oldCoordinate_=t},E.Events.CommentMove.prototype.toJson=function(){var t=E.Events.CommentMove.superClass_.toJson.call(this);return this.newCoordinate_&&(t.newCoordinate=Math.round(this.newCoordinate_.x)+","+Math.round(this.newCoordinate_.y)),t},E.Events.CommentMove.prototype.fromJson=function(t){E.Events.CommentMove.superClass_.fromJson.call(this,t),t.newCoordinate&&(t=t.newCoordinate.split(","),this.newCoordinate_=new E.utils.Coordinate(Number(t[0]),Number(t[1])))},E.Events.CommentMove.prototype.isNull=function(){return E.utils.Coordinate.equals(this.oldCoordinate_,this.newCoordinate_)},E.Events.CommentMove.prototype.run=function(t){var e=this.getEventWorkspace_().getCommentById(this.commentId);if(e){t=t?this.newCoordinate_:this.oldCoordinate_;var o=e.getXY();e.moveBy(t.x-o.x,t.y-o.y)}else console.warn("Can't move non-existent comment: "+this.commentId)},E.registry.register(E.registry.Type.EVENT,E.Events.COMMENT_CREATE,E.Events.CommentCreate),E.registry.register(E.registry.Type.EVENT,E.Events.COMMENT_CHANGE,E.Events.CommentChange),E.registry.register(E.registry.Type.EVENT,E.Events.COMMENT_MOVE,E.Events.CommentMove),E.registry.register(E.registry.Type.EVENT,E.Events.COMMENT_DELETE,E.Events.CommentDelete),E.BubbleDragger=function(t,e){this.draggingBubble_=t,this.workspace_=e,this.deleteArea_=null,this.wouldDeleteBubble_=!1,this.startXY_=this.draggingBubble_.getRelativeToSurfaceXY(),this.dragSurface_=E.utils.is3dSupported()&&e.getBlockDragSurface()?e.getBlockDragSurface():null},E.BubbleDragger.prototype.dispose=function(){this.dragSurface_=this.workspace_=this.draggingBubble_=null},E.BubbleDragger.prototype.startBubbleDrag=function(){E.Events.getGroup()||E.Events.setGroup(!0),this.workspace_.setResizesEnabled(!1),this.draggingBubble_.setAutoLayout(!1),this.dragSurface_&&this.moveToDragSurface_(),this.draggingBubble_.setDragging&&this.draggingBubble_.setDragging(!0);var t=this.workspace_.getToolbox();if(t&&"function"==typeof t.addStyle){var e=this.draggingBubble_.isDeletable()?"blocklyToolboxDelete":"blocklyToolboxGrab";t.addStyle(e)}},E.BubbleDragger.prototype.dragBubble=function(t,e){e=this.pixelsToWorkspaceUnits_(e),e=E.utils.Coordinate.sum(this.startXY_,e),this.draggingBubble_.moveDuringDrag(this.dragSurface_,e),this.draggingBubble_.isDeletable()&&(this.deleteArea_=this.workspace_.isDeleteArea(t),this.updateCursorDuringBubbleDrag_())},E.BubbleDragger.prototype.maybeDeleteBubble_=function(){var t=this.workspace_.trashcan;return this.wouldDeleteBubble_?(t&&setTimeout(t.closeLid.bind(t),100),this.fireMoveEvent_(),this.draggingBubble_.dispose(!1,!0)):t&&t.closeLid(),this.wouldDeleteBubble_},E.BubbleDragger.prototype.updateCursorDuringBubbleDrag_=function(){this.wouldDeleteBubble_=this.deleteArea_!=E.DELETE_AREA_NONE;var t=this.workspace_.trashcan;this.wouldDeleteBubble_?(this.draggingBubble_.setDeleteStyle(!0),this.deleteArea_==E.DELETE_AREA_TRASH&&t&&t.setLidOpen(!0)):(this.draggingBubble_.setDeleteStyle(!1),t&&t.setLidOpen(!1))},E.BubbleDragger.prototype.endBubbleDrag=function(t,e){this.dragBubble(t,e),t=this.pixelsToWorkspaceUnits_(e),t=E.utils.Coordinate.sum(this.startXY_,t),this.draggingBubble_.moveTo(t.x,t.y),this.maybeDeleteBubble_()||(this.dragSurface_&&this.dragSurface_.clearAndHide(this.workspace_.getBubbleCanvas()),this.draggingBubble_.setDragging&&this.draggingBubble_.setDragging(!1),this.fireMoveEvent_()),this.workspace_.setResizesEnabled(!0),(t=this.workspace_.getToolbox())&&"function"==typeof t.removeStyle&&(e=this.draggingBubble_.isDeletable()?"blocklyToolboxDelete":"blocklyToolboxGrab",t.removeStyle(e)),E.Events.setGroup(!1)},E.BubbleDragger.prototype.fireMoveEvent_=function(){if(this.draggingBubble_.isComment){var t=new E.Events.CommentMove(this.draggingBubble_);t.setOldCoordinate(this.startXY_),t.recordNew(),E.Events.fire(t)}},E.BubbleDragger.prototype.pixelsToWorkspaceUnits_=function(t){return t=new E.utils.Coordinate(t.x/this.workspace_.scale,t.y/this.workspace_.scale),this.workspace_.isMutator&&t.scale(1/this.workspace_.options.parentWorkspace.scale),t},E.BubbleDragger.prototype.moveToDragSurface_=function(){this.draggingBubble_.moveTo(0,0),this.dragSurface_.translateSurface(this.startXY_.x,this.startXY_.y),this.dragSurface_.setBlocksAndShow(this.draggingBubble_.getSvgRoot())},E.WorkspaceDragger=function(t){this.workspace_=t,this.startScrollXY_=new E.utils.Coordinate(t.scrollX,t.scrollY)},E.WorkspaceDragger.prototype.dispose=function(){this.workspace_=null},E.WorkspaceDragger.prototype.startDrag=function(){E.selected&&E.selected.unselect(),this.workspace_.setupDragSurface()},E.WorkspaceDragger.prototype.endDrag=function(t){this.drag(t),this.workspace_.resetDragSurface()},E.WorkspaceDragger.prototype.drag=function(t){t=E.utils.Coordinate.sum(this.startScrollXY_,t),this.workspace_.scroll(t.x,t.y)},E.FlyoutDragger=function(t){E.FlyoutDragger.superClass_.constructor.call(this,t.getWorkspace()),this.scrollbar_=t.scrollbar,this.horizontalLayout_=t.horizontalLayout},E.utils.object.inherits(E.FlyoutDragger,E.WorkspaceDragger),E.FlyoutDragger.prototype.drag=function(t){t=E.utils.Coordinate.sum(this.startScrollXY_,t),this.horizontalLayout_?this.scrollbar_.set(-t.x):this.scrollbar_.set(-t.y)},E.Action=function(t,e){this.name=t,this.desc=e},E.navigation={},E.navigation.loggingCallback=null,E.navigation.STATE_FLYOUT=1,E.navigation.STATE_WS=2,E.navigation.STATE_TOOLBOX=3,E.navigation.WS_MOVE_DISTANCE=40,E.navigation.currentState_=E.navigation.STATE_WS,E.navigation.actionNames={PREVIOUS:"previous",NEXT:"next",IN:"in",OUT:"out",INSERT:"insert",MARK:"mark",DISCONNECT:"disconnect",TOOLBOX:"toolbox",EXIT:"exit",TOGGLE_KEYBOARD_NAV:"toggle_keyboard_nav",MOVE_WS_CURSOR_UP:"move workspace cursor up",MOVE_WS_CURSOR_DOWN:"move workspace cursor down",MOVE_WS_CURSOR_LEFT:"move workspace cursor left",MOVE_WS_CURSOR_RIGHT:"move workspace cursor right"},E.navigation.MARKER_NAME="local_marker_1",E.navigation.getMarker=function(){return E.navigation.getNavigationWorkspace().getMarker(E.navigation.MARKER_NAME)},E.navigation.getNavigationWorkspace=function(){return E.getMainWorkspace()},E.navigation.focusToolbox_=function(){var t=E.navigation.getNavigationWorkspace().getToolbox();t&&(E.navigation.currentState_=E.navigation.STATE_TOOLBOX,E.navigation.resetFlyout_(!1),E.navigation.getMarker().getCurNode()||E.navigation.markAtCursor_(),t.getSelectedItem()||t.selectItemByPosition(0))},E.navigation.focusFlyout_=function(){E.navigation.currentState_=E.navigation.STATE_FLYOUT;var t=E.navigation.getNavigationWorkspace(),e=t.getToolbox();t=e?e.getFlyout():t.getFlyout(),E.navigation.getMarker().getCurNode()||E.navigation.markAtCursor_(),t&&t.getWorkspace()&&0<(t=t.getWorkspace().getTopBlocks(!0)).length&&(t=t[0],t=E.ASTNode.createStackNode(t),E.navigation.getFlyoutCursor_().setCurNode(t))},E.navigation.focusWorkspace_=function(){E.hideChaff();var t=E.navigation.getNavigationWorkspace(),e=t.getCursor(),o=!!t.getToolbox(),n=t.getTopBlocks(!0);E.navigation.resetFlyout_(o),E.navigation.currentState_=E.navigation.STATE_WS,0<n.length?e.setCurNode(E.ASTNode.createTopNode(n[0])):(o=new E.utils.Coordinate(100,100),t=E.ASTNode.createWorkspaceNode(t,o),e.setCurNode(t))},E.navigation.getFlyoutCursor_=function(){var t=E.navigation.getNavigationWorkspace(),e=null;return t.rendered&&(e=(t=(e=t.getToolbox())?e.getFlyout():t.getFlyout())?t.getWorkspace().getCursor():null),e},E.navigation.insertFromFlyout=function(){var t=E.navigation.getNavigationWorkspace(),e=t.getFlyout();if(e&&e.isVisible()){var o=E.navigation.getFlyoutCursor_().getCurNode().getLocation();o.isEnabled()?((e=e.createBlock(o)).render(),e.setConnectionTracking(!0),t.getCursor().setCurNode(E.ASTNode.createBlockNode(e)),E.navigation.modify_()||E.navigation.warn_("Something went wrong while inserting a block from the flyout."),E.navigation.focusWorkspace_(),t.getCursor().setCurNode(E.ASTNode.createTopNode(e)),E.navigation.removeMark_()):E.navigation.warn_("Can't insert a disabled block.")}else E.navigation.warn_("Trying to insert from the flyout when the flyout does not  exist or is not visible")},E.navigation.resetFlyout_=function(t){E.navigation.getFlyoutCursor_()&&(E.navigation.getFlyoutCursor_().hide(),t&&E.navigation.getNavigationWorkspace().getFlyout().hide())},E.navigation.modifyWarn_=function(){var t=E.navigation.getMarker().getCurNode(),e=E.navigation.getNavigationWorkspace().getCursor().getCurNode();return t?e?(t=t.getType(),e=e.getType(),t==E.ASTNode.types.FIELD?(E.navigation.warn_("Should not have been able to mark a field."),!1):t==E.ASTNode.types.BLOCK?(E.navigation.warn_("Should not have been able to mark a block."),!1):t==E.ASTNode.types.STACK?(E.navigation.warn_("Should not have been able to mark a stack."),!1):e==E.ASTNode.types.FIELD?(E.navigation.warn_("Cannot attach a field to anything else."),!1):e!=E.ASTNode.types.WORKSPACE||(E.navigation.warn_("Cannot attach a workspace to anything else."),!1)):(E.navigation.warn_("Cannot insert with no cursor node."),!1):(E.navigation.warn_("Cannot insert with no marked node."),!1)},E.navigation.moveBlockToWorkspace_=function(t,e){return!!t&&(t.isShadow()?(E.navigation.warn_("Cannot move a shadow block to the workspace."),!1):(t.getParent()&&t.unplug(!1),t.moveTo(e.getWsCoordinate()),!0))},E.navigation.modify_=function(){var t=E.navigation.getMarker().getCurNode(),e=E.navigation.getNavigationWorkspace().getCursor().getCurNode();if(!E.navigation.modifyWarn_())return!1;var o=t.getType(),n=e.getType(),i=e.getLocation(),r=t.getLocation();return t.isConnection()&&e.isConnection()?E.navigation.connect_(i,r):!t.isConnection()||n!=E.ASTNode.types.BLOCK&&n!=E.ASTNode.types.STACK?o==E.ASTNode.types.WORKSPACE?(e=e?e.getSourceBlock():null,E.navigation.moveBlockToWorkspace_(e,t)):(E.navigation.warn_("Unexpected state in Blockly.navigation.modify_."),!1):E.navigation.insertBlock(i,r)},E.navigation.disconnectChild_=function(t,e){var o=t.getSourceBlock(),n=e.getSourceBlock();o.getRootBlock()==n.getRootBlock()&&(-1<o.getDescendants(!1).indexOf(n)?E.navigation.getInferiorConnection_(e).disconnect():E.navigation.getInferiorConnection_(t).disconnect())},E.navigation.moveAndConnect_=function(t,e){if(!t||!e)return!1;var o=t.getSourceBlock();return!!t.getConnectionChecker().canConnect(t,e,!1)&&(E.navigation.disconnectChild_(t,e),e.isSuperior()||o.getRootBlock().positionNearConnection(t,e),e.connect(t),!0)},E.navigation.getInferiorConnection_=function(t){var e=t.getSourceBlock();return t.isSuperior()?e.previousConnection?e.previousConnection:e.outputConnection?e.outputConnection:null:t},E.navigation.getSuperiorConnection_=function(t){return t.isSuperior()?t:t.targetConnection?t.targetConnection:null},E.navigation.connect_=function(t,e){if(!t||!e)return!1;var o=E.navigation.getInferiorConnection_(t),n=E.navigation.getSuperiorConnection_(e),i=E.navigation.getSuperiorConnection_(t),r=E.navigation.getInferiorConnection_(e);return!!(o&&n&&E.navigation.moveAndConnect_(o,n)||i&&r&&E.navigation.moveAndConnect_(i,r)||E.navigation.moveAndConnect_(t,e))||(n=(o=t.getConnectionChecker()).canConnectWithReason(t,e,!1),E.navigation.warn_("Connection failed with error: "+o.getErrorMessage(n,t,e)),!1)},E.navigation.insertBlock=function(t,e){switch(e.type){case E.PREVIOUS_STATEMENT:if(E.navigation.connect_(t.nextConnection,e))return!0;break;case E.NEXT_STATEMENT:if(E.navigation.connect_(t.previousConnection,e))return!0;break;case E.INPUT_VALUE:if(E.navigation.connect_(t.outputConnection,e))return!0;break;case E.OUTPUT_VALUE:for(var o=0;o<t.inputList.length;o++){var n=t.inputList[o].connection;if(n&&n.type===E.INPUT_VALUE&&E.navigation.connect_(n,e))return!0}if(t.outputConnection&&E.navigation.connect_(t.outputConnection,e))return!0}return E.navigation.warn_("This block can not be inserted at the marked location."),!1},E.navigation.disconnectBlocks_=function(){var t=E.navigation.getNavigationWorkspace(),e=t.getCursor().getCurNode();if(e.isConnection()){var o=e.getLocation();o.isConnected()?(e=o.isSuperior()?o:o.targetConnection,(o=o.isSuperior()?o.targetConnection:o).getSourceBlock().isShadow()?E.navigation.log_("Cannot disconnect a shadow block"):(e.disconnect(),o.bumpAwayFrom(e),e.getSourceBlock().getRootBlock().bringToFront(),e=E.ASTNode.createConnectionNode(e),t.getCursor().setCurNode(e))):E.navigation.log_("Cannot disconnect unconnected connection")}else E.navigation.log_("Cannot disconnect blocks when the cursor is not on a connection")},E.navigation.markAtCursor_=function(){E.navigation.getMarker().setCurNode(E.navigation.getNavigationWorkspace().getCursor().getCurNode())},E.navigation.removeMark_=function(){var t=E.navigation.getMarker();t.setCurNode(null),t.hide()},E.navigation.setState=function(t){E.navigation.currentState_=t},E.navigation.moveCursorOnBlockDelete=function(t){var e=E.navigation.getNavigationWorkspace();if(e&&(e=e.getCursor())){var o=e.getCurNode();(o=o?o.getSourceBlock():null)===t?o.getParent()?(t=o.previousConnection||o.outputConnection)&&e.setCurNode(E.ASTNode.createConnectionNode(t.targetConnection)):e.setCurNode(E.ASTNode.createWorkspaceNode(o.workspace,o.getRelativeToSurfaceXY())):o&&-1<t.getChildren(!1).indexOf(o)&&e.setCurNode(E.ASTNode.createWorkspaceNode(o.workspace,o.getRelativeToSurfaceXY()))}},E.navigation.moveCursorOnBlockMutation=function(t){var e=E.navigation.getNavigationWorkspace().getCursor();if(e){var o=e.getCurNode();(o=o?o.getSourceBlock():null)===t&&e.setCurNode(E.ASTNode.createBlockNode(o))}},E.navigation.enableKeyboardAccessibility=function(){var t=E.navigation.getNavigationWorkspace();t.keyboardAccessibilityMode||(t.keyboardAccessibilityMode=!0,E.navigation.focusWorkspace_())},E.navigation.disableKeyboardAccessibility=function(){var t=E.navigation.getNavigationWorkspace();t.keyboardAccessibilityMode&&(t.keyboardAccessibilityMode=!1,t.getCursor().hide(),E.navigation.getMarker().hide(),E.navigation.getFlyoutCursor_()&&E.navigation.getFlyoutCursor_().hide())},E.navigation.log_=function(t){E.navigation.loggingCallback?E.navigation.loggingCallback("log",t):console.log(t)},E.navigation.warn_=function(t){E.navigation.loggingCallback?E.navigation.loggingCallback("warn",t):console.warn(t)},E.navigation.error_=function(t){E.navigation.loggingCallback?E.navigation.loggingCallback("error",t):console.error(t)},E.navigation.onKeyPress=function(t){return t=E.user.keyMap.serializeKeyEvent(t),!!(t=E.user.keyMap.getActionByKeyCode(t))&&E.navigation.onBlocklyAction(t)},E.navigation.onBlocklyAction=function(t){var e=E.navigation.getNavigationWorkspace(),o=e.options.readOnly,n=!1;return e.keyboardAccessibilityMode?o?-1<E.navigation.READONLY_ACTION_LIST.indexOf(t)&&(n=E.navigation.handleActions_(t)):n=E.navigation.handleActions_(t):t.name===E.navigation.actionNames.TOGGLE_KEYBOARD_NAV&&(E.navigation.enableKeyboardAccessibility(),n=!0),n},E.navigation.handleActions_=function(t){return t.name==E.navigation.actionNames.TOOLBOX||E.navigation.currentState_==E.navigation.STATE_TOOLBOX?E.navigation.toolboxOnAction_(t):t.name==E.navigation.actionNames.TOGGLE_KEYBOARD_NAV?(E.navigation.disableKeyboardAccessibility(),!0):E.navigation.currentState_==E.navigation.STATE_WS?E.navigation.workspaceOnAction_(t):E.navigation.currentState_==E.navigation.STATE_FLYOUT&&E.navigation.flyoutOnAction_(t)},E.navigation.flyoutOnAction_=function(t){var e=E.navigation.getNavigationWorkspace(),o=e.getToolbox();if((e=o?o.getFlyout():e.getFlyout())&&e.onBlocklyAction(t))return!0;switch(t.name){case E.navigation.actionNames.OUT:return E.navigation.focusToolbox_(),!0;case E.navigation.actionNames.MARK:return E.navigation.insertFromFlyout(),!0;case E.navigation.actionNames.EXIT:return E.navigation.focusWorkspace_(),!0;default:return!1}},E.navigation.toolboxOnAction_=function(t){var e=E.navigation.getNavigationWorkspace(),o=e.getToolbox();return!((!o||"function"!=typeof o.onBlocklyAction||!o.onBlocklyAction(t))&&(t.name===E.navigation.actionNames.TOOLBOX?(e.getToolbox()?E.navigation.focusToolbox_():E.navigation.focusFlyout_(),0):t.name===E.navigation.actionNames.IN?(E.navigation.focusFlyout_(),0):t.name!==E.navigation.actionNames.EXIT||(E.navigation.focusWorkspace_(),0)))},E.navigation.moveWSCursor_=function(t,e){var o=E.navigation.getNavigationWorkspace(),n=o.getCursor(),i=o.getCursor().getCurNode();return i.getType()===E.ASTNode.types.WORKSPACE&&(i=i.getWsCoordinate(),n.setCurNode(E.ASTNode.createWorkspaceNode(o,new E.utils.Coordinate(t*E.navigation.WS_MOVE_DISTANCE+i.x,e*E.navigation.WS_MOVE_DISTANCE+i.y))),!0)},E.navigation.workspaceOnAction_=function(t){if(E.navigation.getNavigationWorkspace().getCursor().onBlocklyAction(t))return!0;switch(t.name){case E.navigation.actionNames.INSERT:return E.navigation.modify_(),!0;case E.navigation.actionNames.MARK:return E.navigation.handleEnterForWS_(),!0;case E.navigation.actionNames.DISCONNECT:return E.navigation.disconnectBlocks_(),!0;case E.navigation.actionNames.MOVE_WS_CURSOR_UP:return E.navigation.moveWSCursor_(0,-1);case E.navigation.actionNames.MOVE_WS_CURSOR_DOWN:return E.navigation.moveWSCursor_(0,1);case E.navigation.actionNames.MOVE_WS_CURSOR_LEFT:return E.navigation.moveWSCursor_(-1,0);case E.navigation.actionNames.MOVE_WS_CURSOR_RIGHT:return E.navigation.moveWSCursor_(1,0);default:return!1}},E.navigation.handleEnterForWS_=function(){var t=E.navigation.getNavigationWorkspace().getCursor().getCurNode(),e=t.getType();e==E.ASTNode.types.FIELD?t.getLocation().showEditor():t.isConnection()||e==E.ASTNode.types.WORKSPACE?E.navigation.markAtCursor_():e==E.ASTNode.types.BLOCK?E.navigation.warn_("Cannot mark a block."):e==E.ASTNode.types.STACK&&E.navigation.warn_("Cannot mark a stack.")},E.navigation.ACTION_PREVIOUS=new E.Action(E.navigation.actionNames.PREVIOUS,"Go to the previous location."),E.navigation.ACTION_OUT=new E.Action(E.navigation.actionNames.OUT,"Go to the parent of the current location."),E.navigation.ACTION_NEXT=new E.Action(E.navigation.actionNames.NEXT,"Go to the next location."),E.navigation.ACTION_IN=new E.Action(E.navigation.actionNames.IN,"Go to the first child of the current location."),E.navigation.ACTION_INSERT=new E.Action(E.navigation.actionNames.INSERT,"Connect the current location to the marked location."),E.navigation.ACTION_MARK=new E.Action(E.navigation.actionNames.MARK,"Mark the current location."),E.navigation.ACTION_DISCONNECT=new E.Action(E.navigation.actionNames.DISCONNECT,"Disconnect the block at the current location from its parent."),E.navigation.ACTION_TOOLBOX=new E.Action(E.navigation.actionNames.TOOLBOX,"Open the toolbox."),E.navigation.ACTION_EXIT=new E.Action(E.navigation.actionNames.EXIT,"Close the current modal, such as a toolbox or field editor."),E.navigation.ACTION_TOGGLE_KEYBOARD_NAV=new E.Action(E.navigation.actionNames.TOGGLE_KEYBOARD_NAV,"Turns on and off keyboard navigation."),E.navigation.ACTION_MOVE_WS_CURSOR_LEFT=new E.Action(E.navigation.actionNames.MOVE_WS_CURSOR_LEFT,"Move the workspace cursor to the lefts."),E.navigation.ACTION_MOVE_WS_CURSOR_RIGHT=new E.Action(E.navigation.actionNames.MOVE_WS_CURSOR_RIGHT,"Move the workspace cursor to the right."),E.navigation.ACTION_MOVE_WS_CURSOR_UP=new E.Action(E.navigation.actionNames.MOVE_WS_CURSOR_UP,"Move the workspace cursor up."),E.navigation.ACTION_MOVE_WS_CURSOR_DOWN=new E.Action(E.navigation.actionNames.MOVE_WS_CURSOR_DOWN,"Move the workspace cursor down."),E.navigation.READONLY_ACTION_LIST=[E.navigation.ACTION_PREVIOUS,E.navigation.ACTION_OUT,E.navigation.ACTION_IN,E.navigation.ACTION_NEXT,E.navigation.ACTION_TOGGLE_KEYBOARD_NAV],E.Gesture=function(t,e){this.mouseDownXY_=null,this.currentDragDeltaXY_=new E.utils.Coordinate(0,0),this.startWorkspace_=this.targetBlock_=this.startBlock_=this.startField_=this.startBubble_=null,this.creatorWorkspace_=e,this.isDraggingBubble_=this.isDraggingBlock_=this.isDraggingWorkspace_=this.hasExceededDragRadius_=!1,this.mostRecentEvent_=t,this.flyout_=this.workspaceDragger_=this.blockDragger_=this.bubbleDragger_=this.onUpWrapper_=this.onMoveWrapper_=null,this.isEnding_=this.hasStarted_=this.calledUpdateIsDragging_=!1,this.healStack_=!E.DRAG_STACK},E.Gesture.prototype.dispose=function(){E.Touch.clearTouchIdentifier(),E.Tooltip.unblock(),this.creatorWorkspace_.clearGesture(),this.onMoveWrapper_&&E.unbindEvent_(this.onMoveWrapper_),this.onUpWrapper_&&E.unbindEvent_(this.onUpWrapper_),this.blockDragger_&&this.blockDragger_.dispose(),this.workspaceDragger_&&this.workspaceDragger_.dispose(),this.bubbleDragger_&&this.bubbleDragger_.dispose()},E.Gesture.prototype.updateFromEvent_=function(t){var e=new E.utils.Coordinate(t.clientX,t.clientY);this.updateDragDelta_(e)&&(this.updateIsDragging_(),E.longStop_()),this.mostRecentEvent_=t},E.Gesture.prototype.updateDragDelta_=function(t){return this.currentDragDeltaXY_=E.utils.Coordinate.difference(t,this.mouseDownXY_),!this.hasExceededDragRadius_&&(this.hasExceededDragRadius_=E.utils.Coordinate.magnitude(this.currentDragDeltaXY_)>(this.flyout_?E.FLYOUT_DRAG_RADIUS:E.DRAG_RADIUS))},E.Gesture.prototype.updateIsDraggingFromFlyout_=function(){return!(!this.targetBlock_||!this.flyout_.isBlockCreatable_(this.targetBlock_)||this.flyout_.isScrollable()&&!this.flyout_.isDragTowardWorkspace(this.currentDragDeltaXY_)||(this.startWorkspace_=this.flyout_.targetWorkspace,this.startWorkspace_.updateScreenCalculationsIfScrolled(),E.Events.getGroup()||E.Events.setGroup(!0),this.startBlock_=null,this.targetBlock_=this.flyout_.createBlock(this.targetBlock_),this.targetBlock_.select(),0))},E.Gesture.prototype.updateIsDraggingBubble_=function(){return!!this.startBubble_&&(this.isDraggingBubble_=!0,this.startDraggingBubble_(),!0)},E.Gesture.prototype.updateIsDraggingBlock_=function(){return!!this.targetBlock_&&(this.flyout_?this.isDraggingBlock_=this.updateIsDraggingFromFlyout_():this.targetBlock_.isMovable()&&(this.isDraggingBlock_=!0),!!this.isDraggingBlock_&&(this.startDraggingBlock_(),!0))},E.Gesture.prototype.updateIsDraggingWorkspace_=function(){(this.flyout_?this.flyout_.isScrollable():this.startWorkspace_&&this.startWorkspace_.isDraggable())&&(this.workspaceDragger_=this.flyout_?new E.FlyoutDragger(this.flyout_):new E.WorkspaceDragger(this.startWorkspace_),this.isDraggingWorkspace_=!0,this.workspaceDragger_.startDrag())},E.Gesture.prototype.updateIsDragging_=function(){if(this.calledUpdateIsDragging_)throw Error("updateIsDragging_ should only be called once per gesture.");this.calledUpdateIsDragging_=!0,this.updateIsDraggingBubble_()||this.updateIsDraggingBlock_()||this.updateIsDraggingWorkspace_()},E.Gesture.prototype.startDraggingBlock_=function(){this.blockDragger_=new E.BlockDragger(this.targetBlock_,this.startWorkspace_),this.blockDragger_.startBlockDrag(this.currentDragDeltaXY_,this.healStack_),this.blockDragger_.dragBlock(this.mostRecentEvent_,this.currentDragDeltaXY_)},E.Gesture.prototype.startDraggingBubble_=function(){this.bubbleDragger_=new E.BubbleDragger(this.startBubble_,this.startWorkspace_),this.bubbleDragger_.startBubbleDrag(),this.bubbleDragger_.dragBubble(this.mostRecentEvent_,this.currentDragDeltaXY_)},E.Gesture.prototype.doStart=function(t){E.utils.isTargetInput(t)?this.cancel():(this.hasStarted_=!0,E.blockAnimations.disconnectUiStop(),this.startWorkspace_.updateScreenCalculationsIfScrolled(),this.startWorkspace_.isMutator&&this.startWorkspace_.resize(),E.hideChaff(!!this.flyout_),this.startWorkspace_.markFocused(),this.mostRecentEvent_=t,E.Tooltip.block(),this.targetBlock_&&(!this.targetBlock_.isInFlyout&&t.shiftKey&&this.targetBlock_.workspace.keyboardAccessibilityMode?this.creatorWorkspace_.getCursor().setCurNode(E.ASTNode.createTopNode(this.targetBlock_)):this.targetBlock_.select()),E.utils.isRightButton(t)?this.handleRightClick(t):("touchstart"!=t.type.toLowerCase()&&"pointerdown"!=t.type.toLowerCase()||"mouse"==t.pointerType||E.longStart(t,this),this.mouseDownXY_=new E.utils.Coordinate(t.clientX,t.clientY),this.healStack_=t.altKey||t.ctrlKey||t.metaKey,this.bindMouseEvents(t)))},E.Gesture.prototype.bindMouseEvents=function(t){this.onMoveWrapper_=E.bindEventWithChecks_(document,"mousemove",null,this.handleMove.bind(this)),this.onUpWrapper_=E.bindEventWithChecks_(document,"mouseup",null,this.handleUp.bind(this)),t.preventDefault(),t.stopPropagation()},E.Gesture.prototype.handleMove=function(t){this.updateFromEvent_(t),this.isDraggingWorkspace_?this.workspaceDragger_.drag(this.currentDragDeltaXY_):this.isDraggingBlock_?this.blockDragger_.dragBlock(this.mostRecentEvent_,this.currentDragDeltaXY_):this.isDraggingBubble_&&this.bubbleDragger_.dragBubble(this.mostRecentEvent_,this.currentDragDeltaXY_),t.preventDefault(),t.stopPropagation()},E.Gesture.prototype.handleUp=function(t){this.updateFromEvent_(t),E.longStop_(),this.isEnding_?console.log("Trying to end a gesture recursively."):(this.isEnding_=!0,this.isDraggingBubble_?this.bubbleDragger_.endBubbleDrag(t,this.currentDragDeltaXY_):this.isDraggingBlock_?this.blockDragger_.endBlockDrag(t,this.currentDragDeltaXY_):this.isDraggingWorkspace_?this.workspaceDragger_.endDrag(this.currentDragDeltaXY_):this.isBubbleClick_()?this.doBubbleClick_():this.isFieldClick_()?this.doFieldClick_():this.isBlockClick_()?this.doBlockClick_():this.isWorkspaceClick_()&&this.doWorkspaceClick_(t),t.preventDefault(),t.stopPropagation(),this.dispose())},E.Gesture.prototype.cancel=function(){this.isEnding_||(E.longStop_(),this.isDraggingBubble_?this.bubbleDragger_.endBubbleDrag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.isDraggingBlock_?this.blockDragger_.endBlockDrag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.isDraggingWorkspace_&&this.workspaceDragger_.endDrag(this.currentDragDeltaXY_),this.dispose())},E.Gesture.prototype.handleRightClick=function(t){this.targetBlock_?(this.bringBlockToFront_(),E.hideChaff(!!this.flyout_),this.targetBlock_.showContextMenu(t)):this.startBubble_?this.startBubble_.showContextMenu(t):this.startWorkspace_&&!this.flyout_&&(E.hideChaff(),this.startWorkspace_.showContextMenu(t)),t.preventDefault(),t.stopPropagation(),this.dispose()},E.Gesture.prototype.handleWsStart=function(t,e){if(this.hasStarted_)throw Error("Tried to call gesture.handleWsStart, but the gesture had already been started.");this.setStartWorkspace_(e),this.mostRecentEvent_=t,this.doStart(t),this.startWorkspace_.keyboardAccessibilityMode&&E.navigation.setState(E.navigation.STATE_WS)},E.Gesture.prototype.fireWorkspaceClick_=function(t){var e=new E.Events.Ui(null,"click",null,"workspace");e.workspaceId=t.id,E.Events.fire(e)},E.Gesture.prototype.handleFlyoutStart=function(t,e){if(this.hasStarted_)throw Error("Tried to call gesture.handleFlyoutStart, but the gesture had already been started.");this.setStartFlyout_(e),this.handleWsStart(t,e.getWorkspace())},E.Gesture.prototype.handleBlockStart=function(t,e){if(this.hasStarted_)throw Error("Tried to call gesture.handleBlockStart, but the gesture had already been started.");this.setStartBlock(e),this.mostRecentEvent_=t},E.Gesture.prototype.handleBubbleStart=function(t,e){if(this.hasStarted_)throw Error("Tried to call gesture.handleBubbleStart, but the gesture had already been started.");this.setStartBubble(e),this.mostRecentEvent_=t},E.Gesture.prototype.doBubbleClick_=function(){this.startBubble_.setFocus&&this.startBubble_.setFocus(),this.startBubble_.select&&this.startBubble_.select()},E.Gesture.prototype.doFieldClick_=function(){this.startField_.showEditor(this.mostRecentEvent_),this.bringBlockToFront_()},E.Gesture.prototype.doBlockClick_=function(){this.flyout_&&this.flyout_.autoClose?this.targetBlock_.isEnabled()&&(E.Events.getGroup()||E.Events.setGroup(!0),this.flyout_.createBlock(this.targetBlock_).scheduleSnapAndBump()):E.Events.fire(new E.Events.Ui(this.startBlock_,"click",void 0,"block")),this.bringBlockToFront_(),E.Events.setGroup(!1)},E.Gesture.prototype.doWorkspaceClick_=function(t){var e=this.creatorWorkspace_;t.shiftKey&&e.keyboardAccessibilityMode?(t=new E.utils.Coordinate(t.clientX,t.clientY),t=E.utils.screenToWsCoordinates(e,t),t=E.ASTNode.createWorkspaceNode(e,t),e.getCursor().setCurNode(t)):E.selected&&E.selected.unselect(),this.fireWorkspaceClick_(this.startWorkspace_||e)},E.Gesture.prototype.bringBlockToFront_=function(){this.targetBlock_&&!this.flyout_&&this.targetBlock_.bringToFront()},E.Gesture.prototype.setStartField=function(t){if(this.hasStarted_)throw Error("Tried to call gesture.setStartField, but the gesture had already been started.");this.startField_||(this.startField_=t)},E.Gesture.prototype.setStartBubble=function(t){this.startBubble_||(this.startBubble_=t)},E.Gesture.prototype.setStartBlock=function(t){this.startBlock_||this.startBubble_||((this.startBlock_=t).isInFlyout&&t!=t.getRootBlock()?this.setTargetBlock_(t.getRootBlock()):this.setTargetBlock_(t))},E.Gesture.prototype.setTargetBlock_=function(t){t.isShadow()?this.setTargetBlock_(t.getParent()):this.targetBlock_=t},E.Gesture.prototype.setStartWorkspace_=function(t){this.startWorkspace_||(this.startWorkspace_=t)},E.Gesture.prototype.setStartFlyout_=function(t){this.flyout_||(this.flyout_=t)},E.Gesture.prototype.isBubbleClick_=function(){return!!this.startBubble_&&!this.hasExceededDragRadius_},E.Gesture.prototype.isBlockClick_=function(){return!!this.startBlock_&&!this.hasExceededDragRadius_&&!this.isFieldClick_()},E.Gesture.prototype.isFieldClick_=function(){return!!this.startField_&&this.startField_.isClickable()&&!this.hasExceededDragRadius_&&(!this.flyout_||!this.flyout_.autoClose)},E.Gesture.prototype.isWorkspaceClick_=function(){return!(this.startBlock_||this.startBubble_||this.startField_||this.hasExceededDragRadius_)},E.Gesture.prototype.isDragging=function(){return this.isDraggingWorkspace_||this.isDraggingBlock_||this.isDraggingBubble_},E.Gesture.prototype.hasStarted=function(){return this.hasStarted_},E.Gesture.prototype.getInsertionMarkers=function(){return this.blockDragger_?this.blockDragger_.getInsertionMarkers():[]},E.Gesture.inProgress=function(){for(var t,e=E.Workspace.getAll(),o=0;t=e[o];o++)if(t.currentGesture_)return!0;return!1},E.Field=function(t,e,o){this.value_=this.DEFAULT_VALUE,this.tooltip_=this.validator_=null,this.size_=new E.utils.Size(0,0),this.constants_=this.mouseDownWrapper_=this.textContent_=this.textElement_=this.borderRect_=this.fieldGroup_=this.markerSvg_=this.cursorSvg_=null,o&&this.configure_(o),this.setValue(t),e&&this.setValidator(e)},E.Field.prototype.DEFAULT_VALUE=null,E.Field.prototype.name=void 0,E.Field.prototype.disposed=!1,E.Field.prototype.maxDisplayLength=50,E.Field.prototype.sourceBlock_=null,E.Field.prototype.isDirty_=!0,E.Field.prototype.visible_=!0,E.Field.prototype.clickTarget_=null,E.Field.NBSP="",E.Field.prototype.EDITABLE=!0,E.Field.prototype.SERIALIZABLE=!1,E.Field.prototype.configure_=function(t){var e=t.tooltip;"string"==typeof e&&(e=E.utils.replaceMessageReferences(t.tooltip)),e&&this.setTooltip(e)},E.Field.prototype.setSourceBlock=function(t){if(this.sourceBlock_)throw Error("Field already bound to a block.");this.sourceBlock_=t},E.Field.prototype.getConstants=function(){return!this.constants_&&this.sourceBlock_&&this.sourceBlock_.workspace&&this.sourceBlock_.workspace.rendered&&(this.constants_=this.sourceBlock_.workspace.getRenderer().getConstants()),this.constants_},E.Field.prototype.getSourceBlock=function(){return this.sourceBlock_},E.Field.prototype.init=function(){this.fieldGroup_||(this.fieldGroup_=E.utils.dom.createSvgElement(E.utils.Svg.G,{},null),this.isVisible()||(this.fieldGroup_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.initView(),this.updateEditable(),this.setTooltip(this.tooltip_),this.bindEvents_(),this.initModel())},E.Field.prototype.initView=function(){this.createBorderRect_(),this.createTextElement_()},E.Field.prototype.initModel=function(){},E.Field.prototype.createBorderRect_=function(){this.borderRect_=E.utils.dom.createSvgElement(E.utils.Svg.RECT,{rx:this.getConstants().FIELD_BORDER_RECT_RADIUS,ry:this.getConstants().FIELD_BORDER_RECT_RADIUS,x:0,y:0,height:this.size_.height,width:this.size_.width,class:"blocklyFieldRect"},this.fieldGroup_)},E.Field.prototype.createTextElement_=function(){this.textElement_=E.utils.dom.createSvgElement(E.utils.Svg.TEXT,{class:"blocklyText"},this.fieldGroup_),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.textElement_.setAttribute("dominant-baseline","central"),this.textContent_=document.createTextNode(""),this.textElement_.appendChild(this.textContent_)},E.Field.prototype.bindEvents_=function(){E.Tooltip.bindMouseEvents(this.getClickTarget_()),this.mouseDownWrapper_=E.bindEventWithChecks_(this.getClickTarget_(),"mousedown",this,this.onMouseDown_)},E.Field.prototype.fromXml=function(t){this.setValue(t.textContent)},E.Field.prototype.toXml=function(t){return t.textContent=this.getValue(),t},E.Field.prototype.dispose=function(){E.DropDownDiv.hideIfOwner(this),E.WidgetDiv.hideIfOwner(this),E.Tooltip.unbindMouseEvents(this.getClickTarget_()),this.mouseDownWrapper_&&E.unbindEvent_(this.mouseDownWrapper_),E.utils.dom.removeNode(this.fieldGroup_),this.disposed=!0},E.Field.prototype.updateEditable=function(){var t=this.fieldGroup_;this.EDITABLE&&t&&(this.sourceBlock_.isEditable()?(E.utils.dom.addClass(t,"blocklyEditableText"),E.utils.dom.removeClass(t,"blocklyNonEditableText"),t.style.cursor=this.CURSOR):(E.utils.dom.addClass(t,"blocklyNonEditableText"),E.utils.dom.removeClass(t,"blocklyEditableText"),t.style.cursor=""))},E.Field.prototype.isClickable=function(){return!!this.sourceBlock_&&this.sourceBlock_.isEditable()&&!!this.showEditor_&&"function"==typeof this.showEditor_},E.Field.prototype.isCurrentlyEditable=function(){return this.EDITABLE&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()},E.Field.prototype.isSerializable=function(){var t=!1;return this.name&&(this.SERIALIZABLE?t=!0:this.EDITABLE&&(console.warn("Detected an editable field that was not serializable. Please define SERIALIZABLE property as true on all editable custom fields. Proceeding with serialization."),t=!0)),t},E.Field.prototype.isVisible=function(){return this.visible_},E.Field.prototype.setVisible=function(t){if(this.visible_!=t){this.visible_=t;var e=this.getSvgRoot();e&&(e.style.display=t?"block":"none")}},E.Field.prototype.setValidator=function(t){this.validator_=t},E.Field.prototype.getValidator=function(){return this.validator_},E.Field.prototype.classValidator=function(t){return E.utils.deprecation.warn("Field.prototype.classValidator","May 2019","December 2020","Blockly.Field.prototype.doClassValidation_"),t},E.Field.prototype.callValidator=function(t){E.utils.deprecation.warn("Field.prototype.callValidator","May 2019","December 2020");var e=this.classValidator(t);if(null===e)return null;if(void 0!==e&&(t=e),e=this.getValidator()){if(null===(e=e.call(this,t)))return null;void 0!==e&&(t=e)}return t},E.Field.prototype.getSvgRoot=function(){return this.fieldGroup_},E.Field.prototype.applyColour=function(){},E.Field.prototype.render_=function(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_()},E.Field.prototype.showEditor=function(t){this.isClickable()&&this.showEditor_(t)},E.Field.prototype.updateWidth=function(){E.utils.deprecation.warn("Field.prototype.updateWidth","May 2019","December 2020","Blockly.Field.prototype.updateSize_ or Blockly.utils.dom.getTextWidth"),this.updateSize_()},E.Field.prototype.updateSize_=function(t){var e=this.getConstants(),o=2*(t=null!=t?t:this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0),n=e.FIELD_TEXT_HEIGHT,i=0;this.textElement_&&(o+=i=E.utils.dom.getFastTextWidth(this.textElement_,e.FIELD_TEXT_FONTSIZE,e.FIELD_TEXT_FONTWEIGHT,e.FIELD_TEXT_FONTFAMILY)),this.borderRect_&&(n=Math.max(n,e.FIELD_BORDER_RECT_HEIGHT)),this.size_.height=n,this.size_.width=o,this.positionTextElement_(t,i),this.positionBorderRect_()},E.Field.prototype.positionTextElement_=function(t,e){if(this.textElement_){var o=this.getConstants(),n=this.size_.height/2;this.textElement_.setAttribute("x",this.sourceBlock_.RTL?this.size_.width-e-t:t),this.textElement_.setAttribute("y",o.FIELD_TEXT_BASELINE_CENTER?n:n-o.FIELD_TEXT_HEIGHT/2+o.FIELD_TEXT_BASELINE)}},E.Field.prototype.positionBorderRect_=function(){this.borderRect_&&(this.borderRect_.setAttribute("width",this.size_.width),this.borderRect_.setAttribute("height",this.size_.height),this.borderRect_.setAttribute("rx",this.getConstants().FIELD_BORDER_RECT_RADIUS),this.borderRect_.setAttribute("ry",this.getConstants().FIELD_BORDER_RECT_RADIUS))},E.Field.prototype.getSize=function(){return this.isVisible()?(this.isDirty_?(this.render_(),this.isDirty_=!1):this.visible_&&0==this.size_.width&&(console.warn("Deprecated use of setting size_.width to 0 to rerender a field. Set field.isDirty_ to true instead."),this.render_()),this.size_):new E.utils.Size(0,0)},E.Field.prototype.getScaledBBox=function(){if(this.borderRect_)t=this.borderRect_.getBoundingClientRect(),o=E.utils.style.getPageOffset(this.borderRect_),n=t.width,t=t.height;else{var t=this.sourceBlock_.getHeightWidth(),e=this.sourceBlock_.workspace.scale,o=this.getAbsoluteXY_(),n=t.width*e;t=t.height*e,E.utils.userAgent.GECKO?(o.x+=1.5*e,o.y+=1.5*e):E.utils.userAgent.EDGE||E.utils.userAgent.IE||(o.x-=.5*e,o.y-=.5*e),n+=1*e,t+=1*e}return new E.utils.Rect(o.y,o.y+t,o.x,o.x+n)},E.Field.prototype.getDisplayText_=function(){var t=this.getText();return t?(t.length>this.maxDisplayLength&&(t=t.substring(0,this.maxDisplayLength-2)+""),t=t.replace(/\s/g,E.Field.NBSP),this.sourceBlock_&&this.sourceBlock_.RTL&&(t+=""),t):E.Field.NBSP},E.Field.prototype.getText=function(){if(this.getText_){var t=this.getText_.call(this);if(null!==t)return String(t)}return String(this.getValue())},E.Field.prototype.setText=function(t){throw E.utils.deprecation.warn("Field.prototype.setText","May 2019","December 2020","Blockly.Field.prototype.setValue"),Error("setText method is deprecated")},E.Field.prototype.markDirty=function(){this.isDirty_=!0,this.constants_=null},E.Field.prototype.forceRerender=function(){this.isDirty_=!0,this.sourceBlock_&&this.sourceBlock_.rendered&&(this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours(),this.updateMarkers_())},E.Field.prototype.setValue=function(t){if(null!==t){var e=this.doClassValidation_(t);if(!((t=this.processValidation_(t,e))instanceof Error)){if((e=this.getValidator())&&(e=e.call(this,t),(t=this.processValidation_(t,e))instanceof Error))return;if(!(e=this.sourceBlock_)||!e.disposed){var o=this.getValue();o!==t&&(e&&E.Events.isEnabled()&&E.Events.fire(new E.Events.BlockChange(e,"field",this.name||null,o,t)),this.doValueUpdate_(t),this.isDirty_&&this.forceRerender())}}}},E.Field.prototype.processValidation_=function(t,e){return null===e?(this.doValueInvalid_(t),this.isDirty_&&this.forceRerender(),Error()):(void 0!==e&&(t=e),t)},E.Field.prototype.getValue=function(){return this.value_},E.Field.prototype.doClassValidation_=function(t){return null==t?null:t=this.classValidator(t)},E.Field.prototype.doValueUpdate_=function(t){this.value_=t,this.isDirty_=!0},E.Field.prototype.doValueInvalid_=function(t){},E.Field.prototype.onMouseDown_=function(t){this.sourceBlock_&&this.sourceBlock_.workspace&&(t=this.sourceBlock_.workspace.getGesture(t))&&t.setStartField(this)},E.Field.prototype.setTooltip=function(t){t||""===t||(t=this.sourceBlock_);var e=this.getClickTarget_();e?e.tooltip=t:this.tooltip_=t},E.Field.prototype.getTooltip=function(){var t=this.getClickTarget_();return t?E.Tooltip.getTooltipOfObject(t):E.Tooltip.getTooltipOfObject({tooltip:this.tooltip_})},E.Field.prototype.getClickTarget_=function(){return this.clickTarget_||this.getSvgRoot()},E.Field.prototype.getAbsoluteXY_=function(){return E.utils.style.getPageOffset(this.getClickTarget_())},E.Field.prototype.referencesVariables=function(){return!1},E.Field.prototype.getParentInput=function(){for(var t=null,e=this.sourceBlock_,o=e.inputList,n=0;n<e.inputList.length;n++)for(var i=o[n],r=i.fieldRow,s=0;s<r.length;s++)if(r[s]===this){t=i;break}return t},E.Field.prototype.getFlipRtl=function(){return!1},E.Field.prototype.isTabNavigable=function(){return!1},E.Field.prototype.onBlocklyAction=function(t){return!1},E.Field.prototype.setCursorSvg=function(t){t?(this.fieldGroup_.appendChild(t),this.cursorSvg_=t):this.cursorSvg_=null},E.Field.prototype.setMarkerSvg=function(t){t?(this.fieldGroup_.appendChild(t),this.markerSvg_=t):this.markerSvg_=null},E.Field.prototype.updateMarkers_=function(){var t=this.sourceBlock_.workspace;t.keyboardAccessibilityMode&&this.cursorSvg_&&t.getCursor().draw(),t.keyboardAccessibilityMode&&this.markerSvg_&&t.getMarker(E.navigation.MARKER_NAME).draw()},E.FieldLabel=function(t,e,o){this.class_=null,E.FieldLabel.superClass_.constructor.call(this,t,null,o),o||(this.class_=e||null)},E.utils.object.inherits(E.FieldLabel,E.Field),E.FieldLabel.prototype.DEFAULT_VALUE="",E.FieldLabel.fromJson=function(t){var e=E.utils.replaceMessageReferences(t.text);return new E.FieldLabel(e,void 0,t)},E.FieldLabel.prototype.EDITABLE=!1,E.FieldLabel.prototype.configure_=function(t){E.FieldLabel.superClass_.configure_.call(this,t),this.class_=t.class},E.FieldLabel.prototype.initView=function(){this.createTextElement_(),this.class_&&E.utils.dom.addClass(this.textElement_,this.class_)},E.FieldLabel.prototype.doClassValidation_=function(t){return null==t?null:String(t)},E.FieldLabel.prototype.setClass=function(t){this.textElement_&&(this.class_&&E.utils.dom.removeClass(this.textElement_,this.class_),t&&E.utils.dom.addClass(this.textElement_,t)),this.class_=t},E.fieldRegistry.register("field_label",E.FieldLabel),E.Input=function(t,e,o,n){if(t!=E.DUMMY_INPUT&&!e)throw Error("Value inputs and statement inputs must have non-empty name.");this.type=t,this.name=e,this.sourceBlock_=o,this.connection=n,this.fieldRow=[]},E.Input.prototype.align=E.ALIGN_LEFT,E.Input.prototype.visible_=!0,E.Input.prototype.getSourceBlock=function(){return this.sourceBlock_},E.Input.prototype.appendField=function(t,e){return this.insertFieldAt(this.fieldRow.length,t,e),this},E.Input.prototype.insertFieldAt=function(t,e,o){if(t<0||t>this.fieldRow.length)throw Error("index "+t+" out of bounds.");return(e||""==e&&o)&&("string"==typeof e&&(e=new E.FieldLabel(e)),e.setSourceBlock(this.sourceBlock_),this.sourceBlock_.rendered&&(e.init(),e.applyColour()),e.name=o,e.setVisible(this.isVisible()),(o=e).prefixField&&(t=this.insertFieldAt(t,o.prefixField)),this.fieldRow.splice(t,0,e),++t,o.suffixField&&(t=this.insertFieldAt(t,o.suffixField)),this.sourceBlock_.rendered&&(this.sourceBlock_=this.sourceBlock_,this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours())),t},E.Input.prototype.removeField=function(t,e){for(var o,n=0;o=this.fieldRow[n];n++)if(o.name===t)return o.dispose(),this.fieldRow.splice(n,1),this.sourceBlock_.rendered&&(this.sourceBlock_=this.sourceBlock_,this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours()),!0;if(e)return!1;throw Error('Field "'+t+'" not found.')},E.Input.prototype.isVisible=function(){return this.visible_},E.Input.prototype.setVisible=function(t){var e=[];if(this.visible_==t)return e;this.visible_=t;for(var o,n=0;o=this.fieldRow[n];n++)o.setVisible(t);return this.connection&&(this.connection=this.connection,t?e=this.connection.startTrackingAll():this.connection.stopTrackingAll(),n=this.connection.targetBlock())&&(n.getSvgRoot().style.display=t?"block":"none"),e},E.Input.prototype.markDirty=function(){for(var t,e=0;t=this.fieldRow[e];e++)t.markDirty()},E.Input.prototype.setCheck=function(t){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setCheck(t),this},E.Input.prototype.setAlign=function(t){return this.align=t,this.sourceBlock_.rendered&&(this.sourceBlock_=this.sourceBlock_,this.sourceBlock_.render()),this},E.Input.prototype.setShadowDom=function(t){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setShadowDom(t),this},E.Input.prototype.getShadowDom=function(){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.getShadowDom()},E.Input.prototype.init=function(){if(this.sourceBlock_.workspace.rendered)for(var t=0;t<this.fieldRow.length;t++)this.fieldRow[t].init()},E.Input.prototype.dispose=function(){for(var t,e=0;t=this.fieldRow[e];e++)t.dispose();this.connection&&this.connection.dispose(),this.sourceBlock_=null},E.Block=function(t,e,o){if(E.Generator&&void 0!==E.Generator.prototype[e])throw Error('Block prototypeName "'+e+'" conflicts with Blockly.Generator members.');if(this.id=o&&!t.getBlockById(o)?o:E.utils.genUid(),t.setBlockById(this.id,this),this.previousConnection=this.nextConnection=this.outputConnection=null,this.inputList=[],this.inputsInline=void 0,this.disabled=!1,this.tooltip="",this.contextMenu=!0,this.parentBlock_=null,this.childBlocks_=[],this.editable_=this.movable_=this.deletable_=!0,this.collapsed_=this.isShadow_=!1,this.comment=this.outputShape_=null,this.commentModel={text:null,pinned:!1,size:new E.utils.Size(160,80)},this.xy_=new E.utils.Coordinate(0,0),this.workspace=t,this.isInFlyout=t.isFlyout,this.isInMutator=t.isMutator,this.RTL=t.RTL,this.isInsertionMarker_=!1,this.hat=void 0,this.rendered=null,this.statementInputCount=0,e){if(this.type=e,!(o=E.Blocks[e])||"object"!=typeof o)throw TypeError("Unknown block type: "+e);E.utils.object.mixin(this,o)}t.addTopBlock(this),t.addTypedBlock(this),(t=E.Events.getGroup())||E.Events.setGroup(!0),e=E.Events.recordUndo;try{"function"==typeof this.init&&(E.Events.recordUndo=!1,this.init(),E.Events.recordUndo=e),E.Events.isEnabled()&&E.Events.fire(new E.Events.BlockCreate(this))}finally{t||E.Events.setGroup(!1),E.Events.recordUndo=e}this.inputsInlineDefault=this.inputsInline,"function"==typeof this.onchange&&this.setOnChange(this.onchange)},E.Block.COLLAPSED_INPUT_NAME="_TEMP_COLLAPSED_INPUT",E.Block.COLLAPSED_FIELD_NAME="_TEMP_COLLAPSED_FIELD",E.Block.prototype.data=null,E.Block.prototype.disposed=!1,E.Block.prototype.hue_=null,E.Block.prototype.colour_="#000000",E.Block.prototype.styleName_=null,E.Block.prototype.dispose=function(t){if(this.workspace){this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.unplug(t),E.Events.isEnabled()&&E.Events.fire(new E.Events.BlockDelete(this)),E.Events.disable();try{this.workspace&&(this.workspace.removeTopBlock(this),this.workspace.removeTypedBlock(this),this.workspace.removeBlockById(this.id),this.workspace=null),E.selected==this&&(E.selected=null);for(var e=this.childBlocks_.length-1;0<=e;e--)this.childBlocks_[e].dispose(!1);e=0;for(var o;o=this.inputList[e];e++)o.dispose();this.inputList.length=0;var n,i=this.getConnections_(!0);for(e=0;n=i[e];e++)n.dispose()}finally{E.Events.enable(),this.disposed=!0}}},E.Block.prototype.initModel=function(){for(var t,e=0;t=this.inputList[e];e++)for(var o,n=0;o=t.fieldRow[n];n++)o.initModel&&o.initModel()},E.Block.prototype.unplug=function(t){this.outputConnection?this.unplugFromRow_(t):this.previousConnection&&this.unplugFromStack_(t)},E.Block.prototype.unplugFromRow_=function(t){var e=null;this.outputConnection.isConnected()&&(e=this.outputConnection.targetConnection,this.outputConnection.disconnect()),e&&t&&(t=this.getOnlyValueConnection_())&&t.isConnected()&&!t.targetBlock().isShadow()&&((t=t.targetConnection).disconnect(),this.workspace.connectionChecker.canConnect(t,e,!1)?e.connect(t):t.onFailedConnect(e))},E.Block.prototype.getOnlyValueConnection_=function(){for(var t=null,e=0;e<this.inputList.length;e++){var o=this.inputList[e].connection;if(o&&o.type==E.INPUT_VALUE&&o.targetConnection){if(t)return null;t=o}}return t},E.Block.prototype.unplugFromStack_=function(t){var e=null;this.previousConnection.isConnected()&&(e=this.previousConnection.targetConnection,this.previousConnection.disconnect());var o=this.getNextBlock();t&&o&&!o.isShadow()&&((t=this.nextConnection.targetConnection).disconnect(),e&&this.workspace.connectionChecker.canConnect(e,t,!1)&&e.connect(t))},E.Block.prototype.getConnections_=function(t){t=[],this.outputConnection&&t.push(this.outputConnection),this.previousConnection&&t.push(this.previousConnection),this.nextConnection&&t.push(this.nextConnection);for(var e,o=0;e=this.inputList[o];o++)e.connection&&t.push(e.connection);return t},E.Block.prototype.lastConnectionInStack=function(){for(var t=this.nextConnection;t;){var e=t.targetBlock();if(!e)return t;t=e.nextConnection}return null},E.Block.prototype.bumpNeighbours=function(){console.warn("Not expected to reach Block.bumpNeighbours function. BlockSvg.bumpNeighbours was expected to be called instead.")},E.Block.prototype.getParent=function(){return this.parentBlock_},E.Block.prototype.getInputWithBlock=function(t){for(var e,o=0;e=this.inputList[o];o++)if(e.connection&&e.connection.targetBlock()==t)return e;return null},E.Block.prototype.getSurroundParent=function(){var t=this;do{var e=t;if(!(t=t.getParent()))return null}while(t.getNextBlock()==e);return t},E.Block.prototype.getNextBlock=function(){return this.nextConnection&&this.nextConnection.targetBlock()},E.Block.prototype.getPreviousBlock=function(){return this.previousConnection&&this.previousConnection.targetBlock()},E.Block.prototype.getFirstStatementConnection=function(){for(var t,e=0;t=this.inputList[e];e++)if(t.connection&&t.connection.type==E.NEXT_STATEMENT)return t.connection;return null},E.Block.prototype.getRootBlock=function(){var t=this;do{var e=t;t=e.parentBlock_}while(t);return e},E.Block.prototype.getTopStackBlock=function(){var t=this;do{var e=t.getPreviousBlock()}while(e&&e.getNextBlock()==t&&(t=e));return t},E.Block.prototype.getChildren=function(t){if(!t)return this.childBlocks_;t=[];for(var e,o=0;e=this.inputList[o];o++)e.connection&&(e=e.connection.targetBlock())&&t.push(e);return(o=this.getNextBlock())&&t.push(o),t},E.Block.prototype.setParent=function(t){if(t!=this.parentBlock_){if(this.parentBlock_){if(E.utils.arrayRemove(this.parentBlock_.childBlocks_,this),this.previousConnection&&this.previousConnection.isConnected())throw Error("Still connected to previous block.");if(this.outputConnection&&this.outputConnection.isConnected())throw Error("Still connected to parent block.");this.parentBlock_=null}else this.workspace.removeTopBlock(this);(this.parentBlock_=t)?t.childBlocks_.push(this):this.workspace.addTopBlock(this)}},E.Block.prototype.getDescendants=function(t){for(var e,o=[this],n=this.getChildren(t),i=0;e=n[i];i++)o.push.apply(o,e.getDescendants(t));return o},E.Block.prototype.isDeletable=function(){return this.deletable_&&!this.isShadow_&&!(this.workspace&&this.workspace.options.readOnly)},E.Block.prototype.setDeletable=function(t){this.deletable_=t},E.Block.prototype.isMovable=function(){return this.movable_&&!this.isShadow_&&!(this.workspace&&this.workspace.options.readOnly)},E.Block.prototype.setMovable=function(t){this.movable_=t},E.Block.prototype.isDuplicatable=function(){return!this.workspace.hasBlockLimits()||this.workspace.isCapacityAvailable(E.utils.getBlockTypeCounts(this,!0))},E.Block.prototype.isShadow=function(){return this.isShadow_},E.Block.prototype.setShadow=function(t){this.isShadow_=t},E.Block.prototype.isInsertionMarker=function(){return this.isInsertionMarker_},E.Block.prototype.setInsertionMarker=function(t){this.isInsertionMarker_=t},E.Block.prototype.isEditable=function(){return this.editable_&&!(this.workspace&&this.workspace.options.readOnly)},E.Block.prototype.setEditable=function(t){this.editable_=t,t=0;for(var e;e=this.inputList[t];t++)for(var o,n=0;o=e.fieldRow[n];n++)o.updateEditable()},E.Block.prototype.isDisposed=function(){return this.disposed},E.Block.prototype.getMatchingConnection=function(t,e){var o=this.getConnections_(!0);if(t=t.getConnections_(!0),o.length!=t.length)throw Error("Connection lists did not match in length.");for(var n=0;n<t.length;n++)if(t[n]==e)return o[n];return null},E.Block.prototype.setHelpUrl=function(t){this.helpUrl=t},E.Block.prototype.setTooltip=function(t){this.tooltip=t},E.Block.prototype.getTooltip=function(){return E.Tooltip.getTooltipOfObject(this)},E.Block.prototype.getColour=function(){return this.colour_},E.Block.prototype.getStyleName=function(){return this.styleName_},E.Block.prototype.getHue=function(){return this.hue_},E.Block.prototype.setColour=function(t){t=E.utils.parseBlockColour(t),this.hue_=t.hue,this.colour_=t.hex},E.Block.prototype.setStyle=function(t){this.styleName_=t},E.Block.prototype.setOnChange=function(t){if(t&&"function"!=typeof t)throw Error("onchange must be a function.");this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),(this.onchange=t)&&(this.onchangeWrapper_=t.bind(this),this.workspace.addChangeListener(this.onchangeWrapper_))},E.Block.prototype.getField=function(t){for(var e,o=0;e=this.inputList[o];o++)for(var n,i=0;n=e.fieldRow[i];i++)if(n.name==t)return n;return null},E.Block.prototype.getVars=function(){for(var t,e=[],o=0;t=this.inputList[o];o++)for(var n,i=0;n=t.fieldRow[i];i++)n.referencesVariables()&&e.push(n.getValue());return e},E.Block.prototype.getVarModels=function(){for(var t,e=[],o=0;t=this.inputList[o];o++)for(var n,i=0;n=t.fieldRow[i];i++)n.referencesVariables()&&(n=this.workspace.getVariableById(n.getValue()))&&e.push(n);return e},E.Block.prototype.updateVarName=function(t){for(var e,o=0;e=this.inputList[o];o++)for(var n,i=0;n=e.fieldRow[i];i++)n.referencesVariables()&&t.getId()==n.getValue()&&n.refreshVariableName()},E.Block.prototype.renameVarById=function(t,e){for(var o,n=0;o=this.inputList[n];n++)for(var i,r=0;i=o.fieldRow[r];r++)i.referencesVariables()&&t==i.getValue()&&i.setValue(e)},E.Block.prototype.getFieldValue=function(t){return(t=this.getField(t))?t.getValue():null},E.Block.prototype.setFieldValue=function(t,e){var o=this.getField(e);if(!o)throw Error('Field "'+e+'" not found.');o.setValue(t)},E.Block.prototype.setPreviousStatement=function(t,e){if(t){if(void 0===e&&(e=null),!this.previousConnection){if(this.outputConnection)throw Error("Remove output connection prior to adding previous connection.");this.previousConnection=this.makeConnection_(E.PREVIOUS_STATEMENT)}this.previousConnection.setCheck(e)}else if(this.previousConnection){if(this.previousConnection.isConnected())throw Error("Must disconnect previous statement before removing connection.");this.previousConnection.dispose(),this.previousConnection=null}},E.Block.prototype.setNextStatement=function(t,e){if(t)void 0===e&&(e=null),this.nextConnection||(this.nextConnection=this.makeConnection_(E.NEXT_STATEMENT)),this.nextConnection.setCheck(e);else if(this.nextConnection){if(this.nextConnection.isConnected())throw Error("Must disconnect next statement before removing connection.");this.nextConnection.dispose(),this.nextConnection=null}},E.Block.prototype.setOutput=function(t,e){if(t){if(void 0===e&&(e=null),!this.outputConnection){if(this.previousConnection)throw Error("Remove previous connection prior to adding output connection.");this.outputConnection=this.makeConnection_(E.OUTPUT_VALUE)}this.outputConnection.setCheck(e)}else if(this.outputConnection){if(this.outputConnection.isConnected())throw Error("Must disconnect output value before removing connection.");this.outputConnection.dispose(),this.outputConnection=null}},E.Block.prototype.setInputsInline=function(t){this.inputsInline!=t&&(E.Events.fire(new E.Events.BlockChange(this,"inline",null,this.inputsInline,t)),this.inputsInline=t)},E.Block.prototype.getInputsInline=function(){if(null!=this.inputsInline)return this.inputsInline;for(var t=1;t<this.inputList.length;t++)if(this.inputList[t-1].type==E.DUMMY_INPUT&&this.inputList[t].type==E.DUMMY_INPUT)return!1;for(t=1;t<this.inputList.length;t++)if(this.inputList[t-1].type==E.INPUT_VALUE&&this.inputList[t].type==E.DUMMY_INPUT)return!0;return!1},E.Block.prototype.setOutputShape=function(t){this.outputShape_=t},E.Block.prototype.getOutputShape=function(){return this.outputShape_},E.Block.prototype.setDisabled=function(t){E.utils.deprecation.warn("Block.prototype.setDisabled","May 2019","May 2020","Block.prototype.setEnabled"),this.setEnabled(!t)},E.Block.prototype.isEnabled=function(){return!this.disabled},E.Block.prototype.setEnabled=function(t){this.isEnabled()!=t&&(E.Events.fire(new E.Events.BlockChange(this,"disabled",null,this.disabled,!t)),this.disabled=!t)},E.Block.prototype.getInheritedDisabled=function(){for(var t=this.getSurroundParent();t;){if(t.disabled)return!0;t=t.getSurroundParent()}return!1},E.Block.prototype.isCollapsed=function(){return this.collapsed_},E.Block.prototype.setCollapsed=function(t){this.collapsed_!=t&&(E.Events.fire(new E.Events.BlockChange(this,"collapsed",null,this.collapsed_,t)),this.collapsed_=t)},E.Block.prototype.toString=function(t,e){function o(t){var e=t.getCheck();return!e&&t.targetConnection&&(e=t.targetConnection.getCheck()),!!e&&(-1!=e.indexOf("Boolean")||-1!=e.indexOf("Number"))}function n(){s&&s.getType()==a.getType()&&s.getLocation()==a.getLocation()&&(s=null)}var i=[];e=e||"?";var r=E.ASTNode.NAVIGATE_ALL_FIELDS;E.ASTNode.NAVIGATE_ALL_FIELDS=!0;for(var s=E.ASTNode.createBlockNode(this),a=s;s;){switch(s.getType()){case E.ASTNode.types.INPUT:var l=s.getLocation();s.in()?o(l)&&i.push("("):i.push(e);break;case E.ASTNode.types.FIELD:(l=s.getLocation()).name!=E.Block.COLLAPSED_FIELD_NAME&&i.push(l.getText())}if(!(s=(l=s).in()||l.next())){for(s=l.out(),n();s&&!s.next();)s=s.out(),n(),s&&s.getType()==E.ASTNode.types.INPUT&&o(s.getLocation())&&i.push(")");s&&(s=s.next())}}for(E.ASTNode.NAVIGATE_ALL_FIELDS=r,e=2,r=i.length;e<r;e++)"("==i[e-2]&&")"==i[e]&&(i[e-2]=i[e-1],i.splice(e-1,2),r-=2);return i=i.join(" ").replace(/(\() | (\))/gim,"$1$2").trim()||"???",t&&i.length>t&&(i=i.substring(0,t-3)+"..."),i},E.Block.prototype.appendValueInput=function(t){return this.appendInput_(E.INPUT_VALUE,t)},E.Block.prototype.appendStatementInput=function(t){return this.appendInput_(E.NEXT_STATEMENT,t)},E.Block.prototype.appendDummyInput=function(t){return this.appendInput_(E.DUMMY_INPUT,t||"")},E.Block.prototype.jsonInit=function(t){var e=t.type?'Block "'+t.type+'": ':"";if(t.output&&t.previousStatement)throw Error(e+"Must not have both an output and a previousStatement.");if(t.style&&t.style.hat&&(this.hat=t.style.hat,t.style=null),t.style&&t.colour)throw Error(e+"Must not have both a colour and a style.");t.style?this.jsonInitStyle_(t,e):this.jsonInitColour_(t,e);for(var o=0;void 0!==t["message"+o];)this.interpolate_(t["message"+o],t["args"+o]||[],t["lastDummyAlign"+o],e),o++;if(void 0!==t.inputsInline&&this.setInputsInline(t.inputsInline),void 0!==t.output&&this.setOutput(!0,t.output),void 0!==t.outputShape&&this.setOutputShape(t.outputShape),void 0!==t.previousStatement&&this.setPreviousStatement(!0,t.previousStatement),void 0!==t.nextStatement&&this.setNextStatement(!0,t.nextStatement),void 0!==t.tooltip&&(o=t.tooltip,o=E.utils.replaceMessageReferences(o),this.setTooltip(o)),void 0!==t.enableContextMenu&&(o=t.enableContextMenu,this.contextMenu=!!o),void 0!==t.helpUrl&&(o=t.helpUrl,o=E.utils.replaceMessageReferences(o),this.setHelpUrl(o)),"string"==typeof t.extensions&&(console.warn(e+"JSON attribute 'extensions' should be an array of strings. Found raw string in JSON for '"+t.type+"' block."),t.extensions=[t.extensions]),void 0!==t.mutator&&E.Extensions.apply(t.mutator,this,!0),Array.isArray(t.extensions))for(t=t.extensions,e=0;e<t.length;++e)E.Extensions.apply(t[e],this,!1)},E.Block.prototype.jsonInitColour_=function(e,o){if("colour"in e)if(void 0===e.colour)console.warn(o+"Undefined colour value.");else{e=e.colour;try{this.setColour(e)}catch(t){console.warn(o+"Illegal colour value: ",e)}}},E.Block.prototype.jsonInitStyle_=function(e,o){e=e.style;try{this.setStyle(e)}catch(t){console.warn(o+"Style does not exist: ",e)}},E.Block.prototype.mixin=function(t,e){if(void 0!==e&&"boolean"!=typeof e)throw Error("opt_disableCheck must be a boolean if provided");if(!e){for(var o in e=[],t)void 0!==this[o]&&e.push(o);if(e.length)throw Error("Mixin will overwrite block members: "+JSON.stringify(e))}E.utils.object.mixin(this,t)},E.Block.prototype.interpolate_=function(t,e,o,n){var i=E.utils.tokenizeInterpolation(t),r=[],s=0;t=[];for(var a=0;a<i.length;a++){var l=i[a];if("number"==typeof l){if(l<=0||l>e.length)throw Error('Block "'+this.type+'": Message index %'+l+" out of range.");if(r[l])throw Error('Block "'+this.type+'": Message index %'+l+" duplicated.");r[l]=!0,s++,t.push(e[l-1])}else(l=l.trim())&&t.push(l)}if(s!=e.length)throw Error('Block "'+this.type+'": Message does not reference all '+e.length+" arg(s).");for(t.length&&("string"==typeof t[t.length-1]||E.utils.string.startsWith(t[t.length-1].type,"field_"))&&(a={type:"input_dummy"},o&&(a.align=o),t.push(a)),o={LEFT:E.ALIGN_LEFT,RIGHT:E.ALIGN_RIGHT,CENTRE:E.ALIGN_CENTRE,CENTER:E.ALIGN_CENTRE},e=[],a=0;a<t.length;a++)if("string"==typeof(r=t[a]))e.push([r,void 0]);else{i=s=null;do{if(l=!1,"string"==typeof r)s=new E.FieldLabel(r);else switch(r.type){case"input_value":i=this.appendValueInput(r.name);break;case"input_statement":i=this.appendStatementInput(r.name);break;case"input_dummy":i=this.appendDummyInput(r.name);break;default:!(s=E.fieldRegistry.fromJson(r))&&r.alt&&(r=r.alt,l=!0)}}while(l);if(s)e.push([s,r.name]);else if(i){for(r.check&&i.setCheck(r.check),r.align&&(void 0===(s=o[r.align.toUpperCase()])?console.warn(n+"Illegal align value: ",r.align):i.setAlign(s)),r=0;r<e.length;r++)i.appendField(e[r][0],e[r][1]);e.length=0}}},E.Block.prototype.appendInput_=function(t,e){var o=null;return t!=E.INPUT_VALUE&&t!=E.NEXT_STATEMENT||(o=this.makeConnection_(t)),t==E.NEXT_STATEMENT&&this.statementInputCount++,t=new E.Input(t,e,this,o),this.inputList.push(t),t},E.Block.prototype.moveInputBefore=function(t,e){if(t!=e){for(var o,n=-1,i=e?-1:this.inputList.length,r=0;o=this.inputList[r];r++)if(o.name==t){if(n=r,-1!=i)break}else if(e&&o.name==e&&(i=r,-1!=n))break;if(-1==n)throw Error('Named input "'+t+'" not found.');if(-1==i)throw Error('Reference input "'+e+'" not found.');this.moveNumberedInputBefore(n,i)}},E.Block.prototype.moveNumberedInputBefore=function(t,e){if(t==e)throw Error("Can't move input to itself.");if(t>=this.inputList.length)throw RangeError("Input index "+t+" out of bounds.");if(e>this.inputList.length)throw RangeError("Reference input "+e+" out of bounds.");var o=this.inputList[t];this.inputList.splice(t,1),t<e&&e--,this.inputList.splice(e,0,o)},E.Block.prototype.removeInput=function(t,e){for(var o,n=0;o=this.inputList[n];n++)if(o.name==t)return o.type==E.NEXT_STATEMENT&&this.statementInputCount--,o.dispose(),this.inputList.splice(n,1),!0;if(e)return!1;throw Error("Input not found: "+t)},E.Block.prototype.getInput=function(t){for(var e,o=0;e=this.inputList[o];o++)if(e.name==t)return e;return null},E.Block.prototype.getInputTargetBlock=function(t){return(t=this.getInput(t))&&t.connection&&t.connection.targetBlock()},E.Block.prototype.getCommentText=function(){return this.commentModel.text},E.Block.prototype.setCommentText=function(t){this.commentModel.text!=t&&(E.Events.fire(new E.Events.BlockChange(this,"comment",null,this.commentModel.text,t)),this.comment=this.commentModel.text=t)},E.Block.prototype.setWarningText=function(t,e){},E.Block.prototype.setMutator=function(t){},E.Block.prototype.getRelativeToSurfaceXY=function(){return this.xy_},E.Block.prototype.moveBy=function(t,e){if(this.parentBlock_)throw Error("Block has parent.");var o=new E.Events.BlockMove(this);this.xy_.translate(t,e),o.recordNew(),E.Events.fire(o)},E.Block.prototype.makeConnection_=function(t){return new E.Connection(this,t)},E.Block.prototype.allInputsFilled=function(t){if(void 0===t&&(t=!0),!t&&this.isShadow())return!1;for(var e,o=0;e=this.inputList[o];o++)if(e.connection&&(!(e=e.connection.targetBlock())||!e.allInputsFilled(t)))return!1;return!(o=this.getNextBlock())||o.allInputsFilled(t)},E.Block.prototype.toDevString=function(){var t=this.type?'"'+this.type+'" block':"Block";return this.id&&(t+=' (id="'+this.id+'")'),t},E.blockRendering={},E.blockRendering.IPathObject=function(t,e){},E.utils.aria={},E.utils.aria.ARIA_PREFIX_="aria-",E.utils.aria.ROLE_ATTRIBUTE_="role",E.utils.aria.Role={GRID:"grid",GRIDCELL:"gridcell",GROUP:"group",LISTBOX:"listbox",MENU:"menu",MENUITEM:"menuitem",MENUITEMCHECKBOX:"menuitemcheckbox",OPTION:"option",PRESENTATION:"presentation",ROW:"row",TREE:"tree",TREEITEM:"treeitem"},E.utils.aria.State={ACTIVEDESCENDANT:"activedescendant",COLCOUNT:"colcount",DISABLED:"disabled",EXPANDED:"expanded",INVALID:"invalid",LABEL:"label",LABELLEDBY:"labelledby",LEVEL:"level",ORIENTATION:"orientation",POSINSET:"posinset",ROWCOUNT:"rowcount",SELECTED:"selected",SETSIZE:"setsize",VALUEMAX:"valuemax",VALUEMIN:"valuemin"},E.utils.aria.setRole=function(t,e){t.setAttribute(E.utils.aria.ROLE_ATTRIBUTE_,e)},E.utils.aria.setState=function(t,e,o){Array.isArray(o)&&(o=o.join(" ")),t.setAttribute(E.utils.aria.ARIA_PREFIX_+e,o)},E.Menu=function(){this.menuItems_=[],this.roleName_=this.element_=this.onKeyDownHandler_=this.mouseLeaveHandler_=this.mouseEnterHandler_=this.clickHandler_=this.mouseOverHandler_=this.highlightedItem_=this.openingCoords=null},E.Menu.prototype.addChild=function(t){this.menuItems_.push(t)},E.Menu.prototype.render=function(t){var e=document.createElement("div");e.className="blocklyMenu goog-menu blocklyNonSelectable",e.tabIndex=0,this.roleName_&&E.utils.aria.setRole(e,this.roleName_),this.element_=e;for(var o,n=0;o=this.menuItems_[n];n++)e.appendChild(o.createDom());this.mouseOverHandler_=E.bindEventWithChecks_(e,"mouseover",this,this.handleMouseOver_,!0),this.clickHandler_=E.bindEventWithChecks_(e,"click",this,this.handleClick_,!0),this.mouseEnterHandler_=E.bindEventWithChecks_(e,"mouseenter",this,this.handleMouseEnter_,!0),this.mouseLeaveHandler_=E.bindEventWithChecks_(e,"mouseleave",this,this.handleMouseLeave_,!0),this.onKeyDownHandler_=E.bindEventWithChecks_(e,"keydown",this,this.handleKeyEvent_),t.appendChild(e)},E.Menu.prototype.getElement=function(){return this.element_},E.Menu.prototype.focus=function(){var t=this.getElement();t&&(t.focus({preventScroll:!0}),E.utils.dom.addClass(t,"blocklyFocused"))},E.Menu.prototype.blur_=function(){var t=this.getElement();t&&(t.blur(),E.utils.dom.removeClass(t,"blocklyFocused"))},E.Menu.prototype.setRole=function(t){this.roleName_=t},E.Menu.prototype.dispose=function(){this.mouseOverHandler_&&(E.unbindEvent_(this.mouseOverHandler_),this.mouseOverHandler_=null),this.clickHandler_&&(E.unbindEvent_(this.clickHandler_),this.clickHandler_=null),this.mouseEnterHandler_&&(E.unbindEvent_(this.mouseEnterHandler_),this.mouseEnterHandler_=null),this.mouseLeaveHandler_&&(E.unbindEvent_(this.mouseLeaveHandler_),this.mouseLeaveHandler_=null),this.onKeyDownHandler_&&(E.unbindEvent_(this.onKeyDownHandler_),this.onKeyDownHandler_=null);for(var t,e=0;t=this.menuItems_[e];e++)t.dispose();this.element_=null},E.Menu.prototype.getMenuItem_=function(t){for(var e=this.getElement();t&&t!=e;){if(E.utils.dom.hasClass(t,"blocklyMenuItem"))for(var o,n=0;o=this.menuItems_[n];n++)if(o.getElement()==t)return o;t=t.parentElement}return null},E.Menu.prototype.setHighlighted=function(t){var e=this.highlightedItem_;e&&(e.setHighlighted(!1),this.highlightedItem_=null),t&&(t.setHighlighted(!0),this.highlightedItem_=t,e=this.getElement(),E.utils.style.scrollIntoContainerView(t.getElement(),e),E.utils.aria.setState(e,E.utils.aria.State.ACTIVEDESCENDANT,t.getId()))},E.Menu.prototype.highlightNext=function(){var t=this.menuItems_.indexOf(this.highlightedItem_);this.highlightHelper_(t,1)},E.Menu.prototype.highlightPrevious=function(){var t=this.menuItems_.indexOf(this.highlightedItem_);this.highlightHelper_(t<0?this.menuItems_.length:t,-1)},E.Menu.prototype.highlightFirst_=function(){this.highlightHelper_(-1,1)},E.Menu.prototype.highlightLast_=function(){this.highlightHelper_(this.menuItems_.length,-1)},E.Menu.prototype.highlightHelper_=function(t,e){t+=e;for(var o;o=this.menuItems_[t];){if(o.isEnabled()){this.setHighlighted(o);break}t+=e}},E.Menu.prototype.handleMouseOver_=function(t){(t=this.getMenuItem_(t.target))&&(t.isEnabled()?this.highlightedItem_!=t&&this.setHighlighted(t):this.setHighlighted(null))},E.Menu.prototype.handleClick_=function(t){var e=this.openingCoords;if(this.openingCoords=null,e&&"number"==typeof t.clientX){var o=new E.utils.Coordinate(t.clientX,t.clientY);if(E.utils.Coordinate.distance(e,o)<1)return}(t=this.getMenuItem_(t.target))&&t.performAction()},E.Menu.prototype.handleMouseEnter_=function(t){this.focus()},E.Menu.prototype.handleMouseLeave_=function(t){this.getElement()&&(this.blur_(),this.setHighlighted(null))},E.Menu.prototype.handleKeyEvent_=function(t){if(this.menuItems_.length&&!(t.shiftKey||t.ctrlKey||t.metaKey||t.altKey)){var e=this.highlightedItem_;switch(t.keyCode){case E.utils.KeyCodes.ENTER:case E.utils.KeyCodes.SPACE:e&&e.performAction();break;case E.utils.KeyCodes.UP:this.highlightPrevious();break;case E.utils.KeyCodes.DOWN:this.highlightNext();break;case E.utils.KeyCodes.PAGE_UP:case E.utils.KeyCodes.HOME:this.highlightFirst_();break;case E.utils.KeyCodes.PAGE_DOWN:case E.utils.KeyCodes.END:this.highlightLast_();break;default:return}t.preventDefault(),t.stopPropagation()}},E.Menu.prototype.getSize=function(){var t=this.getElement(),e=E.utils.style.getSize(t);return e.height=t.scrollHeight,e},E.MenuItem=function(t,e){this.content_=t,this.value_=e,this.enabled_=!0,this.element_=null,this.rightToLeft_=!1,this.roleName_=null,this.highlight_=this.checked_=this.checkable_=!1,this.actionHandler_=null},E.MenuItem.prototype.createDom=function(){var t=document.createElement("div");t.id=E.utils.IdGenerator.getNextUniqueId(),(this.element_=t).className="blocklyMenuItem goog-menuitem "+(this.enabled_?"":"blocklyMenuItemDisabled goog-menuitem-disabled ")+(this.checked_?"blocklyMenuItemSelected goog-option-selected ":"")+(this.highlight_?"blocklyMenuItemHighlight goog-menuitem-highlight ":"")+(this.rightToLeft_?"blocklyMenuItemRtl goog-menuitem-rtl ":"");var e=document.createElement("div");if(e.className="blocklyMenuItemContent goog-menuitem-content",this.checkable_){var o=document.createElement("div");o.className="blocklyMenuItemCheckbox goog-menuitem-checkbox",e.appendChild(o)}return o=this.content_,"string"==typeof this.content_&&(o=document.createTextNode(this.content_)),e.appendChild(o),t.appendChild(e),this.roleName_&&E.utils.aria.setRole(t,this.roleName_),E.utils.aria.setState(t,E.utils.aria.State.SELECTED,this.checkable_&&this.checked_||!1),E.utils.aria.setState(t,E.utils.aria.State.DISABLED,!this.enabled_),t},E.MenuItem.prototype.dispose=function(){this.element_=null},E.MenuItem.prototype.getElement=function(){return this.element_},E.MenuItem.prototype.getId=function(){return this.element_.id},E.MenuItem.prototype.getValue=function(){return this.value_},E.MenuItem.prototype.setRightToLeft=function(t){this.rightToLeft_=t},E.MenuItem.prototype.setRole=function(t){this.roleName_=t},E.MenuItem.prototype.setCheckable=function(t){this.checkable_=t},E.MenuItem.prototype.setChecked=function(t){this.checked_=t},E.MenuItem.prototype.setHighlighted=function(t){this.highlight_=t;var e=this.getElement();e&&this.isEnabled()&&(t?(E.utils.dom.addClass(e,"blocklyMenuItemHighlight"),E.utils.dom.addClass(e,"goog-menuitem-highlight")):(E.utils.dom.removeClass(e,"blocklyMenuItemHighlight"),E.utils.dom.removeClass(e,"goog-menuitem-highlight")))},E.MenuItem.prototype.isEnabled=function(){return this.enabled_},E.MenuItem.prototype.setEnabled=function(t){this.enabled_=t},E.MenuItem.prototype.performAction=function(){this.isEnabled()&&this.actionHandler_&&this.actionHandler_(this)},E.MenuItem.prototype.onAction=function(t,e){this.actionHandler_=t.bind(e)},E.ContextMenu={},E.ContextMenu.currentBlock=null,E.ContextMenu.menu_=null,E.ContextMenu.show=function(t,e,o){if(E.WidgetDiv.show(E.ContextMenu,o,E.ContextMenu.dispose),e.length){var n=E.ContextMenu.populate_(e,o);E.ContextMenu.menu_=n,E.ContextMenu.position_(n,t,o),setTimeout(function(){n.focus()},1),E.ContextMenu.currentBlock=null}else E.ContextMenu.hide()},E.ContextMenu.populate_=function(t,e){var o=new E.Menu;o.setRole(E.utils.aria.Role.MENU);for(var n,i=0;n=t[i];i++){var r=new E.MenuItem(n.text);r.setRightToLeft(e),r.setRole(E.utils.aria.Role.MENUITEM),o.addChild(r),r.setEnabled(n.enabled),n.enabled&&r.onAction(function(t){E.ContextMenu.hide(),this.callback(this.scope)},n)}return o},E.ContextMenu.position_=function(t,e,o){var n=E.utils.getViewportBBox();e=new E.utils.Rect(e.clientY+n.top,e.clientY+n.top,e.clientX+n.left,e.clientX+n.left),E.ContextMenu.createWidget_(t);var i=t.getSize();o&&(e.left+=i.width,e.right+=i.width,n.left+=i.width,n.right+=i.width),E.WidgetDiv.positionWithAnchor(n,e,i,o),t.focus()},E.ContextMenu.createWidget_=function(t){t.render(E.WidgetDiv.DIV);var e=t.getElement();E.utils.dom.addClass(e,"blocklyContextMenu"),E.bindEventWithChecks_(e,"contextmenu",null,E.utils.noEvent),t.focus()},E.ContextMenu.hide=function(){E.WidgetDiv.hideIfOwner(E.ContextMenu),E.ContextMenu.currentBlock=null},E.ContextMenu.dispose=function(){E.ContextMenu.menu_&&(E.ContextMenu.menu_.dispose(),E.ContextMenu.menu_=null)},E.ContextMenu.callbackFactory=function(o,n){return function(){E.Events.disable();try{var t=E.Xml.domToBlock(n,o.workspace),e=o.getRelativeToSurfaceXY();e.x=o.RTL?e.x-E.SNAP_RADIUS:e.x+E.SNAP_RADIUS,e.y+=2*E.SNAP_RADIUS,t.moveBy(e.x,e.y)}finally{E.Events.enable()}E.Events.isEnabled()&&!t.isShadow()&&E.Events.fire(new E.Events.BlockCreate(t)),t.select()}},E.ContextMenu.commentDeleteOption=function(t){return{text:E.Msg.REMOVE_COMMENT,enabled:!0,callback:function(){E.Events.setGroup(!0),t.dispose(!0,!0),E.Events.setGroup(!1)}}},E.ContextMenu.commentDuplicateOption=function(t){return{text:E.Msg.DUPLICATE_COMMENT,enabled:!0,callback:function(){E.duplicate(t)}}},E.ContextMenu.workspaceCommentOption=function(n,i){if(!E.WorkspaceCommentSvg)throw Error("Missing require for Blockly.WorkspaceCommentSvg");var t={enabled:!E.utils.userAgent.IE};return t.text=E.Msg.ADD_COMMENT,t.callback=function(){var t=new E.WorkspaceCommentSvg(n,E.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT,E.WorkspaceCommentSvg.DEFAULT_SIZE,E.WorkspaceCommentSvg.DEFAULT_SIZE),e=n.getInjectionDiv().getBoundingClientRect();e=new E.utils.Coordinate(i.clientX-e.left,i.clientY-e.top);var o=n.getOriginOffsetInPixels();(e=E.utils.Coordinate.difference(e,o)).scale(1/n.scale),t.moveBy(e.x,e.y),n.rendered&&(t.initSvg(),t.render(),t.select())},t},E.ContextMenuItems={},E.ContextMenuItems.registerUndo=function(){E.ContextMenuRegistry.registry.register({displayText:function(){return E.Msg.UNDO},preconditionFn:function(t){return 0<t.workspace.getUndoStack().length?"enabled":"disabled"},callback:function(t){t.workspace.undo(!1)},scopeType:E.ContextMenuRegistry.ScopeType.WORKSPACE,id:"undoWorkspace",weight:0})},E.ContextMenuItems.registerRedo=function(){E.ContextMenuRegistry.registry.register({displayText:function(){return E.Msg.REDO},preconditionFn:function(t){return 0<t.workspace.getRedoStack().length?"enabled":"disabled"},callback:function(t){t.workspace.undo(!0)},scopeType:E.ContextMenuRegistry.ScopeType.WORKSPACE,id:"redoWorkspace",weight:0})},E.ContextMenuItems.registerCleanup=function(){E.ContextMenuRegistry.registry.register({displayText:function(){return E.Msg.CLEAN_UP},preconditionFn:function(t){return t.workspace.isMovable()?1<t.workspace.getTopBlocks(!1).length?"enabled":"disabled":"hidden"},callback:function(t){t.workspace.cleanUp()},scopeType:E.ContextMenuRegistry.ScopeType.WORKSPACE,id:"cleanWorkspace",weight:0})},E.ContextMenuItems.toggleOption_=function(t,e){for(var o=0,n=0;n<e.length;n++)for(var i=e[n];i;)setTimeout(i.setCollapsed.bind(i,t),o),i=i.getNextBlock(),o+=10},E.ContextMenuItems.registerCollapse=function(){E.ContextMenuRegistry.registry.register({displayText:function(){return E.Msg.COLLAPSE_ALL},preconditionFn:function(t){if(t.workspace.options.collapse){t=t.workspace.getTopBlocks(!1);for(var e=0;e<t.length;e++)for(var o=t[e];o;){if(!o.isCollapsed())return"enabled";o=o.getNextBlock()}return"disabled"}return"hidden"},callback:function(t){E.ContextMenuItems.toggleOption_(!0,t.workspace.getTopBlocks(!0))},scopeType:E.ContextMenuRegistry.ScopeType.WORKSPACE,id:"collapseWorkspace",weight:0})},E.ContextMenuItems.registerExpand=function(){E.ContextMenuRegistry.registry.register({displayText:function(){return E.Msg.EXPAND_ALL},preconditionFn:function(t){if(t.workspace.options.collapse){t=t.workspace.getTopBlocks(!1);for(var e=0;e<t.length;e++)for(var o=t[e];o;){if(o.isCollapsed())return"enabled";o=o.getNextBlock()}return"disabled"}return"hidden"},callback:function(t){E.ContextMenuItems.toggleOption_(!1,t.workspace.getTopBlocks(!0))},scopeType:E.ContextMenuRegistry.ScopeType.WORKSPACE,id:"expandWorkspace",weight:0})},E.ContextMenuItems.addDeletableBlocks_=function(t,e){if(t.isDeletable())Array.prototype.push.apply(e,t.getDescendants(!1));else{t=t.getChildren(!1);for(var o=0;o<t.length;o++)E.ContextMenuItems.addDeletableBlocks_(t[o],e)}},E.ContextMenuItems.getDeletableBlocks_=function(t){var e=[];t=t.getTopBlocks(!0);for(var o=0;o<t.length;o++)E.ContextMenuItems.addDeletableBlocks_(t[o],e);return e},E.ContextMenuItems.deleteNext_=function(t,e){E.Events.setGroup(e);var o=t.shift();o&&(o.workspace?(o.dispose(!1,!0),setTimeout(E.ContextMenuItems.deleteNext_,10,t,e)):E.ContextMenuItems.deleteNext_(t,e)),E.Events.setGroup(!1)},E.ContextMenuItems.registerDeleteAll=function(){E.ContextMenuRegistry.registry.register({displayText:function(t){if(t.workspace)return 1==(t=E.ContextMenuItems.getDeletableBlocks_(t.workspace).length)?E.Msg.DELETE_BLOCK:E.Msg.DELETE_X_BLOCKS.replace("%1",String(t))},preconditionFn:function(t){if(t.workspace)return 0<E.ContextMenuItems.getDeletableBlocks_(t.workspace).length?"enabled":"disabled"},callback:function(t){if(t.workspace){t.workspace.cancelCurrentGesture();var e=E.ContextMenuItems.getDeletableBlocks_(t.workspace),o=E.utils.genUid();e.length<2?E.ContextMenuItems.deleteNext_(e,o):E.confirm(E.Msg.DELETE_ALL_BLOCKS.replace("%1",e.length),function(t){t&&E.ContextMenuItems.deleteNext_(e,o)})}},scopeType:E.ContextMenuRegistry.ScopeType.WORKSPACE,id:"workspaceDelete",weight:0})},E.ContextMenuItems.registerWorkspaceOptions_=function(){E.ContextMenuItems.registerUndo(),E.ContextMenuItems.registerRedo(),E.ContextMenuItems.registerCleanup(),E.ContextMenuItems.registerCollapse(),E.ContextMenuItems.registerExpand(),E.ContextMenuItems.registerDeleteAll()},E.ContextMenuItems.registerDuplicate=function(){E.ContextMenuRegistry.registry.register({displayText:function(){return E.Msg.DUPLICATE_BLOCK},preconditionFn:function(t){return!(t=t.block).isInFlyout&&t.isDeletable()&&t.isMovable()?t.isDuplicatable()?"enabled":"disabled":"hidden"},callback:function(t){t.block&&E.duplicate(t.block)},scopeType:E.ContextMenuRegistry.ScopeType.BLOCK,id:"blockDuplicate",weight:0})},E.ContextMenuItems.registerComment=function(){E.ContextMenuRegistry.registry.register({displayText:function(t){return t.block.getCommentIcon()?E.Msg.REMOVE_COMMENT:E.Msg.ADD_COMMENT},preconditionFn:function(t){return t=t.block,E.utils.userAgent.IE||t.isInFlyout||!t.workspace.options.comments||t.isCollapsed()||!t.isEditable()?"hidden":"enabled"},callback:function(t){(t=t.block).getCommentIcon()?t.setCommentText(null):t.setCommentText("")},scopeType:E.ContextMenuRegistry.ScopeType.BLOCK,id:"blockComment",weight:0})},E.ContextMenuItems.registerInline=function(){E.ContextMenuRegistry.registry.register({displayText:function(t){return t.block.getInputsInline()?E.Msg.EXTERNAL_INPUTS:E.Msg.INLINE_INPUTS},preconditionFn:function(t){if(!(t=t.block).isInFlyout&&t.isMovable()&&!t.isCollapsed())for(var e=1;e<t.inputList.length;e++)if(t.inputList[e-1].type!=E.NEXT_STATEMENT&&t.inputList[e].type!=E.NEXT_STATEMENT)return"enabled";return"hidden"},callback:function(t){t.block.setInputsInline(!t.block.getInputsInline())},scopeType:E.ContextMenuRegistry.ScopeType.BLOCK,id:"blockInline",weight:0})},E.ContextMenuItems.registerCollapseExpandBlock=function(){E.ContextMenuRegistry.registry.register({displayText:function(t){return t.block.isCollapsed()?E.Msg.EXPAND_BLOCK:E.Msg.COLLAPSE_BLOCK},preconditionFn:function(t){return!(t=t.block).isInFlyout&&t.isMovable()?"enabled":"hidden"},callback:function(t){t.block.setCollapsed(!t.block.isCollapsed())},scopeType:E.ContextMenuRegistry.ScopeType.BLOCK,id:"blockCollapseExpand",weight:0})},E.ContextMenuItems.registerDisable=function(){E.ContextMenuRegistry.registry.register({displayText:function(t){return t.block.isEnabled()?E.Msg.DISABLE_BLOCK:E.Msg.ENABLE_BLOCK},preconditionFn:function(t){return!(t=t.block).isInFlyout&&t.workspace.options.disable&&t.isEditable()?t.getInheritedDisabled()?"disabled":"enabled":"hidden"},callback:function(t){t=t.block;var e=E.Events.getGroup();e||E.Events.setGroup(!0),t.setEnabled(!t.isEnabled()),e||E.Events.setGroup(!1)},scopeType:E.ContextMenuRegistry.ScopeType.BLOCK,id:"blockDisable",weight:0})},E.ContextMenuItems.registerDelete=function(){E.ContextMenuRegistry.registry.register({displayText:function(t){var e=t.block;return t=e.getDescendants(!1).length,(e=e.getNextBlock())&&(t-=e.getDescendants(!1).length),1==t?E.Msg.DELETE_BLOCK:E.Msg.DELETE_X_BLOCKS.replace("%1",String(t))},preconditionFn:function(t){return!t.block.isInFlyout&&t.block.isDeletable()?"enabled":"hidden"},callback:function(t){E.Events.setGroup(!0),t.block.dispose(!0,!0),E.Events.setGroup(!1)},scopeType:E.ContextMenuRegistry.ScopeType.BLOCK,id:"blockDelete",weight:0})},E.ContextMenuItems.registerHelp=function(){E.ContextMenuRegistry.registry.register({displayText:function(){return E.Msg.HELP},preconditionFn:function(t){return("function"==typeof(t=t.block).helpUrl?t.helpUrl():t.helpUrl)?"enabled":"hidden"},callback:function(t){t.block.showHelp()},scopeType:E.ContextMenuRegistry.ScopeType.BLOCK,id:"blockHelp",weight:0})},E.ContextMenuItems.registerBlockOptions_=function(){E.ContextMenuItems.registerDuplicate(),E.ContextMenuItems.registerComment(),E.ContextMenuItems.registerInline(),E.ContextMenuItems.registerCollapseExpandBlock(),E.ContextMenuItems.registerDisable(),E.ContextMenuItems.registerDelete(),E.ContextMenuItems.registerHelp()},E.ContextMenuItems.registerDefaultOptions=function(){E.ContextMenuItems.registerWorkspaceOptions_(),E.ContextMenuItems.registerBlockOptions_()},E.ContextMenuRegistry=function(){(E.ContextMenuRegistry.registry=this).registry_={},E.ContextMenuItems.registerDefaultOptions()},E.ContextMenuRegistry.ScopeType={BLOCK:"block",WORKSPACE:"workspace"},E.ContextMenuRegistry.registry=null,E.ContextMenuRegistry.prototype.register=function(t){if(this.registry_[t.id])throw Error('Menu item with id "'+t.id+'" is already registered.');this.registry_[t.id]=t},E.ContextMenuRegistry.prototype.unregister=function(t){if(!this.registry_[t])throw Error('Menu item with id "'+t+'" not found.');delete this.registry_[t]},E.ContextMenuRegistry.prototype.getItem=function(t){return this.registry_[t]?this.registry_[t]:null},E.ContextMenuRegistry.prototype.getContextMenuOptions=function(o,n){var i=[],r=this.registry_;return Object.keys(r).forEach(function(t){if(t=r[t],o==t.scopeType){var e=t.preconditionFn(n);"hidden"!=e&&(t={text:"function"==typeof t.displayText?t.displayText(n):t.displayText,enabled:"enabled"==e,callback:t.callback,scope:n,weight:t.weight},i.push(t))}}),i.sort(function(t,e){return t.weight-e.weight}),i},new E.ContextMenuRegistry,E.RenderedConnection=function(t,e){E.RenderedConnection.superClass_.constructor.call(this,t,e),this.db_=t.workspace.connectionDBList[e],this.dbOpposite_=t.workspace.connectionDBList[E.OPPOSITE_TYPE[e]],this.offsetInBlock_=new E.utils.Coordinate(0,0),this.trackedState_=E.RenderedConnection.TrackedState.WILL_TRACK,this.targetConnection=null},E.utils.object.inherits(E.RenderedConnection,E.Connection),E.RenderedConnection.TrackedState={WILL_TRACK:-1,UNTRACKED:0,TRACKED:1},E.RenderedConnection.prototype.dispose=function(){E.RenderedConnection.superClass_.dispose.call(this),this.trackedState_==E.RenderedConnection.TrackedState.TRACKED&&this.db_.removeConnection(this,this.y)},E.RenderedConnection.prototype.getSourceBlock=function(){return E.RenderedConnection.superClass_.getSourceBlock.call(this)},E.RenderedConnection.prototype.targetBlock=function(){return E.RenderedConnection.superClass_.targetBlock.call(this)},E.RenderedConnection.prototype.distanceFrom=function(t){var e=this.x-t.x;return t=this.y-t.y,Math.sqrt(e*e+t*t)},E.RenderedConnection.prototype.bumpAwayFrom=function(t){if(!this.sourceBlock_.workspace.isDragging()){var e=this.sourceBlock_.getRootBlock();if(!e.isInFlyout){var o=!1;if(!e.isMovable()){if(!(e=t.getSourceBlock().getRootBlock()).isMovable())return;t=this,o=!0}var n=E.selected==e;n||e.addSelect();var i=t.x+E.SNAP_RADIUS+Math.floor(Math.random()*E.BUMP_RANDOMNESS)-this.x,r=t.y+E.SNAP_RADIUS+Math.floor(Math.random()*E.BUMP_RANDOMNESS)-this.y;o&&(r=-r),e.RTL&&(i=t.x-E.SNAP_RADIUS-Math.floor(Math.random()*E.BUMP_RANDOMNESS)-this.x),e.moveBy(i,r),n||e.removeSelect()}}},E.RenderedConnection.prototype.moveTo=function(t,e){this.trackedState_==E.RenderedConnection.TrackedState.WILL_TRACK?(this.db_.addConnection(this,e),this.trackedState_=E.RenderedConnection.TrackedState.TRACKED):this.trackedState_==E.RenderedConnection.TrackedState.TRACKED&&(this.db_.removeConnection(this,this.y),this.db_.addConnection(this,e)),this.x=t,this.y=e},E.RenderedConnection.prototype.moveBy=function(t,e){this.moveTo(this.x+t,this.y+e)},E.RenderedConnection.prototype.moveToOffset=function(t){this.moveTo(t.x+this.offsetInBlock_.x,t.y+this.offsetInBlock_.y)},E.RenderedConnection.prototype.setOffsetInBlock=function(t,e){this.offsetInBlock_.x=t,this.offsetInBlock_.y=e},E.RenderedConnection.prototype.getOffsetInBlock=function(){return this.offsetInBlock_},E.RenderedConnection.prototype.tighten=function(){var t=this.targetConnection.x-this.x,e=this.targetConnection.y-this.y;if(0!=t||0!=e){var o=this.targetBlock(),n=o.getSvgRoot();if(!n)throw Error("block is not rendered.");n=E.utils.getRelativeXY(n),o.getSvgRoot().setAttribute("transform","translate("+(n.x-t)+","+(n.y-e)+")"),o.moveConnections(-t,-e)}},E.RenderedConnection.prototype.closest=function(t,e){return this.dbOpposite_.searchForClosest(this,t,e)},E.RenderedConnection.prototype.highlight=function(){var t=this.sourceBlock_.workspace.getRenderer().getConstants(),e=t.shapeFor(this);e=this.type==E.INPUT_VALUE||this.type==E.OUTPUT_VALUE?(t=t.TAB_OFFSET_FROM_TOP,E.utils.svgPaths.moveBy(0,-t)+E.utils.svgPaths.lineOnAxis("v",t)+e.pathDown+E.utils.svgPaths.lineOnAxis("v",t)):(t=t.NOTCH_OFFSET_LEFT-t.CORNER_RADIUS,E.utils.svgPaths.moveBy(-t,0)+E.utils.svgPaths.lineOnAxis("h",t)+e.pathLeft+E.utils.svgPaths.lineOnAxis("h",t)),t=this.sourceBlock_.getRelativeToSurfaceXY(),E.Connection.highlightedPath_=E.utils.dom.createSvgElement(E.utils.Svg.PATH,{class:"blocklyHighlightedConnectionPath",d:e,transform:"translate("+(this.x-t.x)+","+(this.y-t.y)+")"+(this.sourceBlock_.RTL?" scale(-1 1)":"")},this.sourceBlock_.getSvgRoot())},E.RenderedConnection.prototype.unhighlight=function(){E.utils.dom.removeNode(E.Connection.highlightedPath_),delete E.Connection.highlightedPath_},E.RenderedConnection.prototype.setTracking=function(t){t&&this.trackedState_==E.RenderedConnection.TrackedState.TRACKED||!t&&this.trackedState_==E.RenderedConnection.TrackedState.UNTRACKED||this.sourceBlock_.isInFlyout||(t?(this.db_.addConnection(this,this.y),this.trackedState_=E.RenderedConnection.TrackedState.TRACKED):(this.trackedState_==E.RenderedConnection.TrackedState.TRACKED&&this.db_.removeConnection(this,this.y),this.trackedState_=E.RenderedConnection.TrackedState.UNTRACKED))},E.RenderedConnection.prototype.stopTrackingAll=function(){if(this.setTracking(!1),this.targetConnection)for(var t=this.targetBlock().getDescendants(!1),e=0;e<t.length;e++){for(var o=t[e],n=o.getConnections_(!0),i=0;i<n.length;i++)n[i].setTracking(!1);for(o=o.getIcons(),i=0;i<o.length;i++)o[i].setVisible(!1)}},E.RenderedConnection.prototype.startTrackingAll=function(){this.setTracking(!0);var t=[];if(this.type!=E.INPUT_VALUE&&this.type!=E.NEXT_STATEMENT)return t;var e=this.targetBlock();if(e){if(e.isCollapsed()){var o=[];e.outputConnection&&o.push(e.outputConnection),e.nextConnection&&o.push(e.nextConnection),e.previousConnection&&o.push(e.previousConnection)}else o=e.getConnections_(!0);for(var n=0;n<o.length;n++)t.push.apply(t,o[n].startTrackingAll());t.length||(t[0]=e)}return t},E.RenderedConnection.prototype.isConnectionAllowed=function(t,e){return E.utils.deprecation.warn("RenderedConnection.prototype.isConnectionAllowed","July 2020","July 2021","Blockly.Workspace.prototype.getConnectionChecker().canConnect"),!(this.distanceFrom(t)>e)&&E.RenderedConnection.superClass_.isConnectionAllowed.call(this,t)},E.RenderedConnection.prototype.onFailedConnect=function(t){this.bumpAwayFrom(t)},E.RenderedConnection.prototype.disconnectInternal_=function(t,e){E.RenderedConnection.superClass_.disconnectInternal_.call(this,t,e),t.rendered&&t.render(),e.rendered&&(e.updateDisabled(),e.render(),e.getSvgRoot().style.display="block")},E.RenderedConnection.prototype.respawnShadow_=function(){E.RenderedConnection.superClass_.respawnShadow_.call(this);var t=this.targetBlock();t&&(t.initSvg(),t.render(!1),(t=this.getSourceBlock()).rendered&&t.render())},E.RenderedConnection.prototype.neighbours=function(t){return this.dbOpposite_.getNeighbours(this,t)},E.RenderedConnection.prototype.connect_=function(t){E.RenderedConnection.superClass_.connect_.call(this,t);var e=this.getSourceBlock();t=t.getSourceBlock();var o=e.rendered,n=t.rendered;o&&e.updateDisabled(),n&&t.updateDisabled(),o&&n&&(this.type==E.NEXT_STATEMENT||this.type==E.PREVIOUS_STATEMENT?t.render():e.render()),(e=e.getInputWithBlock(t))&&(e=e.isVisible(),t.getSvgRoot().style.display=e?"block":"none")},E.RenderedConnection.prototype.onCheckChanged_=function(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||((this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug(),this.sourceBlock_.bumpNeighbours())},E.Marker=function(){this.drawer_=this.curNode_=this.colour=null,this.type="marker"},E.Marker.prototype.setDrawer=function(t){this.drawer_=t},E.Marker.prototype.getDrawer=function(){return this.drawer_},E.Marker.prototype.getCurNode=function(){return this.curNode_},E.Marker.prototype.setCurNode=function(t){var e=this.curNode_;this.curNode_=t,this.drawer_&&this.drawer_.draw(e,this.curNode_)},E.Marker.prototype.draw=function(){this.drawer_&&this.drawer_.draw(this.curNode_,this.curNode_)},E.Marker.prototype.hide=function(){this.drawer_&&this.drawer_.hide()},E.Marker.prototype.dispose=function(){this.getDrawer()&&this.getDrawer().dispose()},E.Cursor=function(){E.Cursor.superClass_.constructor.call(this),this.type="cursor"},E.utils.object.inherits(E.Cursor,E.Marker),E.Cursor.prototype.next=function(){var t=this.getCurNode();if(!t)return null;for(t=t.next();t&&t.next()&&(t.getType()==E.ASTNode.types.NEXT||t.getType()==E.ASTNode.types.BLOCK);)t=t.next();return t&&this.setCurNode(t),t},E.Cursor.prototype.in=function(){var t=this.getCurNode();return t?(t.getType()!=E.ASTNode.types.PREVIOUS&&t.getType()!=E.ASTNode.types.OUTPUT||(t=t.next()),(t=t.in())&&this.setCurNode(t),t):null},E.Cursor.prototype.prev=function(){var t=this.getCurNode();if(!t)return null;for(t=t.prev();t&&t.prev()&&(t.getType()==E.ASTNode.types.NEXT||t.getType()==E.ASTNode.types.BLOCK);)t=t.prev();return t&&this.setCurNode(t),t},E.Cursor.prototype.out=function(){var t=this.getCurNode();return t?((t=t.out())&&t.getType()==E.ASTNode.types.BLOCK&&(t=t.prev()||t),t&&this.setCurNode(t),t):null},E.Cursor.prototype.onBlocklyAction=function(t){if(this.getCurNode()&&this.getCurNode().getType()===E.ASTNode.types.FIELD&&this.getCurNode().getLocation().onBlocklyAction(t))return!0;switch(t.name){case E.navigation.actionNames.PREVIOUS:return this.prev(),!0;case E.navigation.actionNames.OUT:return this.out(),!0;case E.navigation.actionNames.NEXT:return this.next(),!0;case E.navigation.actionNames.IN:return this.in(),!0;default:return!1}},E.BasicCursor=function(){E.BasicCursor.superClass_.constructor.call(this)},E.utils.object.inherits(E.BasicCursor,E.Cursor),E.BasicCursor.prototype.next=function(){var t=this.getCurNode();return t?((t=this.getNextNode_(t,this.validNode_))&&this.setCurNode(t),t):null},E.BasicCursor.prototype.in=function(){return this.next()},E.BasicCursor.prototype.prev=function(){var t=this.getCurNode();return t?((t=this.getPreviousNode_(t,this.validNode_))&&this.setCurNode(t),t):null},E.BasicCursor.prototype.out=function(){return this.prev()},E.BasicCursor.prototype.getNextNode_=function(t,e){if(!t)return null;var o=t.in()||t.next();return e(o)?o:o?this.getNextNode_(o,e):e(t=this.findSiblingOrParent_(t.out()))?t:t?this.getNextNode_(t,e):null},E.BasicCursor.prototype.getPreviousNode_=function(t,e){if(!t)return null;var o=t.prev();return e(o=o?this.getRightMostChild_(o):t.out())?o:o?this.getPreviousNode_(o,e):null},E.BasicCursor.prototype.validNode_=function(t){var e=!1;return(t=t&&t.getType())!=E.ASTNode.types.OUTPUT&&t!=E.ASTNode.types.INPUT&&t!=E.ASTNode.types.FIELD&&t!=E.ASTNode.types.NEXT&&t!=E.ASTNode.types.PREVIOUS&&t!=E.ASTNode.types.WORKSPACE||(e=!0),e},E.BasicCursor.prototype.findSiblingOrParent_=function(t){if(!t)return null;var e=t.next();return e||this.findSiblingOrParent_(t.out())},E.BasicCursor.prototype.getRightMostChild_=function(t){if(!t.in())return t;for(t=t.in();t.next();)t=t.next();return this.getRightMostChild_(t)},E.TabNavigateCursor=function(){E.TabNavigateCursor.superClass_.constructor.call(this)},E.utils.object.inherits(E.TabNavigateCursor,E.BasicCursor),E.TabNavigateCursor.prototype.validNode_=function(t){var e=!1,o=t&&t.getType();return t&&(t=t.getLocation(),o==E.ASTNode.types.FIELD&&t&&t.isTabNavigable()&&t.isClickable()&&(e=!0)),e},E.BlockSvg=function(t,e,o){this.svgGroup_=E.utils.dom.createSvgElement(E.utils.Svg.G,{},null),this.svgGroup_.translate_="",this.style=t.getRenderer().getConstants().getBlockStyle(null),this.pathObject=t.getRenderer().makePathObject(this.svgGroup_,this.style),this.renderIsInProgress_=this.rendered=!1,this.workspace=t,this.previousConnection=this.nextConnection=this.outputConnection=null,this.useDragSurface_=E.utils.is3dSupported()&&!!t.getBlockDragSurface();var n=this.pathObject.svgPath;n.tooltip=this,E.Tooltip.bindMouseEvents(n),E.BlockSvg.superClass_.constructor.call(this,t,e,o),this.svgGroup_.dataset&&(this.svgGroup_.dataset.id=this.id)},E.utils.object.inherits(E.BlockSvg,E.Block),E.BlockSvg.prototype.height=0,E.BlockSvg.prototype.width=0,E.BlockSvg.prototype.warningTextDb_=null,E.BlockSvg.INLINE=-1,E.BlockSvg.COLLAPSED_WARNING_ID="TEMP_COLLAPSED_WARNING_",E.BlockSvg.prototype.initSvg=function(){if(!this.workspace.rendered)throw TypeError("Workspace is headless.");for(var t,e=0;t=this.inputList[e];e++)t.init();for(t=this.getIcons(),e=0;e<t.length;e++)t[e].createIcon();this.applyColour(),this.pathObject.updateMovable(this.isMovable()),e=this.getSvgRoot(),this.workspace.options.readOnly||this.eventsInit_||!e||E.bindEventWithChecks_(e,"mousedown",this,this.onMouseDown_),this.eventsInit_=!0,e.parentNode||this.workspace.getCanvas().appendChild(e)},E.BlockSvg.prototype.getColourSecondary=function(){return this.style.colourSecondary},E.BlockSvg.prototype.getColourTertiary=function(){return this.style.colourTertiary},E.BlockSvg.prototype.getColourShadow=function(){return E.utils.deprecation.warn("BlockSvg.prototype.getColourShadow","January 2020","January 2021","style.colourSecondary"),this.getColourSecondary()},E.BlockSvg.prototype.getColourBorder=function(){return E.utils.deprecation.warn("BlockSvg.prototype.getColourBorder","January 2020","January 2021","style.colourTertiary"),{colourBorder:this.getColourTertiary(),colourLight:null,colourDark:null}},E.BlockSvg.prototype.select=function(){if(this.isShadow()&&this.getParent())this.getParent().select();else if(E.selected!=this){var t=null;if(E.selected){t=E.selected.id,E.Events.disable();try{E.selected.unselect()}finally{E.Events.enable()}}(t=new E.Events.Ui(null,"selected",t,this.id)).workspaceId=this.workspace.id,E.Events.fire(t),(E.selected=this).addSelect()}},E.BlockSvg.prototype.unselect=function(){if(E.selected==this){var t=new E.Events.Ui(null,"selected",this.id,null);t.workspaceId=this.workspace.id,E.Events.fire(t),E.selected=null,this.removeSelect()}},E.BlockSvg.prototype.mutator=null,E.BlockSvg.prototype.comment=null,E.BlockSvg.prototype.commentIcon_=null,E.BlockSvg.prototype.warning=null,E.BlockSvg.prototype.getIcons=function(){var t=[];return this.mutator&&t.push(this.mutator),this.commentIcon_&&t.push(this.commentIcon_),this.warning&&t.push(this.warning),t},E.BlockSvg.prototype.setParent=function(t){var e=this.parentBlock_;if(t!=e){E.utils.dom.startTextWidthCache(),E.BlockSvg.superClass_.setParent.call(this,t),E.utils.dom.stopTextWidthCache();var o=this.getSvgRoot();if(!this.workspace.isClearing&&o){var n=this.getRelativeToSurfaceXY();t?(t.getSvgRoot().appendChild(o),t=this.getRelativeToSurfaceXY(),this.moveConnections(t.x-n.x,t.y-n.y)):e&&(this.workspace.getCanvas().appendChild(o),this.translate(n.x,n.y)),this.applyColour()}}},E.BlockSvg.prototype.getRelativeToSurfaceXY=function(){var t=0,e=0,o=this.useDragSurface_?this.workspace.getBlockDragSurface().getGroup():null,n=this.getSvgRoot();if(n)do{var i=E.utils.getRelativeXY(n);t+=i.x,e+=i.y,this.useDragSurface_&&this.workspace.getBlockDragSurface().getCurrentBlock()==n&&(t+=(i=this.workspace.getBlockDragSurface().getSurfaceTranslation()).x,e+=i.y),n=n.parentNode}while(n&&n!=this.workspace.getCanvas()&&n!=o);return new E.utils.Coordinate(t,e)},E.BlockSvg.prototype.moveBy=function(t,e){if(this.parentBlock_)throw Error("Block has parent.");var o=E.Events.isEnabled();if(o)var n=new E.Events.BlockMove(this);var i=this.getRelativeToSurfaceXY();this.translate(i.x+t,i.y+e),this.moveConnections(t,e),o&&(n.recordNew(),E.Events.fire(n)),this.workspace.resizeContents()},E.BlockSvg.prototype.translate=function(t,e){this.getSvgRoot().setAttribute("transform","translate("+t+","+e+")")},E.BlockSvg.prototype.moveToDragSurface=function(){if(this.useDragSurface_){var t=this.getRelativeToSurfaceXY();this.clearTransformAttributes_(),this.workspace.getBlockDragSurface().translateSurface(t.x,t.y),(t=this.getSvgRoot())&&this.workspace.getBlockDragSurface().setBlocksAndShow(t)}},E.BlockSvg.prototype.moveTo=function(t){var e=this.getRelativeToSurfaceXY();this.moveBy(t.x-e.x,t.y-e.y)},E.BlockSvg.prototype.moveOffDragSurface=function(t){this.useDragSurface_&&(this.translate(t.x,t.y),this.workspace.getBlockDragSurface().clearAndHide(this.workspace.getCanvas()))},E.BlockSvg.prototype.moveDuringDrag=function(t){this.useDragSurface_?this.workspace.getBlockDragSurface().translateSurface(t.x,t.y):(this.svgGroup_.translate_="translate("+t.x+","+t.y+")",this.svgGroup_.setAttribute("transform",this.svgGroup_.translate_+this.svgGroup_.skew_))},E.BlockSvg.prototype.clearTransformAttributes_=function(){this.getSvgRoot().removeAttribute("transform")},E.BlockSvg.prototype.snapToGrid=function(){if(this.workspace&&!this.workspace.isDragging()&&!this.getParent()&&!this.isInFlyout){var t=this.workspace.getGrid();if(t&&t.shouldSnap()){var e=t.getSpacing(),o=e/2,n=this.getRelativeToSurfaceXY();t=Math.round((n.x-o)/e)*e+o-n.x,e=Math.round((n.y-o)/e)*e+o-n.y,t=Math.round(t),e=Math.round(e),0==t&&0==e||this.moveBy(t,e)}}},E.BlockSvg.prototype.getBoundingRectangle=function(){var t=this.getRelativeToSurfaceXY(),e=this.getHeightWidth();if(this.RTL)var o=t.x-e.width,n=t.x;else o=t.x,n=t.x+e.width;return new E.utils.Rect(t.y,t.y+e.height,o,n)},E.BlockSvg.prototype.markDirty=function(){this.pathObject.constants=this.workspace.getRenderer().getConstants();for(var t,e=0;t=this.inputList[e];e++)t.markDirty()},E.BlockSvg.prototype.setCollapsed=function(t){this.collapsed_!=t&&(E.BlockSvg.superClass_.setCollapsed.call(this,t),t?this.rendered&&this.render():this.updateCollapsed_())},E.BlockSvg.prototype.updateCollapsed_=function(){for(var t,e=this.isCollapsed(),o=E.Block.COLLAPSED_INPUT_NAME,n=E.Block.COLLAPSED_FIELD_NAME,i=0;t=this.inputList[i];i++)t.name!=o&&t.setVisible(!e);if(e){for(t=this.getIcons(),i=0;e=t[i];i++)e.setVisible(!1);i=this.toString(E.COLLAPSE_CHARS),(t=this.getField(n))?t.setValue(i):(t=this.getInput(o)||this.appendDummyInput(o)).appendField(new E.FieldLabel(i),n)}else this.removeInput(o)},E.BlockSvg.prototype.tab=function(t,e){var o=new E.TabNavigateCursor;o.setCurNode(E.ASTNode.createFieldNode(t)),t=o.getCurNode(),o.onBlocklyAction(e?E.navigation.ACTION_NEXT:E.navigation.ACTION_PREVIOUS),(e=o.getCurNode())&&e!==t&&(e.getLocation().showEditor(),this.workspace.keyboardAccessibilityMode&&this.workspace.getCursor().setCurNode(e))},E.BlockSvg.prototype.onMouseDown_=function(t){var e=this.workspace&&this.workspace.getGesture(t);e&&e.handleBlockStart(t,this)},E.BlockSvg.prototype.showHelp=function(){var t="function"==typeof this.helpUrl?this.helpUrl():this.helpUrl;t&&window.open(t)},E.BlockSvg.prototype.generateContextMenu=function(){if(this.workspace.options.readOnly||!this.contextMenu)return null;var t=E.ContextMenuRegistry.registry.getContextMenuOptions(E.ContextMenuRegistry.ScopeType.BLOCK,{block:this});return this.customContextMenu&&this.customContextMenu(t),t},E.BlockSvg.prototype.showContextMenu=function(t){var e=this.generateContextMenu();e&&e.length&&(E.ContextMenu.show(t,e,this.RTL),E.ContextMenu.currentBlock=this)},E.BlockSvg.prototype.moveConnections=function(t,e){if(this.rendered){for(var o=this.getConnections_(!1),n=0;n<o.length;n++)o[n].moveBy(t,e);for(o=this.getIcons(),n=0;n<o.length;n++)o[n].computeIconLocation();for(n=0;n<this.childBlocks_.length;n++)this.childBlocks_[n].moveConnections(t,e)}},E.BlockSvg.prototype.setDragging=function(t){if(t){var e=this.getSvgRoot();e.translate_="",e.skew_="",E.draggingConnections=E.draggingConnections.concat(this.getConnections_(!0)),E.utils.dom.addClass(this.svgGroup_,"blocklyDragging")}else E.draggingConnections=[],E.utils.dom.removeClass(this.svgGroup_,"blocklyDragging");for(e=0;e<this.childBlocks_.length;e++)this.childBlocks_[e].setDragging(t)},E.BlockSvg.prototype.setMovable=function(t){E.BlockSvg.superClass_.setMovable.call(this,t),this.pathObject.updateMovable(t)},E.BlockSvg.prototype.setEditable=function(t){E.BlockSvg.superClass_.setEditable.call(this,t),t=this.getIcons();for(var e=0;e<t.length;e++)t[e].updateEditable()},E.BlockSvg.prototype.setShadow=function(t){E.BlockSvg.superClass_.setShadow.call(this,t),this.applyColour()},E.BlockSvg.prototype.setInsertionMarker=function(t){this.isInsertionMarker_!=t&&(this.isInsertionMarker_=t)&&(this.setColour(this.workspace.getRenderer().getConstants().INSERTION_MARKER_COLOUR),this.pathObject.updateInsertionMarker(!0))},E.BlockSvg.prototype.getSvgRoot=function(){return this.svgGroup_},E.BlockSvg.prototype.dispose=function(t,e){if(this.workspace){E.Tooltip.dispose(),E.Tooltip.unbindMouseEvents(this.pathObject.svgPath),E.utils.dom.startTextWidthCache();var o=this.workspace;if(E.selected==this&&(this.unselect(),this.workspace.cancelCurrentGesture()),E.ContextMenu.currentBlock==this&&E.ContextMenu.hide(),this.workspace.keyboardAccessibilityMode&&E.navigation.moveCursorOnBlockDelete(this),e&&this.rendered&&(this.unplug(t),E.blockAnimations.disposeUiEffect(this)),this.rendered=!1,this.warningTextDb_){for(var n in this.warningTextDb_)clearTimeout(this.warningTextDb_[n]);this.warningTextDb_=null}for(e=this.getIcons(),n=0;n<e.length;n++)e[n].dispose();E.BlockSvg.superClass_.dispose.call(this,!!t),E.utils.dom.removeNode(this.svgGroup_),o.resizeContents(),this.svgGroup_=null,E.utils.dom.stopTextWidthCache()}},E.BlockSvg.prototype.toCopyData=function(){if(this.isInsertionMarker_)return null;var t=E.Xml.blockToDom(this,!0);E.Xml.deleteNext(t);var e=this.getRelativeToSurfaceXY();return t.setAttribute("x",this.RTL?-e.x:e.x),t.setAttribute("y",e.y),{xml:t,source:this.workspace,typeCounts:E.utils.getBlockTypeCounts(this,!0)}},E.BlockSvg.prototype.applyColour=function(){this.pathObject.applyColour(this);for(var t=this.getIcons(),e=0;e<t.length;e++)t[e].applyColour();for(t=0;e=this.inputList[t];t++)for(var o,n=0;o=e.fieldRow[n];n++)o.applyColour()},E.BlockSvg.prototype.updateDisabled=function(){var t=this.getChildren(!1);if(this.applyColour(),!this.isCollapsed())for(var e,o=0;e=t[o];o++)e.rendered&&e.updateDisabled()},E.BlockSvg.prototype.getCommentIcon=function(){return this.commentIcon_},E.BlockSvg.prototype.setCommentText=function(t){if(!E.Comment)throw Error("Missing require for Blockly.Comment");this.commentModel.text!=t&&(E.BlockSvg.superClass_.setCommentText.call(this,t),t=null!=t,!!this.commentIcon_==t?this.commentIcon_.updateText():(t?this.comment=this.commentIcon_=new E.Comment(this):(this.commentIcon_.dispose(),this.comment=this.commentIcon_=null),this.rendered&&(this.render(),this.bumpNeighbours())))},E.BlockSvg.prototype.setWarningText=function(t,e){if(!E.Warning)throw Error("Missing require for Blockly.Warning");this.warningTextDb_||(this.warningTextDb_=Object.create(null));var o=e||"";if(o)this.warningTextDb_[o]&&(clearTimeout(this.warningTextDb_[o]),delete this.warningTextDb_[o]);else for(var n in this.warningTextDb_)clearTimeout(this.warningTextDb_[n]),delete this.warningTextDb_[n];if(this.workspace.isDragging()){var i=this;this.warningTextDb_[o]=setTimeout(function(){i.workspace&&(delete i.warningTextDb_[o],i.setWarningText(t,o))},100)}else{if(this.isInFlyout&&(t=null),e=!1,"string"==typeof t){n=this.getSurroundParent();for(var r=null;n;)n.isCollapsed()&&(r=n),n=n.getSurroundParent();r&&r.setWarningText(E.Msg.COLLAPSED_WARNINGS_WARNING,E.BlockSvg.COLLAPSED_WARNING_ID),this.warning||(this.warning=new E.Warning(this),e=!0),this.warning.setText(t,o)}else this.warning&&!o?(this.warning.dispose(),e=!0):this.warning&&(e=this.warning.getText(),this.warning.setText("",o),(n=this.warning.getText())||this.warning.dispose(),e=e!=n);e&&this.rendered&&(this.render(),this.bumpNeighbours())}},E.BlockSvg.prototype.setMutator=function(t){this.mutator&&this.mutator!==t&&this.mutator.dispose(),t&&(t.setBlock(this),(this.mutator=t).createIcon()),this.rendered&&(this.render(),this.bumpNeighbours())},E.BlockSvg.prototype.setDisabled=function(t){E.utils.deprecation.warn("BlockSvg.prototype.setDisabled","May 2019","May 2020","BlockSvg.prototype.setEnabled"),this.setEnabled(!t)},E.BlockSvg.prototype.setEnabled=function(t){this.isEnabled()!=t&&(E.BlockSvg.superClass_.setEnabled.call(this,t),this.rendered&&!this.getInheritedDisabled()&&this.updateDisabled())},E.BlockSvg.prototype.setHighlighted=function(t){this.rendered&&this.pathObject.updateHighlighted(t)},E.BlockSvg.prototype.addSelect=function(){this.pathObject.updateSelected(!0)},E.BlockSvg.prototype.removeSelect=function(){this.pathObject.updateSelected(!1)},E.BlockSvg.prototype.setDeleteStyle=function(t){this.pathObject.updateDraggingDelete(t)},E.BlockSvg.prototype.getColour=function(){return this.style.colourPrimary},E.BlockSvg.prototype.setColour=function(t){E.BlockSvg.superClass_.setColour.call(this,t),t=this.workspace.getRenderer().getConstants().getBlockStyleForColour(this.colour_),this.pathObject.setStyle(t.style),this.style=t.style,this.styleName_=t.name,this.applyColour()},E.BlockSvg.prototype.setStyle=function(t){var e=this.workspace.getRenderer().getConstants().getBlockStyle(t);if(this.styleName_=t,!e)throw Error("Invalid style name: "+t);this.hat=e.hat,this.pathObject.setStyle(e),this.colour_=e.colourPrimary,this.style=e,this.applyColour()},E.BlockSvg.prototype.bringToFront=function(){var t=this;do{var e=t.getSvgRoot(),o=e.parentNode,n=o.childNodes;n[n.length-1]!==e&&o.appendChild(e),t=t.getParent()}while(t)},E.BlockSvg.prototype.setPreviousStatement=function(t,e){E.BlockSvg.superClass_.setPreviousStatement.call(this,t,e),this.rendered&&(this.render(),this.bumpNeighbours())},E.BlockSvg.prototype.setNextStatement=function(t,e){E.BlockSvg.superClass_.setNextStatement.call(this,t,e),this.rendered&&(this.render(),this.bumpNeighbours())},E.BlockSvg.prototype.setOutput=function(t,e){E.BlockSvg.superClass_.setOutput.call(this,t,e),this.rendered&&(this.render(),this.bumpNeighbours())},E.BlockSvg.prototype.setInputsInline=function(t){E.BlockSvg.superClass_.setInputsInline.call(this,t),this.rendered&&(this.render(),this.bumpNeighbours())},E.BlockSvg.prototype.removeInput=function(t,e){return t=E.BlockSvg.superClass_.removeInput.call(this,t,e),this.rendered&&(this.render(),this.bumpNeighbours()),t},E.BlockSvg.prototype.moveNumberedInputBefore=function(t,e){E.BlockSvg.superClass_.moveNumberedInputBefore.call(this,t,e),this.rendered&&(this.render(),this.bumpNeighbours())},E.BlockSvg.prototype.appendInput_=function(t,e){return t=E.BlockSvg.superClass_.appendInput_.call(this,t,e),this.rendered&&(this.render(),this.bumpNeighbours()),t},E.BlockSvg.prototype.setConnectionTracking=function(t){if(this.previousConnection&&this.previousConnection.setTracking(t),this.outputConnection&&this.outputConnection.setTracking(t),this.nextConnection){this.nextConnection.setTracking(t);var e=this.nextConnection.targetBlock();e&&e.setConnectionTracking(t)}if(!this.collapsed_)for(e=0;e<this.inputList.length;e++){var o=this.inputList[e].connection;o&&(o.setTracking(t),(o=o.targetBlock())&&o.setConnectionTracking(t))}},E.BlockSvg.prototype.getConnections_=function(t){var e=[];if((t||this.rendered)&&(this.outputConnection&&e.push(this.outputConnection),this.previousConnection&&e.push(this.previousConnection),this.nextConnection&&e.push(this.nextConnection),t||!this.collapsed_)){t=0;for(var o;o=this.inputList[t];t++)o.connection&&e.push(o.connection)}return e},E.BlockSvg.prototype.lastConnectionInStack=function(){return E.BlockSvg.superClass_.lastConnectionInStack.call(this)},E.BlockSvg.prototype.getMatchingConnection=function(t,e){return E.BlockSvg.superClass_.getMatchingConnection.call(this,t,e)},E.BlockSvg.prototype.makeConnection_=function(t){return new E.RenderedConnection(this,t)},E.BlockSvg.prototype.bumpNeighbours=function(){if(this.workspace&&!this.workspace.isDragging()){var t=this.getRootBlock();if(!t.isInFlyout)for(var e,o=this.getConnections_(!1),n=0;e=o[n];n++){e.isConnected()&&e.isSuperior()&&e.targetBlock().bumpNeighbours();for(var i,r=e.neighbours(E.SNAP_RADIUS),s=0;i=r[s];s++)e.isConnected()&&i.isConnected()||i.getSourceBlock().getRootBlock()!=t&&(e.isSuperior()?i.bumpAwayFrom(e):e.bumpAwayFrom(i))}}},E.BlockSvg.prototype.scheduleSnapAndBump=function(){var t=this,e=E.Events.getGroup();setTimeout(function(){E.Events.setGroup(e),t.snapToGrid(),E.Events.setGroup(!1)},E.BUMP_DELAY/2),setTimeout(function(){E.Events.setGroup(e),t.bumpNeighbours(),E.Events.setGroup(!1)},E.BUMP_DELAY)},E.BlockSvg.prototype.positionNearConnection=function(t,e){t.type!=E.NEXT_STATEMENT&&t.type!=E.INPUT_VALUE||this.moveBy(e.x-t.x,e.y-t.y)},E.BlockSvg.prototype.getParent=function(){return E.BlockSvg.superClass_.getParent.call(this)},E.BlockSvg.prototype.getRootBlock=function(){return E.BlockSvg.superClass_.getRootBlock.call(this)},E.BlockSvg.prototype.render=function(t){if(!this.renderIsInProgress_){this.renderIsInProgress_=!0;try{if(this.rendered=!0,E.utils.dom.startTextWidthCache(),this.isCollapsed()&&this.updateCollapsed_(),this.workspace.getRenderer().render(this),this.updateConnectionLocations_(),!1!==t){var e=this.getParent();e?e.render(!0):this.workspace.resizeContents()}E.utils.dom.stopTextWidthCache(),this.updateMarkers_()}finally{this.renderIsInProgress_=!1}}},E.BlockSvg.prototype.updateMarkers_=function(){this.workspace.keyboardAccessibilityMode&&this.pathObject.cursorSvg&&this.workspace.getCursor().draw(),this.workspace.keyboardAccessibilityMode&&this.pathObject.markerSvg&&this.workspace.getMarker(E.navigation.MARKER_NAME).draw()},E.BlockSvg.prototype.updateConnectionLocations_=function(){var t=this.getRelativeToSurfaceXY();this.previousConnection&&this.previousConnection.moveToOffset(t),this.outputConnection&&this.outputConnection.moveToOffset(t);for(var e=0;e<this.inputList.length;e++){var o=this.inputList[e].connection;o&&(o.moveToOffset(t),o.isConnected()&&o.tighten())}this.nextConnection&&(this.nextConnection.moveToOffset(t),this.nextConnection.isConnected()&&this.nextConnection.tighten())},E.BlockSvg.prototype.setCursorSvg=function(t){this.pathObject.setCursorSvg(t)},E.BlockSvg.prototype.setMarkerSvg=function(t){this.pathObject.setMarkerSvg(t)},E.BlockSvg.prototype.getHeightWidth=function(){var t=this.height,e=this.width,o=this.getNextBlock();if(o){o=o.getHeightWidth();var n=this.workspace.getRenderer().getConstants().NOTCH_HEIGHT;t+=o.height-n,e=Math.max(e,o.width)}return{height:t,width:e}},E.BlockSvg.prototype.fadeForReplacement=function(t){this.pathObject.updateReplacementFade(t)},E.BlockSvg.prototype.highlightShapeForInput=function(t,e){this.pathObject.updateShapeForInputHighlight(t,e)},E.blockRendering.useDebugger=!1,E.blockRendering.register=function(t,e){E.registry.register(E.registry.Type.RENDERER,t,e)},E.blockRendering.unregister=function(t){E.registry.unregister(E.registry.Type.RENDERER,t)},E.blockRendering.startDebugger=function(){E.blockRendering.useDebugger=!0},E.blockRendering.stopDebugger=function(){E.blockRendering.useDebugger=!1},E.blockRendering.init=function(t,e,o){return(t=new(E.registry.getClass(E.registry.Type.RENDERER,t))(t)).init(e,o),t},E.ConnectionDB=function(t){this.connections_=[],this.connectionChecker_=t},E.ConnectionDB.prototype.addConnection=function(t,e){e=this.calculateIndexForYPos_(e),this.connections_.splice(e,0,t)},E.ConnectionDB.prototype.findIndexOfConnection_=function(t,e){if(!this.connections_.length)return-1;var o=this.calculateIndexForYPos_(e);if(o>=this.connections_.length)return-1;e=t.y;for(var n=o;0<=n&&this.connections_[n].y==e;){if(this.connections_[n]==t)return n;n--}for(;o<this.connections_.length&&this.connections_[o].y==e;){if(this.connections_[o]==t)return o;o++}return-1},E.ConnectionDB.prototype.calculateIndexForYPos_=function(t){if(!this.connections_.length)return 0;for(var e=0,o=this.connections_.length;e<o;){var n=Math.floor((e+o)/2);if(this.connections_[n].y<t)e=n+1;else{if(!(this.connections_[n].y>t)){e=n;break}o=n}}return e},E.ConnectionDB.prototype.removeConnection=function(t,e){if(-1==(t=this.findIndexOfConnection_(t,e)))throw Error("Unable to find connection in connectionDB.");this.connections_.splice(t,1)},E.ConnectionDB.prototype.getNeighbours=function(t,n){function e(t){var e=r-i[t].x,o=s-i[t].y;return Math.sqrt(e*e+o*o)<=n&&l.push(i[t]),o<n}var i=this.connections_,r=t.x,s=t.y;t=0;for(var o=i.length-2,a=o;t<a;)i[a].y<s?t=a:o=a,a=Math.floor((t+o)/2);var l=[];if(o=t=a,i.length){for(;0<=t&&e(t);)t--;for(;++o<i.length&&e(o););}return l},E.ConnectionDB.prototype.isInYRange_=function(t,e,o){return Math.abs(this.connections_[t].y-e)<=o},E.ConnectionDB.prototype.searchForClosest=function(t,e,o){if(!this.connections_.length)return{connection:null,radius:e};var n=t.y,i=t.x;t.x=i+o.x,t.y=n+o.y;var r=this.calculateIndexForYPos_(t.y);o=null;for(var s,a=e,l=r-1;0<=l&&this.isInYRange_(l,t.y,e);)s=this.connections_[l],this.connectionChecker_.canConnect(t,s,!0,a)&&(a=(o=s).distanceFrom(t)),l--;for(;r<this.connections_.length&&this.isInYRange_(r,t.y,e);)s=this.connections_[r],this.connectionChecker_.canConnect(t,s,!0,a)&&(a=(o=s).distanceFrom(t)),r++;return t.x=i,t.y=n,{connection:o,radius:a}},E.ConnectionDB.init=function(t){var e=[];return e[E.INPUT_VALUE]=new E.ConnectionDB(t),e[E.OUTPUT_VALUE]=new E.ConnectionDB(t),e[E.NEXT_STATEMENT]=new E.ConnectionDB(t),e[E.PREVIOUS_STATEMENT]=new E.ConnectionDB(t),e},E.MarkerManager=function(t){this.cursorSvg_=this.cursor_=null,this.markers_={},this.workspace_=t},E.MarkerManager.prototype.registerMarker=function(t,e){this.markers_[t]&&this.unregisterMarker(t),e.setDrawer(this.workspace_.getRenderer().makeMarkerDrawer(this.workspace_,e)),this.setMarkerSvg(e.getDrawer().createDom()),this.markers_[t]=e},E.MarkerManager.prototype.unregisterMarker=function(t){var e=this.markers_[t];if(!e)throw Error("Marker with id "+t+" does not exist. Can only unregistermarkers that exist.");e.dispose(),delete this.markers_[t]},E.MarkerManager.prototype.getCursor=function(){return this.cursor_},E.MarkerManager.prototype.getMarker=function(t){return this.markers_[t]},E.MarkerManager.prototype.setCursor=function(t){this.cursor_&&this.cursor_.getDrawer()&&this.cursor_.getDrawer().dispose(),(this.cursor_=t)&&(t=this.workspace_.getRenderer().makeMarkerDrawer(this.workspace_,this.cursor_),this.cursor_.setDrawer(t),this.setCursorSvg(this.cursor_.getDrawer().createDom()))},E.MarkerManager.prototype.setCursorSvg=function(t){t?(this.workspace_.getBlockCanvas().appendChild(t),this.cursorSvg_=t):this.cursorSvg_=null},E.MarkerManager.prototype.setMarkerSvg=function(t){t?this.workspace_.getBlockCanvas()&&(this.cursorSvg_?this.workspace_.getBlockCanvas().insertBefore(t,this.cursorSvg_):this.workspace_.getBlockCanvas().appendChild(t)):this.markerSvg_=null},E.MarkerManager.prototype.updateMarkers=function(){this.workspace_.keyboardAccessibilityMode&&this.cursorSvg_&&this.workspace_.getCursor().draw()},E.MarkerManager.prototype.dispose=function(){for(var t,e=Object.keys(this.markers_),o=0;t=e[o];o++)this.unregisterMarker(t);this.markers_=null,this.cursor_&&(this.cursor_.dispose(),this.cursor_=null)},E.ThemeManager=function(t,e){this.workspace_=t,this.theme_=e,this.subscribedWorkspaces_=[],this.componentDB_=Object.create(null)},E.ThemeManager.prototype.getTheme=function(){return this.theme_},E.ThemeManager.prototype.setTheme=function(t){var e,o=this.theme_;for(this.theme_=t,(t=this.workspace_.getInjectionDiv())&&(o&&E.utils.dom.removeClass(t,o.getClassName()),E.utils.dom.addClass(t,this.theme_.getClassName())),o=0;t=this.subscribedWorkspaces_[o];o++)t.refreshTheme();for(o=0,t=Object.keys(this.componentDB_);e=t[o];o++)for(var n,i=0;n=this.componentDB_[e][i];i++){var r=n.element;n=n.propertyName;var s=this.theme_&&this.theme_.getComponentStyle(e);r.style[n]=s||""}E.hideChaff()},E.ThemeManager.prototype.subscribeWorkspace=function(t){this.subscribedWorkspaces_.push(t)},E.ThemeManager.prototype.unsubscribeWorkspace=function(t){if((t=this.subscribedWorkspaces_.indexOf(t))<0)throw Error("Cannot unsubscribe a workspace that hasn't been subscribed.");this.subscribedWorkspaces_.splice(t,1)},E.ThemeManager.prototype.subscribe=function(t,e,o){this.componentDB_[e]||(this.componentDB_[e]=[]),this.componentDB_[e].push({element:t,propertyName:o}),e=this.theme_&&this.theme_.getComponentStyle(e),t.style[o]=e||""},E.ThemeManager.prototype.unsubscribe=function(t){if(t)for(var e,o=Object.keys(this.componentDB_),n=0;e=o[n];n++){for(var i=this.componentDB_[e],r=i.length-1;0<=r;r--)i[r].element===t&&i.splice(r,1);this.componentDB_[e].length||delete this.componentDB_[e]}},E.ThemeManager.prototype.dispose=function(){this.componentDB_=this.subscribedWorkspaces_=this.theme_=this.owner_=null},E.TouchGesture=function(t,e){E.TouchGesture.superClass_.constructor.call(this,t,e),this.isMultiTouch_=!1,this.cachedPoints_=Object.create(null),this.startDistance_=this.previousScale_=0,this.isPinchZoomEnabled_=this.onStartWrapper_=null},E.utils.object.inherits(E.TouchGesture,E.Gesture),E.TouchGesture.ZOOM_IN_MULTIPLIER=5,E.TouchGesture.ZOOM_OUT_MULTIPLIER=6,E.TouchGesture.prototype.doStart=function(t){this.isPinchZoomEnabled_=this.startWorkspace_.options.zoomOptions&&this.startWorkspace_.options.zoomOptions.pinch,E.TouchGesture.superClass_.doStart.call(this,t),!this.isEnding_&&E.Touch.isTouchEvent(t)&&this.handleTouchStart(t)},E.TouchGesture.prototype.bindMouseEvents=function(t){this.onStartWrapper_=E.bindEventWithChecks_(document,"mousedown",null,this.handleStart.bind(this),!0),this.onMoveWrapper_=E.bindEventWithChecks_(document,"mousemove",null,this.handleMove.bind(this),!0),this.onUpWrapper_=E.bindEventWithChecks_(document,"mouseup",null,this.handleUp.bind(this),!0),t.preventDefault(),t.stopPropagation()},E.TouchGesture.prototype.handleStart=function(t){!this.isDragging()&&E.Touch.isTouchEvent(t)&&(this.handleTouchStart(t),this.isMultiTouch()&&E.longStop_())},E.TouchGesture.prototype.handleMove=function(t){this.isDragging()?E.Touch.shouldHandleEvent(t)&&E.TouchGesture.superClass_.handleMove.call(this,t):this.isMultiTouch()?(E.Touch.isTouchEvent(t)&&this.handleTouchMove(t),E.longStop_()):E.TouchGesture.superClass_.handleMove.call(this,t)},E.TouchGesture.prototype.handleUp=function(t){E.Touch.isTouchEvent(t)&&!this.isDragging()&&this.handleTouchEnd(t),!this.isMultiTouch()||this.isDragging()?E.Touch.shouldHandleEvent(t)&&E.TouchGesture.superClass_.handleUp.call(this,t):(t.preventDefault(),t.stopPropagation(),this.dispose())},E.TouchGesture.prototype.isMultiTouch=function(){return this.isMultiTouch_},E.TouchGesture.prototype.dispose=function(){E.TouchGesture.superClass_.dispose.call(this),this.onStartWrapper_&&E.unbindEvent_(this.onStartWrapper_)},E.TouchGesture.prototype.handleTouchStart=function(t){var e=E.Touch.getTouchIdentifierFromEvent(t);this.cachedPoints_[e]=this.getTouchPoint(t),2==(e=Object.keys(this.cachedPoints_)).length&&(this.startDistance_=E.utils.Coordinate.distance(this.cachedPoints_[e[0]],this.cachedPoints_[e[1]]),this.isMultiTouch_=!0,t.preventDefault())},E.TouchGesture.prototype.handleTouchMove=function(t){var e=E.Touch.getTouchIdentifierFromEvent(t);this.cachedPoints_[e]=this.getTouchPoint(t),e=Object.keys(this.cachedPoints_),this.isPinchZoomEnabled_&&2===e.length?this.handlePinch_(t):E.TouchGesture.superClass_.handleMove.call(this,t)},E.TouchGesture.prototype.handlePinch_=function(t){var e=Object.keys(this.cachedPoints_);if(e=E.utils.Coordinate.distance(this.cachedPoints_[e[0]],this.cachedPoints_[e[1]])/this.startDistance_,0<this.previousScale_&&1/0>this.previousScale_){var o=e-this.previousScale_;o=0<o?o*E.TouchGesture.ZOOM_IN_MULTIPLIER:o*E.TouchGesture.ZOOM_OUT_MULTIPLIER;var n=this.startWorkspace_,i=E.utils.mouseToSvg(t,n.getParentSvg(),n.getInverseScreenCTM());n.zoom(i.x,i.y,o)}this.previousScale_=e,t.preventDefault()},E.TouchGesture.prototype.handleTouchEnd=function(t){t=E.Touch.getTouchIdentifierFromEvent(t),this.cachedPoints_[t]&&delete this.cachedPoints_[t],Object.keys(this.cachedPoints_).length<2&&(this.cachedPoints_=Object.create(null),this.previousScale_=0)},E.TouchGesture.prototype.getTouchPoint=function(t){return this.startWorkspace_?new E.utils.Coordinate(t.pageX?t.pageX:t.changedTouches[0].pageX,t.pageY?t.pageY:t.changedTouches[0].pageY):null},E.WorkspaceAudio=function(t){this.parentWorkspace_=t,this.SOUNDS_=Object.create(null)},E.WorkspaceAudio.prototype.lastSound_=null,E.WorkspaceAudio.prototype.dispose=function(){this.SOUNDS_=this.parentWorkspace_=null},E.WorkspaceAudio.prototype.load=function(t,e){if(t.length){try{var o=new E.utils.global.Audio}catch(t){return}for(var n,i=0;i<t.length;i++){var r=t[i],s=r.match(/\.(\w+)$/);if(s&&o.canPlayType("audio/"+s[1])){n=new E.utils.global.Audio(r);break}}n&&n.play&&(this.SOUNDS_[e]=n)}},E.WorkspaceAudio.prototype.preload=function(){for(var t in this.SOUNDS_){var e=this.SOUNDS_[t];e.volume=.01;var o=e.play();if(void 0!==o?o.then(e.pause).catch(function(){}):e.pause(),E.utils.userAgent.IPAD||E.utils.userAgent.IPHONE)break}},E.WorkspaceAudio.prototype.play=function(t,e){var o=this.SOUNDS_[t];o?(t=new Date,null!=this.lastSound_&&t-this.lastSound_<E.SOUND_LIMIT||(this.lastSound_=t,(o=E.utils.userAgent.IPAD||E.utils.userAgent.ANDROID?o:o.cloneNode()).volume=void 0===e?1:e,o.play())):this.parentWorkspace_&&this.parentWorkspace_.getAudioManager().play(t,e)},E.WorkspaceSvg=function(t,e,o){E.WorkspaceSvg.superClass_.constructor.call(this,t),this.getMetrics=t.getMetrics||E.WorkspaceSvg.getTopLevelWorkspaceMetrics_,this.setMetrics=t.setMetrics||E.WorkspaceSvg.setTopLevelWorkspaceMetrics_,this.connectionDBList=E.ConnectionDB.init(this.connectionChecker),e&&(this.blockDragSurface_=e),o&&(this.workspaceDragSurface_=o),this.useWorkspaceDragSurface_=!!this.workspaceDragSurface_&&E.utils.is3dSupported(),this.highlightedBlocks_=[],this.audioManager_=new E.WorkspaceAudio(t.parentWorkspace),this.grid_=this.options.gridPattern?new E.Grid(this.options.gridPattern,t.gridOptions):null,this.markerManager_=new E.MarkerManager(this),this.toolboxCategoryCallbacks_={},this.flyoutButtonCallbacks_={},E.Variables&&E.Variables.flyoutCategory&&this.registerToolboxCategoryCallback(E.VARIABLE_CATEGORY_NAME,E.Variables.flyoutCategory),E.VariablesDynamic&&E.VariablesDynamic.flyoutCategory&&this.registerToolboxCategoryCallback(E.VARIABLE_DYNAMIC_CATEGORY_NAME,E.VariablesDynamic.flyoutCategory),E.Procedures&&E.Procedures.flyoutCategory&&(this.registerToolboxCategoryCallback(E.PROCEDURE_CATEGORY_NAME,E.Procedures.flyoutCategory),this.addChangeListener(E.Procedures.mutatorOpenListener)),this.themeManager_=this.options.parentWorkspace?this.options.parentWorkspace.getThemeManager():new E.ThemeManager(this,this.options.theme||E.Themes.Classic),this.themeManager_.subscribeWorkspace(this),this.renderer_=E.blockRendering.init(this.options.renderer||"geras",this.getTheme(),this.options.rendererOverrides),this.cachedParentSvg_=null,this.keyboardAccessibilityMode=!1,this.topBoundedElements_=[]},E.utils.object.inherits(E.WorkspaceSvg,E.Workspace),E.WorkspaceSvg.prototype.resizeHandlerWrapper_=null,E.WorkspaceSvg.prototype.rendered=!0,E.WorkspaceSvg.prototype.isVisible_=!0,E.WorkspaceSvg.prototype.isFlyout=!1,E.WorkspaceSvg.prototype.isMutator=!1,E.WorkspaceSvg.prototype.resizesEnabled_=!0,E.WorkspaceSvg.prototype.scrollX=0,E.WorkspaceSvg.prototype.scrollY=0,E.WorkspaceSvg.prototype.startScrollX=0,E.WorkspaceSvg.prototype.startScrollY=0,E.WorkspaceSvg.prototype.dragDeltaXY_=null,E.WorkspaceSvg.prototype.scale=1,E.WorkspaceSvg.prototype.trashcan=null,E.WorkspaceSvg.prototype.scrollbar=null,E.WorkspaceSvg.prototype.flyout_=null,E.WorkspaceSvg.prototype.toolbox_=null,E.WorkspaceSvg.prototype.currentGesture_=null,E.WorkspaceSvg.prototype.blockDragSurface_=null,E.WorkspaceSvg.prototype.workspaceDragSurface_=null,E.WorkspaceSvg.prototype.useWorkspaceDragSurface_=!1,E.WorkspaceSvg.prototype.isDragSurfaceActive_=!1,E.WorkspaceSvg.prototype.injectionDiv_=null,E.WorkspaceSvg.prototype.lastRecordedPageScroll_=null,E.WorkspaceSvg.prototype.targetWorkspace=null,E.WorkspaceSvg.prototype.inverseScreenCTM_=null,E.WorkspaceSvg.prototype.inverseScreenCTMDirty_=!0,E.WorkspaceSvg.prototype.getMarkerManager=function(){return this.markerManager_},E.WorkspaceSvg.prototype.setCursorSvg=function(t){this.markerManager_.setCursorSvg(t)},E.WorkspaceSvg.prototype.setMarkerSvg=function(t){this.markerManager_.setMarkerSvg(t)},E.WorkspaceSvg.prototype.getMarker=function(t){return this.markerManager_?this.markerManager_.getMarker(t):null},E.WorkspaceSvg.prototype.getCursor=function(){return this.markerManager_?this.markerManager_.getCursor():null},E.WorkspaceSvg.prototype.getRenderer=function(){return this.renderer_},E.WorkspaceSvg.prototype.getThemeManager=function(){return this.themeManager_},E.WorkspaceSvg.prototype.getTheme=function(){return this.themeManager_.getTheme()},E.WorkspaceSvg.prototype.setTheme=function(t){t||(t=E.Themes.Classic),this.themeManager_.setTheme(t)},E.WorkspaceSvg.prototype.refreshTheme=function(){this.svgGroup_&&this.renderer_.refreshDom(this.svgGroup_,this.getTheme()),this.updateBlockStyles_(this.getAllBlocks(!1).filter(function(t){return void 0!==t.getStyleName()})),this.refreshToolboxSelection(),this.toolbox_&&this.toolbox_.refreshTheme(),this.isVisible()&&this.setVisible(!0);var t=new E.Events.Ui(null,"theme",null,null);t.workspaceId=this.id,E.Events.fire(t)},E.WorkspaceSvg.prototype.updateBlockStyles_=function(t){for(var e,o=0;e=t[o];o++){var n=e.getStyleName();n&&(e.setStyle(n),e.mutator&&e.mutator.updateBlockStyle())}},E.WorkspaceSvg.prototype.getInverseScreenCTM=function(){if(this.inverseScreenCTMDirty_){var t=this.getParentSvg().getScreenCTM();t&&(this.inverseScreenCTM_=t.inverse(),this.inverseScreenCTMDirty_=!1)}return this.inverseScreenCTM_},E.WorkspaceSvg.prototype.updateInverseScreenCTM=function(){this.inverseScreenCTMDirty_=!0},E.WorkspaceSvg.prototype.isVisible=function(){return this.isVisible_},E.WorkspaceSvg.prototype.getSvgXY=function(t){var e=0,o=0,n=1;(E.utils.dom.containsNode(this.getCanvas(),t)||E.utils.dom.containsNode(this.getBubbleCanvas(),t))&&(n=this.scale);do{var i=E.utils.getRelativeXY(t);t!=this.getCanvas()&&t!=this.getBubbleCanvas()||(n=1),e+=i.x*n,o+=i.y*n,t=t.parentNode}while(t&&t!=this.getParentSvg());return new E.utils.Coordinate(e,o)},E.WorkspaceSvg.prototype.getOriginOffsetInPixels=function(){return E.utils.getInjectionDivXY_(this.getCanvas())},E.WorkspaceSvg.prototype.getInjectionDiv=function(){if(!this.injectionDiv_)for(var t=this.svgGroup_;t;){if(-1!=(" "+(t.getAttribute("class")||"")+" ").indexOf(" injectionDiv ")){this.injectionDiv_=t;break}t=t.parentNode}return this.injectionDiv_},E.WorkspaceSvg.prototype.getBlockCanvas=function(){return this.svgBlockCanvas_},E.WorkspaceSvg.prototype.setResizeHandlerWrapper=function(t){this.resizeHandlerWrapper_=t},E.WorkspaceSvg.prototype.createDom=function(t){if(this.svgGroup_=E.utils.dom.createSvgElement(E.utils.Svg.G,{class:"blocklyWorkspace"},null),t&&(this.svgBackground_=E.utils.dom.createSvgElement(E.utils.Svg.RECT,{height:"100%",width:"100%",class:t},this.svgGroup_),"blocklyMainBackground"==t&&this.grid_?this.svgBackground_.style.fill="url(#"+this.grid_.getPatternId()+")":this.themeManager_.subscribe(this.svgBackground_,"workspaceBackgroundColour","fill")),this.svgBlockCanvas_=E.utils.dom.createSvgElement(E.utils.Svg.G,{class:"blocklyBlockCanvas"},this.svgGroup_),this.svgBubbleCanvas_=E.utils.dom.createSvgElement(E.utils.Svg.G,{class:"blocklyBubbleCanvas"},this.svgGroup_),this.isFlyout||(E.bindEventWithChecks_(this.svgGroup_,"mousedown",this,this.onMouseDown_,!1,!0),E.bindEventWithChecks_(this.svgGroup_,"wheel",this,this.onMouseWheel_)),this.options.hasCategories){if(!E.Toolbox)throw Error("Missing require for Blockly.Toolbox");this.toolbox_=new(E.registry.getClassFromOptions(E.registry.Type.TOOLBOX,this.options))(this)}return this.grid_&&this.grid_.update(this.scale),this.recordDeleteAreas(),this.markerManager_.setCursor(new E.Cursor),this.markerManager_.registerMarker(E.navigation.MARKER_NAME,new E.Marker),this.renderer_.createDom(this.svgGroup_,this.getTheme()),this.svgGroup_},E.WorkspaceSvg.prototype.dispose=function(){if(this.rendered=!1,this.currentGesture_&&this.currentGesture_.cancel(),this.svgGroup_&&(E.utils.dom.removeNode(this.svgGroup_),this.svgGroup_=null),this.svgBubbleCanvas_=this.svgBlockCanvas_=null,this.toolbox_&&(this.toolbox_.dispose(),this.toolbox_=null),this.flyout_&&(this.flyout_.dispose(),this.flyout_=null),this.trashcan&&(this.trashcan.dispose(),this.trashcan=null),this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null),this.zoomControls_&&(this.zoomControls_.dispose(),this.zoomControls_=null),this.audioManager_&&(this.audioManager_.dispose(),this.audioManager_=null),this.grid_&&(this.grid_.dispose(),this.grid_=null),this.renderer_.dispose(),this.markerManager_&&(this.markerManager_.dispose(),this.markerManager_=null),E.WorkspaceSvg.superClass_.dispose.call(this),this.themeManager_&&(this.themeManager_.unsubscribeWorkspace(this),this.themeManager_.unsubscribe(this.svgBackground_),this.options.parentWorkspace||(this.themeManager_.dispose(),this.themeManager_=null)),this.flyoutButtonCallbacks_=this.toolboxCategoryCallbacks_=this.connectionDBList=null,!this.options.parentWorkspace){var t=this.getParentSvg();t&&t.parentNode&&E.utils.dom.removeNode(t.parentNode)}this.resizeHandlerWrapper_&&(E.unbindEvent_(this.resizeHandlerWrapper_),this.resizeHandlerWrapper_=null)},E.WorkspaceSvg.prototype.newBlock=function(t,e){return new E.BlockSvg(this,t,e)},E.WorkspaceSvg.prototype.addTrashcan=function(){if(!E.Trashcan)throw Error("Missing require for Blockly.Trashcan");this.trashcan=new E.Trashcan(this);var t=this.trashcan.createDom();this.svgGroup_.insertBefore(t,this.svgBlockCanvas_)},E.WorkspaceSvg.prototype.addZoomControls=function(){if(!E.ZoomControls)throw Error("Missing require for Blockly.ZoomControls");this.zoomControls_=new E.ZoomControls(this);var t=this.zoomControls_.createDom();this.svgGroup_.appendChild(t)},E.WorkspaceSvg.prototype.addFlyout=function(t){var e=new E.Options({parentWorkspace:this,rtl:this.RTL,oneBasedIndex:this.options.oneBasedIndex,horizontalLayout:this.horizontalLayout,renderer:this.options.renderer,rendererOverrides:this.options.rendererOverrides});if(e.toolboxPosition=this.options.toolboxPosition,this.horizontalLayout){if(!E.HorizontalFlyout)throw Error("Missing require for Blockly.HorizontalFlyout");this.flyout_=new E.HorizontalFlyout(e)}else{if(!E.VerticalFlyout)throw Error("Missing require for Blockly.VerticalFlyout");this.flyout_=new E.VerticalFlyout(e)}return this.flyout_.autoClose=!1,this.flyout_.getWorkspace().setVisible(!0),this.flyout_.createDom(t)},E.WorkspaceSvg.prototype.getFlyout=function(t){return this.flyout_||t?this.flyout_:this.toolbox_?this.toolbox_.getFlyout():null},E.WorkspaceSvg.prototype.getToolbox=function(){return this.toolbox_},E.WorkspaceSvg.prototype.updateScreenCalculations_=function(){this.updateInverseScreenCTM(),this.recordDeleteAreas()},E.WorkspaceSvg.prototype.resizeContents=function(){this.resizesEnabled_&&this.rendered&&(this.scrollbar&&this.scrollbar.resize(),this.updateInverseScreenCTM())},E.WorkspaceSvg.prototype.resize=function(){this.toolbox_&&this.toolbox_.position(),this.flyout_&&this.flyout_.position(),this.trashcan&&this.trashcan.position(),this.zoomControls_&&this.zoomControls_.position(),this.scrollbar&&this.scrollbar.resize(),this.updateScreenCalculations_()},E.WorkspaceSvg.prototype.updateScreenCalculationsIfScrolled=function(){var t=E.utils.getDocumentScroll();E.utils.Coordinate.equals(this.lastRecordedPageScroll_,t)||(this.lastRecordedPageScroll_=t,this.updateScreenCalculations_())},E.WorkspaceSvg.prototype.getCanvas=function(){return this.svgBlockCanvas_},E.WorkspaceSvg.prototype.getBubbleCanvas=function(){return this.svgBubbleCanvas_},E.WorkspaceSvg.prototype.getParentSvg=function(){if(!this.cachedParentSvg_)for(var t=this.svgGroup_;t;){if("svg"==t.tagName){this.cachedParentSvg_=t;break}t=t.parentNode}return this.cachedParentSvg_},E.WorkspaceSvg.prototype.maybeFireViewportChangeEvent=function(){},E.WorkspaceSvg.prototype.translate=function(t,e){if(this.useWorkspaceDragSurface_&&this.isDragSurfaceActive_)this.workspaceDragSurface_.translateSurface(t,e);else{var o="translate("+t+","+e+") scale("+this.scale+")";this.svgBlockCanvas_.setAttribute("transform",o),this.svgBubbleCanvas_.setAttribute("transform",o)}this.blockDragSurface_&&this.blockDragSurface_.translateAndScaleGroup(t,e,this.scale),this.grid_&&this.grid_.moveTo(t,e),this.maybeFireViewportChangeEvent()},E.WorkspaceSvg.prototype.resetDragSurface=function(){if(this.useWorkspaceDragSurface_){this.isDragSurfaceActive_=!1;var t=this.workspaceDragSurface_.getSurfaceTranslation();this.workspaceDragSurface_.clearAndHide(this.svgGroup_),t="translate("+t.x+","+t.y+") scale("+this.scale+")",this.svgBlockCanvas_.setAttribute("transform",t),this.svgBubbleCanvas_.setAttribute("transform",t)}},E.WorkspaceSvg.prototype.setupDragSurface=function(){if(this.useWorkspaceDragSurface_&&!this.isDragSurfaceActive_){this.isDragSurfaceActive_=!0;var t=this.svgBlockCanvas_.previousSibling,e=parseInt(this.getParentSvg().getAttribute("width"),10),o=parseInt(this.getParentSvg().getAttribute("height"),10),n=E.utils.getRelativeXY(this.getCanvas());this.workspaceDragSurface_.setContentsAndShow(this.getCanvas(),this.getBubbleCanvas(),t,e,o,this.scale),this.workspaceDragSurface_.translateSurface(n.x,n.y)}},E.WorkspaceSvg.prototype.getBlockDragSurface=function(){return this.blockDragSurface_},E.WorkspaceSvg.prototype.getWidth=function(){var t=this.getMetrics();return t?t.viewWidth/this.scale:0},E.WorkspaceSvg.prototype.setVisible=function(t){if(this.isVisible_=t,this.svgGroup_)if(this.scrollbar&&this.scrollbar.setContainerVisible(t),this.getFlyout()&&this.getFlyout().setContainerVisible(t),this.getParentSvg().style.display=t?"block":"none",this.toolbox_&&this.toolbox_.setVisible(t),t){for(var e=(t=this.getAllBlocks(!1)).length-1;0<=e;e--)t[e].markDirty();this.render(),this.toolbox_&&this.toolbox_.position()}else E.hideChaff(!0)},E.WorkspaceSvg.prototype.render=function(){for(var t=this.getAllBlocks(!1),e=t.length-1;0<=e;e--)t[e].render(!1);if(this.currentGesture_)for(t=this.currentGesture_.getInsertionMarkers(),e=0;e<t.length;e++)t[e].render(!1);this.markerManager_.updateMarkers()},E.WorkspaceSvg.prototype.highlightBlock=function(t,e){if(void 0===e){for(var o,n=0;o=this.highlightedBlocks_[n];n++)o.setHighlighted(!1);this.highlightedBlocks_.length=0}(o=t?this.getBlockById(t):null)&&((t=void 0===e||e)?-1==this.highlightedBlocks_.indexOf(o)&&this.highlightedBlocks_.push(o):E.utils.arrayRemove(this.highlightedBlocks_,o),o.setHighlighted(t))},E.WorkspaceSvg.prototype.paste=function(t){!this.rendered||!t.tagName||t.getElementsByTagName("block").length>=this.remainingCapacity()||(this.currentGesture_&&this.currentGesture_.cancel(),"comment"==t.tagName.toLowerCase()?this.pasteWorkspaceComment_(t):this.pasteBlock_(t))},E.WorkspaceSvg.prototype.pasteBlock_=function(t){E.Events.disable();try{var e=E.Xml.domToBlock(t,this),o=this.getMarker(E.navigation.MARKER_NAME).getCurNode();if(this.keyboardAccessibilityMode&&o&&o.isConnection()){var n=o.getLocation();return void E.navigation.insertBlock(e,n)}var i=parseInt(t.getAttribute("x"),10),r=parseInt(t.getAttribute("y"),10);if(!isNaN(i)&&!isNaN(r)){this.RTL&&(i=-i);do{t=!1;var s,a=this.getAllBlocks(!1);for(o=0;s=a[o];o++){var l=s.getRelativeToSurfaceXY();if(Math.abs(i-l.x)<=1&&Math.abs(r-l.y)<=1){t=!0;break}}if(!t){var c,u=e.getConnections_(!1);for(o=0;c=u[o];o++)if(c.closest(E.SNAP_RADIUS,new E.utils.Coordinate(i,r)).connection){t=!0;break}}t&&(i=this.RTL?i-E.SNAP_RADIUS:i+E.SNAP_RADIUS,r+=2*E.SNAP_RADIUS)}while(t);e.moveBy(i,r)}}finally{E.Events.enable()}E.Events.isEnabled()&&!e.isShadow()&&E.Events.fire(new E.Events.BlockCreate(e)),e.select()},E.WorkspaceSvg.prototype.pasteWorkspaceComment_=function(t){E.Events.disable();try{var e=E.WorkspaceCommentSvg.fromXml(t,this),o=parseInt(t.getAttribute("x"),10),n=parseInt(t.getAttribute("y"),10);isNaN(o)||isNaN(n)||(this.RTL&&(o=-o),e.moveBy(o+50,n+50))}finally{E.Events.enable()}E.Events.isEnabled(),e.select()},E.WorkspaceSvg.prototype.refreshToolboxSelection=function(){var t=this.isFlyout?this.targetWorkspace:this;t&&!t.currentGesture_&&t.toolbox_&&t.toolbox_.getFlyout()&&t.toolbox_.refreshSelection()},E.WorkspaceSvg.prototype.renameVariableById=function(t,e){E.WorkspaceSvg.superClass_.renameVariableById.call(this,t,e),this.refreshToolboxSelection()},E.WorkspaceSvg.prototype.deleteVariableById=function(t){E.WorkspaceSvg.superClass_.deleteVariableById.call(this,t),this.refreshToolboxSelection()},E.WorkspaceSvg.prototype.createVariable=function(t,e,o){return t=E.WorkspaceSvg.superClass_.createVariable.call(this,t,e,o),this.refreshToolboxSelection(),t},E.WorkspaceSvg.prototype.recordDeleteAreas=function(){this.deleteAreaTrash_=this.trashcan&&this.svgGroup_.parentNode?this.trashcan.getClientRect():null,this.deleteAreaToolbox_=this.flyout_?this.flyout_.getClientRect():this.toolbox_&&"function"==typeof this.toolbox_.getClientRect?this.toolbox_.getClientRect():null},E.WorkspaceSvg.prototype.isDeleteArea=function(t){return this.deleteAreaTrash_&&this.deleteAreaTrash_.contains(t.clientX,t.clientY)?E.DELETE_AREA_TRASH:this.deleteAreaToolbox_&&this.deleteAreaToolbox_.contains(t.clientX,t.clientY)?E.DELETE_AREA_TOOLBOX:E.DELETE_AREA_NONE},E.WorkspaceSvg.prototype.onMouseDown_=function(t){var e=this.getGesture(t);e&&e.handleWsStart(t,this)},E.WorkspaceSvg.prototype.startDrag=function(t,e){(t=E.utils.mouseToSvg(t,this.getParentSvg(),this.getInverseScreenCTM())).x/=this.scale,t.y/=this.scale,this.dragDeltaXY_=E.utils.Coordinate.difference(e,t)},E.WorkspaceSvg.prototype.moveDrag=function(t){return(t=E.utils.mouseToSvg(t,this.getParentSvg(),this.getInverseScreenCTM())).x/=this.scale,t.y/=this.scale,E.utils.Coordinate.sum(this.dragDeltaXY_,t)},E.WorkspaceSvg.prototype.isDragging=function(){return null!=this.currentGesture_&&this.currentGesture_.isDragging()},E.WorkspaceSvg.prototype.isDraggable=function(){return this.options.moveOptions&&this.options.moveOptions.drag},E.WorkspaceSvg.prototype.isContentBounded=function(){return this.options.moveOptions&&this.options.moveOptions.scrollbars||this.options.moveOptions&&this.options.moveOptions.wheel||this.options.moveOptions&&this.options.moveOptions.drag||this.options.zoomOptions&&this.options.zoomOptions.controls||this.options.zoomOptions&&this.options.zoomOptions.wheel||this.options.zoomOptions&&this.options.zoomOptions.pinch},E.WorkspaceSvg.prototype.isMovable=function(){return this.options.moveOptions&&this.options.moveOptions.scrollbars||this.options.moveOptions&&this.options.moveOptions.wheel||this.options.moveOptions&&this.options.moveOptions.drag||this.options.zoomOptions&&this.options.zoomOptions.wheel||this.options.zoomOptions&&this.options.zoomOptions.pinch},E.WorkspaceSvg.prototype.onMouseWheel_=function(t){if(E.Gesture.inProgress())t.preventDefault(),t.stopPropagation();else{var e=this.options.zoomOptions&&this.options.zoomOptions.wheel,o=this.options.moveOptions&&this.options.moveOptions.wheel;if(e||o){var n=E.utils.getScrollDeltaPixels(t);!e||!t.ctrlKey&&o?(e=this.scrollX-n.x,o=this.scrollY-n.y,t.shiftKey&&!n.x&&(e=this.scrollX-n.y,o=this.scrollY),this.scroll(e,o)):(n=-n.y/50,e=E.utils.mouseToSvg(t,this.getParentSvg(),this.getInverseScreenCTM()),this.zoom(e.x,e.y,n)),t.preventDefault()}}},E.WorkspaceSvg.prototype.getBlocksBoundingBox=function(){var t=this.getTopBoundedElements();if(!t.length)return new E.utils.Rect(0,0,0,0);for(var e=t[0].getBoundingRectangle(),o=1;o<t.length;o++){var n=t[o].getBoundingRectangle();n.top<e.top&&(e.top=n.top),n.bottom>e.bottom&&(e.bottom=n.bottom),n.left<e.left&&(e.left=n.left),n.right>e.right&&(e.right=n.right)}return e},E.WorkspaceSvg.prototype.cleanUp=function(){this.setResizesEnabled(!1),E.Events.setGroup(!0);for(var t,e=this.getTopBlocks(!0),o=0,n=0;t=e[n];n++)if(t.isMovable()){var i=t.getRelativeToSurfaceXY();t.moveBy(-i.x,o-i.y),t.snapToGrid(),o=t.getRelativeToSurfaceXY().y+t.getHeightWidth().height+this.renderer_.getConstants().MIN_BLOCK_HEIGHT}E.Events.setGroup(!1),this.setResizesEnabled(!0)},E.WorkspaceSvg.prototype.showContextMenu=function(t){if(!this.options.readOnly&&!this.isFlyout){var e=E.ContextMenuRegistry.registry.getContextMenuOptions(E.ContextMenuRegistry.ScopeType.WORKSPACE,{workspace:this});this.configureContextMenu&&this.configureContextMenu(e,t),E.ContextMenu.show(t,e,this.RTL)}},E.WorkspaceSvg.prototype.updateToolbox=function(t){if(t=E.utils.toolbox.convertToolboxDefToJson(t)){if(!this.options.languageTree)throw Error("Existing toolbox is null.  Can't create new toolbox.");if(E.utils.toolbox.hasCategories(t)){if(!this.toolbox_)throw Error("Existing toolbox has no categories.  Can't change mode.");this.options.languageTree=t,this.toolbox_.render(t)}else{if(!this.flyout_)throw Error("Existing toolbox has categories.  Can't change mode.");this.options.languageTree=t,this.flyout_.show(t)}}else if(this.options.languageTree)throw Error("Can't nullify an existing toolbox.")},E.WorkspaceSvg.prototype.markFocused=function(){this.options.parentWorkspace?this.options.parentWorkspace.markFocused():(E.mainWorkspace=this).setBrowserFocus()},E.WorkspaceSvg.prototype.setBrowserFocus=function(){document.activeElement&&document.activeElement.blur();try{this.getParentSvg().focus({preventScroll:!0})}catch(t){try{this.getParentSvg().parentNode.setActive()}catch(t){this.getParentSvg().parentNode.focus({preventScroll:!0})}}},E.WorkspaceSvg.prototype.zoom=function(t,e,o){o=Math.pow(this.options.zoomOptions.scaleSpeed,o);var n=this.scale*o;if(this.scale!=n){n>this.options.zoomOptions.maxScale?o=this.options.zoomOptions.maxScale/this.scale:n<this.options.zoomOptions.minScale&&(o=this.options.zoomOptions.minScale/this.scale);var i=this.getCanvas().getCTM(),r=this.getParentSvg().createSVGPoint();r.x=t,r.y=e,t=(r=r.matrixTransform(i.inverse())).x,e=r.y,i=i.translate(t*(1-o),e*(1-o)).scale(o),this.scrollX=i.e,this.scrollY=i.f,this.setScale(n)}},E.WorkspaceSvg.prototype.zoomCenter=function(t){var e=this.getMetrics();if(this.flyout_){var o=e.svgWidth?e.svgWidth/2:0;e=e.svgHeight?e.svgHeight/2:0}else o=e.viewWidth/2+e.absoluteLeft,e=e.viewHeight/2+e.absoluteTop;this.zoom(o,e,t)},E.WorkspaceSvg.prototype.zoomToFit=function(){if(this.isMovable()){var t=this.getMetrics(),e=t.viewWidth;t=t.viewHeight;var o=this.getBlocksBoundingBox(),n=o.right-o.left;if(o=o.bottom-o.top,n){this.flyout_&&(this.horizontalLayout?(t+=this.flyout_.getHeight(),o+=this.flyout_.getHeight()/this.scale):(e+=this.flyout_.getWidth(),n+=this.flyout_.getWidth()/this.scale)),e/=n,t/=o,E.Events.disable();try{this.setScale(Math.min(e,t)),this.scrollCenter()}finally{E.Events.enable()}this.maybeFireViewportChangeEvent()}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")},E.WorkspaceSvg.prototype.beginCanvasTransition=function(){E.utils.dom.addClass(this.svgBlockCanvas_,"blocklyCanvasTransitioning"),E.utils.dom.addClass(this.svgBubbleCanvas_,"blocklyCanvasTransitioning")},E.WorkspaceSvg.prototype.endCanvasTransition=function(){E.utils.dom.removeClass(this.svgBlockCanvas_,"blocklyCanvasTransitioning"),E.utils.dom.removeClass(this.svgBubbleCanvas_,"blocklyCanvasTransitioning")},E.WorkspaceSvg.prototype.scrollCenter=function(){if(this.isMovable()){var t=this.getMetrics(),e=(t.contentWidth-t.viewWidth)/2,o=(t.contentHeight-t.viewHeight)/2;e=-e-t.contentLeft,o=-o-t.contentTop,this.scroll(e,o)}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")},E.WorkspaceSvg.prototype.centerOnBlock=function(t){if(this.isMovable()){if(t=t?this.getBlockById(t):null){var e=t.getRelativeToSurfaceXY(),o=t.getHeightWidth(),n=this.scale;t=(e.x+(this.RTL?-1:1)*o.width/2)*n,e=(e.y+o.height/2)*n,o=this.getMetrics(),this.scroll(-(t-o.viewWidth/2),-(e-o.viewHeight/2))}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")},E.WorkspaceSvg.prototype.setScale=function(t){this.options.zoomOptions.maxScale&&t>this.options.zoomOptions.maxScale?t=this.options.zoomOptions.maxScale:this.options.zoomOptions.minScale&&t<this.options.zoomOptions.minScale&&(t=this.options.zoomOptions.minScale),this.scale=t,E.hideChaff(!1),this.flyout_&&(this.flyout_.reflow(),this.recordDeleteAreas()),this.grid_&&this.grid_.update(this.scale),t=this.getMetrics(),this.scrollX-=t.absoluteLeft,this.scrollY-=t.absoluteTop,t.viewLeft+=t.absoluteLeft,t.viewTop+=t.absoluteTop,this.scroll(this.scrollX,this.scrollY),this.scrollbar&&(this.flyout_?(this.scrollbar.hScroll.resizeViewHorizontal(t),this.scrollbar.vScroll.resizeViewVertical(t)):(this.scrollbar.hScroll.resizeContentHorizontal(t),this.scrollbar.vScroll.resizeContentVertical(t)))},E.WorkspaceSvg.prototype.getScale=function(){return this.options.parentWorkspace?this.options.parentWorkspace.getScale():this.scale},E.WorkspaceSvg.prototype.scroll=function(t,e){E.hideChaff(!0);var o=this.getMetrics(),n=o.contentWidth+o.contentLeft-o.viewWidth,i=o.contentHeight+o.contentTop-o.viewHeight;t=Math.min(t,-o.contentLeft),e=Math.min(e,-o.contentTop),t=Math.max(t,-n),e=Math.max(e,-i),this.scrollX=t,this.scrollY=e,this.scrollbar&&(this.scrollbar.hScroll.setHandlePosition(-(t+o.contentLeft)*this.scrollbar.hScroll.ratio),this.scrollbar.vScroll.setHandlePosition(-(e+o.contentTop)*this.scrollbar.vScroll.ratio)),t+=o.absoluteLeft,e+=o.absoluteTop,this.translate(t,e)},E.WorkspaceSvg.getDimensionsPx_=function(t){var e=0,o=0;return t&&(e=t.getWidth(),o=t.getHeight()),new E.utils.Size(e,o)},E.WorkspaceSvg.getContentDimensions_=function(t,e){return t.isContentBounded()?E.WorkspaceSvg.getContentDimensionsBounded_(t,e):E.WorkspaceSvg.getContentDimensionsExact_(t)},E.WorkspaceSvg.getContentDimensionsExact_=function(t){var e=t.getBlocksBoundingBox(),o=t.scale;t=e.top*o;var n=e.bottom*o,i=e.left*o;return{top:t,bottom:n,left:i,right:e=e.right*o,width:e-i,height:n-t}},E.WorkspaceSvg.getContentDimensionsBounded_=function(t,e){t=E.WorkspaceSvg.getContentDimensionsExact_(t);var o=e.width,n=o/2,i=(e=e.height)/2,r=Math.min(t.left-n,t.right-o),s=Math.min(t.top-i,t.bottom-e);return{left:r,top:s,height:Math.max(t.bottom+i,t.top+e)-s,width:Math.max(t.right+n,t.left+o)-r}},E.WorkspaceSvg.getTopLevelWorkspaceMetrics_=function(){var t=E.WorkspaceSvg.getDimensionsPx_(this.toolbox_),e=E.WorkspaceSvg.getDimensionsPx_(this.flyout_),o=E.svgSize(this.getParentSvg()),n={height:o.height,width:o.width};this.toolbox_?this.toolboxPosition==E.TOOLBOX_AT_TOP||this.toolboxPosition==E.TOOLBOX_AT_BOTTOM?n.height-=t.height:this.toolboxPosition!=E.TOOLBOX_AT_LEFT&&this.toolboxPosition!=E.TOOLBOX_AT_RIGHT||(n.width-=t.width):this.flyout_&&(this.toolboxPosition==E.TOOLBOX_AT_TOP||this.toolboxPosition==E.TOOLBOX_AT_BOTTOM?n.height-=e.height:this.toolboxPosition!=E.TOOLBOX_AT_LEFT&&this.toolboxPosition!=E.TOOLBOX_AT_RIGHT||(n.width-=e.width));var i=E.WorkspaceSvg.getContentDimensions_(this,n),r=0;this.toolbox_&&this.toolboxPosition==E.TOOLBOX_AT_LEFT?r=t.width:this.flyout_&&this.toolboxPosition==E.TOOLBOX_AT_LEFT&&(r=e.width);var s=0;return this.toolbox_&&this.toolboxPosition==E.TOOLBOX_AT_TOP?s=t.height:this.flyout_&&this.toolboxPosition==E.TOOLBOX_AT_TOP&&(s=e.height),{contentHeight:i.height,contentWidth:i.width,contentTop:i.top,contentLeft:i.left,viewHeight:n.height,viewWidth:n.width,viewTop:-this.scrollY,viewLeft:-this.scrollX,absoluteTop:s,absoluteLeft:r,svgHeight:o.height,svgWidth:o.width,toolboxWidth:t.width,toolboxHeight:t.height,toolboxPosition:this.toolboxPosition,flyoutWidth:e.width,flyoutHeight:e.height}},E.WorkspaceSvg.setTopLevelWorkspaceMetrics_=function(t){var e=this.getMetrics();"number"==typeof t.x&&(this.scrollX=-e.contentWidth*t.x-e.contentLeft),"number"==typeof t.y&&(this.scrollY=-e.contentHeight*t.y-e.contentTop),this.translate(this.scrollX+e.absoluteLeft,this.scrollY+e.absoluteTop)},E.WorkspaceSvg.prototype.getBlockById=function(t){return E.WorkspaceSvg.superClass_.getBlockById.call(this,t)},E.WorkspaceSvg.prototype.getTopBlocks=function(t){return E.WorkspaceSvg.superClass_.getTopBlocks.call(this,t)},E.WorkspaceSvg.prototype.addTopBlock=function(t){this.addTopBoundedElement(t),E.WorkspaceSvg.superClass_.addTopBlock.call(this,t)},E.WorkspaceSvg.prototype.removeTopBlock=function(t){this.removeTopBoundedElement(t),E.WorkspaceSvg.superClass_.removeTopBlock.call(this,t)},E.WorkspaceSvg.prototype.addTopComment=function(t){this.addTopBoundedElement(t),E.WorkspaceSvg.superClass_.addTopComment.call(this,t)},E.WorkspaceSvg.prototype.removeTopComment=function(t){this.removeTopBoundedElement(t),E.WorkspaceSvg.superClass_.removeTopComment.call(this,t)},E.WorkspaceSvg.prototype.addTopBoundedElement=function(t){this.topBoundedElements_.push(t)},E.WorkspaceSvg.prototype.removeTopBoundedElement=function(t){E.utils.arrayRemove(this.topBoundedElements_,t)},E.WorkspaceSvg.prototype.getTopBoundedElements=function(){return[].concat(this.topBoundedElements_)},E.WorkspaceSvg.prototype.setResizesEnabled=function(t){var e=!this.resizesEnabled_&&t;this.resizesEnabled_=t,e&&this.resizeContents()},E.WorkspaceSvg.prototype.clear=function(){this.setResizesEnabled(!1),E.WorkspaceSvg.superClass_.clear.call(this),this.topBoundedElements_=[],this.setResizesEnabled(!0)},E.WorkspaceSvg.prototype.registerButtonCallback=function(t,e){if("function"!=typeof e)throw TypeError("Button callbacks must be functions.");this.flyoutButtonCallbacks_[t]=e},E.WorkspaceSvg.prototype.getButtonCallback=function(t){return(t=this.flyoutButtonCallbacks_[t])?t:null},E.WorkspaceSvg.prototype.removeButtonCallback=function(t){this.flyoutButtonCallbacks_[t]=null},E.WorkspaceSvg.prototype.registerToolboxCategoryCallback=function(t,e){if("function"!=typeof e)throw TypeError("Toolbox category callbacks must be functions.");this.toolboxCategoryCallbacks_[t]=e},E.WorkspaceSvg.prototype.getToolboxCategoryCallback=function(t){return this.toolboxCategoryCallbacks_[t]||null},E.WorkspaceSvg.prototype.removeToolboxCategoryCallback=function(t){this.toolboxCategoryCallbacks_[t]=null},E.WorkspaceSvg.prototype.getGesture=function(t){var e="mousedown"==t.type||"touchstart"==t.type||"pointerdown"==t.type,o=this.currentGesture_;return o?e&&o.hasStarted()?(console.warn("Tried to start the same gesture twice."),o.cancel(),null):o:e?this.currentGesture_=new E.TouchGesture(t,this):null},E.WorkspaceSvg.prototype.clearGesture=function(){this.currentGesture_=null},E.WorkspaceSvg.prototype.cancelCurrentGesture=function(){this.currentGesture_&&this.currentGesture_.cancel()},E.WorkspaceSvg.prototype.getAudioManager=function(){return this.audioManager_},E.WorkspaceSvg.prototype.getGrid=function(){return this.grid_},E.inject=function(t,e){if(E.checkBlockColourConstants(),"string"==typeof t&&(t=document.getElementById(t)||document.querySelector(t)),!t||!E.utils.dom.containsNode(document,t))throw Error("Error: container is not in current document.");e=new E.Options(e||{});var o=document.createElement("div");o.className="injectionDiv",o.tabIndex=0,E.utils.aria.setState(o,E.utils.aria.State.LABEL,E.Msg.WORKSPACE_ARIA_LABEL),t.appendChild(o),t=E.createDom_(o,e);var n=new E.BlockDragSurfaceSvg(o),i=new E.WorkspaceDragSurfaceSvg(o),r=E.createMainWorkspace_(t,e,n,i);return E.user.keyMap.setKeyMap(e.keyMap),E.init_(r),E.mainWorkspace=r,E.svgResize(r),o.addEventListener("focusin",function(){E.mainWorkspace=r}),r},E.createDom_=function(t,e){t.setAttribute("dir","LTR"),E.Component.defaultRightToLeft=e.RTL,E.Css.inject(e.hasCss,e.pathToMedia),t=E.utils.dom.createSvgElement(E.utils.Svg.SVG,{xmlns:E.utils.dom.SVG_NS,"xmlns:html":E.utils.dom.HTML_NS,"xmlns:xlink":E.utils.dom.XLINK_NS,version:"1.1",class:"blocklySvg",tabindex:"0"},t);var o=E.utils.dom.createSvgElement(E.utils.Svg.DEFS,{},t),n=String(Math.random()).substring(2);return e.gridPattern=E.Grid.createDom(n,e.gridOptions,o),t},E.createMainWorkspace_=function(t,e,o,n){e.parentWorkspace=null;var l=new E.WorkspaceSvg(e,o,n);return e=l.options,l.scale=e.zoomOptions.startScale,t.appendChild(l.createDom("blocklyMainBackground")),E.utils.dom.addClass(l.getInjectionDiv(),l.getRenderer().getClassName()),E.utils.dom.addClass(l.getInjectionDiv(),l.getTheme().getClassName()),!e.hasCategories&&e.languageTree&&(o=l.addFlyout(E.utils.Svg.SVG),E.utils.dom.insertAfter(o,t)),e.hasTrashcan&&l.addTrashcan(),e.zoomOptions&&e.zoomOptions.controls&&l.addZoomControls(),l.getThemeManager().subscribe(t,"workspaceBackgroundColour","background-color"),l.translate(0,0),e.readOnly||l.isMovable()||l.addChangeListener(function(t){if(!l.isDragging()&&!l.isMovable()&&-1!=E.Events.BUMP_EVENTS.indexOf(t.type)){var e=Object.create(null),o=l.getMetrics(),n=l.scale;if(e.RTL=l.RTL,e.viewLeft=o.viewLeft/n,e.viewTop=o.viewTop/n,e.viewRight=(o.viewLeft+o.viewWidth)/n,e.viewBottom=(o.viewTop+o.viewHeight)/n,l.isContentBounded()?(o=l.getBlocksBoundingBox(),e.contentLeft=o.left,e.contentTop=o.top,e.contentRight=o.right,e.contentBottom=o.bottom):(e.contentLeft=o.contentLeft/n,e.contentTop=o.contentTop/n,e.contentRight=(o.contentLeft+o.contentWidth)/n,e.contentBottom=(o.contentTop+o.contentHeight)/n),e.contentTop<e.viewTop||e.contentBottom>e.viewBottom||e.contentLeft<e.viewLeft||e.contentRight>e.viewRight){switch(o=null,t&&(o=E.Events.getGroup(),E.Events.setGroup(t.group)),t.type){case E.Events.BLOCK_CREATE:case E.Events.BLOCK_MOVE:var i=l.getBlockById(t.blockId);i&&(i=i.getRootBlock());break;case E.Events.COMMENT_CREATE:case E.Events.COMMENT_MOVE:i=l.getCommentById(t.commentId)}if(i){(n=i.getBoundingRectangle()).height=n.bottom-n.top,n.width=n.right-n.left;var r=e.viewTop,s=e.viewBottom-n.height;s=Math.max(r,s),r=E.utils.math.clamp(r,n.top,s)-n.top,s=e.viewLeft;var a=e.viewRight-n.width;e.RTL?s=Math.min(a,s):a=Math.max(s,a),e=E.utils.math.clamp(s,n.left,a)-n.left,i.moveBy(e,r)}t&&(!t.group&&i&&console.warn("Moved object in bounds but there was no event group. This may break undo."),null!==o&&E.Events.setGroup(o))}}}),E.svgResize(l),E.WidgetDiv.createDom(),E.DropDownDiv.createDom(),E.Tooltip.createDom(),l},E.init_=function(t){var e=t.options,o=t.getParentSvg();if(E.bindEventWithChecks_(o.parentNode,"contextmenu",null,function(t){E.utils.isTargetInput(t)||t.preventDefault()}),o=E.bindEventWithChecks_(window,"resize",null,function(){E.hideChaff(!0),E.svgResize(t)}),t.setResizeHandlerWrapper(o),E.inject.bindDocumentEvents_(),e.languageTree){o=t.getToolbox();var n=t.getFlyout(!0);o?o.init():n&&(n.init(t),n.show(e.languageTree),"function"==typeof n.scrollToStart&&n.scrollToStart())}o=E.Scrollbar.scrollbarThickness,e.hasTrashcan&&(o=t.trashcan.init(o)),e.zoomOptions&&e.zoomOptions.controls&&t.zoomControls_.init(o),e.moveOptions&&e.moveOptions.scrollbars?(t.scrollbar=new E.ScrollbarPair(t),t.scrollbar.resize()):t.setMetrics({x:.5,y:.5}),e.hasSounds&&E.inject.loadSounds_(e.pathToMedia,t)},E.inject.bindDocumentEvents_=function(){E.documentEventsBound_||(E.bindEventWithChecks_(document,"scroll",null,function(){for(var t,e=E.Workspace.getAll(),o=0;t=e[o];o++)t.updateInverseScreenCTM&&t.updateInverseScreenCTM()}),E.bindEventWithChecks_(document,"keydown",null,E.onKeyDown),E.bindEvent_(document,"touchend",null,E.longStop_),E.bindEvent_(document,"touchcancel",null,E.longStop_),E.utils.userAgent.IPAD&&E.bindEventWithChecks_(window,"orientationchange",document,function(){E.svgResize(E.getMainWorkspace())})),E.documentEventsBound_=!0},E.inject.loadSounds_=function(t,e){var o=e.getAudioManager();o.load([t+"click.mp3",t+"click.wav",t+"click.ogg"],"click"),o.load([t+"disconnect.wav",t+"disconnect.mp3",t+"disconnect.ogg"],"disconnect"),o.load([t+"delete.mp3",t+"delete.ogg",t+"delete.wav"],"delete");var n=[];t=function(){for(;n.length;)E.unbindEvent_(n.pop());o.preload()},n.push(E.bindEventWithChecks_(document,"mousemove",null,t,!0)),n.push(E.bindEventWithChecks_(document,"touchstart",null,t,!0))},E.Names=function(t,e){if(this.variablePrefix_=e||"",this.reservedDict_=Object.create(null),t)for(t=t.split(","),e=0;e<t.length;e++)this.reservedDict_[t[e]]=!0;this.reset()},E.Names.DEVELOPER_VARIABLE_TYPE="DEVELOPER_VARIABLE",E.Names.prototype.reset=function(){this.db_=Object.create(null),this.dbReverse_=Object.create(null),this.variableMap_=null},E.Names.prototype.setVariableMap=function(t){this.variableMap_=t},E.Names.prototype.getNameForUserVariable_=function(t){return this.variableMap_?(t=this.variableMap_.getVariableById(t))?t.name:null:(console.log("Deprecated call to Blockly.Names.prototype.getName without defining a variable map. To fix, add the following code in your generator's init() function:\nBlockly.YourGeneratorName.variableDB_.setVariableMap(workspace.getVariableMap());"),null)},E.Names.prototype.getName=function(t,e){if(e==E.VARIABLE_CATEGORY_NAME){var o=this.getNameForUserVariable_(t);o&&(t=o)}o=t.toLowerCase()+"_"+e;var n=e==E.VARIABLE_CATEGORY_NAME||e==E.Names.DEVELOPER_VARIABLE_TYPE?this.variablePrefix_:"";return o in this.db_?n+this.db_[o]:(t=this.getDistinctName(t,e),this.db_[o]=t.substr(n.length),t)},E.Names.prototype.getDistinctName=function(t,e){t=this.safeName_(t);for(var o="";this.dbReverse_[t+o]||t+o in this.reservedDict_;)o=o?o+1:2;return t+=o,this.dbReverse_[t]=!0,(e==E.VARIABLE_CATEGORY_NAME||e==E.Names.DEVELOPER_VARIABLE_TYPE?this.variablePrefix_:"")+t},E.Names.prototype.safeName_=function(t){return t?(t=encodeURI(t.replace(/ /g,"_")).replace(/[^\w]/g,"_"),-1!="0123456789".indexOf(t[0])&&(t="my_"+t)):t=E.Msg.UNNAMED_KEY||"unnamed",t},E.Names.equals=function(t,e){return t.toLowerCase()==e.toLowerCase()},E.Procedures={},E.Procedures.NAME_TYPE=E.PROCEDURE_CATEGORY_NAME,E.Procedures.DEFAULT_ARG="x",E.Procedures.allProcedures=function(t){var e=t.getBlocksByType("procedures_defnoreturn",!1).map(function(t){return t.getProcedureDef()});return t=t.getBlocksByType("procedures_defreturn",!1).map(function(t){return t.getProcedureDef()}),e.sort(E.Procedures.procTupleComparator_),t.sort(E.Procedures.procTupleComparator_),[e,t]},E.Procedures.procTupleComparator_=function(t,e){return t[0].toLowerCase().localeCompare(e[0].toLowerCase())},E.Procedures.findLegalName=function(t,e){if(e.isInFlyout)return t;for(t=t||E.Msg.UNNAMED_KEY||"unnamed";!E.Procedures.isLegalName_(t,e.workspace,e);){var o=t.match(/^(.*?)(\d+)$/);t=o?o[1]+(parseInt(o[2],10)+1):t+"2"}return t},E.Procedures.isLegalName_=function(t,e,o){return!E.Procedures.isNameUsed(t,e,o)},E.Procedures.isNameUsed=function(t,e,o){e=e.getAllBlocks(!1);for(var n=0;n<e.length;n++)if(e[n]!=o&&e[n].getProcedureDef){var i=e[n].getProcedureDef();if(E.Names.equals(i[0],t))return!0}return!1},E.Procedures.rename=function(t){t=t.trim();var e=E.Procedures.findLegalName(t,this.getSourceBlock()),o=this.getValue();if(o!=t&&o!=e){t=this.getSourceBlock().workspace.getAllBlocks(!1);for(var n=0;n<t.length;n++)t[n].renameProcedure&&t[n].renameProcedure(o,e)}return e},E.Procedures.flyoutCategory=function(t){function e(t,e){for(var o=0;o<t.length;o++){var n=t[o][0],i=t[o][1],r=E.utils.xml.createElement("block");r.setAttribute("type",e),r.setAttribute("gap",16);var s=E.utils.xml.createElement("mutation");for(s.setAttribute("name",n),r.appendChild(s),n=0;n<i.length;n++){var a=E.utils.xml.createElement("arg");a.setAttribute("name",i[n]),s.appendChild(a)}l.push(r)}}var l=[];if(E.Blocks.procedures_defnoreturn){var o=E.utils.xml.createElement("block");o.setAttribute("type","procedures_defnoreturn"),o.setAttribute("gap",16);var n=E.utils.xml.createElement("field");n.setAttribute("name","NAME"),n.appendChild(E.utils.xml.createTextNode(E.Msg.PROCEDURES_DEFNORETURN_PROCEDURE)),o.appendChild(n),l.push(o)}return E.Blocks.procedures_defreturn&&((o=E.utils.xml.createElement("block")).setAttribute("type","procedures_defreturn"),o.setAttribute("gap",16),(n=E.utils.xml.createElement("field")).setAttribute("name","NAME"),n.appendChild(E.utils.xml.createTextNode(E.Msg.PROCEDURES_DEFRETURN_PROCEDURE)),o.appendChild(n),l.push(o)),E.Blocks.procedures_ifreturn&&((o=E.utils.xml.createElement("block")).setAttribute("type","procedures_ifreturn"),o.setAttribute("gap",16),l.push(o)),l.length&&l[l.length-1].setAttribute("gap",24),e((t=E.Procedures.allProcedures(t))[0],"procedures_callnoreturn"),e(t[1],"procedures_callreturn"),l},E.Procedures.updateMutatorFlyout_=function(t){for(var e,o=[],n=t.getBlocksByType("procedures_mutatorarg",!1),i=0;e=n[i];i++)o.push(e.getFieldValue("NAME"));n=E.utils.xml.createElement("xml"),(i=E.utils.xml.createElement("block")).setAttribute("type","procedures_mutatorarg"),(e=E.utils.xml.createElement("field")).setAttribute("name","NAME"),o=E.Variables.generateUniqueNameFromOptions(E.Procedures.DEFAULT_ARG,o),o=E.utils.xml.createTextNode(o),e.appendChild(o),i.appendChild(e),n.appendChild(i),t.updateToolbox(n)},E.Procedures.mutatorOpenListener=function(t){if(t.type==E.Events.UI&&"mutatorOpen"==t.element&&t.newValue){var e=(t=E.Workspace.getById(t.workspaceId).getBlockById(t.blockId)).type;"procedures_defnoreturn"!=e&&"procedures_defreturn"!=e||(t=t.mutator.getWorkspace(),E.Procedures.updateMutatorFlyout_(t),t.addChangeListener(E.Procedures.mutatorChangeListener_))}},E.Procedures.mutatorChangeListener_=function(t){t.type!=E.Events.BLOCK_CREATE&&t.type!=E.Events.BLOCK_DELETE&&t.type!=E.Events.BLOCK_CHANGE||(t=E.Workspace.getById(t.workspaceId),E.Procedures.updateMutatorFlyout_(t))},E.Procedures.getCallers=function(t,e){var o=[];e=e.getAllBlocks(!1);for(var n=0;n<e.length;n++)if(e[n].getProcedureCall){var i=e[n].getProcedureCall();i&&E.Names.equals(i,t)&&o.push(e[n])}return o},E.Procedures.mutateCallers=function(t){var e,o=E.Events.recordUndo,n=t.getProcedureDef()[0],i=t.mutationToDom(!0);for(t=E.Procedures.getCallers(n,t.workspace),n=0;e=t[n];n++){var r=e.mutationToDom();r=r&&E.Xml.domToText(r),e.domToMutation(i);var s=e.mutationToDom();r!=(s=s&&E.Xml.domToText(s))&&(E.Events.recordUndo=!1,E.Events.fire(new E.Events.BlockChange(e,"mutation",null,r,s)),E.Events.recordUndo=o)}},E.Procedures.getDefinition=function(t,e){e=e.getTopBlocks(!1);for(var o=0;o<e.length;o++)if(e[o].getProcedureDef){var n=e[o].getProcedureDef();if(n&&E.Names.equals(n[0],t))return e[o]}return null},E.VariableModel=function(t,e,o,n){this.workspace=t,this.name=e,this.type=o||"",this.id_=n||E.utils.genUid(),E.Events.fire(new E.Events.VarCreate(this))},E.VariableModel.prototype.getId=function(){return this.id_},E.VariableModel.compareByName=function(t,e){return(t=t.name.toLowerCase())<(e=e.name.toLowerCase())?-1:t==e?0:1},E.Variables={},E.Variables.NAME_TYPE=E.VARIABLE_CATEGORY_NAME,E.Variables.allUsedVarModels=function(t){var e=t.getAllBlocks(!1);t=Object.create(null);for(var o=0;o<e.length;o++){var n=e[o].getVarModels();if(n)for(var i=0;i<n.length;i++){var r=n[i],s=r.getId();s&&(t[s]=r)}}for(s in e=[],t)e.push(t[s]);return e},E.Variables.ALL_DEVELOPER_VARS_WARNINGS_BY_BLOCK_TYPE_={},E.Variables.allDeveloperVariables=function(t){t=t.getAllBlocks(!1);for(var e,o=Object.create(null),n=0;e=t[n];n++){var i=e.getDeveloperVariables;if(!i&&e.getDeveloperVars&&(i=e.getDeveloperVars,E.Variables.ALL_DEVELOPER_VARS_WARNINGS_BY_BLOCK_TYPE_[e.type]||(console.warn("Function getDeveloperVars() deprecated. Use getDeveloperVariables() (block type '"+e.type+"')"),E.Variables.ALL_DEVELOPER_VARS_WARNINGS_BY_BLOCK_TYPE_[e.type]=!0)),i)for(e=i(),i=0;i<e.length;i++)o[e[i]]=!0}return Object.keys(o)},E.Variables.flyoutCategory=function(t){var e=[],o=document.createElement("button");return o.setAttribute("text","%{BKY_NEW_VARIABLE}"),o.setAttribute("callbackKey","CREATE_VARIABLE"),t.registerButtonCallback("CREATE_VARIABLE",function(t){E.Variables.createVariableButtonHandler(t.getTargetWorkspace())}),e.push(o),t=E.Variables.flyoutCategoryBlocks(t),e.concat(t)},E.Variables.flyoutCategoryBlocks=function(t){var e=[];if(0<(t=t.getVariablesOfType("")).length){var o=t[t.length-1];if(E.Blocks.variables_set){var n=E.utils.xml.createElement("block");n.setAttribute("type","variables_set"),n.setAttribute("gap",E.Blocks.math_change?8:24),n.appendChild(E.Variables.generateVariableFieldDom(o)),e.push(n)}if(E.Blocks.math_change&&((n=E.utils.xml.createElement("block")).setAttribute("type","math_change"),n.setAttribute("gap",E.Blocks.variables_get?20:8),n.appendChild(E.Variables.generateVariableFieldDom(o)),o=E.Xml.textToDom('<value name="DELTA"><shadow type="math_number"><field name="NUM">1</field></shadow></value>'),n.appendChild(o),e.push(n)),E.Blocks.variables_get){t.sort(E.VariableModel.compareByName),o=0;for(var i;i=t[o];o++)(n=E.utils.xml.createElement("block")).setAttribute("type","variables_get"),n.setAttribute("gap",8),n.appendChild(E.Variables.generateVariableFieldDom(i)),e.push(n)}}return e},E.Variables.VAR_LETTER_OPTIONS="ijkmnopqrstuvwxyzabcdefgh",E.Variables.generateUniqueName=function(t){return E.Variables.generateUniqueNameFromOptions(E.Variables.VAR_LETTER_OPTIONS.charAt(0),t.getAllVariableNames())},E.Variables.generateUniqueNameFromOptions=function(t,e){if(!e.length)return t;for(var o=E.Variables.VAR_LETTER_OPTIONS,n="",i=o.indexOf(t);;){for(var r=!1,s=0;s<e.length;s++)if(e[s].toLowerCase()==t){r=!0;break}if(!r)return t;++i==o.length&&(i=0,n=Number(n)+1),t=o.charAt(i)+n}},E.Variables.createVariableButtonHandler=function(n,i,t){var r=t||"",s=function(t){E.Variables.promptName(E.Msg.NEW_VARIABLE_TITLE,t,function(t){if(t){var e=E.Variables.nameUsedWithAnyType(t,n);if(e){if(e.type==r)var o=E.Msg.VARIABLE_ALREADY_EXISTS.replace("%1",e.name);else o=(o=E.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE).replace("%1",e.name).replace("%2",e.type);E.alert(o,function(){s(t)})}else n.createVariable(t,r),i&&i(t)}else i&&i(null)})};s("")},E.Variables.createVariable=E.Variables.createVariableButtonHandler,E.Variables.renameVariable=function(o,n,i){var r=function(t){var e=E.Msg.RENAME_VARIABLE_TITLE.replace("%1",n.name);E.Variables.promptName(e,t,function(t){if(t){var e=E.Variables.nameUsedWithOtherType_(t,n.type,o);e?(e=E.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE.replace("%1",e.name).replace("%2",e.type),E.alert(e,function(){r(t)})):(o.renameVariableById(n.getId(),t),i&&i(t))}else i&&i(null)})};r("")},E.Variables.promptName=function(t,e,o){E.prompt(t,e,function(t){t&&((t=t.replace(/[\s\xa0]+/g," ").trim())==E.Msg.RENAME_VARIABLE||t==E.Msg.NEW_VARIABLE)&&(t=null),o(t)})},E.Variables.nameUsedWithOtherType_=function(t,e,o){o=o.getVariableMap().getAllVariables(),t=t.toLowerCase();for(var n,i=0;n=o[i];i++)if(n.name.toLowerCase()==t&&n.type!=e)return n;return null},E.Variables.nameUsedWithAnyType=function(t,e){e=e.getVariableMap().getAllVariables(),t=t.toLowerCase();for(var o,n=0;o=e[n];n++)if(o.name.toLowerCase()==t)return o;return null},E.Variables.generateVariableFieldDom=function(t){var e=E.utils.xml.createElement("field");return e.setAttribute("name","VAR"),e.setAttribute("id",t.getId()),e.setAttribute("variabletype",t.type),t=E.utils.xml.createTextNode(t.name),e.appendChild(t),e},E.Variables.getOrCreateVariablePackage=function(t,e,o,n){var i=E.Variables.getVariable(t,e,o,n);return i||(i=E.Variables.createVariable_(t,e,o,n)),i},E.Variables.getVariable=function(t,e,o,n){var i=t.getPotentialVariableMap(),r=null;if(e&&(!(r=t.getVariableById(e))&&i&&(r=i.getVariableById(e)),r))return r;if(o){if(null==n)throw Error("Tried to look up a variable by name without a type");!(r=t.getVariable(o,n))&&i&&(r=i.getVariable(o,n))}return r},E.Variables.createVariable_=function(t,e,o,n){var i=t.getPotentialVariableMap();return o||(o=E.Variables.generateUniqueName(t.isFlyout?t.targetWorkspace:t)),i?i.createVariable(o,n,e):t.createVariable(o,n,e)},E.Variables.getAddedVariables=function(t,e){t=t.getAllVariables();var o=[];if(e.length!=t.length)for(var n=0;n<t.length;n++){var i=t[n];-1==e.indexOf(i)&&o.push(i)}return o},E.WidgetDiv={},E.WidgetDiv.owner_=null,E.WidgetDiv.dispose_=null,E.WidgetDiv.rendererClassName_="",E.WidgetDiv.themeClassName_="",E.WidgetDiv.createDom=function(){E.WidgetDiv.DIV||(E.WidgetDiv.DIV=document.createElement("div"),E.WidgetDiv.DIV.className="blocklyWidgetDiv",(E.parentContainer||document.body).appendChild(E.WidgetDiv.DIV))},E.WidgetDiv.show=function(t,e,o){E.WidgetDiv.hide(),E.WidgetDiv.owner_=t,E.WidgetDiv.dispose_=o,(t=E.WidgetDiv.DIV).style.direction=e?"rtl":"ltr",t.style.display="block",e=E.getMainWorkspace(),E.WidgetDiv.rendererClassName_=e.getRenderer().getClassName(),E.WidgetDiv.themeClassName_=e.getTheme().getClassName(),E.utils.dom.addClass(t,E.WidgetDiv.rendererClassName_),E.utils.dom.addClass(t,E.WidgetDiv.themeClassName_)},E.WidgetDiv.hide=function(){if(E.WidgetDiv.isVisible()){E.WidgetDiv.owner_=null;var t=E.WidgetDiv.DIV;t.style.display="none",t.style.left="",t.style.top="",E.WidgetDiv.dispose_&&E.WidgetDiv.dispose_(),E.WidgetDiv.dispose_=null,t.textContent="",E.WidgetDiv.rendererClassName_&&(E.utils.dom.removeClass(t,E.WidgetDiv.rendererClassName_),E.WidgetDiv.rendererClassName_=""),E.WidgetDiv.themeClassName_&&(E.utils.dom.removeClass(t,E.WidgetDiv.themeClassName_),E.WidgetDiv.themeClassName_=""),E.getMainWorkspace().markFocused()}},E.WidgetDiv.isVisible=function(){return!!E.WidgetDiv.owner_},E.WidgetDiv.hideIfOwner=function(t){E.WidgetDiv.owner_==t&&E.WidgetDiv.hide()},E.WidgetDiv.positionInternal_=function(t,e,o){E.WidgetDiv.DIV.style.left=t+"px",E.WidgetDiv.DIV.style.top=e+"px",E.WidgetDiv.DIV.style.height=o+"px"},E.WidgetDiv.positionWithAnchor=function(t,e,o,n){var i=E.WidgetDiv.calculateY_(t,e,o);t=E.WidgetDiv.calculateX_(t,e,o,n),i<0?E.WidgetDiv.positionInternal_(t,0,o.height+i):E.WidgetDiv.positionInternal_(t,i,o.height)},E.WidgetDiv.calculateX_=function(t,e,o,n){return n?(e=Math.max(e.right-o.width,t.left),Math.min(e,t.right-o.width)):(e=Math.min(e.left,t.right-o.width),Math.max(e,t.left))},E.WidgetDiv.calculateY_=function(t,e,o){return e.bottom+o.height>=t.bottom?e.top-o.height:e.bottom},E.VERSION="3.20200924.2",E.mainWorkspace=null,E.selected=null,E.draggingConnections=[],E.clipboardXml_=null,E.clipboardSource_=null,E.clipboardTypeCounts_=null,E.cache3dSupported_=null,E.parentContainer=null,E.svgSize=function(t){return new E.utils.Size(t.cachedWidth_,t.cachedHeight_)},E.resizeSvgContents=function(t){t.resizeContents()},E.svgResize=function(t){for(;t.options.parentWorkspace;)t=t.options.parentWorkspace;var e=t.getParentSvg(),o=e.parentNode;if(o){var n=o.offsetWidth;o=o.offsetHeight,e.cachedWidth_!=n&&(e.setAttribute("width",n+"px"),e.cachedWidth_=n),e.cachedHeight_!=o&&(e.setAttribute("height",o+"px"),e.cachedHeight_=o),t.resize()}},E.onKeyDown=function(t){var e=E.mainWorkspace;if(e&&!(E.utils.isTargetInput(t)||e.rendered&&!e.isVisible()))if(e.options.readOnly)E.navigation.onKeyPress(t);else{var o=!1;if(t.keyCode==E.utils.KeyCodes.ESC)E.hideChaff(),E.navigation.onBlocklyAction(E.navigation.ACTION_EXIT);else{if(!E.Gesture.inProgress()&&E.navigation.onKeyPress(t))return;if(t.keyCode==E.utils.KeyCodes.BACKSPACE||t.keyCode==E.utils.KeyCodes.DELETE){if(t.preventDefault(),E.Gesture.inProgress())return;E.selected&&E.selected.isDeletable()&&(o=!0)}else if(t.altKey||t.ctrlKey||t.metaKey){if(E.Gesture.inProgress())return;E.selected&&E.selected.isDeletable()&&E.selected.isMovable()&&(t.keyCode==E.utils.KeyCodes.C?(E.hideChaff(),E.copy_(E.selected)):t.keyCode!=E.utils.KeyCodes.X||E.selected.workspace.isFlyout||(E.copy_(E.selected),o=!0)),t.keyCode==E.utils.KeyCodes.V?E.clipboardXml_&&((t=E.clipboardSource_).isFlyout&&(t=t.targetWorkspace),E.clipboardTypeCounts_&&t.isCapacityAvailable(E.clipboardTypeCounts_)&&(E.Events.setGroup(!0),t.paste(E.clipboardXml_),E.Events.setGroup(!1))):t.keyCode==E.utils.KeyCodes.Z?(E.hideChaff(),e.undo(t.shiftKey)):t.ctrlKey&&t.keyCode==E.utils.KeyCodes.Y&&(E.hideChaff(),e.undo(!0))}}o&&!E.selected.workspace.isFlyout&&(E.Events.setGroup(!0),E.hideChaff(),E.selected.dispose(!0,!0),E.Events.setGroup(!1))}},E.copy_=function(t){(t=t.toCopyData())&&(E.clipboardXml_=t.xml,E.clipboardSource_=t.source,E.clipboardTypeCounts_=t.typeCounts)},E.duplicate=function(t){var e=E.clipboardXml_,o=E.clipboardSource_;E.copy_(t),t.workspace.paste(E.clipboardXml_),E.clipboardXml_=e,E.clipboardSource_=o},E.onContextMenu_=function(t){E.utils.isTargetInput(t)||t.preventDefault()},E.hideChaff=function(t){E.Tooltip.hide(),E.WidgetDiv.hide(),E.DropDownDiv.hideWithoutAnimation(),t||((t=E.getMainWorkspace()).trashcan&&t.trashcan.flyout&&t.trashcan.closeFlyout(),(t=t.getToolbox())&&t.getFlyout()&&t.getFlyout().autoClose&&t.clearSelection())},E.getMainWorkspace=function(){return E.mainWorkspace},E.alert=function(t,e){alert(t),e&&e()},E.confirm=function(t,e){e(confirm(t))},E.prompt=function(t,e,o){o(prompt(t,e))},E.jsonInitFactory_=function(t){return function(){this.jsonInit(t)}},E.defineBlocksWithJsonArray=function(t){for(var e=0;e<t.length;e++){var o=t[e];if(o){var n=o.type;null==n||""===n?console.warn("Block definition #"+e+" in JSON array is missing a type attribute. Skipping."):(E.Blocks[n]&&console.warn("Block definition #"+e+' in JSON array overwrites prior definition of "'+n+'".'),E.Blocks[n]={init:E.jsonInitFactory_(o)})}else console.warn("Block definition #"+e+" in JSON array is "+o+". Skipping.")}},E.bindEventWithChecks_=function(t,e,i,r,s,o){var a=!1,n=function(t){var e=!s;t=E.Touch.splitEventByTouches(t);for(var o,n=0;o=t[n];n++)e&&!E.Touch.shouldHandleEvent(o)||(E.Touch.setClientFromTouch(o),i?r.call(i,o):r(o),a=!0)},l=[];if(E.utils.global.PointerEvent&&e in E.Touch.TOUCH_MAP)for(var c,u=0;c=E.Touch.TOUCH_MAP[e][u];u++)t.addEventListener(c,n,!1),l.push([t,c,n]);else if(t.addEventListener(e,n,!1),l.push([t,e,n]),e in E.Touch.TOUCH_MAP){var h=function(t){n(t),a&&!o&&t.preventDefault()};for(u=0;c=E.Touch.TOUCH_MAP[e][u];u++)t.addEventListener(c,h,!1),l.push([t,c,h])}return l},E.bindEvent_=function(t,e,o,n){var i=function(t){o?n.call(o,t):n(t)},r=[];if(E.utils.global.PointerEvent&&e in E.Touch.TOUCH_MAP)for(var s,a=0;s=E.Touch.TOUCH_MAP[e][a];a++)t.addEventListener(s,i,!1),r.push([t,s,i]);else if(t.addEventListener(e,i,!1),r.push([t,e,i]),e in E.Touch.TOUCH_MAP){var l=function(t){if(t.changedTouches&&1==t.changedTouches.length){var e=t.changedTouches[0];t.clientX=e.clientX,t.clientY=e.clientY}i(t),t.preventDefault()};for(a=0;s=E.Touch.TOUCH_MAP[e][a];a++)t.addEventListener(s,l,!1),r.push([t,s,l])}return r},E.unbindEvent_=function(t){for(;t.length;){var e=t.pop(),o=e[2];e[0].removeEventListener(e[1],o,!1)}return o},E.isNumber=function(t){return/^\s*-?\d+(\.\d+)?\s*$/.test(t)},E.hueToHex=function(t){return E.utils.colour.hsvToHex(t,E.HSV_SATURATION,255*E.HSV_VALUE)},E.checkBlockColourConstants=function(){E.checkBlockColourConstant_("LOGIC_HUE",["Blocks","logic","HUE"],void 0),E.checkBlockColourConstant_("LOGIC_HUE",["Constants","Logic","HUE"],210),E.checkBlockColourConstant_("LOOPS_HUE",["Blocks","loops","HUE"],void 0),E.checkBlockColourConstant_("LOOPS_HUE",["Constants","Loops","HUE"],120),E.checkBlockColourConstant_("MATH_HUE",["Blocks","math","HUE"],void 0),E.checkBlockColourConstant_("MATH_HUE",["Constants","Math","HUE"],230),E.checkBlockColourConstant_("TEXTS_HUE",["Blocks","texts","HUE"],void 0),E.checkBlockColourConstant_("TEXTS_HUE",["Constants","Text","HUE"],160),E.checkBlockColourConstant_("LISTS_HUE",["Blocks","lists","HUE"],void 0),E.checkBlockColourConstant_("LISTS_HUE",["Constants","Lists","HUE"],260),E.checkBlockColourConstant_("COLOUR_HUE",["Blocks","colour","HUE"],void 0),E.checkBlockColourConstant_("COLOUR_HUE",["Constants","Colour","HUE"],20),E.checkBlockColourConstant_("VARIABLES_HUE",["Blocks","variables","HUE"],void 0),E.checkBlockColourConstant_("VARIABLES_HUE",["Constants","Variables","HUE"],330),E.checkBlockColourConstant_("VARIABLES_DYNAMIC_HUE",["Constants","VariablesDynamic","HUE"],310),E.checkBlockColourConstant_("PROCEDURES_HUE",["Blocks","procedures","HUE"],void 0)},E.checkBlockColourConstant_=function(t,e,o){for(var n="Blockly",i=E,r=0;r<e.length;++r)n+="."+e[r],i&&(i=i[e[r]]);i&&i!==o&&(t=(void 0===o?'%1 has been removed. Use Blockly.Msg["%2"].':'%1 is deprecated and unused. Override Blockly.Msg["%2"].').replace("%1",n).replace("%2",t),console.warn(t))},E.setParentContainer=function(t){E.parentContainer=t},E.Icon=function(t){this.block_=t,this.iconGroup_=null},E.Icon.prototype.collapseHidden=!0,E.Icon.prototype.SIZE=17,E.Icon.prototype.bubble_=null,E.Icon.prototype.iconXY_=null,E.Icon.prototype.createIcon=function(){this.iconGroup_||(this.iconGroup_=E.utils.dom.createSvgElement(E.utils.Svg.G,{class:"blocklyIconGroup"},null),this.block_.isInFlyout&&E.utils.dom.addClass(this.iconGroup_,"blocklyIconGroupReadonly"),this.drawIcon_(this.iconGroup_),this.block_.getSvgRoot().appendChild(this.iconGroup_),E.bindEventWithChecks_(this.iconGroup_,"mouseup",this,this.iconClick_),this.updateEditable())},E.Icon.prototype.dispose=function(){E.utils.dom.removeNode(this.iconGroup_),this.iconGroup_=null,this.setVisible(!1),this.block_=null},E.Icon.prototype.updateEditable=function(){},E.Icon.prototype.isVisible=function(){return!!this.bubble_},E.Icon.prototype.iconClick_=function(t){this.block_.workspace.isDragging()||this.block_.isInFlyout||E.utils.isRightButton(t)||this.setVisible(!this.isVisible())},E.Icon.prototype.applyColour=function(){this.isVisible()&&this.bubble_.setColour(this.block_.style.colourPrimary)},E.Icon.prototype.setIconLocation=function(t){this.iconXY_=t,this.isVisible()&&this.bubble_.setAnchorLocation(t)},E.Icon.prototype.computeIconLocation=function(){var t=this.block_.getRelativeToSurfaceXY(),e=E.utils.getRelativeXY(this.iconGroup_);t=new E.utils.Coordinate(t.x+e.x+this.SIZE/2,t.y+e.y+this.SIZE/2),E.utils.Coordinate.equals(this.getIconLocation(),t)||this.setIconLocation(t)},E.Icon.prototype.getIconLocation=function(){return this.iconXY_},E.Icon.prototype.getCorrectedSize=function(){return new E.utils.Size(E.Icon.prototype.SIZE,E.Icon.prototype.SIZE-2)},E.Warning=function(t){E.Warning.superClass_.constructor.call(this,t),this.createIcon(),this.text_={}},E.utils.object.inherits(E.Warning,E.Icon),E.Warning.prototype.collapseHidden=!1,E.Warning.prototype.drawIcon_=function(t){E.utils.dom.createSvgElement(E.utils.Svg.PATH,{class:"blocklyIconShape",d:"M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z"},t),E.utils.dom.createSvgElement(E.utils.Svg.PATH,{class:"blocklyIconSymbol",d:"m7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z"},t),E.utils.dom.createSvgElement(E.utils.Svg.RECT,{class:"blocklyIconSymbol",x:"7",y:"11",height:"2",width:"2"},t)},E.Warning.textToDom_=function(t){var e=E.utils.dom.createSvgElement(E.utils.Svg.TEXT,{class:"blocklyText blocklyBubbleText blocklyNoPointerEvents",y:E.Bubble.BORDER_WIDTH},null);t=t.split("\n");for(var o=0;o<t.length;o++){var n=E.utils.dom.createSvgElement(E.utils.Svg.TSPAN,{dy:"1em",x:E.Bubble.BORDER_WIDTH},e),i=document.createTextNode(t[o]);n.appendChild(i)}return e},E.Warning.prototype.setVisible=function(t){t!=this.isVisible()&&(E.Events.fire(new E.Events.Ui(this.block_,"warningOpen",!t,t)),t?this.createBubble():this.disposeBubble())},E.Warning.prototype.createBubble=function(){if(this.paragraphElement_=E.Warning.textToDom_(this.getText()),this.bubble_=new E.Bubble(this.block_.workspace,this.paragraphElement_,this.block_.pathObject.svgPath,this.iconXY_,null,null),this.bubble_.setSvgId(this.block_.id),this.block_.RTL)for(var t,e=this.paragraphElement_.getBBox().width,o=0;t=this.paragraphElement_.childNodes[o];o++)t.setAttribute("text-anchor","end"),t.setAttribute("x",e+E.Bubble.BORDER_WIDTH);this.applyColour()},E.Warning.prototype.disposeBubble=function(){this.bubble_.dispose(),this.paragraphElement_=this.body_=this.bubble_=null},E.Warning.prototype.setText=function(t,e){this.text_[e]!=t&&(t?this.text_[e]=t:delete this.text_[e],this.isVisible()&&(this.setVisible(!1),this.setVisible(!0)))},E.Warning.prototype.getText=function(){var t,e=[];for(t in this.text_)e.push(this.text_[t]);return e.join("\n")},E.Warning.prototype.dispose=function(){this.block_.warning=null,E.Icon.prototype.dispose.call(this)},E.Comment=function(t){E.Comment.superClass_.constructor.call(this,t),this.model_=t.commentModel,this.model_.text=this.model_.text||"",this.cachedText_="",this.onInputWrapper_=this.onChangeWrapper_=this.onWheelWrapper_=this.onMouseUpWrapper_=null,this.createIcon()},E.utils.object.inherits(E.Comment,E.Icon),E.Comment.prototype.drawIcon_=function(t){E.utils.dom.createSvgElement(E.utils.Svg.CIRCLE,{class:"blocklyIconShape",r:"8",cx:"8",cy:"8"},t),E.utils.dom.createSvgElement(E.utils.Svg.PATH,{class:"blocklyIconSymbol",d:"m6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.4050.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25-1.201,0.998 -1.201,1.528 -1.204,2.19z"},t),E.utils.dom.createSvgElement(E.utils.Svg.RECT,{class:"blocklyIconSymbol",x:"6.8",y:"10.78",height:"2",width:"2"},t)},E.Comment.prototype.createEditor_=function(){this.foreignObject_=E.utils.dom.createSvgElement(E.utils.Svg.FOREIGNOBJECT,{x:E.Bubble.BORDER_WIDTH,y:E.Bubble.BORDER_WIDTH},null);var t=document.createElementNS(E.utils.dom.HTML_NS,"body");t.setAttribute("xmlns",E.utils.dom.HTML_NS),t.className="blocklyMinimalBody";var e=this.textarea_=document.createElementNS(E.utils.dom.HTML_NS,"textarea");return e.className="blocklyCommentTextarea",e.setAttribute("dir",this.block_.RTL?"RTL":"LTR"),e.value=this.model_.text,this.resizeTextarea_(),t.appendChild(e),this.foreignObject_.appendChild(t),this.onMouseUpWrapper_=E.bindEventWithChecks_(e,"mouseup",this,this.startEdit_,!0,!0),this.onWheelWrapper_=E.bindEventWithChecks_(e,"wheel",this,function(t){t.stopPropagation()}),this.onChangeWrapper_=E.bindEventWithChecks_(e,"change",this,function(t){this.cachedText_!=this.model_.text&&E.Events.fire(new E.Events.BlockChange(this.block_,"comment",null,this.cachedText_,this.model_.text))}),this.onInputWrapper_=E.bindEventWithChecks_(e,"input",this,function(t){this.model_.text=e.value}),setTimeout(e.focus.bind(e),0),this.foreignObject_},E.Comment.prototype.updateEditable=function(){E.Comment.superClass_.updateEditable.call(this),this.isVisible()&&(this.disposeBubble_(),this.createBubble_())},E.Comment.prototype.onBubbleResize_=function(){this.isVisible()&&(this.model_.size=this.bubble_.getBubbleSize(),this.resizeTextarea_())},E.Comment.prototype.resizeTextarea_=function(){var t=this.model_.size,e=2*E.Bubble.BORDER_WIDTH,o=t.width-e;t=t.height-e,this.foreignObject_.setAttribute("width",o),this.foreignObject_.setAttribute("height",t),this.textarea_.style.width=o-4+"px",this.textarea_.style.height=t-4+"px"},E.Comment.prototype.setVisible=function(t){t!=this.isVisible()&&(E.Events.fire(new E.Events.Ui(this.block_,"commentOpen",!t,t)),(this.model_.pinned=t)?this.createBubble_():this.disposeBubble_())},E.Comment.prototype.createBubble_=function(){!this.block_.isEditable()||E.utils.userAgent.IE?this.createNonEditableBubble_():this.createEditableBubble_()},E.Comment.prototype.createEditableBubble_=function(){this.bubble_=new E.Bubble(this.block_.workspace,this.createEditor_(),this.block_.pathObject.svgPath,this.iconXY_,this.model_.size.width,this.model_.size.height),this.bubble_.setSvgId(this.block_.id),this.bubble_.registerResizeEvent(this.onBubbleResize_.bind(this)),this.applyColour()},E.Comment.prototype.createNonEditableBubble_=function(){E.Warning.prototype.createBubble.call(this)},E.Comment.prototype.disposeBubble_=function(){this.paragraphElement_?E.Warning.prototype.disposeBubble.call(this):(this.onMouseUpWrapper_&&(E.unbindEvent_(this.onMouseUpWrapper_),this.onMouseUpWrapper_=null),this.onWheelWrapper_&&(E.unbindEvent_(this.onWheelWrapper_),this.onWheelWrapper_=null),this.onChangeWrapper_&&(E.unbindEvent_(this.onChangeWrapper_),this.onChangeWrapper_=null),this.onInputWrapper_&&(E.unbindEvent_(this.onInputWrapper_),this.onInputWrapper_=null),this.bubble_.dispose(),this.foreignObject_=this.textarea_=this.bubble_=null)},E.Comment.prototype.startEdit_=function(t){this.bubble_.promote()&&this.textarea_.focus(),this.cachedText_=this.model_.text},E.Comment.prototype.getBubbleSize=function(){return this.model_.size},E.Comment.prototype.setBubbleSize=function(t,e){this.bubble_?this.bubble_.setBubbleSize(t,e):(this.model_.size.width=t,this.model_.size.height=e)},E.Comment.prototype.getText=function(){return E.utils.deprecation.warn("Comment.prototype.getText","August 2019","December 2020","block.getCommentText"),this.model_.text||""},E.Comment.prototype.setText=function(t){E.utils.deprecation.warn("Comment.prototype.setText","August 2019","December 2020","block.setCommentText"),this.model_.text!=t&&(this.model_.text=t,this.updateText())},E.Comment.prototype.updateText=function(){this.textarea_?this.textarea_.value=this.model_.text:this.paragraphElement_&&(this.paragraphElement_.firstChild.textContent=this.model_.text)},E.Comment.prototype.dispose=function(){this.block_.comment=null,E.Icon.prototype.dispose.call(this)},E.Css.register(".blocklyCommentTextarea {,background-color: #fef49c;,border: 0;,outline: 0;,margin: 0;,padding: 3px;,resize: none;,display: block;,overflow: hidden;,}".split(",")),E.FlyoutCursor=function(){E.FlyoutCursor.superClass_.constructor.call(this)},E.utils.object.inherits(E.FlyoutCursor,E.Cursor),E.FlyoutCursor.prototype.onBlocklyAction=function(t){switch(t.name){case E.navigation.actionNames.PREVIOUS:return this.prev(),!0;case E.navigation.actionNames.NEXT:return this.next(),!0;default:return!1}},E.FlyoutCursor.prototype.next=function(){var t=this.getCurNode();return t?((t=t.next())&&this.setCurNode(t),t):null},E.FlyoutCursor.prototype.in=function(){return null},E.FlyoutCursor.prototype.prev=function(){var t=this.getCurNode();return t?((t=t.prev())&&this.setCurNode(t),t):null},E.FlyoutCursor.prototype.out=function(){return null},E.Flyout=function(t){t.getMetrics=this.getMetrics_.bind(this),t.setMetrics=this.setMetrics_.bind(this),this.workspace_=new E.WorkspaceSvg(t),this.workspace_.isFlyout=!0,this.workspace_.setVisible(this.isVisible_),this.RTL=!!t.RTL,this.horizontalLayout=!1,this.toolboxPosition_=t.toolboxPosition,this.eventWrappers_=[],this.mats_=[],this.buttons_=[],this.listeners_=[],this.permanentlyDisabled_=[],this.tabWidth_=this.workspace_.getRenderer().getConstants().TAB_WIDTH,this.targetWorkspace=null},E.Flyout.prototype.autoClose=!0,E.Flyout.prototype.isVisible_=!1,E.Flyout.prototype.containerVisible_=!0,E.Flyout.prototype.CORNER_RADIUS=8,E.Flyout.prototype.MARGIN=E.Flyout.prototype.CORNER_RADIUS,E.Flyout.prototype.GAP_X=3*E.Flyout.prototype.MARGIN,E.Flyout.prototype.GAP_Y=3*E.Flyout.prototype.MARGIN,E.Flyout.prototype.SCROLLBAR_PADDING=2,E.Flyout.prototype.width_=0,E.Flyout.prototype.height_=0,E.Flyout.prototype.dragAngleRange_=70,E.Flyout.prototype.createDom=function(t){return this.svgGroup_=E.utils.dom.createSvgElement(t,{class:"blocklyFlyout",style:"display: none"},null),this.svgBackground_=E.utils.dom.createSvgElement(E.utils.Svg.PATH,{class:"blocklyFlyoutBackground"},this.svgGroup_),this.svgGroup_.appendChild(this.workspace_.createDom()),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutBackgroundColour","fill"),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutOpacity","fill-opacity"),this.workspace_.getMarkerManager().setCursor(new E.FlyoutCursor),this.svgGroup_},E.Flyout.prototype.init=function(t){this.targetWorkspace=t,this.workspace_.targetWorkspace=t,this.scrollbar=new E.Scrollbar(this.workspace_,this.horizontalLayout,!1,"blocklyFlyoutScrollbar"),this.hide(),Array.prototype.push.apply(this.eventWrappers_,E.bindEventWithChecks_(this.svgGroup_,"wheel",this,this.wheel_)),this.autoClose||(this.filterWrapper_=this.filterForCapacity_.bind(this),this.targetWorkspace.addChangeListener(this.filterWrapper_)),Array.prototype.push.apply(this.eventWrappers_,E.bindEventWithChecks_(this.svgBackground_,"mousedown",this,this.onMouseDown_)),this.workspace_.getGesture=this.targetWorkspace.getGesture.bind(this.targetWorkspace),this.workspace_.setVariableMap(this.targetWorkspace.getVariableMap()),this.workspace_.createPotentialVariableMap()},E.Flyout.prototype.dispose=function(){this.hide(),E.unbindEvent_(this.eventWrappers_),this.filterWrapper_&&(this.targetWorkspace.removeChangeListener(this.filterWrapper_),this.filterWrapper_=null),this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null),this.workspace_&&(this.workspace_.getThemeManager().unsubscribe(this.svgBackground_),this.workspace_.targetWorkspace=null,this.workspace_.dispose(),this.workspace_=null),this.svgGroup_&&(E.utils.dom.removeNode(this.svgGroup_),this.svgGroup_=null),this.targetWorkspace=this.svgBackground_=null},E.Flyout.prototype.getWidth=function(){return this.width_},E.Flyout.prototype.getHeight=function(){return this.height_},E.Flyout.prototype.getWorkspace=function(){return this.workspace_},E.Flyout.prototype.isVisible=function(){return this.isVisible_},E.Flyout.prototype.setVisible=function(t){var e=t!=this.isVisible();this.isVisible_=t,e&&this.updateDisplay_()},E.Flyout.prototype.setContainerVisible=function(t){var e=t!=this.containerVisible_;this.containerVisible_=t,e&&this.updateDisplay_()},E.Flyout.prototype.updateDisplay_=function(){var t=!!this.containerVisible_&&this.isVisible();this.svgGroup_.style.display=t?"block":"none",this.scrollbar.setContainerVisible(t)},E.Flyout.prototype.positionAt_=function(t,e,o,n){this.svgGroup_.setAttribute("width",t),this.svgGroup_.setAttribute("height",e),"svg"==this.svgGroup_.tagName?E.utils.dom.setCssTransform(this.svgGroup_,"translate("+o+"px,"+n+"px)"):this.svgGroup_.setAttribute("transform","translate("+o+","+n+")"),this.scrollbar&&(this.scrollbar.setOrigin(o,n),this.scrollbar.resize(),this.scrollbar.setPosition(this.scrollbar.position.x,this.scrollbar.position.y))},E.Flyout.prototype.hide=function(){if(this.isVisible()){this.setVisible(!1);for(var t,e=0;t=this.listeners_[e];e++)E.unbindEvent_(t);this.listeners_.length=0,this.reflowWrapper_&&(this.workspace_.removeChangeListener(this.reflowWrapper_),this.reflowWrapper_=null)}},E.Flyout.prototype.show=function(t){this.workspace_.setResizesEnabled(!1),this.hide(),this.clearOldBlocks_(),"string"==typeof t&&(t=this.getDynamicCategoryContents_(t)),this.setVisible(!0),t=E.utils.toolbox.convertFlyoutDefToJsonArray(t),t=this.createFlyoutInfo_(t),this.layout_(t.contents,t.gaps),this.listeners_.push(E.bindEventWithChecks_(this.svgBackground_,"mouseover",this,function(){for(var t,e=this.workspace_.getTopBlocks(!1),o=0;t=e[o];o++)t.removeSelect()})),this.horizontalLayout?this.height_=0:this.width_=0,this.workspace_.setResizesEnabled(!0),this.reflow(),this.filterForCapacity_(),this.position(),this.reflowWrapper_=this.reflow.bind(this),this.workspace_.addChangeListener(this.reflowWrapper_)},E.Flyout.prototype.createFlyoutInfo_=function(t){var e=[],o=[];this.permanentlyDisabled_.length=0;for(var n,i=this.horizontalLayout?this.GAP_X:this.GAP_Y,r=0;n=t[r];r++)switch(n.custom&&(n=this.getDynamicCategoryContents_(n.custom),n=E.utils.toolbox.convertFlyoutDefToJsonArray(n),t.splice.apply(t,[r,1].concat(n)),n=t[r]),n.kind.toUpperCase()){case"BLOCK":var s=n,a=this.getBlockXml_(s);n=this.createBlock_(a),s=parseInt(s.gap||a.getAttribute("gap"),10),o.push(isNaN(s)?i:s),e.push({type:"block",block:n});break;case"SEP":this.addSeparatorGap_(n,o,i);break;case"LABEL":n=this.createButton_(n,!0),e.push({type:"button",button:n}),o.push(i);break;case"BUTTON":n=this.createButton_(n,!1),e.push({type:"button",button:n}),o.push(i)}return{contents:e,gaps:o}},E.Flyout.prototype.getDynamicCategoryContents_=function(t){if("function"!=typeof(t=this.workspace_.targetWorkspace.getToolboxCategoryCallback(t)))throw TypeError("Couldn't find a callback function when opening a toolbox category.");if(t=t(this.workspace_.targetWorkspace),!Array.isArray(t))throw new TypeError("Result of toolbox category callback must be an array.");return t},E.Flyout.prototype.createButton_=function(t,e){if(!E.FlyoutButton)throw Error("Missing require for Blockly.FlyoutButton");return new E.FlyoutButton(this.workspace_,this.targetWorkspace,t,e)},E.Flyout.prototype.createBlock_=function(t){return(t=E.Xml.domToBlock(t,this.workspace_)).isEnabled()||this.permanentlyDisabled_.push(t),t},E.Flyout.prototype.getBlockXml_=function(t){var e=null,o=t.blockxml;if(o&&"string"!=typeof o?e=o:o&&"string"==typeof o?(e=E.Xml.textToDom(o),t.blockxml=e):t.type&&((e=E.utils.xml.createElement("xml")).setAttribute("type",t.type),e.setAttribute("disabled",t.disabled),t.blockxml=e),!e)throw Error("Error: Invalid block definition. Block definition must have blockxml or type.");return e},E.Flyout.prototype.addSeparatorGap_=function(t,e,o){t=parseInt(t.gap,10),!isNaN(t)&&0<e.length?e[e.length-1]=t:e.push(o)},E.Flyout.prototype.clearOldBlocks_=function(){for(var t,e=this.workspace_.getTopBlocks(!1),o=0;t=e[o];o++)t.workspace==this.workspace_&&t.dispose(!1,!1);for(o=0;o<this.mats_.length;o++)(e=this.mats_[o])&&(E.Tooltip.unbindMouseEvents(e),E.utils.dom.removeNode(e));for(o=this.mats_.length=0;e=this.buttons_[o];o++)e.dispose();this.buttons_.length=0,this.workspace_.getPotentialVariableMap().clear()},E.Flyout.prototype.addBlockListeners_=function(t,e,o){this.listeners_.push(E.bindEventWithChecks_(t,"mousedown",null,this.blockMouseDown_(e))),this.listeners_.push(E.bindEventWithChecks_(o,"mousedown",null,this.blockMouseDown_(e))),this.listeners_.push(E.bindEvent_(t,"mouseenter",e,e.addSelect)),this.listeners_.push(E.bindEvent_(t,"mouseleave",e,e.removeSelect)),this.listeners_.push(E.bindEvent_(o,"mouseenter",e,e.addSelect)),this.listeners_.push(E.bindEvent_(o,"mouseleave",e,e.removeSelect))},E.Flyout.prototype.blockMouseDown_=function(o){var n=this;return function(t){var e=n.targetWorkspace.getGesture(t);e&&(e.setStartBlock(o),e.handleFlyoutStart(t,n))}},E.Flyout.prototype.onMouseDown_=function(t){var e=this.targetWorkspace.getGesture(t);e&&e.handleFlyoutStart(t,this)},E.Flyout.prototype.isBlockCreatable_=function(t){return t.isEnabled()},E.Flyout.prototype.createBlock=function(t){var e=null;E.Events.disable();var o=this.targetWorkspace.getAllVariables();this.targetWorkspace.setResizesEnabled(!1);try{e=this.placeNewBlock_(t)}finally{E.Events.enable()}if(E.hideChaff(),t=E.Variables.getAddedVariables(this.targetWorkspace,o),E.Events.isEnabled()){for(E.Events.setGroup(!0),o=0;o<t.length;o++)E.Events.fire(new E.Events.VarCreate(t[o]));E.Events.fire(new E.Events.Create(e))}return this.autoClose?this.hide():this.filterForCapacity_(),e},E.Flyout.prototype.initFlyoutButton_=function(t,e,o){var n=t.createDom();t.moveTo(e,o),t.show(),this.listeners_.push(E.bindEventWithChecks_(n,"mousedown",this,this.onMouseDown_)),this.buttons_.push(t)},E.Flyout.prototype.createRect_=function(t,e,o,n,i){return(e=E.utils.dom.createSvgElement(E.utils.Svg.RECT,{"fill-opacity":0,x:e,y:o,height:n.height,width:n.width},null)).tooltip=t,E.Tooltip.bindMouseEvents(e),this.workspace_.getCanvas().insertBefore(e,t.getSvgRoot()),t.flyoutRect_=e,this.mats_[i]=e},E.Flyout.prototype.moveRectToBlock_=function(t,e){var o=e.getHeightWidth();t.setAttribute("width",o.width),t.setAttribute("height",o.height),e=e.getRelativeToSurfaceXY(),t.setAttribute("y",e.y),t.setAttribute("x",this.RTL?e.x-o.width:e.x)},E.Flyout.prototype.filterForCapacity_=function(){for(var t,e=this.workspace_.getTopBlocks(!1),o=0;t=e[o];o++)if(-1==this.permanentlyDisabled_.indexOf(t))for(var n=this.targetWorkspace.isCapacityAvailable(E.utils.getBlockTypeCounts(t));t;)t.setEnabled(n),t=t.getNextBlock()},E.Flyout.prototype.reflow=function(){this.reflowWrapper_&&this.workspace_.removeChangeListener(this.reflowWrapper_),this.reflowInternal_(),this.reflowWrapper_&&this.workspace_.addChangeListener(this.reflowWrapper_)},E.Flyout.prototype.isScrollable=function(){return!!this.scrollbar&&this.scrollbar.isVisible()},E.Flyout.prototype.placeNewBlock_=function(t){var e=this.targetWorkspace;if(!t.getSvgRoot())throw Error("oldBlock is not rendered.");var o=E.Xml.blockToDom(t,!0);if(e.setResizesEnabled(!1),!(o=E.Xml.domToBlock(o,e)).getSvgRoot())throw Error("block is not rendered.");var n=e.getOriginOffsetInPixels(),i=this.workspace_.getOriginOffsetInPixels();return(t=t.getRelativeToSurfaceXY()).scale(this.workspace_.scale),t=E.utils.Coordinate.sum(i,t),(n=E.utils.Coordinate.difference(t,n)).scale(1/e.scale),o.moveBy(n.x,n.y),o},E.Flyout.prototype.onBlocklyAction=function(t){return this.workspace_.getCursor().onBlocklyAction(t)},E.HorizontalFlyout=function(t){E.HorizontalFlyout.superClass_.constructor.call(this,t),this.horizontalLayout=!0},E.utils.object.inherits(E.HorizontalFlyout,E.Flyout),E.HorizontalFlyout.prototype.getMetrics_=function(){if(!this.isVisible())return null;try{var e=this.workspace_.getCanvas().getBBox()}catch(t){e={height:0,y:0,width:0,x:0}}var t=this.SCROLLBAR_PADDING,o=this.SCROLLBAR_PADDING;this.toolboxPosition_==E.TOOLBOX_AT_BOTTOM&&(t=0);var n=this.height_;return this.toolboxPosition_==E.TOOLBOX_AT_TOP&&(n-=this.SCROLLBAR_PADDING),{contentHeight:(e.height+2*this.MARGIN)*this.workspace_.scale,contentWidth:(e.width+2*this.MARGIN)*this.workspace_.scale,contentTop:0,contentLeft:0,viewHeight:n,viewWidth:this.width_-2*this.SCROLLBAR_PADDING,viewTop:-this.workspace_.scrollY,viewLeft:-this.workspace_.scrollX,absoluteTop:t,absoluteLeft:o}},E.HorizontalFlyout.prototype.setMetrics_=function(t){var e=this.getMetrics_();e&&("number"==typeof t.x&&(this.workspace_.scrollX=-e.contentWidth*t.x),this.workspace_.translate(this.workspace_.scrollX+e.absoluteLeft,this.workspace_.scrollY+e.absoluteTop))},E.HorizontalFlyout.prototype.position=function(){if(this.isVisible()){var t=this.targetWorkspace.getMetrics();t&&(this.width_=t.viewWidth,this.setBackgroundPath_(t.viewWidth-2*this.CORNER_RADIUS,this.height_-this.CORNER_RADIUS),this.positionAt_(this.width_,this.height_,0,this.targetWorkspace.toolboxPosition==this.toolboxPosition_?t.toolboxHeight?this.toolboxPosition_==E.TOOLBOX_AT_TOP?t.toolboxHeight:t.viewHeight-this.height_:this.toolboxPosition_==E.TOOLBOX_AT_TOP?0:t.viewHeight:this.toolboxPosition_==E.TOOLBOX_AT_TOP?0:t.viewHeight+t.absoluteTop-this.height_))}},E.HorizontalFlyout.prototype.setBackgroundPath_=function(t,e){var o=this.toolboxPosition_==E.TOOLBOX_AT_TOP,n=["M 0,"+(o?0:this.CORNER_RADIUS)];o?(n.push("h",t+2*this.CORNER_RADIUS),n.push("v",e),n.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,this.CORNER_RADIUS),n.push("h",-t),n.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,-this.CORNER_RADIUS)):(n.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,-this.CORNER_RADIUS),n.push("h",t),n.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,this.CORNER_RADIUS),n.push("v",e),n.push("h",-t-2*this.CORNER_RADIUS)),n.push("z"),this.svgBackground_.setAttribute("d",n.join(" "))},E.HorizontalFlyout.prototype.scrollToStart=function(){this.scrollbar.set(this.RTL?1/0:0)},E.HorizontalFlyout.prototype.wheel_=function(t){var e=E.utils.getScrollDeltaPixels(t),o=e.x||e.y;o&&(o=(e=this.getMetrics_()).viewLeft+o,o=Math.min(o,e.contentWidth-e.viewWidth),o=Math.max(o,0),this.scrollbar.set(o),E.WidgetDiv.hide(),E.DropDownDiv.hideWithoutAnimation()),t.preventDefault(),t.stopPropagation()},E.HorizontalFlyout.prototype.layout_=function(t,e){this.workspace_.scale=this.targetWorkspace.scale;var o=this.MARGIN,n=o+this.tabWidth_;this.RTL&&(t=t.reverse());for(var i,r=0;i=t[r];r++)if("block"==i.type){for(var s,a=(i=i.block).getDescendants(!1),l=0;s=a[l];l++)s.isInFlyout=!0;i.render(),a=i.getSvgRoot(),l=i.getHeightWidth(),s=i.outputConnection?this.tabWidth_:0,s=this.RTL?n+l.width:n-s,i.moveBy(s,o),s=this.createRect_(i,s,o,l,r),n+=l.width+e[r],this.addBlockListeners_(a,i,s)}else"button"==i.type&&(this.initFlyoutButton_(i.button,n,o),n+=i.button.width+e[r])},E.HorizontalFlyout.prototype.isDragTowardWorkspace=function(t){t=Math.atan2(t.y,t.x)/Math.PI*180;var e=this.dragAngleRange_;return t<90+e&&90-e<t||-90-e<t&&t<-90+e},E.HorizontalFlyout.prototype.getClientRect=function(){if(!this.svgGroup_)return null;var t=this.svgGroup_.getBoundingClientRect(),e=t.top;return this.toolboxPosition_==E.TOOLBOX_AT_TOP?new E.utils.Rect(-1e9,e+t.height,-1e9,1e9):new E.utils.Rect(e,1e9,-1e9,1e9)},E.HorizontalFlyout.prototype.reflowInternal_=function(){this.workspace_.scale=this.targetWorkspace.scale;for(var t,e=0,o=this.workspace_.getTopBlocks(!1),n=0;t=o[n];n++)e=Math.max(e,t.getHeightWidth().height);if(e+=1.5*this.MARGIN,e*=this.workspace_.scale,e+=E.Scrollbar.scrollbarThickness,this.height_!=e){for(n=0;t=o[n];n++)t.flyoutRect_&&this.moveRectToBlock_(t.flyoutRect_,t);this.targetWorkspace.toolboxPosition!=this.toolboxPosition_||this.toolboxPosition_!=E.TOOLBOX_AT_TOP||this.targetWorkspace.getToolbox()||this.targetWorkspace.translate(0,this.targetWorkspace.scrollY+e),this.height_=e,this.position()}},E.registry.register(E.registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX,E.registry.DEFAULT,E.HorizontalFlyout),E.VerticalFlyout=function(t){E.VerticalFlyout.superClass_.constructor.call(this,t)},E.utils.object.inherits(E.VerticalFlyout,E.Flyout),E.VerticalFlyout.registryName="verticalFlyout",E.VerticalFlyout.prototype.getMetrics_=function(){if(!this.isVisible())return null;try{var e=this.workspace_.getCanvas().getBBox()}catch(t){e={height:0,y:0,width:0,x:0}}var t=this.SCROLLBAR_PADDING,o=this.height_-2*this.SCROLLBAR_PADDING,n=this.width_;return this.RTL||(n-=this.SCROLLBAR_PADDING),{contentHeight:e.height*this.workspace_.scale+2*this.MARGIN,contentWidth:e.width*this.workspace_.scale+2*this.MARGIN,contentTop:e.y,contentLeft:e.x,viewHeight:o,viewWidth:n,viewTop:-this.workspace_.scrollY+e.y,viewLeft:-this.workspace_.scrollX,absoluteTop:t,absoluteLeft:0}},E.VerticalFlyout.prototype.setMetrics_=function(t){var e=this.getMetrics_();e&&("number"==typeof t.y&&(this.workspace_.scrollY=-e.contentHeight*t.y),this.workspace_.translate(this.workspace_.scrollX+e.absoluteLeft,this.workspace_.scrollY+e.absoluteTop))},E.VerticalFlyout.prototype.position=function(){if(this.isVisible()){var t=this.targetWorkspace.getMetrics();t&&(this.height_=t.viewHeight,this.setBackgroundPath_(this.width_-this.CORNER_RADIUS,t.viewHeight-2*this.CORNER_RADIUS),this.positionAt_(this.width_,this.height_,this.targetWorkspace.toolboxPosition==this.toolboxPosition_?t.toolboxWidth?this.toolboxPosition_==E.TOOLBOX_AT_LEFT?t.toolboxWidth:t.viewWidth-this.width_:this.toolboxPosition_==E.TOOLBOX_AT_LEFT?0:t.viewWidth:this.toolboxPosition_==E.TOOLBOX_AT_LEFT?0:t.viewWidth+t.absoluteLeft-this.width_,0))}},E.VerticalFlyout.prototype.setBackgroundPath_=function(t,e){var o=this.toolboxPosition_==E.TOOLBOX_AT_RIGHT,n=t+this.CORNER_RADIUS;(n=["M "+(o?n:0)+",0"]).push("h",o?-t:t),n.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,o?0:1,o?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS),n.push("v",Math.max(0,e)),n.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,o?0:1,o?this.CORNER_RADIUS:-this.CORNER_RADIUS,this.CORNER_RADIUS),n.push("h",o?t:-t),n.push("z"),this.svgBackground_.setAttribute("d",n.join(" "))},E.VerticalFlyout.prototype.scrollToStart=function(){this.scrollbar.set(0)},E.VerticalFlyout.prototype.wheel_=function(t){var e=E.utils.getScrollDeltaPixels(t);if(e.y){var o=this.getMetrics_();e=o.viewTop-o.contentTop+e.y,e=Math.min(e,o.contentHeight-o.viewHeight),e=Math.max(e,0),this.scrollbar.set(e),E.WidgetDiv.hide(),E.DropDownDiv.hideWithoutAnimation()}t.preventDefault(),t.stopPropagation()},E.VerticalFlyout.prototype.layout_=function(t,e){this.workspace_.scale=this.targetWorkspace.scale;for(var o,n=this.MARGIN,i=this.RTL?n:n+this.tabWidth_,r=0;o=t[r];r++)if("block"==o.type){for(var s,a=(o=o.block).getDescendants(!1),l=0;s=a[l];l++)s.isInFlyout=!0;o.render(),a=o.getSvgRoot(),l=o.getHeightWidth(),s=o.outputConnection?i-this.tabWidth_:i,o.moveBy(s,n),s=this.createRect_(o,this.RTL?s-l.width:s,n,l,r),this.addBlockListeners_(a,o,s),n+=l.height+e[r]}else"button"==o.type&&(this.initFlyoutButton_(o.button,i,n),n+=o.button.height+e[r])},E.VerticalFlyout.prototype.isDragTowardWorkspace=function(t){t=Math.atan2(t.y,t.x)/Math.PI*180;var e=this.dragAngleRange_;return t<e&&-e<t||t<-180+e||180-e<t},E.VerticalFlyout.prototype.getClientRect=function(){if(!this.svgGroup_)return null;var t=this.svgGroup_.getBoundingClientRect(),e=t.left;return this.toolboxPosition_==E.TOOLBOX_AT_LEFT?new E.utils.Rect(-1e9,1e9,-1e9,e+t.width):new E.utils.Rect(-1e9,1e9,e,1e9)},E.VerticalFlyout.prototype.reflowInternal_=function(){this.workspace_.scale=this.targetWorkspace.scale;for(var t,e=0,o=this.workspace_.getTopBlocks(!1),n=0;t=o[n];n++){var i=t.getHeightWidth().width;t.outputConnection&&(i-=this.tabWidth_),e=Math.max(e,i)}for(n=0;t=this.buttons_[n];n++)e=Math.max(e,t.width);if(e+=1.5*this.MARGIN+this.tabWidth_,e*=this.workspace_.scale,e+=E.Scrollbar.scrollbarThickness,this.width_!=e){for(n=0;t=o[n];n++){if(this.RTL){i=t.getRelativeToSurfaceXY().x;var r=e/this.workspace_.scale-this.MARGIN;t.outputConnection||(r-=this.tabWidth_),t.moveBy(r-i,0)}t.flyoutRect_&&this.moveRectToBlock_(t.flyoutRect_,t)}if(this.RTL)for(n=0;t=this.buttons_[n];n++)o=t.getPosition().y,t.moveTo(e/this.workspace_.scale-t.width-this.MARGIN-this.tabWidth_,o);this.targetWorkspace.toolboxPosition!=this.toolboxPosition_||this.toolboxPosition_!=E.TOOLBOX_AT_LEFT||this.targetWorkspace.getToolbox()||this.targetWorkspace.translate(this.targetWorkspace.scrollX+e,0),this.width_=e,this.position()}},E.registry.register(E.registry.Type.FLYOUTS_VERTICAL_TOOLBOX,E.registry.DEFAULT,E.VerticalFlyout),E.FlyoutButton=function(t,e,o,n){this.workspace_=t,this.targetWorkspace_=e,this.text_=o.text,this.position_=new E.utils.Coordinate(0,0),this.isLabel_=n,this.callbackKey_=o.callbackKey||o.callbackkey,this.cssClass_=o["web-class"]||null,this.onMouseUpWrapper_=null,this.info=o},E.FlyoutButton.MARGIN_X=5,E.FlyoutButton.MARGIN_Y=2,E.FlyoutButton.prototype.width=0,E.FlyoutButton.prototype.height=0,E.FlyoutButton.prototype.createDom=function(){var t=this.isLabel_?"blocklyFlyoutLabel":"blocklyFlyoutButton";if(this.cssClass_&&(t+=" "+this.cssClass_),this.svgGroup_=E.utils.dom.createSvgElement(E.utils.Svg.G,{class:t},this.workspace_.getCanvas()),!this.isLabel_)var e=E.utils.dom.createSvgElement(E.utils.Svg.RECT,{class:"blocklyFlyoutButtonShadow",rx:4,ry:4,x:1,y:1},this.svgGroup_);t=E.utils.dom.createSvgElement(E.utils.Svg.RECT,{class:this.isLabel_?"blocklyFlyoutLabelBackground":"blocklyFlyoutButtonBackground",rx:4,ry:4},this.svgGroup_);var o=E.utils.dom.createSvgElement(E.utils.Svg.TEXT,{class:this.isLabel_?"blocklyFlyoutLabelText":"blocklyText",x:0,y:0,"text-anchor":"middle"},this.svgGroup_),n=E.utils.replaceMessageReferences(this.text_);this.workspace_.RTL&&(n+=""),o.textContent=n,this.isLabel_&&(this.svgText_=o,this.workspace_.getThemeManager().subscribe(this.svgText_,"flyoutForegroundColour","fill"));var i=E.utils.style.getComputedStyle(o,"fontSize"),r=E.utils.style.getComputedStyle(o,"fontWeight"),s=E.utils.style.getComputedStyle(o,"fontFamily");return this.width=E.utils.dom.getFastTextWidthWithSizeString(o,i,r,s),n=E.utils.dom.measureFontMetrics(n,i,r,s),this.height=n.height,this.isLabel_||(this.width+=2*E.FlyoutButton.MARGIN_X,this.height+=2*E.FlyoutButton.MARGIN_Y,e.setAttribute("width",this.width),e.setAttribute("height",this.height)),t.setAttribute("width",this.width),t.setAttribute("height",this.height),o.setAttribute("x",this.width/2),o.setAttribute("y",this.height/2-n.height/2+n.baseline),this.updateTransform_(),this.onMouseUpWrapper_=E.bindEventWithChecks_(this.svgGroup_,"mouseup",this,this.onMouseUp_),this.svgGroup_},E.FlyoutButton.prototype.show=function(){this.updateTransform_(),this.svgGroup_.setAttribute("display","block")},E.FlyoutButton.prototype.updateTransform_=function(){this.svgGroup_.setAttribute("transform","translate("+this.position_.x+","+this.position_.y+")")},E.FlyoutButton.prototype.moveTo=function(t,e){this.position_.x=t,this.position_.y=e,this.updateTransform_()},E.FlyoutButton.prototype.isLabel=function(){return this.isLabel_},E.FlyoutButton.prototype.getPosition=function(){return this.position_},E.FlyoutButton.prototype.getButtonText=function(){return this.text_},E.FlyoutButton.prototype.getTargetWorkspace=function(){return this.targetWorkspace_},E.FlyoutButton.prototype.dispose=function(){this.onMouseUpWrapper_&&E.unbindEvent_(this.onMouseUpWrapper_),this.svgGroup_&&E.utils.dom.removeNode(this.svgGroup_),this.svgText_&&this.workspace_.getThemeManager().unsubscribe(this.svgText_)},E.FlyoutButton.prototype.onMouseUp_=function(t){(t=this.targetWorkspace_.getGesture(t))&&t.cancel(),this.isLabel_&&this.callbackKey_?console.warn("Labels should not have callbacks. Label text: "+this.text_):this.isLabel_||this.callbackKey_&&this.targetWorkspace_.getButtonCallback(this.callbackKey_)?this.isLabel_||this.targetWorkspace_.getButtonCallback(this.callbackKey_)(this):console.warn("Buttons should have callbacks. Button text: "+this.text_)},E.Css.register(".blocklyFlyoutButton {,fill: #888;,cursor: default;,},.blocklyFlyoutButtonShadow {,fill: #666;,},.blocklyFlyoutButton:hover {,fill: #aaa;,},.blocklyFlyoutLabel {,cursor: default;,},.blocklyFlyoutLabelBackground {,opacity: 0;,}".split(",")),E.Generator=function(t){this.name_=t,this.FUNCTION_NAME_PLACEHOLDER_REGEXP_=new RegExp(this.FUNCTION_NAME_PLACEHOLDER_,"g")},E.Generator.NAME_TYPE="generated_function",E.Generator.prototype.INFINITE_LOOP_TRAP=null,E.Generator.prototype.STATEMENT_PREFIX=null,E.Generator.prototype.STATEMENT_SUFFIX=null,E.Generator.prototype.INDENT="  ",E.Generator.prototype.COMMENT_WRAP=60,E.Generator.prototype.ORDER_OVERRIDES=[],E.Generator.prototype.workspaceToCode=function(t){t||(console.warn("No workspace specified in workspaceToCode call.  Guessing."),t=E.getMainWorkspace());var e=[];this.init(t),t=t.getTopBlocks(!0);for(var o,n=0;o=t[n];n++){var i=this.blockToCode(o);Array.isArray(i)&&(i=i[0]),i&&(o.outputConnection&&(i=this.scrubNakedValue(i),this.STATEMENT_PREFIX&&!o.suppressPrefixSuffix&&(i=this.injectId(this.STATEMENT_PREFIX,o)+i),this.STATEMENT_SUFFIX&&!o.suppressPrefixSuffix&&(i+=this.injectId(this.STATEMENT_SUFFIX,o))),e.push(i))}return e=e.join("\n"),(e=(e=(e=this.finish(e)).replace(/^\s+\n/,"")).replace(/\n\s+$/,"\n")).replace(/[ \t]+\n/g,"\n")},E.Generator.prototype.prefixLines=function(t,e){return e+t.replace(/(?!\n$)\n/g,"\n"+e)},E.Generator.prototype.allNestedComments=function(t){var e=[];t=t.getDescendants(!0);for(var o=0;o<t.length;o++){var n=t[o].getCommentText();n&&e.push(n)}return e.length&&e.push(""),e.join("\n")},E.Generator.prototype.blockToCode=function(t,e){if(!t)return"";if(!t.isEnabled())return e?"":this.blockToCode(t.getNextBlock());if(t.isInsertionMarker())return e?"":this.blockToCode(t.getChildren(!1)[0]);var o=this[t.type];if("function"!=typeof o)throw Error('Language "'+this.name_+'" does not know how to generate  code for block type "'+t.type+'".');if(o=o.call(t,t),Array.isArray(o)){if(!t.outputConnection)throw TypeError("Expecting string from statement block: "+t.type);return[this.scrub_(t,o[0],e),o[1]]}if("string"==typeof o)return this.STATEMENT_PREFIX&&!t.suppressPrefixSuffix&&(o=this.injectId(this.STATEMENT_PREFIX,t)+o),this.STATEMENT_SUFFIX&&!t.suppressPrefixSuffix&&(o+=this.injectId(this.STATEMENT_SUFFIX,t)),this.scrub_(t,o,e);if(null===o)return"";throw SyntaxError("Invalid code generated: "+o)},E.Generator.prototype.valueToCode=function(t,e,o){if(isNaN(o))throw TypeError("Expecting valid order from block: "+t.type);var n=t.getInputTargetBlock(e);if(!n)return"";if(""===(e=this.blockToCode(n)))return"";if(!Array.isArray(e))throw TypeError("Expecting tuple from value block: "+n.type);if(t=e[0],e=e[1],isNaN(e))throw TypeError("Expecting valid order from value block: "+n.type);if(!t)return"";n=!1;var i=Math.floor(o),r=Math.floor(e);if(i<=r&&(i!=r||0!=i&&99!=i))for(n=!0,i=0;i<this.ORDER_OVERRIDES.length;i++)if(this.ORDER_OVERRIDES[i][0]==o&&this.ORDER_OVERRIDES[i][1]==e){n=!1;break}return n&&(t="("+t+")"),t},E.Generator.prototype.statementToCode=function(t,e){if(t=t.getInputTargetBlock(e),"string"!=typeof(e=this.blockToCode(t)))throw TypeError("Expecting code from statement block: "+(t&&t.type));return e&&(e=this.prefixLines(e,this.INDENT)),e},E.Generator.prototype.addLoopTrap=function(t,e){return this.INFINITE_LOOP_TRAP&&(t=this.prefixLines(this.injectId(this.INFINITE_LOOP_TRAP,e),this.INDENT)+t),this.STATEMENT_SUFFIX&&!e.suppressPrefixSuffix&&(t=this.prefixLines(this.injectId(this.STATEMENT_SUFFIX,e),this.INDENT)+t),this.STATEMENT_PREFIX&&!e.suppressPrefixSuffix&&(t+=this.prefixLines(this.injectId(this.STATEMENT_PREFIX,e),this.INDENT)),t},E.Generator.prototype.injectId=function(t,e){return e=e.id.replace(/\$/g,"$$$$"),t.replace(/%1/g,"'"+e+"'")},E.Generator.prototype.RESERVED_WORDS_="",E.Generator.prototype.addReservedWords=function(t){this.RESERVED_WORDS_+=t+","},E.Generator.prototype.FUNCTION_NAME_PLACEHOLDER_="{leCUI8hutHZI4480Dc}",E.Generator.prototype.provideFunction_=function(t,e){if(!this.definitions_[t]){var o,n=this.variableDB_.getDistinctName(t,E.PROCEDURE_CATEGORY_NAME);for(this.functionNames_[t]=n,e=e.join("\n").replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_,n);o!=e;)e=(o=e).replace(/^(( {2})*) {2}/gm,"$1\0");e=e.replace(/\0/g,this.INDENT),this.definitions_[t]=e}return this.functionNames_[t]},E.Generator.prototype.init=function(t){},E.Generator.prototype.scrub_=function(t,e,o){return e},E.Generator.prototype.finish=function(t){return t},E.Generator.prototype.scrubNakedValue=function(t){return t},E.ToolboxItem=function(t,e,o){this.id_=t.toolboxitemid||E.utils.IdGenerator.getNextUniqueId(),this.level_=(this.parent_=o||null)?this.parent_.getLevel()+1:0,this.toolboxItemDef_=t,this.parentToolbox_=e,this.workspace_=this.parentToolbox_.getWorkspace()},E.ToolboxItem.prototype.init=function(){},E.ToolboxItem.prototype.getDiv=function(){return null},E.ToolboxItem.prototype.getId=function(){return this.id_},E.ToolboxItem.prototype.getParent=function(){return null},E.ToolboxItem.prototype.getLevel=function(){return this.level_},E.ToolboxItem.prototype.isSelectable=function(){return!1},E.ToolboxItem.prototype.isCollapsible=function(){return!1},E.ToolboxItem.prototype.dispose=function(){},E.ToolboxCategory=function(t,e,o){E.ToolboxCategory.superClass_.constructor.call(this,t,e,o),this.name_=E.utils.replaceMessageReferences(t.name),this.colour_=this.getColour_(t),this.iconDom_=this.rowContents_=this.rowDiv_=this.htmlDiv_=null,this.cssConfig_=this.makeDefaultCssConfig_(),E.utils.object.mixin(this.cssConfig_,t.cssconfig||t.cssConfig),this.isDisabled_=this.isHidden_=!1,this.flyoutItems_=[],this.parseContents_(t)},E.utils.object.inherits(E.ToolboxCategory,E.ToolboxItem),E.ToolboxCategory.registrationName="category",E.ToolboxCategory.nestedPadding=19,E.ToolboxCategory.borderWidth=8,E.ToolboxCategory.defaultBackgroundColour="#57e",E.ToolboxCategory.prototype.makeDefaultCssConfig_=function(){return{container:"blocklyToolboxCategory",row:"blocklyTreeRow",rowcontentcontainer:"blocklyTreeRowContentContainer",icon:"blocklyTreeIcon",label:"blocklyTreeLabel",contents:"blocklyToolboxContents",selected:"blocklyTreeSelected",openicon:"blocklyTreeIconOpen",closedicon:"blocklyTreeIconClosed"}},E.ToolboxCategory.prototype.parseContents_=function(t){var e=t.contents;if(t.custom)this.flyoutItems_=t.custom;else if(e){t=0;for(var o;o=e[t];t++)this.flyoutItems_.push(o)}},E.ToolboxCategory.prototype.init=function(){this.createDom_(),"true"==this.toolboxItemDef_.hidden&&this.hide()},E.ToolboxCategory.prototype.createDom_=function(){this.htmlDiv_=this.createContainer_(),E.utils.aria.setRole(this.htmlDiv_,E.utils.aria.Role.TREEITEM),E.utils.aria.setState(this.htmlDiv_,E.utils.aria.State.SELECTED,!1),E.utils.aria.setState(this.htmlDiv_,E.utils.aria.State.LEVEL,this.level_),this.rowDiv_=this.createRowContainer_(),this.rowDiv_.setAttribute("id",this.id_),this.rowDiv_.style.pointerEvents="auto",this.htmlDiv_.appendChild(this.rowDiv_),this.rowContents_=this.createRowContentsContainer_(),this.rowContents_.style.pointerEvents="none",this.rowDiv_.appendChild(this.rowContents_),this.iconDom_=this.createIconDom_(),E.utils.aria.setRole(this.iconDom_,E.utils.aria.Role.PRESENTATION),this.rowContents_.appendChild(this.iconDom_);var t=this.createLabelDom_(this.name_);return this.rowContents_.appendChild(t),E.utils.aria.setState(this.htmlDiv_,E.utils.aria.State.LABELLEDBY,t.getAttribute("id")),this.addColourBorder_(this.colour_),this.htmlDiv_},E.ToolboxCategory.prototype.createContainer_=function(){var t=document.createElement("div");return E.utils.dom.addClass(t,this.cssConfig_.container),t},E.ToolboxCategory.prototype.createRowContainer_=function(){var t=document.createElement("div");E.utils.dom.addClass(t,this.cssConfig_.row);var e=E.ToolboxCategory.nestedPadding*this.getLevel();return e=e.toString()+"px",this.workspace_.RTL?t.style.paddingRight=e:t.style.paddingLeft=e,t},E.ToolboxCategory.prototype.createRowContentsContainer_=function(){var t=document.createElement("div");return E.utils.dom.addClass(t,this.cssConfig_.rowcontentcontainer),t},E.ToolboxCategory.prototype.createIconDom_=function(){var t=document.createElement("span");return this.parentToolbox_.isHorizontal()||E.utils.dom.addClass(t,this.cssConfig_.icon),t.style.display="inline-block",t},E.ToolboxCategory.prototype.createLabelDom_=function(t){var e=document.createElement("span");return e.setAttribute("id",this.getId()+".label"),e.textContent=t,E.utils.dom.addClass(e,this.cssConfig_.label),e},E.ToolboxCategory.prototype.refreshTheme=function(){this.colour_=this.getColour_(this.toolboxItemDef_),this.addColourBorder_(this.colour_)},E.ToolboxCategory.prototype.addColourBorder_=function(t){t&&(t=E.ToolboxCategory.borderWidth+"px solid "+(t||"#ddd"),this.workspace_.RTL?this.rowDiv_.style.borderRight=t:this.rowDiv_.style.borderLeft=t)},E.ToolboxCategory.prototype.getColour_=function(t){var e=t.categorystyle||t.categoryStyle;return(t=t.colour)&&e?(console.warn('Toolbox category "'+this.name_+'" must not have both a style and a colour'),""):e?this.getColourfromStyle_(e):this.parseColour_(t)},E.ToolboxCategory.prototype.getColourfromStyle_=function(t){var e=this.workspace_.getTheme();if(t&&e){if((e=e.categoryStyles[t])&&e.colour)return this.parseColour_(e.colour);console.warn('Style "'+t+'" must exist and contain a colour value')}return""},E.ToolboxCategory.prototype.parseColour_=function(t){if(null==(t=E.utils.replaceMessageReferences(t))||""===t)return"";var e=Number(t);return isNaN(e)?(e=E.utils.colour.parse(t))?e:(console.warn('Toolbox category "'+this.name_+'" has unrecognized colour attribute: '+t),""):E.hueToHex(e)},E.ToolboxCategory.prototype.openIcon_=function(t){t&&(E.utils.dom.removeClasses(t,this.cssConfig_.closedicon),E.utils.dom.addClass(t,this.cssConfig_.openicon))},E.ToolboxCategory.prototype.closeIcon_=function(t){t&&(E.utils.dom.removeClasses(t,this.cssConfig_.openicon),E.utils.dom.addClass(t,this.cssConfig_.closedicon))},E.ToolboxCategory.prototype.setVisible_=function(t){this.htmlDiv_.style.display=t?"block":"none",this.isHidden_=!t,this.parentToolbox_.getSelectedItem()==this&&this.parentToolbox_.clearSelection()},E.ToolboxCategory.prototype.hide=function(){this.setVisible_(!1)},E.ToolboxCategory.prototype.show=function(){this.setVisible_(!0)},E.ToolboxCategory.prototype.isVisible=function(){return!this.isHidden_&&this.allAncestorsExpanded_()},E.ToolboxCategory.prototype.allAncestorsExpanded_=function(){for(var t=this;t.getParent();)if(!(t=t.getParent()).isExpanded())return!1;return!0},E.ToolboxCategory.prototype.isSelectable=function(){return this.isVisible()&&!this.isDisabled_},E.ToolboxCategory.prototype.onClick=function(t){},E.ToolboxCategory.prototype.setSelected=function(t){if(t){var e=this.parseColour_(E.ToolboxCategory.defaultBackgroundColour);this.rowDiv_.style.backgroundColor=this.colour_||e,E.utils.dom.addClass(this.rowDiv_,this.cssConfig_.selected)}else this.rowDiv_.style.backgroundColor="",E.utils.dom.removeClass(this.rowDiv_,this.cssConfig_.selected);E.utils.aria.setState(this.htmlDiv_,E.utils.aria.State.SELECTED,t)},E.ToolboxCategory.prototype.setDisabled=function(t){this.isDisabled_=t,this.getDiv().setAttribute("disabled",t),t?this.getDiv().setAttribute("disabled","true"):this.getDiv().removeAttribute("disabled")},E.ToolboxCategory.prototype.getName=function(){return this.name_},E.ToolboxCategory.prototype.getParent=function(){return this.parent_},E.ToolboxCategory.prototype.getDiv=function(){return this.htmlDiv_},E.ToolboxCategory.prototype.getContents=function(){return this.flyoutItems_},E.ToolboxCategory.prototype.updateFlyoutContents=function(t){this.flyoutItems_=[],"string"==typeof t?this.toolboxItemDef_.custom=t:(delete this.toolboxItemDef_.custom,this.toolboxItemDef_.contents=E.utils.toolbox.convertFlyoutDefToJsonArray(t)),this.parseContents_(this.toolboxItemDef_)},E.ToolboxCategory.prototype.dispose=function(){E.utils.dom.removeNode(this.htmlDiv_)},E.Css.register([".blocklyTreeRow:not(.blocklyTreeSelected):hover {","background-color: rgba(255, 255, 255, 0.2);","}",'.blocklyToolboxDiv[layout="h"] .blocklyToolboxCategory {',"margin: 1px 5px 1px 0;","}",'.blocklyToolboxDiv[dir="RTL"][layout="h"] .blocklyToolboxCategory {',"margin: 1px 0 1px 5px;","}",".blocklyTreeRow {","height: 22px;","line-height: 22px;","margin-bottom: 3px;","padding-right: 8px;","white-space: nowrap;","}",'.blocklyToolboxDiv[dir="RTL"] .blocklyTreeRow {',"margin-left: 8px;","padding-right: 0px","}",".blocklyTreeIcon {","background-image: url(<<<PATH>>>/sprites.png);","height: 16px;","vertical-align: middle;","visibility: hidden;","width: 16px;","}",".blocklyTreeIconClosed {","background-position: -32px -1px;","}",'.blocklyToolboxDiv[dir="RTL"] .blocklyTreeIconClosed {',"background-position: 0 -1px;","}",".blocklyTreeSelected>.blocklyTreeIconClosed {","background-position: -32px -17px;","}",'.blocklyToolboxDiv[dir="RTL"] .blocklyTreeSelected>.blocklyTreeIconClosed {',"background-position: 0 -17px;","}",".blocklyTreeIconOpen {","background-position: -16px -1px;","}",".blocklyTreeSelected>.blocklyTreeIconOpen {","background-position: -16px -17px;","}",".blocklyTreeLabel {","cursor: default;","font: 16px sans-serif;","padding: 0 3px;","vertical-align: middle;","}",".blocklyToolboxDelete .blocklyTreeLabel {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyTreeSelected .blocklyTreeLabel {","color: #fff;","}"]),E.registry.register(E.registry.Type.TOOLBOX_ITEM,E.ToolboxCategory.registrationName,E.ToolboxCategory),E.ToolboxSeparator=function(t,e){E.ToolboxSeparator.superClass_.constructor.call(this,t,e),this.cssConfig_={container:"blocklyTreeSeparator"},E.utils.object.mixin(this.cssConfig_,t.cssconfig||t.cssConfig)},E.utils.object.inherits(E.ToolboxSeparator,E.ToolboxItem),E.ToolboxSeparator.registrationName="sep",E.ToolboxSeparator.prototype.init=function(){this.createDom_()},E.ToolboxSeparator.prototype.createDom_=function(){var t=document.createElement("div");return E.utils.dom.addClass(t,this.cssConfig_.container),this.htmlDiv_=t},E.ToolboxSeparator.prototype.getDiv=function(){return this.htmlDiv_},E.ToolboxSeparator.prototype.dispose=function(){E.utils.dom.removeNode(this.htmlDiv_)},E.Css.register('.blocklyTreeSeparator {,border-bottom: solid #e5e5e5 1px;,height: 0;,margin: 5px 0;,},.blocklyToolboxDiv[layout="h"] .blocklyTreeSeparator {,border-right: solid #e5e5e5 1px;,border-bottom: none;,height: auto;,margin: 0 5px 0 5px;,padding: 5px 0;,width: 0;,}'.split(",")),E.registry.register(E.registry.Type.TOOLBOX_ITEM,E.ToolboxSeparator.registrationName,E.ToolboxSeparator),E.CollapsibleToolboxCategory=function(t,e,o){this.subcategoriesDiv_=null,this.expanded_=!1,this.toolboxItems_=[],E.CollapsibleToolboxCategory.superClass_.constructor.call(this,t,e,o)},E.utils.object.inherits(E.CollapsibleToolboxCategory,E.ToolboxCategory),E.CollapsibleToolboxCategory.registrationName="collapsibleCategory",E.CollapsibleToolboxCategory.prototype.makeDefaultCssConfig_=function(){var t=E.CollapsibleToolboxCategory.superClass_.makeDefaultCssConfig_.call(this);return t.contents="blocklyToolboxContents",t},E.CollapsibleToolboxCategory.prototype.parseContents_=function(t){var e=t.contents,o=!0;if(t.custom)this.flyoutItems_=t.custom;else if(e){t=0;for(var n;n=e[t];t++)o=!E.registry.hasItem(E.registry.Type.TOOLBOX_ITEM,n.kind)||n.kind.toLowerCase()==E.ToolboxSeparator.registrationName&&o?(this.flyoutItems_.push(n),!0):(this.createToolboxItem_(n),!1)}},E.CollapsibleToolboxCategory.prototype.createToolboxItem_=function(t){var e=t.kind;"CATEGORY"==e.toUpperCase()&&E.utils.toolbox.isCategoryCollapsible(t)&&(e=E.CollapsibleToolboxCategory.registrationName),t=new(E.registry.getClass(E.registry.Type.TOOLBOX_ITEM,e))(t,this.parentToolbox_,this),this.toolboxItems_.push(t)},E.CollapsibleToolboxCategory.prototype.init=function(){E.CollapsibleToolboxCategory.superClass_.init.call(this),this.setExpanded("true"==this.toolboxItemDef_.expanded||this.toolboxItemDef_.expanded)},E.CollapsibleToolboxCategory.prototype.createDom_=function(){E.CollapsibleToolboxCategory.superClass_.createDom_.call(this);var t=this.getChildToolboxItems();return this.subcategoriesDiv_=this.createSubCategoriesDom_(t),E.utils.aria.setRole(this.subcategoriesDiv_,E.utils.aria.Role.GROUP),this.htmlDiv_.appendChild(this.subcategoriesDiv_),this.htmlDiv_},E.CollapsibleToolboxCategory.prototype.createIconDom_=function(){var t=document.createElement("span");return this.parentToolbox_.isHorizontal()||(E.utils.dom.addClass(t,this.cssConfig_.icon),t.style.visibility="visible"),t.style.display="inline-block",t},E.CollapsibleToolboxCategory.prototype.createSubCategoriesDom_=function(t){var e=document.createElement("div");E.utils.dom.addClass(e,this.cssConfig_.contents);for(var o=0;o<t.length;o++){var n=t[o];n.init(),n=n.getDiv(),e.appendChild(n)}return e},E.CollapsibleToolboxCategory.prototype.setExpanded=function(t){this.expanded_!=t&&((this.expanded_=t)?(this.subcategoriesDiv_.style.display="block",this.openIcon_(this.iconDom_)):(this.subcategoriesDiv_.style.display="none",this.closeIcon_(this.iconDom_)),E.utils.aria.setState(this.htmlDiv_,E.utils.aria.State.EXPANDED,t),this.parentToolbox_.handleToolboxItemResize())},E.CollapsibleToolboxCategory.prototype.setVisible_=function(t){this.htmlDiv_.style.display=t?"block":"none";for(var e,o=0;e=this.getChildToolboxItems()[o];o++)e.setVisible_(t);this.isHidden_=!t,this.parentToolbox_.getSelectedItem()==this&&this.parentToolbox_.clearSelection()},E.CollapsibleToolboxCategory.prototype.isExpanded=function(){return this.expanded_},E.CollapsibleToolboxCategory.prototype.isCollapsible=function(){return!0},E.CollapsibleToolboxCategory.prototype.onClick=function(t){this.toggleExpanded()},E.CollapsibleToolboxCategory.prototype.toggleExpanded=function(){this.setExpanded(!this.expanded_)},E.CollapsibleToolboxCategory.prototype.getDiv=function(){return this.htmlDiv_},E.CollapsibleToolboxCategory.prototype.getChildToolboxItems=function(){return this.toolboxItems_},E.registry.register(E.registry.Type.TOOLBOX_ITEM,E.CollapsibleToolboxCategory.registrationName,E.CollapsibleToolboxCategory),E.Toolbox=function(t){this.workspace_=t,this.toolboxDef_=t.options.languageTree||{contents:[]},this.horizontalLayout_=t.options.horizontalLayout,this.contentsDiv_=this.HtmlDiv=null,this.contents_=[],this.height_=this.width_=0,this.RTL=t.options.RTL,this.flyout_=null,this.contentMap_={},this.toolboxPosition=t.options.toolboxPosition,this.previouslySelectedItem_=this.selectedItem_=null,this.boundEvents_=[]},E.Toolbox.prototype.init=function(){var t=this.workspace_,e=t.getParentSvg();this.flyout_=this.createFlyout_(),this.HtmlDiv=this.createDom_(this.workspace_),E.utils.dom.insertAfter(this.flyout_.createDom("svg"),e),this.flyout_.init(t),this.render(this.toolboxDef_),(t=t.getThemeManager()).subscribe(this.HtmlDiv,"toolboxBackgroundColour","background-color"),t.subscribe(this.HtmlDiv,"toolboxForegroundColour","color")},E.Toolbox.prototype.createDom_=function(t){t=t.getParentSvg();var e=this.createContainer_();return this.contentsDiv_=this.createContentsContainer_(),this.contentsDiv_.tabIndex=0,E.utils.aria.setRole(this.contentsDiv_,E.utils.aria.Role.TREE),e.appendChild(this.contentsDiv_),t.parentNode.insertBefore(e,t),this.attachEvents_(e,this.contentsDiv_),e},E.Toolbox.prototype.createContainer_=function(){var t=document.createElement("div");return t.setAttribute("layout",this.isHorizontal()?"h":"v"),E.utils.dom.addClass(t,"blocklyToolboxDiv"),E.utils.dom.addClass(t,"blocklyNonSelectable"),t.setAttribute("dir",this.RTL?"RTL":"LTR"),t},E.Toolbox.prototype.createContentsContainer_=function(){var t=document.createElement("div");return E.utils.dom.addClass(t,"blocklyToolboxContents"),this.isHorizontal()&&(t.style.flexDirection="row"),t},E.Toolbox.prototype.attachEvents_=function(t,e){t=E.bindEventWithChecks_(t,"mousedown",this,this.onClick_,!1,!0),this.boundEvents_.push(t),e=E.bindEventWithChecks_(e,"keydown",this,this.onKeyDown_,!1,!0),this.boundEvents_.push(e)},E.Toolbox.prototype.onClick_=function(t){if(E.utils.isRightButton(t)||t.target==this.HtmlDiv)E.hideChaff(!1);else{var e=t.srcElement.getAttribute("id");e&&(e=this.getToolboxItemById(e)).isSelectable()&&(this.setSelectedItem(e),e.onClick(t)),E.hideChaff(!0)}E.Touch.clearTouchIdentifier()},E.Toolbox.prototype.onKeyDown_=function(t){var e=!1;switch(t.keyCode){case E.utils.KeyCodes.DOWN:e=this.selectNext_();break;case E.utils.KeyCodes.UP:e=this.selectPrevious_();break;case E.utils.KeyCodes.LEFT:e=this.selectParent_();break;case E.utils.KeyCodes.RIGHT:e=this.selectChild_();break;case E.utils.KeyCodes.ENTER:case E.utils.KeyCodes.SPACE:this.selectedItem_&&this.selectedItem_.isCollapsible()&&(this.selectedItem_.toggleExpanded(),e=!0);break;default:e=!1}e&&t.preventDefault()},E.Toolbox.prototype.createFlyout_=function(){var t=this.workspace_,e=new E.Options({parentWorkspace:t,rtl:t.RTL,oneBasedIndex:t.options.oneBasedIndex,horizontalLayout:t.horizontalLayout,renderer:t.options.renderer,rendererOverrides:t.options.rendererOverrides});if(e.toolboxPosition=t.options.toolboxPosition,!(t=t.horizontalLayout?E.registry.getClassFromOptions(E.registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX,t.options):E.registry.getClassFromOptions(E.registry.Type.FLYOUTS_VERTICAL_TOOLBOX,t.options)))throw Error("Blockly.VerticalFlyout, Blockly.HorizontalFlyout or your own custom flyout must be required.");return new t(e)},E.Toolbox.prototype.render=function(t){this.toolboxDef_=t;for(var e=0;e<this.contents_.length;e++){var o=this.contents_[e];o&&o.dispose()}this.contents_=[],this.contentMap_={},this.renderContents_(t.contents),this.position()},E.Toolbox.prototype.renderContents_=function(t){for(var e,o=document.createDocumentFragment(),n=0;e=t[n];n++)this.createToolboxItem_(e,o);this.contentsDiv_.appendChild(o)},E.Toolbox.prototype.createToolboxItem_=function(t,e){var o=t.kind;"CATEGORY"==o.toUpperCase()&&E.utils.toolbox.isCategoryCollapsible(t)&&(o=E.CollapsibleToolboxCategory.registrationName),(o=E.registry.getClass(E.registry.Type.TOOLBOX_ITEM,o.toLowerCase()))&&(t=new o(t,this),this.addToolboxItem_(t),t.init(),(t=t.getDiv())&&e.appendChild(t))},E.Toolbox.prototype.addToolboxItem_=function(t){if(this.contents_.push(t),(this.contentMap_[t.getId()]=t).isCollapsible())for(var e,o=0;e=t.getChildToolboxItems()[o];o++)this.addToolboxItem_(e)},E.Toolbox.prototype.getToolboxItems=function(){return this.contents_},E.Toolbox.prototype.addStyle=function(t){E.utils.dom.addClass(this.HtmlDiv,t)},E.Toolbox.prototype.removeStyle=function(t){E.utils.dom.removeClass(this.HtmlDiv,t)},E.Toolbox.prototype.getClientRect=function(){if(!this.HtmlDiv)return null;var t=this.HtmlDiv.getBoundingClientRect(),e=t.top,o=e+t.height,n=t.left;return t=n+t.width,this.toolboxPosition==E.utils.toolbox.Position.TOP?new E.utils.Rect(-1e7,o,-1e7,1e7):this.toolboxPosition==E.utils.toolbox.Position.BOTTOM?new E.utils.Rect(e,1e7,-1e7,1e7):this.toolboxPosition==E.utils.toolbox.Position.LEFT?new E.utils.Rect(-1e7,1e7,-1e7,t):new E.utils.Rect(-1e7,1e7,n,1e7)},E.Toolbox.prototype.getToolboxItemById=function(t){return this.contentMap_[t]},E.Toolbox.prototype.getWidth=function(){return this.width_},E.Toolbox.prototype.getHeight=function(){return this.height_},E.Toolbox.prototype.getFlyout=function(){return this.flyout_},E.Toolbox.prototype.getWorkspace=function(){return this.workspace_},E.Toolbox.prototype.getSelectedItem=function(){return this.selectedItem_},E.Toolbox.prototype.getPreviouslySelectedItem=function(){return this.previouslySelectedItem_},E.Toolbox.prototype.isHorizontal=function(){return this.horizontalLayout_},E.Toolbox.prototype.position=function(){var t=this.HtmlDiv;t&&(this.horizontalLayout_?(t.style.left="0",t.style.height="auto",t.style.width="100%",this.height_=t.offsetHeight,this.toolboxPosition==E.TOOLBOX_AT_TOP?t.style.top="0":t.style.bottom="0"):(this.toolboxPosition==E.TOOLBOX_AT_RIGHT?t.style.right="0":t.style.left="0",t.style.height="100%",this.width_=t.offsetWidth),this.flyout_.position())},E.Toolbox.prototype.handleToolboxItemResize=function(){var t=this.workspace_,e=this.HtmlDiv.getBoundingClientRect();t.translate(this.toolboxPosition==E.TOOLBOX_AT_LEFT?t.scrollX+e.width:t.scrollX,this.toolboxPosition==E.TOOLBOX_AT_TOP?t.scrollY+e.height:t.scrollY),E.svgResize(t)},E.Toolbox.prototype.clearSelection=function(){this.setSelectedItem(null)},E.Toolbox.prototype.refreshTheme=function(){for(var t=0;t<this.contents_.length;t++){var e=this.contents_[t];e.refreshTheme&&e.refreshTheme()}},E.Toolbox.prototype.refreshSelection=function(){this.selectedItem_&&this.selectedItem_.isSelectable()&&this.selectedItem_.getContents().length&&this.flyout_.show(this.selectedItem_.getContents())},E.Toolbox.prototype.setVisible=function(t){this.HtmlDiv.style.display=t?"block":"none"},E.Toolbox.prototype.setSelectedItem=function(t){var e=this.selectedItem_;!t&&!e||t&&!t.isSelectable()||(this.shouldDeselectItem_(e,t)&&null!=e&&this.deselectItem_(e),this.shouldSelectItem_(e,t)&&null!=t&&this.selectItem_(e,t),this.updateFlyout_(e,t),this.fireSelectEvent_(e,t))},E.Toolbox.prototype.shouldDeselectItem_=function(t,e){return null!=t&&(!t.isCollapsible()||t!=e)},E.Toolbox.prototype.shouldSelectItem_=function(t,e){return null!=e&&e!=t},E.Toolbox.prototype.deselectItem_=function(t){this.selectedItem_=null,(this.previouslySelectedItem_=t).setSelected(!1),E.utils.aria.setState(this.contentsDiv_,E.utils.aria.State.ACTIVEDESCENDANT,"")},E.Toolbox.prototype.selectItem_=function(t,e){this.selectedItem_=e,this.previouslySelectedItem_=t,e.setSelected(!0),E.utils.aria.setState(this.contentsDiv_,E.utils.aria.State.ACTIVEDESCENDANT,e.getId())},E.Toolbox.prototype.selectItemByPosition=function(t){-1<t&&t<this.contents_.length&&(t=this.contents_[t]).isSelectable()&&this.setSelectedItem(t)},E.Toolbox.prototype.updateFlyout_=function(t,e){(t!=e||e.isCollapsible())&&e&&e.getContents().length?(this.flyout_.show(e.getContents()),this.flyout_.scrollToStart()):this.flyout_.hide()},E.Toolbox.prototype.fireSelectEvent_=function(t,e){var o=t&&t.getName(),n=e&&e.getName();t==e&&(n=null),(t=new E.Events.Ui(null,"category",o,n)).workspaceId=this.workspace_.id,E.Events.fire(t)},E.Toolbox.prototype.onBlocklyAction=function(t){if(!this.selectedItem_)return!1;switch(t.name){case E.navigation.actionNames.PREVIOUS:return this.selectPrevious_();case E.navigation.actionNames.OUT:return this.selectParent_();case E.navigation.actionNames.NEXT:return this.selectNext_();case E.navigation.actionNames.IN:return this.selectChild_();default:return!1}},E.Toolbox.prototype.selectParent_=function(){return!(!this.selectedItem_||(this.selectedItem_.isCollapsible()&&this.selectedItem_.isExpanded()?(this.selectedItem_.setExpanded(!1),0):!this.selectedItem_.getParent()||!this.selectedItem_.getParent().isSelectable()||(this.setSelectedItem(this.selectedItem_.getParent()),0)))},E.Toolbox.prototype.selectChild_=function(){if(!this.selectedItem_||!this.selectedItem_.isCollapsible())return!1;var t=this.selectedItem_;return t.isExpanded()?this.selectNext_():t.setExpanded(!0),!0},E.Toolbox.prototype.selectNext_=function(){if(!this.selectedItem_)return!1;var t=this.contents_.indexOf(this.selectedItem_)+1;if(-1<t&&t<this.contents_.length){for(var e=this.contents_[t];e&&!e.isSelectable();)e=this.contents_[++t];if(e&&e.isSelectable())return this.setSelectedItem(e),!0}return!1},E.Toolbox.prototype.selectPrevious_=function(){if(!this.selectedItem_)return!1;var t=this.contents_.indexOf(this.selectedItem_)-1;if(-1<t&&t<this.contents_.length){for(var e=this.contents_[t];e&&!e.isSelectable();)e=this.contents_[--t];if(e&&e.isSelectable())return this.setSelectedItem(e),!0}return!1},E.Toolbox.prototype.dispose=function(){this.flyout_.dispose();for(var t=0;t<this.contents_.length;t++)this.contents_[t].dispose();for(t=0;t<this.boundEvents_.length;t++)E.unbindEvent_(this.boundEvents_[t]);this.boundEvents_=[],this.contents_=[],this.workspace_.getThemeManager().unsubscribe(this.HtmlDiv),E.utils.dom.removeNode(this.HtmlDiv)},E.Css.register([".blocklyToolboxDelete {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyToolboxGrab {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyToolboxDiv {","background-color: #ddd;","overflow-x: visible;","overflow-y: auto;","padding: 4px 0 4px 0;","position: absolute;","z-index: 70;","-webkit-tap-highlight-color: transparent;","}",".blocklyToolboxContents {","display: flex;","flex-wrap: wrap;","flex-direction: column;","}",".blocklyToolboxContents:focus {","outline: none;","}"]),E.registry.register(E.registry.Type.TOOLBOX,E.registry.DEFAULT,E.Toolbox),E.Trashcan=function(t){if(this.workspace_=t,this.contents_=[],this.flyout=null,!(this.workspace_.options.maxTrashcanContents<=0)){if(t=new E.Options({scrollbars:!0,parentWorkspace:this.workspace_,rtl:this.workspace_.RTL,oneBasedIndex:this.workspace_.options.oneBasedIndex,renderer:this.workspace_.options.renderer,rendererOverrides:this.workspace_.options.rendererOverrides}),this.workspace_.horizontalLayout){if(t.toolboxPosition=this.workspace_.toolboxPosition==E.utils.toolbox.Position.TOP?E.utils.toolbox.Position.BOTTOM:E.utils.toolbox.Position.TOP,!E.HorizontalFlyout)throw Error("Missing require for Blockly.HorizontalFlyout");this.flyout=new E.HorizontalFlyout(t)}else{if(t.toolboxPosition=this.workspace_.toolboxPosition==E.utils.toolbox.Position.RIGHT?E.utils.toolbox.Position.LEFT:E.utils.toolbox.Position.RIGHT,!E.VerticalFlyout)throw Error("Missing require for Blockly.VerticalFlyout");this.flyout=new E.VerticalFlyout(t)}this.workspace_.addChangeListener(this.onDelete_.bind(this))}},E.Trashcan.prototype.WIDTH_=47,E.Trashcan.prototype.BODY_HEIGHT_=44,E.Trashcan.prototype.LID_HEIGHT_=16,E.Trashcan.prototype.MARGIN_BOTTOM_=20,E.Trashcan.prototype.MARGIN_SIDE_=20,E.Trashcan.prototype.MARGIN_HOTSPOT_=10,E.Trashcan.prototype.SPRITE_LEFT_=0,E.Trashcan.prototype.SPRITE_TOP_=32,E.Trashcan.prototype.HAS_BLOCKS_LID_ANGLE_=.1,E.Trashcan.ANIMATION_LENGTH_=80,E.Trashcan.ANIMATION_FRAMES_=4,E.Trashcan.OPACITY_MIN_=.4,E.Trashcan.OPACITY_MAX_=.8,E.Trashcan.MAX_LID_ANGLE_=45,E.Trashcan.prototype.isLidOpen=!1,E.Trashcan.prototype.minOpenness_=0,E.Trashcan.prototype.svgGroup_=null,E.Trashcan.prototype.svgLid_=null,E.Trashcan.prototype.lidTask_=0,E.Trashcan.prototype.lidOpen_=0,E.Trashcan.prototype.left_=0,E.Trashcan.prototype.top_=0,E.Trashcan.prototype.createDom=function(){this.svgGroup_=E.utils.dom.createSvgElement(E.utils.Svg.G,{class:"blocklyTrash"},null);var t=String(Math.random()).substring(2),e=E.utils.dom.createSvgElement(E.utils.Svg.CLIPPATH,{id:"blocklyTrashBodyClipPath"+t},this.svgGroup_);E.utils.dom.createSvgElement(E.utils.Svg.RECT,{width:this.WIDTH_,height:this.BODY_HEIGHT_,y:this.LID_HEIGHT_},e);var o=E.utils.dom.createSvgElement(E.utils.Svg.IMAGE,{width:E.SPRITE.width,x:-this.SPRITE_LEFT_,height:E.SPRITE.height,y:-this.SPRITE_TOP_,"clip-path":"url(#blocklyTrashBodyClipPath"+t+")"},this.svgGroup_);return o.setAttributeNS(E.utils.dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+E.SPRITE.url),e=E.utils.dom.createSvgElement(E.utils.Svg.CLIPPATH,{id:"blocklyTrashLidClipPath"+t},this.svgGroup_),E.utils.dom.createSvgElement(E.utils.Svg.RECT,{width:this.WIDTH_,height:this.LID_HEIGHT_},e),this.svgLid_=E.utils.dom.createSvgElement(E.utils.Svg.IMAGE,{width:E.SPRITE.width,x:-this.SPRITE_LEFT_,height:E.SPRITE.height,y:-this.SPRITE_TOP_,"clip-path":"url(#blocklyTrashLidClipPath"+t+")"},this.svgGroup_),this.svgLid_.setAttributeNS(E.utils.dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+E.SPRITE.url),E.bindEventWithChecks_(this.svgGroup_,"mouseup",this,this.click),E.bindEvent_(o,"mouseover",this,this.mouseOver_),E.bindEvent_(o,"mouseout",this,this.mouseOut_),this.animateLid_(),this.svgGroup_},E.Trashcan.prototype.init=function(t){return 0<this.workspace_.options.maxTrashcanContents&&(E.utils.dom.insertAfter(this.flyout.createDom(E.utils.Svg.SVG),this.workspace_.getParentSvg()),this.flyout.init(this.workspace_)),this.verticalSpacing_=this.MARGIN_BOTTOM_+t,this.setLidOpen(!1),this.verticalSpacing_+this.BODY_HEIGHT_+this.LID_HEIGHT_},E.Trashcan.prototype.dispose=function(){this.svgGroup_&&(E.utils.dom.removeNode(this.svgGroup_),this.svgGroup_=null),this.workspace_=this.svgLid_=null,clearTimeout(this.lidTask_)},E.Trashcan.prototype.hasContents_=function(){return!!this.contents_.length},E.Trashcan.prototype.contentsIsOpen=function(){return this.flyout.isVisible()},E.Trashcan.prototype.openFlyout=function(){if(!this.contentsIsOpen()){for(var t,e=[],o=0;t=this.contents_[o];o++)e[o]=E.Xml.textToDom(t);this.flyout.show(e),this.fireUiEvent_(!0)}},E.Trashcan.prototype.closeFlyout=function(){this.contentsIsOpen()&&(this.flyout.hide(),this.fireUiEvent_(!1))},E.Trashcan.prototype.emptyContents=function(){this.hasContents_()&&(this.contents_.length=0,this.setMinOpenness_(0),this.closeFlyout())},E.Trashcan.prototype.position=function(){if(this.verticalSpacing_){var t=this.workspace_.getMetrics();t&&(this.left_=t.toolboxPosition==E.TOOLBOX_AT_LEFT||this.workspace_.horizontalLayout&&!this.workspace_.RTL?t.viewWidth+t.absoluteLeft-this.WIDTH_-this.MARGIN_SIDE_-E.Scrollbar.scrollbarThickness:this.MARGIN_SIDE_+E.Scrollbar.scrollbarThickness,this.top_=t.toolboxPosition==E.TOOLBOX_AT_BOTTOM?this.verticalSpacing_:t.viewHeight+t.absoluteTop-(this.BODY_HEIGHT_+this.LID_HEIGHT_)-this.verticalSpacing_,this.svgGroup_.setAttribute("transform","translate("+this.left_+","+this.top_+")"))}},E.Trashcan.prototype.getClientRect=function(){if(!this.svgGroup_)return null;var t=this.svgGroup_.getBoundingClientRect(),e=t.top+this.SPRITE_TOP_-this.MARGIN_HOTSPOT_;return t=t.left+this.SPRITE_LEFT_-this.MARGIN_HOTSPOT_,new E.utils.Rect(e,e+this.LID_HEIGHT_+this.BODY_HEIGHT_+2*this.MARGIN_HOTSPOT_,t,t+this.WIDTH_+2*this.MARGIN_HOTSPOT_)},E.Trashcan.prototype.setLidOpen=function(t){this.isLidOpen!=t&&(clearTimeout(this.lidTask_),this.isLidOpen=t,this.animateLid_())},E.Trashcan.prototype.animateLid_=function(){var t=E.Trashcan.ANIMATION_FRAMES_,e=1/(t+1);this.lidOpen_+=this.isLidOpen?e:-e,this.lidOpen_=Math.min(Math.max(this.lidOpen_,this.minOpenness_),1),this.setLidAngle_(this.lidOpen_*E.Trashcan.MAX_LID_ANGLE_),e=E.Trashcan.OPACITY_MIN_,this.svgGroup_.style.opacity=e+this.lidOpen_*(E.Trashcan.OPACITY_MAX_-e),this.lidOpen_>this.minOpenness_&&this.lidOpen_<1&&(this.lidTask_=setTimeout(this.animateLid_.bind(this),E.Trashcan.ANIMATION_LENGTH_/t))},E.Trashcan.prototype.setLidAngle_=function(t){var e=this.workspace_.toolboxPosition==E.TOOLBOX_AT_RIGHT||this.workspace_.horizontalLayout&&this.workspace_.RTL;this.svgLid_.setAttribute("transform","rotate("+(e?-t:t)+","+(e?4:this.WIDTH_-4)+","+(this.LID_HEIGHT_-2)+")")},E.Trashcan.prototype.setMinOpenness_=function(t){this.minOpenness_=t,this.isLidOpen||this.setLidAngle_(t*E.Trashcan.MAX_LID_ANGLE_)},E.Trashcan.prototype.closeLid=function(){this.setLidOpen(!1)},E.Trashcan.prototype.click=function(){this.hasContents_()&&this.openFlyout()},E.Trashcan.prototype.fireUiEvent_=function(t){(t=new E.Events.Ui(null,"trashcanOpen",null,t)).workspaceId=this.workspace_.id,E.Events.fire(t)},E.Trashcan.prototype.mouseOver_=function(){this.hasContents_()&&this.setLidOpen(!0)},E.Trashcan.prototype.mouseOut_=function(){this.setLidOpen(!1)},E.Trashcan.prototype.onDelete_=function(t){if(!(this.workspace_.options.maxTrashcanContents<=0)&&t.type==E.Events.BLOCK_DELETE&&t.oldXml.tagName&&"shadow"!=t.oldXml.tagName.toLowerCase()&&(t=this.cleanBlockXML_(t.oldXml),-1==this.contents_.indexOf(t))){for(this.contents_.unshift(t);this.contents_.length>this.workspace_.options.maxTrashcanContents;)this.contents_.pop();this.setMinOpenness_(this.HAS_BLOCKS_LID_ANGLE_)}},E.Trashcan.prototype.cleanBlockXML_=function(t){for(var e=t=t.cloneNode(!0);e;){e.removeAttribute&&(e.removeAttribute("x"),e.removeAttribute("y"),e.removeAttribute("id"),e.removeAttribute("disabled"),"comment"==e.nodeName&&(e.removeAttribute("h"),e.removeAttribute("w"),e.removeAttribute("pinned")));var o=e.firstChild||e.nextSibling;if(!o)for(o=e.parentNode;o;){if(o.nextSibling){o=o.nextSibling;break}o=o.parentNode}e=o}return E.Xml.domToText(t)},E.VariablesDynamic={},E.VariablesDynamic.onCreateVariableButtonClick_String=function(t){E.Variables.createVariableButtonHandler(t.getTargetWorkspace(),void 0,"String")},E.VariablesDynamic.onCreateVariableButtonClick_Number=function(t){E.Variables.createVariableButtonHandler(t.getTargetWorkspace(),void 0,"Number")},E.VariablesDynamic.onCreateVariableButtonClick_Colour=function(t){E.Variables.createVariableButtonHandler(t.getTargetWorkspace(),void 0,"Colour")},E.VariablesDynamic.flyoutCategory=function(t){var e=[],o=document.createElement("button");return o.setAttribute("text",E.Msg.NEW_STRING_VARIABLE),o.setAttribute("callbackKey","CREATE_VARIABLE_STRING"),e.push(o),(o=document.createElement("button")).setAttribute("text",E.Msg.NEW_NUMBER_VARIABLE),o.setAttribute("callbackKey","CREATE_VARIABLE_NUMBER"),e.push(o),(o=document.createElement("button")).setAttribute("text",E.Msg.NEW_COLOUR_VARIABLE),o.setAttribute("callbackKey","CREATE_VARIABLE_COLOUR"),e.push(o),t.registerButtonCallback("CREATE_VARIABLE_STRING",E.VariablesDynamic.onCreateVariableButtonClick_String),t.registerButtonCallback("CREATE_VARIABLE_NUMBER",E.VariablesDynamic.onCreateVariableButtonClick_Number),t.registerButtonCallback("CREATE_VARIABLE_COLOUR",E.VariablesDynamic.onCreateVariableButtonClick_Colour),t=E.VariablesDynamic.flyoutCategoryBlocks(t),e.concat(t)},E.VariablesDynamic.flyoutCategoryBlocks=function(t){var e=[];if(0<(t=t.getAllVariables()).length){if(E.Blocks.variables_set_dynamic){var o=t[t.length-1],n=E.utils.xml.createElement("block");n.setAttribute("type","variables_set_dynamic"),n.setAttribute("gap",24),n.appendChild(E.Variables.generateVariableFieldDom(o)),e.push(n)}if(E.Blocks.variables_get_dynamic){t.sort(E.VariableModel.compareByName),o=0;for(var i;i=t[o];o++)(n=E.utils.xml.createElement("block")).setAttribute("type","variables_get_dynamic"),n.setAttribute("gap",8),n.appendChild(E.Variables.generateVariableFieldDom(i)),e.push(n)}}return e},E.ZoomControls=function(t){this.workspace_=t,this.zoomResetGroup_=this.zoomOutGroup_=this.zoomInGroup_=this.verticalSpacing_=this.onZoomOutWrapper_=this.onZoomInWrapper_=this.onZoomResetWrapper_=null},E.ZoomControls.prototype.WIDTH_=32,E.ZoomControls.prototype.HEIGHT_=110,E.ZoomControls.prototype.MARGIN_BOTTOM_=20,E.ZoomControls.prototype.MARGIN_SIDE_=20,E.ZoomControls.prototype.svgGroup_=null,E.ZoomControls.prototype.left_=0,E.ZoomControls.prototype.top_=0,E.ZoomControls.prototype.createDom=function(){this.svgGroup_=E.utils.dom.createSvgElement(E.utils.Svg.G,{},null);var t=String(Math.random()).substring(2);return this.createZoomOutSvg_(t),this.createZoomInSvg_(t),this.workspace_.isMovable()&&this.createZoomResetSvg_(t),this.svgGroup_},E.ZoomControls.prototype.init=function(t){return this.verticalSpacing_=this.MARGIN_BOTTOM_+t,this.verticalSpacing_+this.HEIGHT_},E.ZoomControls.prototype.dispose=function(){this.svgGroup_&&E.utils.dom.removeNode(this.svgGroup_),this.onZoomResetWrapper_&&E.unbindEvent_(this.onZoomResetWrapper_),this.onZoomInWrapper_&&E.unbindEvent_(this.onZoomInWrapper_),this.onZoomOutWrapper_&&E.unbindEvent_(this.onZoomOutWrapper_)},E.ZoomControls.prototype.position=function(){if(this.verticalSpacing_){var t=this.workspace_.getMetrics();t&&(this.left_=t.toolboxPosition==E.TOOLBOX_AT_LEFT||this.workspace_.horizontalLayout&&!this.workspace_.RTL?t.viewWidth+t.absoluteLeft-this.WIDTH_-this.MARGIN_SIDE_-E.Scrollbar.scrollbarThickness:this.MARGIN_SIDE_+E.Scrollbar.scrollbarThickness,t.toolboxPosition==E.TOOLBOX_AT_BOTTOM?(this.top_=this.verticalSpacing_,this.zoomInGroup_.setAttribute("transform","translate(0, 34)"),this.zoomResetGroup_&&this.zoomResetGroup_.setAttribute("transform","translate(0, 77)")):(this.top_=t.viewHeight+t.absoluteTop-this.HEIGHT_-this.verticalSpacing_,this.zoomInGroup_.setAttribute("transform","translate(0, 43)"),this.zoomOutGroup_.setAttribute("transform","translate(0, 77)")),this.svgGroup_.setAttribute("transform","translate("+this.left_+","+this.top_+")"))}},E.ZoomControls.prototype.createZoomOutSvg_=function(t){this.zoomOutGroup_=E.utils.dom.createSvgElement(E.utils.Svg.G,{class:"blocklyZoom"},this.svgGroup_);var e=E.utils.dom.createSvgElement(E.utils.Svg.CLIPPATH,{id:"blocklyZoomoutClipPath"+t},this.zoomOutGroup_);E.utils.dom.createSvgElement(E.utils.Svg.RECT,{width:32,height:32},e),E.utils.dom.createSvgElement(E.utils.Svg.IMAGE,{width:E.SPRITE.width,height:E.SPRITE.height,x:-64,y:-92,"clip-path":"url(#blocklyZoomoutClipPath"+t+")"},this.zoomOutGroup_).setAttributeNS(E.utils.dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+E.SPRITE.url),this.onZoomOutWrapper_=E.bindEventWithChecks_(this.zoomOutGroup_,"mousedown",null,this.zoom_.bind(this,-1))},E.ZoomControls.prototype.createZoomInSvg_=function(t){this.zoomInGroup_=E.utils.dom.createSvgElement(E.utils.Svg.G,{class:"blocklyZoom"},this.svgGroup_);var e=E.utils.dom.createSvgElement(E.utils.Svg.CLIPPATH,{id:"blocklyZoominClipPath"+t},this.zoomInGroup_);E.utils.dom.createSvgElement(E.utils.Svg.RECT,{width:32,height:32},e),E.utils.dom.createSvgElement(E.utils.Svg.IMAGE,{width:E.SPRITE.width,height:E.SPRITE.height,x:-32,y:-92,"clip-path":"url(#blocklyZoominClipPath"+t+")"},this.zoomInGroup_).setAttributeNS(E.utils.dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+E.SPRITE.url),this.onZoomInWrapper_=E.bindEventWithChecks_(this.zoomInGroup_,"mousedown",null,this.zoom_.bind(this,1))},E.ZoomControls.prototype.zoom_=function(t,e){this.workspace_.markFocused();var o=this.workspace_.scale;this.workspace_.zoomCenter(t),this.fireZoomEvent_(o),E.Touch.clearTouchIdentifier(),e.stopPropagation(),e.preventDefault()},E.ZoomControls.prototype.createZoomResetSvg_=function(t){this.zoomResetGroup_=E.utils.dom.createSvgElement(E.utils.Svg.G,{class:"blocklyZoom"},this.svgGroup_);var e=E.utils.dom.createSvgElement(E.utils.Svg.CLIPPATH,{id:"blocklyZoomresetClipPath"+t},this.zoomResetGroup_);E.utils.dom.createSvgElement(E.utils.Svg.RECT,{width:32,height:32},e),E.utils.dom.createSvgElement(E.utils.Svg.IMAGE,{width:E.SPRITE.width,height:E.SPRITE.height,y:-92,"clip-path":"url(#blocklyZoomresetClipPath"+t+")"},this.zoomResetGroup_).setAttributeNS(E.utils.dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+E.SPRITE.url),this.onZoomResetWrapper_=E.bindEventWithChecks_(this.zoomResetGroup_,"mousedown",null,this.resetZoom_.bind(this))},E.ZoomControls.prototype.resetZoom_=function(t){this.workspace_.markFocused();var e=this.workspace_.scale;this.workspace_.setScale(this.workspace_.options.zoomOptions.startScale),this.workspace_.beginCanvasTransition(),this.workspace_.scrollCenter(),setTimeout(this.workspace_.endCanvasTransition.bind(this.workspace_),500),this.fireZoomEvent_(e),E.Touch.clearTouchIdentifier(),t.stopPropagation(),t.preventDefault()},E.ZoomControls.prototype.fireZoomEvent_=function(t){(t=new E.Events.Ui(null,"zoom",t,this.workspace_.scale)).workspaceId=this.workspace_.id,E.Events.fire(t)},E.Css.register([".blocklyZoom>image, .blocklyZoom>svg>image {","opacity: .4;","}",".blocklyZoom>image:hover, .blocklyZoom>svg>image:hover {","opacity: .6;","}",".blocklyZoom>image:active, .blocklyZoom>svg>image:active {","opacity: .8;","}"]),E.Mutator=function(t){E.Mutator.superClass_.constructor.call(this,null),this.quarkNames_=t},E.utils.object.inherits(E.Mutator,E.Icon),E.Mutator.prototype.workspaceWidth_=0,E.Mutator.prototype.workspaceHeight_=0,E.Mutator.prototype.setBlock=function(t){this.block_=t},E.Mutator.prototype.getWorkspace=function(){return this.workspace_},E.Mutator.prototype.drawIcon_=function(t){E.utils.dom.createSvgElement(E.utils.Svg.RECT,{class:"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},t),E.utils.dom.createSvgElement(E.utils.Svg.PATH,{class:"blocklyIconSymbol",d:"m4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 -0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z"},t),E.utils.dom.createSvgElement(E.utils.Svg.CIRCLE,{class:"blocklyIconShape",r:"2.7",cx:"8",cy:"8"},t)},E.Mutator.prototype.iconClick_=function(t){this.block_.isEditable()&&E.Icon.prototype.iconClick_.call(this,t)},E.Mutator.prototype.createEditor_=function(){if(this.svgDialog_=E.utils.dom.createSvgElement(E.utils.Svg.SVG,{x:E.Bubble.BORDER_WIDTH,y:E.Bubble.BORDER_WIDTH},null),this.quarkNames_.length)for(var t,e=E.utils.xml.createElement("xml"),o=0;t=this.quarkNames_[o];o++){var n=E.utils.xml.createElement("block");n.setAttribute("type",t),e.appendChild(n)}else e=null;return(o=new E.Options({disable:!1,parentWorkspace:this.block_.workspace,media:this.block_.workspace.options.pathToMedia,rtl:this.block_.RTL,horizontalLayout:!1,renderer:this.block_.workspace.options.renderer,rendererOverrides:this.block_.workspace.options.rendererOverrides})).toolboxPosition=this.block_.RTL?E.utils.toolbox.Position.RIGHT:E.utils.toolbox.Position.LEFT,(t=!!e)&&(o.languageTree=E.utils.toolbox.convertToolboxDefToJson(e),o.getMetrics=this.getFlyoutMetrics_.bind(this)),this.workspace_=new E.WorkspaceSvg(o),this.workspace_.isMutator=!0,this.workspace_.addChangeListener(E.Events.disableOrphans),e=t?this.workspace_.addFlyout(E.utils.Svg.G):null,o=this.workspace_.createDom("blocklyMutatorBackground"),e&&o.insertBefore(e,this.workspace_.svgBlockCanvas_),this.svgDialog_.appendChild(o),this.svgDialog_},E.Mutator.prototype.updateEditable=function(){E.Mutator.superClass_.updateEditable.call(this),this.block_.isInFlyout||(this.block_.isEditable()?this.iconGroup_&&E.utils.dom.removeClass(this.iconGroup_,"blocklyIconGroupReadonly"):(this.setVisible(!1),this.iconGroup_&&E.utils.dom.addClass(this.iconGroup_,"blocklyIconGroupReadonly")))},E.Mutator.prototype.resizeBubble_=function(){var t=2*E.Bubble.BORDER_WIDTH,e=this.workspace_.getCanvas().getBBox(),o=e.width+e.x,n=e.height+3*t,i=this.workspace_.getFlyout();if(i){var r=i.getMetrics_();n=Math.max(n,r.contentHeight+20),o+=i.getWidth()}this.block_.RTL&&(o=-e.x),o+=3*t,(Math.abs(this.workspaceWidth_-o)>t||Math.abs(this.workspaceHeight_-n)>t)&&(this.workspaceWidth_=o,this.workspaceHeight_=n,this.bubble_.setBubbleSize(o+t,n+t),this.svgDialog_.setAttribute("width",this.workspaceWidth_),this.svgDialog_.setAttribute("height",this.workspaceHeight_)),this.block_.RTL&&(t="translate("+this.workspaceWidth_+",0)",this.workspace_.getCanvas().setAttribute("transform",t)),this.workspace_.resize()},E.Mutator.prototype.onBubbleMove_=function(){this.workspace_&&this.workspace_.recordDeleteAreas()},E.Mutator.prototype.setVisible=function(t){if(t!=this.isVisible())if(E.Events.fire(new E.Events.Ui(this.block_,"mutatorOpen",!t,t)),t){this.bubble_=new E.Bubble(this.block_.workspace,this.createEditor_(),this.block_.pathObject.svgPath,this.iconXY_,null,null),this.bubble_.setSvgId(this.block_.id),this.bubble_.registerMoveEvent(this.onBubbleMove_.bind(this));var e=this.workspace_.options.languageTree;t=this.workspace_.getFlyout(),e&&(t.init(this.workspace_),t.show(e)),this.rootBlock_=this.block_.decompose(this.workspace_),e=this.rootBlock_.getDescendants(!1);for(var o,n=0;o=e[n];n++)o.render();if(this.rootBlock_.setMovable(!1),this.rootBlock_.setDeletable(!1),t=t?(e=2*t.CORNER_RADIUS,this.rootBlock_.RTL?t.getWidth()+e:e):e=16,this.block_.RTL&&(t=-t),this.rootBlock_.moveBy(t,e),this.block_.saveConnections){var i=this,r=this.block_;r.saveConnections(this.rootBlock_),this.sourceListener_=function(){r.saveConnections(i.rootBlock_)},this.block_.workspace.addChangeListener(this.sourceListener_)}this.resizeBubble_(),this.workspace_.addChangeListener(this.workspaceChanged_.bind(this)),this.applyColour()}else this.svgDialog_=null,this.workspace_.dispose(),this.rootBlock_=this.workspace_=null,this.bubble_.dispose(),this.bubble_=null,this.workspaceHeight_=this.workspaceWidth_=0,this.sourceListener_&&(this.block_.workspace.removeChangeListener(this.sourceListener_),this.sourceListener_=null)},E.Mutator.prototype.workspaceChanged_=function(t){if(t.type!=E.Events.UI&&(t.type!=E.Events.CHANGE||"disabled"!=t.element)){if(!this.workspace_.isDragging())for(var e=this.workspace_.getTopBlocks(!1),o=0;t=e[o];o++){var n=t.getRelativeToSurfaceXY();if(n.y<20&&t.moveBy(0,20-n.y),t.RTL){var i=-20,r=this.workspace_.getFlyout();r&&(i-=r.getWidth()),n.x>i&&t.moveBy(i-n.x,0)}else n.x<20&&t.moveBy(20-n.x,0)}this.rootBlock_.workspace==this.workspace_&&(E.Events.setGroup(!0),e=(e=(t=this.block_).mutationToDom())&&E.Xml.domToText(e),o=t.rendered,t.rendered=!1,t.compose(this.rootBlock_),t.rendered=o,t.initSvg(),E.getMainWorkspace().keyboardAccessibilityMode&&E.navigation.moveCursorOnBlockMutation(t),t.rendered&&t.render(),e!=(o=(o=t.mutationToDom())&&E.Xml.domToText(o))&&E.Events.fire(new E.Events.BlockChange(t,"mutation",null,e,o)),this.workspace_.isDragging()||this.resizeBubble_(),E.Events.setGroup(!1))}},E.Mutator.prototype.getFlyoutMetrics_=function(){var t=this.workspace_.getFlyout();return t=t?t.getWidth():0,{contentHeight:0,contentWidth:0,contentTop:0,contentLeft:0,viewHeight:this.workspaceHeight_,viewWidth:this.workspaceWidth_-t,viewTop:0,viewLeft:0,absoluteTop:0,absoluteLeft:this.workspace_.RTL?0:t}},E.Mutator.prototype.dispose=function(){this.block_.mutator=null,E.Icon.prototype.dispose.call(this)},E.Mutator.prototype.updateBlockStyle=function(){var t=this.workspace_;if(t&&t.getAllBlocks(!1)){for(var e=t.getAllBlocks(!1),o=0;o<e.length;o++){var n=e[o];n.setStyle(n.getStyleName())}if(o=t.getFlyout())for(t=o.workspace_.getAllBlocks(!1),o=0;o<t.length;o++)(n=t[o]).setStyle(n.getStyleName())}},E.Mutator.reconnect=function(t,e,o){if(!t||!t.getSourceBlock().workspace)return!1;o=e.getInput(o).connection;var n=t.targetBlock();return!(n&&n!=e||o.targetConnection==t||(o.isConnected()&&o.disconnect(),o.connect(t),0))},E.Mutator.findParentWs=function(t){var e=null;if(t&&t.options){var o=t.options.parentWorkspace;t.isFlyout?o&&o.options&&(e=o.options.parentWorkspace):o&&(e=o)}return e},E.FieldTextInput=function(t,e,o){this.spellcheck_=!0,E.FieldTextInput.superClass_.constructor.call(this,t,e,o),this.onKeyInputWrapper_=this.onKeyDownWrapper_=this.htmlInput_=null,this.fullBlockClickTarget_=!1,this.workspace_=null},E.utils.object.inherits(E.FieldTextInput,E.Field),E.FieldTextInput.prototype.DEFAULT_VALUE="",E.FieldTextInput.fromJson=function(t){var e=E.utils.replaceMessageReferences(t.text);return new E.FieldTextInput(e,void 0,t)},E.FieldTextInput.prototype.SERIALIZABLE=!0,E.FieldTextInput.BORDERRADIUS=4,E.FieldTextInput.prototype.CURSOR="text",E.FieldTextInput.prototype.configure_=function(t){E.FieldTextInput.superClass_.configure_.call(this,t),"boolean"==typeof t.spellcheck&&(this.spellcheck_=t.spellcheck)},E.FieldTextInput.prototype.initView=function(){if(this.getConstants().FULL_BLOCK_FIELDS){for(var t,e=0,o=0,n=0;t=this.sourceBlock_.inputList[n];n++){for(var i=0;t.fieldRow[i];i++)e++;t.connection&&o++}this.fullBlockClickTarget_=e<=1&&this.sourceBlock_.outputConnection&&!o}else this.fullBlockClickTarget_=!1;this.fullBlockClickTarget_?this.clickTarget_=this.sourceBlock_.getSvgRoot():this.createBorderRect_(),this.createTextElement_()},E.FieldTextInput.prototype.doClassValidation_=function(t){return null==t?null:String(t)},E.FieldTextInput.prototype.doValueInvalid_=function(t){this.isBeingEdited_&&(this.isTextValid_=!1,t=this.value_,this.value_=this.htmlInput_.untypedDefaultValue_,this.sourceBlock_&&E.Events.isEnabled()&&E.Events.fire(new E.Events.BlockChange(this.sourceBlock_,"field",this.name||null,t,this.value_)))},E.FieldTextInput.prototype.doValueUpdate_=function(t){this.isTextValid_=!0,this.value_=t,this.isBeingEdited_||(this.isDirty_=!0)},E.FieldTextInput.prototype.applyColour=function(){this.sourceBlock_&&this.getConstants().FULL_BLOCK_FIELDS&&(this.borderRect_?this.borderRect_.setAttribute("stroke",this.sourceBlock_.style.colourTertiary):this.sourceBlock_.pathObject.svgPath.setAttribute("fill",this.getConstants().FIELD_BORDER_RECT_COLOUR))},E.FieldTextInput.prototype.render_=function(){if(E.FieldTextInput.superClass_.render_.call(this),this.isBeingEdited_){this.resizeEditor_();var t=this.htmlInput_;this.isTextValid_?(E.utils.dom.removeClass(t,"blocklyInvalidInput"),E.utils.aria.setState(t,E.utils.aria.State.INVALID,!1)):(E.utils.dom.addClass(t,"blocklyInvalidInput"),E.utils.aria.setState(t,E.utils.aria.State.INVALID,!0))}},E.FieldTextInput.prototype.setSpellcheck=function(t){t!=this.spellcheck_&&(this.spellcheck_=t,this.htmlInput_&&this.htmlInput_.setAttribute("spellcheck",this.spellcheck_))},E.FieldTextInput.prototype.showEditor_=function(t,e){this.workspace_=this.sourceBlock_.workspace,!(t=e||!1)&&(E.utils.userAgent.MOBILE||E.utils.userAgent.ANDROID||E.utils.userAgent.IPAD)?this.showPromptEditor_():this.showInlineEditor_(t)},E.FieldTextInput.prototype.showPromptEditor_=function(){var e=this;E.prompt(E.Msg.CHANGE_VALUE_TITLE,this.getText(),function(t){e.setValue(t)})},E.FieldTextInput.prototype.showInlineEditor_=function(t){E.WidgetDiv.show(this,this.sourceBlock_.RTL,this.widgetDispose_.bind(this)),this.htmlInput_=this.widgetCreate_(),this.isBeingEdited_=!0,t||(this.htmlInput_.focus({preventScroll:!0}),this.htmlInput_.select())},E.FieldTextInput.prototype.widgetCreate_=function(){var t=E.WidgetDiv.DIV;E.utils.dom.addClass(this.getClickTarget_(),"editing");var e=document.createElement("input");e.className="blocklyHtmlInput",e.setAttribute("spellcheck",this.spellcheck_);var o=this.workspace_.getScale(),n=this.getConstants().FIELD_TEXT_FONTSIZE*o+"pt";if(t.style.fontSize=n,e.style.fontSize=n,n=E.FieldTextInput.BORDERRADIUS*o+"px",this.fullBlockClickTarget_){n=((n=this.getScaledBBox()).bottom-n.top)/2+"px";var i=this.sourceBlock_.getParent()?this.sourceBlock_.getParent().style.colourTertiary:this.sourceBlock_.style.colourTertiary;e.style.border=1*o+"px solid "+i,t.style.borderRadius=n,t.style.transition="box-shadow 0.25s ease 0s",this.getConstants().FIELD_TEXTINPUT_BOX_SHADOW&&(t.style.boxShadow="rgba(255, 255, 255, 0.3) 0px 0px 0px "+4*o+"px")}return e.style.borderRadius=n,t.appendChild(e),e.value=e.defaultValue=this.getEditorText_(this.value_),e.untypedDefaultValue_=this.value_,e.oldValue_=null,this.resizeEditor_(),this.bindInputEvents_(e),e},E.FieldTextInput.prototype.widgetDispose_=function(){this.isBeingEdited_=!1,this.isTextValid_=!0,this.forceRerender(),this.onFinishEditing_&&this.onFinishEditing_(this.value_),this.unbindInputEvents_();var t=E.WidgetDiv.DIV.style;t.width="auto",t.height="auto",t.fontSize="",t.transition="",t.boxShadow="",this.htmlInput_=null,E.utils.dom.removeClass(this.getClickTarget_(),"editing")},E.FieldTextInput.prototype.bindInputEvents_=function(t){this.onKeyDownWrapper_=E.bindEventWithChecks_(t,"keydown",this,this.onHtmlInputKeyDown_),this.onKeyInputWrapper_=E.bindEventWithChecks_(t,"input",this,this.onHtmlInputChange_)},E.FieldTextInput.prototype.unbindInputEvents_=function(){this.onKeyDownWrapper_&&(E.unbindEvent_(this.onKeyDownWrapper_),this.onKeyDownWrapper_=null),this.onKeyInputWrapper_&&(E.unbindEvent_(this.onKeyInputWrapper_),this.onKeyInputWrapper_=null)},E.FieldTextInput.prototype.onHtmlInputKeyDown_=function(t){t.keyCode==E.utils.KeyCodes.ENTER?(E.WidgetDiv.hide(),E.DropDownDiv.hideWithoutAnimation()):t.keyCode==E.utils.KeyCodes.ESC?(this.htmlInput_.value=this.htmlInput_.defaultValue,E.WidgetDiv.hide(),E.DropDownDiv.hideWithoutAnimation()):t.keyCode==E.utils.KeyCodes.TAB&&(E.WidgetDiv.hide(),E.DropDownDiv.hideWithoutAnimation(),this.sourceBlock_.tab(this,!t.shiftKey),t.preventDefault())},E.FieldTextInput.prototype.onHtmlInputChange_=function(t){(t=this.htmlInput_.value)!==this.htmlInput_.oldValue_&&(this.htmlInput_.oldValue_=t,E.Events.setGroup(!0),t=this.getValueFromEditorText_(t),this.setValue(t),this.forceRerender(),this.resizeEditor_(),E.Events.setGroup(!1))},E.FieldTextInput.prototype.setEditorValue_=function(t){this.isDirty_=!0,this.isBeingEdited_&&(this.htmlInput_.value=this.getEditorText_(t)),this.setValue(t)},E.FieldTextInput.prototype.resizeEditor_=function(){var t=E.WidgetDiv.DIV,e=this.getScaledBBox();t.style.width=e.right-e.left+"px",t.style.height=e.bottom-e.top+"px",e=new E.utils.Coordinate(this.sourceBlock_.RTL?e.right-t.offsetWidth:e.left,e.top),t.style.left=e.x+"px",t.style.top=e.y+"px"},E.FieldTextInput.numberValidator=function(t){return console.warn("Blockly.FieldTextInput.numberValidator is deprecated. Use Blockly.FieldNumber instead."),null===t?null:(t=(t=(t=String(t)).replace(/O/gi,"0")).replace(/,/g,""),t=Number(t||0),isNaN(t)?null:String(t))},E.FieldTextInput.nonnegativeIntegerValidator=function(t){return(t=E.FieldTextInput.numberValidator(t))&&(t=String(Math.max(0,Math.floor(t)))),t},E.FieldTextInput.prototype.isTabNavigable=function(){return!0},E.FieldTextInput.prototype.getText_=function(){return this.isBeingEdited_&&this.htmlInput_?this.htmlInput_.value:null},E.FieldTextInput.prototype.getEditorText_=function(t){return String(t)},E.FieldTextInput.prototype.getValueFromEditorText_=function(t){return t},E.fieldRegistry.register("field_input",E.FieldTextInput),E.FieldAngle=function(t,e,o){this.clockwise_=E.FieldAngle.CLOCKWISE,this.offset_=E.FieldAngle.OFFSET,this.wrap_=E.FieldAngle.WRAP,this.round_=E.FieldAngle.ROUND,E.FieldAngle.superClass_.constructor.call(this,t,e,o),this.moveSurfaceWrapper_=this.clickSurfaceWrapper_=this.clickWrapper_=this.line_=this.gauge_=null},E.utils.object.inherits(E.FieldAngle,E.FieldTextInput),E.FieldAngle.prototype.DEFAULT_VALUE=0,E.FieldAngle.fromJson=function(t){return new E.FieldAngle(t.angle,void 0,t)},E.FieldAngle.prototype.SERIALIZABLE=!0,E.FieldAngle.ROUND=15,E.FieldAngle.HALF=50,E.FieldAngle.CLOCKWISE=!1,E.FieldAngle.OFFSET=0,E.FieldAngle.WRAP=360,E.FieldAngle.RADIUS=E.FieldAngle.HALF-1,E.FieldAngle.prototype.configure_=function(t){switch(E.FieldAngle.superClass_.configure_.call(this,t),t.mode){case"compass":this.clockwise_=!0,this.offset_=90;break;case"protractor":this.clockwise_=!1,this.offset_=0}var e=t.clockwise;"boolean"==typeof e&&(this.clockwise_=e),null!=(e=t.offset)&&(e=Number(e),isNaN(e)||(this.offset_=e)),null!=(e=t.wrap)&&(e=Number(e),isNaN(e)||(this.wrap_=e)),null!=(t=t.round)&&(t=Number(t),isNaN(t)||(this.round_=t))},E.FieldAngle.prototype.initView=function(){E.FieldAngle.superClass_.initView.call(this),this.symbol_=E.utils.dom.createSvgElement(E.utils.Svg.TSPAN,{},null),this.symbol_.appendChild(document.createTextNode("")),this.textElement_.appendChild(this.symbol_)},E.FieldAngle.prototype.render_=function(){E.FieldAngle.superClass_.render_.call(this),this.updateGraph_()},E.FieldAngle.prototype.showEditor_=function(t){E.FieldAngle.superClass_.showEditor_.call(this,t,E.utils.userAgent.MOBILE||E.utils.userAgent.ANDROID||E.utils.userAgent.IPAD),t=this.dropdownCreate_(),E.DropDownDiv.getContentDiv().appendChild(t),E.DropDownDiv.setColour(this.sourceBlock_.style.colourPrimary,this.sourceBlock_.style.colourTertiary),E.DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this)),this.updateGraph_()},E.FieldAngle.prototype.dropdownCreate_=function(){var t=E.utils.dom.createSvgElement(E.utils.Svg.SVG,{xmlns:E.utils.dom.SVG_NS,"xmlns:html":E.utils.dom.HTML_NS,"xmlns:xlink":E.utils.dom.XLINK_NS,version:"1.1",height:2*E.FieldAngle.HALF+"px",width:2*E.FieldAngle.HALF+"px",style:"touch-action: none"},null),e=E.utils.dom.createSvgElement(E.utils.Svg.CIRCLE,{cx:E.FieldAngle.HALF,cy:E.FieldAngle.HALF,r:E.FieldAngle.RADIUS,class:"blocklyAngleCircle"},t);this.gauge_=E.utils.dom.createSvgElement(E.utils.Svg.PATH,{class:"blocklyAngleGauge"},t),this.line_=E.utils.dom.createSvgElement(E.utils.Svg.LINE,{x1:E.FieldAngle.HALF,y1:E.FieldAngle.HALF,class:"blocklyAngleLine"},t);for(var o=0;o<360;o+=15)E.utils.dom.createSvgElement(E.utils.Svg.LINE,{x1:E.FieldAngle.HALF+E.FieldAngle.RADIUS,y1:E.FieldAngle.HALF,x2:E.FieldAngle.HALF+E.FieldAngle.RADIUS-(0==o%45?10:5),y2:E.FieldAngle.HALF,class:"blocklyAngleMarks",transform:"rotate("+o+","+E.FieldAngle.HALF+","+E.FieldAngle.HALF+")"},t);return this.clickWrapper_=E.bindEventWithChecks_(t,"click",this,this.hide_),this.clickSurfaceWrapper_=E.bindEventWithChecks_(e,"click",this,this.onMouseMove_,!0,!0),this.moveSurfaceWrapper_=E.bindEventWithChecks_(e,"mousemove",this,this.onMouseMove_,!0,!0),t},E.FieldAngle.prototype.dropdownDispose_=function(){this.clickWrapper_&&(E.unbindEvent_(this.clickWrapper_),this.clickWrapper_=null),this.clickSurfaceWrapper_&&(E.unbindEvent_(this.clickSurfaceWrapper_),this.clickSurfaceWrapper_=null),this.moveSurfaceWrapper_&&(E.unbindEvent_(this.moveSurfaceWrapper_),this.moveSurfaceWrapper_=null),this.line_=this.gauge_=null},E.FieldAngle.prototype.hide_=function(){E.DropDownDiv.hideIfOwner(this),E.WidgetDiv.hide()},E.FieldAngle.prototype.onMouseMove_=function(t){var e=this.gauge_.ownerSVGElement.getBoundingClientRect(),o=t.clientX-e.left-E.FieldAngle.HALF;t=t.clientY-e.top-E.FieldAngle.HALF,e=Math.atan(-t/o),isNaN(e)||(e=E.utils.math.toDegrees(e),o<0?e+=180:0<t&&(e+=360),e=this.clockwise_?this.offset_+360-e:360-(this.offset_-e),this.displayMouseOrKeyboardValue_(e))},E.FieldAngle.prototype.displayMouseOrKeyboardValue_=function(t){this.round_&&(t=Math.round(t/this.round_)*this.round_),(t=this.wrapValue_(t))!=this.value_&&this.setEditorValue_(t)},E.FieldAngle.prototype.updateGraph_=function(){if(this.gauge_){var t=Number(this.getText())+this.offset_,e=E.utils.math.toRadians(t%360);t=["M ",E.FieldAngle.HALF,",",E.FieldAngle.HALF];var o=E.FieldAngle.HALF,n=E.FieldAngle.HALF;if(!isNaN(e)){var i=Number(this.clockwise_),r=E.utils.math.toRadians(this.offset_),s=Math.cos(r)*E.FieldAngle.RADIUS,a=Math.sin(r)*-E.FieldAngle.RADIUS;i&&(e=2*r-e),o+=Math.cos(e)*E.FieldAngle.RADIUS,n-=Math.sin(e)*E.FieldAngle.RADIUS,e=Math.abs(Math.floor((e-r)/Math.PI)%2),i&&(e=1-e),t.push(" l ",s,",",a," A ",E.FieldAngle.RADIUS,",",E.FieldAngle.RADIUS," 0 ",e," ",i," ",o,",",n," z")}this.gauge_.setAttribute("d",t.join("")),this.line_.setAttribute("x2",o),this.line_.setAttribute("y2",n)}},E.FieldAngle.prototype.onHtmlInputKeyDown_=function(t){var e;if(E.FieldAngle.superClass_.onHtmlInputKeyDown_.call(this,t),t.keyCode===E.utils.KeyCodes.LEFT?e=this.sourceBlock_.RTL?1:-1:t.keyCode===E.utils.KeyCodes.RIGHT?e=this.sourceBlock_.RTL?-1:1:t.keyCode===E.utils.KeyCodes.DOWN?e=-1:t.keyCode===E.utils.KeyCodes.UP&&(e=1),e){var o=this.getValue();this.displayMouseOrKeyboardValue_(o+e*this.round_),t.preventDefault(),t.stopPropagation()}},E.FieldAngle.prototype.doClassValidation_=function(t){return t=Number(t),isNaN(t)||!isFinite(t)?null:this.wrapValue_(t)},E.FieldAngle.prototype.wrapValue_=function(t){return(t%=360)<0&&(t+=360),t>this.wrap_&&(t-=360),t},E.Css.register(".blocklyAngleCircle {,stroke: #444;,stroke-width: 1;,fill: #ddd;,fill-opacity: .8;,},.blocklyAngleMarks {,stroke: #444;,stroke-width: 1;,},.blocklyAngleGauge {,fill: #f88;,fill-opacity: .8;,pointer-events: none;,},.blocklyAngleLine {,stroke: #f00;,stroke-width: 2;,stroke-linecap: round;,pointer-events: none;,}".split(",")),E.fieldRegistry.register("field_angle",E.FieldAngle),E.FieldCheckbox=function(t,e,o){this.checkChar_=null,E.FieldCheckbox.superClass_.constructor.call(this,t,e,o)},E.utils.object.inherits(E.FieldCheckbox,E.Field),E.FieldCheckbox.prototype.DEFAULT_VALUE=!1,E.FieldCheckbox.fromJson=function(t){return new E.FieldCheckbox(t.checked,void 0,t)},E.FieldCheckbox.CHECK_CHAR="",E.FieldCheckbox.prototype.SERIALIZABLE=!0,E.FieldCheckbox.prototype.CURSOR="default",E.FieldCheckbox.prototype.configure_=function(t){E.FieldCheckbox.superClass_.configure_.call(this,t),t.checkCharacter&&(this.checkChar_=t.checkCharacter)},E.FieldCheckbox.prototype.initView=function(){E.FieldCheckbox.superClass_.initView.call(this),E.utils.dom.addClass(this.textElement_,"blocklyCheckbox"),this.textElement_.style.display=this.value_?"block":"none"},E.FieldCheckbox.prototype.render_=function(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_(this.getConstants().FIELD_CHECKBOX_X_OFFSET)},E.FieldCheckbox.prototype.getDisplayText_=function(){return this.checkChar_||E.FieldCheckbox.CHECK_CHAR},E.FieldCheckbox.prototype.setCheckCharacter=function(t){this.checkChar_=t,this.forceRerender()},E.FieldCheckbox.prototype.showEditor_=function(){this.setValue(!this.value_)},E.FieldCheckbox.prototype.doClassValidation_=function(t){return!0===t||"TRUE"===t?"TRUE":!1===t||"FALSE"===t?"FALSE":null},E.FieldCheckbox.prototype.doValueUpdate_=function(t){this.value_=this.convertValueToBool_(t),this.textElement_&&(this.textElement_.style.display=this.value_?"block":"none")},E.FieldCheckbox.prototype.getValue=function(){return this.value_?"TRUE":"FALSE"},E.FieldCheckbox.prototype.getValueBoolean=function(){return this.value_},E.FieldCheckbox.prototype.getText=function(){return String(this.convertValueToBool_(this.value_))},E.FieldCheckbox.prototype.convertValueToBool_=function(t){return"string"==typeof t?"TRUE"==t:!!t},E.fieldRegistry.register("field_checkbox",E.FieldCheckbox),E.FieldColour=function(t,e,o){E.FieldColour.superClass_.constructor.call(this,t,e,o),this.onKeyDownWrapper_=this.onMouseLeaveWrapper_=this.onMouseEnterWrapper_=this.onMouseMoveWrapper_=this.onClickWrapper_=this.highlightedIndex_=this.picker_=null},E.utils.object.inherits(E.FieldColour,E.Field),E.FieldColour.fromJson=function(t){return new E.FieldColour(t.colour,void 0,t)},E.FieldColour.prototype.SERIALIZABLE=!0,E.FieldColour.prototype.CURSOR="default",E.FieldColour.prototype.isDirty_=!1,E.FieldColour.prototype.colours_=null,E.FieldColour.prototype.titles_=null,E.FieldColour.prototype.columns_=0,E.FieldColour.prototype.configure_=function(t){E.FieldColour.superClass_.configure_.call(this,t),t.colourOptions&&(this.colours_=t.colourOptions,this.titles_=t.colourTitles),t.columns&&(this.columns_=t.columns)},E.FieldColour.prototype.initView=function(){this.size_=new E.utils.Size(this.getConstants().FIELD_COLOUR_DEFAULT_WIDTH,this.getConstants().FIELD_COLOUR_DEFAULT_HEIGHT),this.getConstants().FIELD_COLOUR_FULL_BLOCK?this.clickTarget_=this.sourceBlock_.getSvgRoot():(this.createBorderRect_(),this.borderRect_.style.fillOpacity="1")},E.FieldColour.prototype.applyColour=function(){this.getConstants().FIELD_COLOUR_FULL_BLOCK?(this.sourceBlock_.pathObject.svgPath.setAttribute("fill",this.getValue()),this.sourceBlock_.pathObject.svgPath.setAttribute("stroke","#fff")):this.borderRect_&&(this.borderRect_.style.fill=this.getValue())},E.FieldColour.prototype.doClassValidation_=function(t){return"string"!=typeof t?null:E.utils.colour.parse(t)},E.FieldColour.prototype.doValueUpdate_=function(t){this.value_=t,this.borderRect_?this.borderRect_.style.fill=t:this.sourceBlock_&&this.sourceBlock_.rendered&&(this.sourceBlock_.pathObject.svgPath.setAttribute("fill",t),this.sourceBlock_.pathObject.svgPath.setAttribute("stroke","#fff"))},E.FieldColour.prototype.getText=function(){var t=this.value_;return/^#(.)\1(.)\2(.)\3$/.test(t)&&(t="#"+t[1]+t[3]+t[5]),t},E.FieldColour.COLOURS="#ffffff #cccccc #c0c0c0 #999999 #666666 #333333 #000000 #ffcccc #ff6666 #ff0000 #cc0000 #990000 #660000 #330000 #ffcc99 #ff9966 #ff9900 #ff6600 #cc6600 #993300 #663300 #ffff99 #ffff66 #ffcc66 #ffcc33 #cc9933 #996633 #663333 #ffffcc #ffff33 #ffff00 #ffcc00 #999900 #666600 #333300 #99ff99 #66ff99 #33ff33 #33cc00 #009900 #006600 #003300 #99ffff #33ffff #66cccc #00cccc #339999 #336666 #003333 #ccffff #66ffff #33ccff #3366ff #3333ff #000099 #000066 #ccccff #9999ff #6666cc #6633ff #6600cc #333399 #330099 #ffccff #ff99ff #cc66cc #cc33cc #993399 #663366 #330033".split(" "),E.FieldColour.prototype.DEFAULT_VALUE=E.FieldColour.COLOURS[0],E.FieldColour.TITLES=[],E.FieldColour.COLUMNS=7,E.FieldColour.prototype.setColours=function(t,e){return this.colours_=t,e&&(this.titles_=e),this},E.FieldColour.prototype.setColumns=function(t){return this.columns_=t,this},E.FieldColour.prototype.showEditor_=function(){this.picker_=this.dropdownCreate_(),E.DropDownDiv.getContentDiv().appendChild(this.picker_),E.DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this)),this.picker_.focus({preventScroll:!0})},E.FieldColour.prototype.onClick_=function(t){null!==(t=(t=t.target)&&t.label)&&(this.setValue(t),E.DropDownDiv.hideIfOwner(this))},E.FieldColour.prototype.onKeyDown_=function(t){var e=!1;t.keyCode===E.utils.KeyCodes.UP?(this.moveHighlightBy_(0,-1),e=!0):t.keyCode===E.utils.KeyCodes.DOWN?(this.moveHighlightBy_(0,1),e=!0):t.keyCode===E.utils.KeyCodes.LEFT?(this.moveHighlightBy_(-1,0),e=!0):t.keyCode===E.utils.KeyCodes.RIGHT?(this.moveHighlightBy_(1,0),e=!0):t.keyCode===E.utils.KeyCodes.ENTER&&((e=this.getHighlighted_())&&null!==(e=e&&e.label)&&this.setValue(e),E.DropDownDiv.hideWithoutAnimation(),e=!0),e&&t.stopPropagation()},E.FieldColour.prototype.onBlocklyAction=function(t){if(this.picker_){if(t===E.navigation.ACTION_PREVIOUS)return this.moveHighlightBy_(0,-1),!0;if(t===E.navigation.ACTION_NEXT)return this.moveHighlightBy_(0,1),!0;if(t===E.navigation.ACTION_OUT)return this.moveHighlightBy_(-1,0),!0;if(t===E.navigation.ACTION_IN)return this.moveHighlightBy_(1,0),!0}return E.FieldColour.superClass_.onBlocklyAction.call(this,t)},E.FieldColour.prototype.moveHighlightBy_=function(t,e){var o=this.colours_||E.FieldColour.COLOURS,n=this.columns_||E.FieldColour.COLUMNS,i=this.highlightedIndex_%n,r=Math.floor(this.highlightedIndex_/n);i+=t,r+=e,t<0?i<0&&0<r?(i=n-1,r--):i<0&&(i=0):0<t?n-1<i&&r<Math.floor(o.length/n)-1?(i=0,r++):n-1<i&&i--:e<0?r<0&&(r=0):0<e&&r>Math.floor(o.length/n)-1&&(r=Math.floor(o.length/n)-1),this.setHighlightedCell_(this.picker_.childNodes[r].childNodes[i],r*n+i)},E.FieldColour.prototype.onMouseMove_=function(t){var e=(t=t.target)&&Number(t.getAttribute("data-index"));null!==e&&e!==this.highlightedIndex_&&this.setHighlightedCell_(t,e)},E.FieldColour.prototype.onMouseEnter_=function(){this.picker_.focus({preventScroll:!0})},E.FieldColour.prototype.onMouseLeave_=function(){this.picker_.blur();var t=this.getHighlighted_();t&&E.utils.dom.removeClass(t,"blocklyColourHighlighted")},E.FieldColour.prototype.getHighlighted_=function(){var t=this.columns_||E.FieldColour.COLUMNS,e=this.picker_.childNodes[Math.floor(this.highlightedIndex_/t)];return e?e.childNodes[this.highlightedIndex_%t]:null},E.FieldColour.prototype.setHighlightedCell_=function(t,e){var o=this.getHighlighted_();o&&E.utils.dom.removeClass(o,"blocklyColourHighlighted"),E.utils.dom.addClass(t,"blocklyColourHighlighted"),this.highlightedIndex_=e,E.utils.aria.setState(this.picker_,E.utils.aria.State.ACTIVEDESCENDANT,t.getAttribute("id"))},E.FieldColour.prototype.dropdownCreate_=function(){var t=this.columns_||E.FieldColour.COLUMNS,e=this.colours_||E.FieldColour.COLOURS,o=this.titles_||E.FieldColour.TITLES,n=this.getValue(),i=document.createElement("table");i.className="blocklyColourTable",i.tabIndex=0,i.dir="ltr",E.utils.aria.setRole(i,E.utils.aria.Role.GRID),E.utils.aria.setState(i,E.utils.aria.State.EXPANDED,!0),E.utils.aria.setState(i,E.utils.aria.State.ROWCOUNT,Math.floor(e.length/t)),E.utils.aria.setState(i,E.utils.aria.State.COLCOUNT,t);for(var r,s=0;s<e.length;s++){0==s%t&&(r=document.createElement("tr"),E.utils.aria.setRole(r,E.utils.aria.Role.ROW),i.appendChild(r));var a=document.createElement("td");r.appendChild(a),a.label=e[s],a.title=o[s]||e[s],a.id=E.utils.IdGenerator.getNextUniqueId(),a.setAttribute("data-index",s),E.utils.aria.setRole(a,E.utils.aria.Role.GRIDCELL),E.utils.aria.setState(a,E.utils.aria.State.LABEL,e[s]),E.utils.aria.setState(a,E.utils.aria.State.SELECTED,e[s]==n),a.style.backgroundColor=e[s],e[s]==n&&(a.className="blocklyColourSelected",this.highlightedIndex_=s)}return this.onClickWrapper_=E.bindEventWithChecks_(i,"click",this,this.onClick_,!0),this.onMouseMoveWrapper_=E.bindEventWithChecks_(i,"mousemove",this,this.onMouseMove_,!0),this.onMouseEnterWrapper_=E.bindEventWithChecks_(i,"mouseenter",this,this.onMouseEnter_,!0),this.onMouseLeaveWrapper_=E.bindEventWithChecks_(i,"mouseleave",this,this.onMouseLeave_,!0),this.onKeyDownWrapper_=E.bindEventWithChecks_(i,"keydown",this,this.onKeyDown_),i},E.FieldColour.prototype.dropdownDispose_=function(){this.onClickWrapper_&&(E.unbindEvent_(this.onClickWrapper_),this.onClickWrapper_=null),this.onMouseMoveWrapper_&&(E.unbindEvent_(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null),this.onMouseEnterWrapper_&&(E.unbindEvent_(this.onMouseEnterWrapper_),this.onMouseEnterWrapper_=null),this.onMouseLeaveWrapper_&&(E.unbindEvent_(this.onMouseLeaveWrapper_),this.onMouseLeaveWrapper_=null),this.onKeyDownWrapper_&&(E.unbindEvent_(this.onKeyDownWrapper_),this.onKeyDownWrapper_=null),this.highlightedIndex_=this.picker_=null},E.Css.register([".blocklyColourTable {","border-collapse: collapse;","display: block;","outline: none;","padding: 1px;","}",".blocklyColourTable>tr>td {","border: .5px solid #888;","box-sizing: border-box;","cursor: pointer;","display: inline-block;","height: 20px;","padding: 0;","width: 20px;","}",".blocklyColourTable>tr>td.blocklyColourHighlighted {","border-color: #eee;","box-shadow: 2px 2px 7px 2px rgba(0,0,0,.3);","position: relative;","}",".blocklyColourSelected, .blocklyColourSelected:hover {","border-color: #eee !important;","outline: 1px solid #333;","position: relative;","}"]),E.fieldRegistry.register("field_colour",E.FieldColour),E.FieldDropdown=function(t,e,o){"function"!=typeof t&&E.FieldDropdown.validateOptions_(t),this.menuGenerator_=t,this.suffixField=this.prefixField=this.generatedOptions_=null,this.trimOptions_(),this.selectedOption_=this.getOptions(!1)[0],E.FieldDropdown.superClass_.constructor.call(this,this.selectedOption_[1],e,o),this.svgArrow_=this.arrow_=this.imageElement_=this.menu_=this.selectedMenuItem_=null},E.utils.object.inherits(E.FieldDropdown,E.Field),E.FieldDropdown.fromJson=function(t){return new E.FieldDropdown(t.options,void 0,t)},E.FieldDropdown.prototype.SERIALIZABLE=!0,E.FieldDropdown.CHECKMARK_OVERHANG=25,E.FieldDropdown.MAX_MENU_HEIGHT_VH=.45,E.FieldDropdown.IMAGE_Y_OFFSET=5,E.FieldDropdown.IMAGE_Y_PADDING=2*E.FieldDropdown.IMAGE_Y_OFFSET,E.FieldDropdown.ARROW_CHAR=E.utils.userAgent.ANDROID?"":"",E.FieldDropdown.prototype.CURSOR="default",E.FieldDropdown.prototype.initView=function(){this.shouldAddBorderRect_()?this.createBorderRect_():this.clickTarget_=this.sourceBlock_.getSvgRoot(),this.createTextElement_(),this.imageElement_=E.utils.dom.createSvgElement(E.utils.Svg.IMAGE,{},this.fieldGroup_),this.getConstants().FIELD_DROPDOWN_SVG_ARROW?this.createSVGArrow_():this.createTextArrow_(),this.borderRect_&&E.utils.dom.addClass(this.borderRect_,"blocklyDropdownRect")},E.FieldDropdown.prototype.shouldAddBorderRect_=function(){return!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW&&!this.sourceBlock_.isShadow()},E.FieldDropdown.prototype.createTextArrow_=function(){this.arrow_=E.utils.dom.createSvgElement(E.utils.Svg.TSPAN,{},this.textElement_),this.arrow_.appendChild(document.createTextNode(this.sourceBlock_.RTL?E.FieldDropdown.ARROW_CHAR+" ":" "+E.FieldDropdown.ARROW_CHAR)),this.sourceBlock_.RTL?this.textElement_.insertBefore(this.arrow_,this.textContent_):this.textElement_.appendChild(this.arrow_)},E.FieldDropdown.prototype.createSVGArrow_=function(){this.svgArrow_=E.utils.dom.createSvgElement(E.utils.Svg.IMAGE,{height:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px",width:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px"},this.fieldGroup_),this.svgArrow_.setAttributeNS(E.utils.dom.XLINK_NS,"xlink:href",this.getConstants().FIELD_DROPDOWN_SVG_ARROW_DATAURI)},E.FieldDropdown.prototype.showEditor_=function(t){if(this.menu_=this.dropdownCreate_(),this.menu_.openingCoords=t&&"number"==typeof t.clientX?new E.utils.Coordinate(t.clientX,t.clientY):null,this.menu_.render(E.DropDownDiv.getContentDiv()),t=this.menu_.getElement(),E.utils.dom.addClass(t,"blocklyDropdownMenu"),this.getConstants().FIELD_DROPDOWN_COLOURED_DIV){t=this.sourceBlock_.isShadow()?this.sourceBlock_.getParent().getColour():this.sourceBlock_.getColour();var e=this.sourceBlock_.isShadow()?this.sourceBlock_.getParent().style.colourTertiary:this.sourceBlock_.style.colourTertiary;E.DropDownDiv.setColour(t,e)}E.DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this)),this.menu_.focus(),this.selectedMenuItem_&&this.menu_.setHighlighted(this.selectedMenuItem_),this.applyColour()},E.FieldDropdown.prototype.dropdownCreate_=function(){var t=new E.Menu;t.setRole(E.utils.aria.Role.LISTBOX);var e=this.getOptions(!1);this.selectedMenuItem_=null;for(var o=0;o<e.length;o++){var n=e[o][0],i=e[o][1];if("object"==typeof n){var r=new Image(n.width,n.height);r.src=n.src,r.alt=n.alt||"",n=r}(n=new E.MenuItem(n,i)).setRole(E.utils.aria.Role.OPTION),n.setRightToLeft(this.sourceBlock_.RTL),n.setCheckable(!0),t.addChild(n),n.setChecked(i==this.value_),i==this.value_&&(this.selectedMenuItem_=n),n.onAction(this.handleMenuActionEvent_,this)}return t},E.FieldDropdown.prototype.dropdownDispose_=function(){this.menu_&&this.menu_.dispose(),this.selectedMenuItem_=this.menu_=null,this.applyColour()},E.FieldDropdown.prototype.handleMenuActionEvent_=function(t){E.DropDownDiv.hideIfOwner(this,!0),this.onItemSelected_(this.menu_,t)},E.FieldDropdown.prototype.onItemSelected_=function(t,e){this.setValue(e.getValue())},E.FieldDropdown.prototype.trimOptions_=function(){var t=this.menuGenerator_;if(Array.isArray(t)){for(var e=!1,o=0;o<t.length;o++){var n=t[o][0];"string"==typeof n?t[o][0]=E.utils.replaceMessageReferences(n):(null!=n.alt&&(t[o][0].alt=E.utils.replaceMessageReferences(n.alt)),e=!0)}if(!(e||t.length<2)){for(e=[],o=0;o<t.length;o++)e.push(t[o][0]);o=E.utils.string.shortestStringLength(e),n=E.utils.string.commonWordPrefix(e,o);var i=E.utils.string.commonWordSuffix(e,o);!n&&!i||o<=n+i||(n&&(this.prefixField=e[0].substring(0,n-1)),i&&(this.suffixField=e[0].substr(1-i)),this.menuGenerator_=E.FieldDropdown.applyTrim_(t,n,i))}}},E.FieldDropdown.applyTrim_=function(t,e,o){for(var n=[],i=0;i<t.length;i++){var r=t[i][0],s=t[i][1];r=r.substring(e,r.length-o),n[i]=[r,s]}return n},E.FieldDropdown.prototype.isOptionListDynamic=function(){return"function"==typeof this.menuGenerator_},E.FieldDropdown.prototype.getOptions=function(t){return this.isOptionListDynamic()?(this.generatedOptions_&&t||(this.generatedOptions_=this.menuGenerator_.call(this),E.FieldDropdown.validateOptions_(this.generatedOptions_)),this.generatedOptions_):this.menuGenerator_},E.FieldDropdown.prototype.doClassValidation_=function(t){for(var e,o=!1,n=this.getOptions(!0),i=0;e=n[i];i++)if(e[1]==t){o=!0;break}return o?t:(this.sourceBlock_&&console.warn("Cannot set the dropdown's value to an unavailable option. Block type: "+this.sourceBlock_.type+", Field name: "+this.name+", Value: "+t),null)},E.FieldDropdown.prototype.doValueUpdate_=function(t){E.FieldDropdown.superClass_.doValueUpdate_.call(this,t),t=this.getOptions(!0);for(var e,o=0;e=t[o];o++)e[1]==this.value_&&(this.selectedOption_=e)},E.FieldDropdown.prototype.applyColour=function(){this.borderRect_&&(this.borderRect_.setAttribute("stroke",this.sourceBlock_.style.colourTertiary),this.menu_?this.borderRect_.setAttribute("fill",this.sourceBlock_.style.colourTertiary):this.borderRect_.setAttribute("fill","transparent")),this.sourceBlock_&&this.arrow_&&(this.sourceBlock_.isShadow()?this.arrow_.style.fill=this.sourceBlock_.style.colourSecondary:this.arrow_.style.fill=this.sourceBlock_.style.colourPrimary)},E.FieldDropdown.prototype.render_=function(){this.textContent_.nodeValue="",this.imageElement_.style.display="none";var t=this.selectedOption_&&this.selectedOption_[0];t&&"object"==typeof t?this.renderSelectedImage_(t):this.renderSelectedText_(),this.positionBorderRect_()},E.FieldDropdown.prototype.renderSelectedImage_=function(t){this.imageElement_.style.display="",this.imageElement_.setAttributeNS(E.utils.dom.XLINK_NS,"xlink:href",t.src),this.imageElement_.setAttribute("height",t.height),this.imageElement_.setAttribute("width",t.width);var e=Number(t.height);t=Number(t.width);var o=!!this.borderRect_,n=Math.max(o?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,e+E.FieldDropdown.IMAGE_Y_PADDING);o=o?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;var i=this.svgArrow_?this.positionSVGArrow_(t+o,n/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2):E.utils.dom.getFastTextWidth(this.arrow_,this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY);this.size_.width=t+i+2*o,this.size_.height=n;var r=0;this.sourceBlock_.RTL?this.imageElement_.setAttribute("x",o+i):(r=t+i,this.textElement_.setAttribute("text-anchor","end"),this.imageElement_.setAttribute("x",o)),this.imageElement_.setAttribute("y",n/2-e/2),this.positionTextElement_(r+o,t+i)},E.FieldDropdown.prototype.renderSelectedText_=function(){this.textContent_.nodeValue=this.getDisplayText_(),E.utils.dom.addClass(this.textElement_,"blocklyDropdownText"),this.textElement_.setAttribute("text-anchor","start");var t=!!this.borderRect_,e=Math.max(t?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,this.getConstants().FIELD_TEXT_HEIGHT),o=E.utils.dom.getFastTextWidth(this.textElement_,this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY);t=t?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;var n=0;this.svgArrow_&&(n=this.positionSVGArrow_(o+t,e/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2)),this.size_.width=o+n+2*t,this.size_.height=e,this.positionTextElement_(t,o)},E.FieldDropdown.prototype.positionSVGArrow_=function(t,e){if(!this.svgArrow_)return 0;var o=this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,n=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_PADDING,i=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE;return this.svgArrow_.setAttribute("transform","translate("+(this.sourceBlock_.RTL?o:t+n)+","+e+")"),i+n},E.FieldDropdown.prototype.getText_=function(){if(!this.selectedOption_)return null;var t=this.selectedOption_[0];return"object"==typeof t?t.alt:t},E.FieldDropdown.validateOptions_=function(t){if(!Array.isArray(t))throw TypeError("FieldDropdown options must be an array.");if(!t.length)throw TypeError("FieldDropdown options must not be an empty array.");for(var e=!1,o=0;o<t.length;++o){var n=t[o];Array.isArray(n)?"string"!=typeof n[1]?(e=!0,console.error("Invalid option["+o+"]: Each FieldDropdown option id must be a string. Found "+n[1]+" in: ",n)):n[0]&&"string"!=typeof n[0]&&"string"!=typeof n[0].src&&(e=!0,console.error("Invalid option["+o+"]: Each FieldDropdown option must have a string label or image description. Found"+n[0]+" in: ",n)):(e=!0,console.error("Invalid option["+o+"]: Each FieldDropdown option must be an array. Found: ",n))}if(e)throw TypeError("Found invalid FieldDropdown options.")},E.FieldDropdown.prototype.onBlocklyAction=function(t){if(this.menu_){if(t===E.navigation.ACTION_PREVIOUS)return this.menu_.highlightPrevious(),!0;if(t===E.navigation.ACTION_NEXT)return this.menu_.highlightNext(),!0}return E.FieldDropdown.superClass_.onBlocklyAction.call(this,t)},E.fieldRegistry.register("field_dropdown",E.FieldDropdown),E.FieldLabelSerializable=function(t,e,o){E.FieldLabelSerializable.superClass_.constructor.call(this,t,e,o)},E.utils.object.inherits(E.FieldLabelSerializable,E.FieldLabel),E.FieldLabelSerializable.fromJson=function(t){var e=E.utils.replaceMessageReferences(t.text);return new E.FieldLabelSerializable(e,void 0,t)},E.FieldLabelSerializable.prototype.EDITABLE=!1,E.FieldLabelSerializable.prototype.SERIALIZABLE=!0,E.fieldRegistry.register("field_label_serializable",E.FieldLabelSerializable),E.FieldImage=function(t,e,o,n,i,r,s){if(!t)throw Error("Src value of an image field is required");if(t=E.utils.replaceMessageReferences(t),o=Number(E.utils.replaceMessageReferences(o)),e=Number(E.utils.replaceMessageReferences(e)),isNaN(o)||isNaN(e))throw Error("Height and width values of an image field must cast to numbers.");if(o<=0||e<=0)throw Error("Height and width values of an image field must be greater than 0.");this.flipRtl_=!1,this.altText_="",E.FieldImage.superClass_.constructor.call(this,t,null,s),s||(this.flipRtl_=!!r,this.altText_=E.utils.replaceMessageReferences(n)||""),this.size_=new E.utils.Size(e,o+E.FieldImage.Y_PADDING),this.imageHeight_=o,this.clickHandler_=null,"function"==typeof i&&(this.clickHandler_=i),this.imageElement_=null},E.utils.object.inherits(E.FieldImage,E.Field),E.FieldImage.prototype.DEFAULT_VALUE="",E.FieldImage.fromJson=function(t){return new E.FieldImage(t.src,t.width,t.height,void 0,void 0,void 0,t)},E.FieldImage.Y_PADDING=1,E.FieldImage.prototype.EDITABLE=!1,E.FieldImage.prototype.isDirty_=!1,E.FieldImage.prototype.configure_=function(t){E.FieldImage.superClass_.configure_.call(this,t),this.flipRtl_=!!t.flipRtl,this.altText_=E.utils.replaceMessageReferences(t.alt)||""},E.FieldImage.prototype.initView=function(){this.imageElement_=E.utils.dom.createSvgElement(E.utils.Svg.IMAGE,{height:this.imageHeight_+"px",width:this.size_.width+"px",alt:this.altText_},this.fieldGroup_),this.imageElement_.setAttributeNS(E.utils.dom.XLINK_NS,"xlink:href",this.value_),this.clickHandler_&&(this.imageElement_.style.cursor="pointer")},E.FieldImage.prototype.updateSize_=function(){},E.FieldImage.prototype.doClassValidation_=function(t){return"string"!=typeof t?null:t},E.FieldImage.prototype.doValueUpdate_=function(t){this.value_=t,this.imageElement_&&this.imageElement_.setAttributeNS(E.utils.dom.XLINK_NS,"xlink:href",String(this.value_))},E.FieldImage.prototype.getFlipRtl=function(){return this.flipRtl_},E.FieldImage.prototype.setAlt=function(t){t!=this.altText_&&(this.altText_=t||"",this.imageElement_&&this.imageElement_.setAttribute("alt",this.altText_))},E.FieldImage.prototype.showEditor_=function(){this.clickHandler_&&this.clickHandler_(this)},E.FieldImage.prototype.setOnClickHandler=function(t){this.clickHandler_=t},E.FieldImage.prototype.getText_=function(){return this.altText_},E.fieldRegistry.register("field_image",E.FieldImage),E.FieldMultilineInput=function(t,e,o){E.FieldMultilineInput.superClass_.constructor.call(this,t,e,o),this.textGroup_=null},E.utils.object.inherits(E.FieldMultilineInput,E.FieldTextInput),E.FieldMultilineInput.fromJson=function(t){var e=E.utils.replaceMessageReferences(t.text);return new E.FieldMultilineInput(e,void 0,t)},E.FieldMultilineInput.prototype.toXml=function(t){return t.textContent=this.getValue().replace(/\n/g,"&#10;"),t},E.FieldMultilineInput.prototype.fromXml=function(t){this.setValue(t.textContent.replace(/&#10;/g,"\n"))},E.FieldMultilineInput.prototype.initView=function(){this.createBorderRect_(),this.textGroup_=E.utils.dom.createSvgElement(E.utils.Svg.G,{class:"blocklyEditableText"},this.fieldGroup_)},E.FieldMultilineInput.prototype.getDisplayText_=function(){var t=this.value_;if(!t)return E.Field.NBSP;var e=t.split("\n");t="";for(var o=0;o<e.length;o++){var n=e[o];n.length>this.maxDisplayLength&&(n=n.substring(0,this.maxDisplayLength-4)+"..."),t+=n=n.replace(/\s/g,E.Field.NBSP),o!==e.length-1&&(t+="\n")}return this.sourceBlock_.RTL&&(t+=""),t},E.FieldMultilineInput.prototype.render_=function(){for(var t;t=this.textGroup_.firstChild;)this.textGroup_.removeChild(t);t=this.getDisplayText_().split("\n");for(var e=0,o=0;o<t.length;o++){var n=this.getConstants().FIELD_TEXT_HEIGHT+this.getConstants().FIELD_BORDER_RECT_Y_PADDING;E.utils.dom.createSvgElement(E.utils.Svg.TEXT,{class:"blocklyText blocklyMultilineText",x:this.getConstants().FIELD_BORDER_RECT_X_PADDING,y:e+this.getConstants().FIELD_BORDER_RECT_Y_PADDING,dy:this.getConstants().FIELD_TEXT_BASELINE},this.textGroup_).appendChild(document.createTextNode(t[o])),e+=n}this.updateSize_(),this.isBeingEdited_&&(this.sourceBlock_.RTL?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),t=this.htmlInput_,this.isTextValid_?(E.utils.dom.removeClass(t,"blocklyInvalidInput"),E.utils.aria.setState(t,E.utils.aria.State.INVALID,!1)):(E.utils.dom.addClass(t,"blocklyInvalidInput"),E.utils.aria.setState(t,E.utils.aria.State.INVALID,!0)))},E.FieldMultilineInput.prototype.updateSize_=function(){for(var t=this.textGroup_.childNodes,e=0,o=0,n=0;n<t.length;n++){var i=E.utils.dom.getTextWidth(t[n]);e<i&&(e=i),o+=this.getConstants().FIELD_TEXT_HEIGHT+(0<n?this.getConstants().FIELD_BORDER_RECT_Y_PADDING:0)}this.borderRect_&&(o+=2*this.getConstants().FIELD_BORDER_RECT_Y_PADDING,e+=2*this.getConstants().FIELD_BORDER_RECT_X_PADDING,this.borderRect_.setAttribute("width",e),this.borderRect_.setAttribute("height",o)),this.size_.width=e,this.size_.height=o,this.positionBorderRect_()},E.FieldMultilineInput.prototype.widgetCreate_=function(){var t=E.WidgetDiv.DIV,e=this.workspace_.getScale(),o=document.createElement("textarea");o.className="blocklyHtmlInput blocklyHtmlTextAreaInput",o.setAttribute("spellcheck",this.spellcheck_);var n=this.getConstants().FIELD_TEXT_FONTSIZE*e+"pt";t.style.fontSize=n,o.style.fontSize=n,o.style.borderRadius=E.FieldTextInput.BORDERRADIUS*e+"px",n=this.getConstants().FIELD_BORDER_RECT_X_PADDING*e;var i=this.getConstants().FIELD_BORDER_RECT_Y_PADDING*e/2;return o.style.padding=i+"px "+n+"px "+i+"px "+n+"px",n=this.getConstants().FIELD_TEXT_HEIGHT+this.getConstants().FIELD_BORDER_RECT_Y_PADDING,o.style.lineHeight=n*e+"px",t.appendChild(o),o.value=o.defaultValue=this.getEditorText_(this.value_),o.untypedDefaultValue_=this.value_,o.oldValue_=null,E.utils.userAgent.GECKO?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),this.bindInputEvents_(o),o},E.FieldMultilineInput.prototype.onHtmlInputKeyDown_=function(t){t.keyCode!==E.utils.KeyCodes.ENTER&&E.FieldMultilineInput.superClass_.onHtmlInputKeyDown_.call(this,t)},E.Css.register(".blocklyHtmlTextAreaInput {,font-family: monospace;,resize: none;,overflow: hidden;,height: 100%;,text-align: left;,}".split(",")),E.fieldRegistry.register("field_multilinetext",E.FieldMultilineInput),E.FieldNumber=function(t,e,o,n,i,r){this.min_=-1/0,this.max_=1/0,this.precision_=0,this.decimalPlaces_=null,E.FieldNumber.superClass_.constructor.call(this,t,i,r),r||this.setConstraints(e,o,n)},E.utils.object.inherits(E.FieldNumber,E.FieldTextInput),E.FieldNumber.prototype.DEFAULT_VALUE=0,E.FieldNumber.fromJson=function(t){return new E.FieldNumber(t.value,void 0,void 0,void 0,void 0,t)},E.FieldNumber.prototype.SERIALIZABLE=!0,E.FieldNumber.prototype.configure_=function(t){E.FieldNumber.superClass_.configure_.call(this,t),this.setMinInternal_(t.min),this.setMaxInternal_(t.max),this.setPrecisionInternal_(t.precision)},E.FieldNumber.prototype.setConstraints=function(t,e,o){this.setMinInternal_(t),this.setMaxInternal_(e),this.setPrecisionInternal_(o),this.setValue(this.getValue())},E.FieldNumber.prototype.setMin=function(t){this.setMinInternal_(t),this.setValue(this.getValue())},E.FieldNumber.prototype.setMinInternal_=function(t){null==t?this.min_=-1/0:(t=Number(t),isNaN(t)||(this.min_=t))},E.FieldNumber.prototype.getMin=function(){return this.min_},E.FieldNumber.prototype.setMax=function(t){this.setMaxInternal_(t),this.setValue(this.getValue())},E.FieldNumber.prototype.setMaxInternal_=function(t){null==t?this.max_=1/0:(t=Number(t),isNaN(t)||(this.max_=t))},E.FieldNumber.prototype.getMax=function(){return this.max_},E.FieldNumber.prototype.setPrecision=function(t){this.setPrecisionInternal_(t),this.setValue(this.getValue())},E.FieldNumber.prototype.setPrecisionInternal_=function(t){null==t?this.precision_=0:(t=Number(t),isNaN(t)||(this.precision_=t));var e=this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}),o=e.indexOf(".");this.decimalPlaces_=-1==o?t?0:null:e.length-o-1},E.FieldNumber.prototype.getPrecision=function(){return this.precision_},E.FieldNumber.prototype.doClassValidation_=function(t){return null===t?null:(t=(t=(t=(t=String(t)).replace(/O/gi,"0")).replace(/,/g,"")).replace(/infinity/i,"Infinity"),t=Number(t||0),isNaN(t)?null:(t=Math.min(Math.max(t,this.min_),this.max_),this.precision_&&isFinite(t)&&(t=Math.round(t/this.precision_)*this.precision_),null!=this.decimalPlaces_&&(t=Number(t.toFixed(this.decimalPlaces_))),t))},E.FieldNumber.prototype.widgetCreate_=function(){var t=E.FieldNumber.superClass_.widgetCreate_.call(this);return-1/0<this.min_&&E.utils.aria.setState(t,E.utils.aria.State.VALUEMIN,this.min_),1/0>this.max_&&E.utils.aria.setState(t,E.utils.aria.State.VALUEMAX,this.max_),t},E.fieldRegistry.register("field_number",E.FieldNumber),E.FieldVariable=function(t,e,o,n,i){this.menuGenerator_=E.FieldVariable.dropdownCreate,this.defaultVariableName=t||"",this.size_=new E.utils.Size(0,0),i&&this.configure_(i),e&&this.setValidator(e),i||this.setTypes_(o,n)},E.utils.object.inherits(E.FieldVariable,E.FieldDropdown),E.FieldVariable.fromJson=function(t){var e=E.utils.replaceMessageReferences(t.variable);return new E.FieldVariable(e,void 0,void 0,void 0,t)},E.FieldVariable.prototype.SERIALIZABLE=!0,E.FieldVariable.prototype.configure_=function(t){E.FieldVariable.superClass_.configure_.call(this,t),this.setTypes_(t.variableTypes,t.defaultType)},E.FieldVariable.prototype.initModel=function(){if(!this.variable_){var t=E.Variables.getOrCreateVariablePackage(this.sourceBlock_.workspace,null,this.defaultVariableName,this.defaultType_);this.doValueUpdate_(t.getId())}},E.FieldVariable.prototype.shouldAddBorderRect_=function(){return E.FieldVariable.superClass_.shouldAddBorderRect_.call(this)&&(!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||"variables_get"!=this.sourceBlock_.type)},E.FieldVariable.prototype.fromXml=function(t){var e=t.getAttribute("id"),o=t.textContent,n=t.getAttribute("variabletype")||t.getAttribute("variableType")||"";if(e=E.Variables.getOrCreateVariablePackage(this.sourceBlock_.workspace,e,o,n),null!=n&&n!==e.type)throw Error("Serialized variable type with id '"+e.getId()+"' had type "+e.type+", and does not match variable field that references it: "+E.Xml.domToText(t)+".");this.setValue(e.getId())},E.FieldVariable.prototype.toXml=function(t){return this.initModel(),t.id=this.variable_.getId(),t.textContent=this.variable_.name,this.variable_.type&&t.setAttribute("variabletype",this.variable_.type),t},E.FieldVariable.prototype.setSourceBlock=function(t){if(t.isShadow())throw Error("Variable fields are not allowed to exist on shadow blocks.");E.FieldVariable.superClass_.setSourceBlock.call(this,t)},E.FieldVariable.prototype.getValue=function(){return this.variable_?this.variable_.getId():null},E.FieldVariable.prototype.getText=function(){return this.variable_?this.variable_.name:""},E.FieldVariable.prototype.getVariable=function(){return this.variable_},E.FieldVariable.prototype.getValidator=function(){return this.variable_?this.validator_:null},E.FieldVariable.prototype.doClassValidation_=function(t){if(null===t)return null;var e=E.Variables.getVariable(this.sourceBlock_.workspace,t);return e?(e=e.type,this.typeIsAllowed_(e)?t:(console.warn("Variable type doesn't match this field!  Type was "+e),null)):(console.warn("Variable id doesn't point to a real variable! ID was "+t),null)},E.FieldVariable.prototype.doValueUpdate_=function(t){this.variable_=E.Variables.getVariable(this.sourceBlock_.workspace,t),E.FieldVariable.superClass_.doValueUpdate_.call(this,t)},E.FieldVariable.prototype.typeIsAllowed_=function(t){var e=this.getVariableTypes_();if(!e)return!0;for(var o=0;o<e.length;o++)if(t==e[o])return!0;return!1},E.FieldVariable.prototype.getVariableTypes_=function(){var t=this.variableTypes;if(null===t&&this.sourceBlock_&&this.sourceBlock_.workspace)return this.sourceBlock_.workspace.getVariableTypes();if(0==(t=t||[""]).length)throw t=this.getText(),Error("'variableTypes' of field variable "+t+" was an empty list");return t},E.FieldVariable.prototype.setTypes_=function(t,e){if(e=e||"",null==t||null==t)t=null;else{if(!Array.isArray(t))throw Error("'variableTypes' was not an array in the definition of a FieldVariable");for(var o=!1,n=0;n<t.length;n++)t[n]==e&&(o=!0);if(!o)throw Error("Invalid default type '"+e+"' in the definition of a FieldVariable")}this.defaultType_=e,this.variableTypes=t},E.FieldVariable.prototype.refreshVariableName=function(){this.forceRerender()},E.FieldVariable.dropdownCreate=function(){if(!this.variable_)throw Error("Tried to call dropdownCreate on a variable field with no variable selected.");var t=this.getText(),e=[];if(this.sourceBlock_&&this.sourceBlock_.workspace)for(var o=this.getVariableTypes_(),n=0;n<o.length;n++){var i=this.sourceBlock_.workspace.getVariablesOfType(o[n]);e=e.concat(i)}for(e.sort(E.VariableModel.compareByName),o=[],n=0;n<e.length;n++)o[n]=[e[n].name,e[n].getId()];return o.push([E.Msg.RENAME_VARIABLE,E.RENAME_VARIABLE_ID]),E.Msg.DELETE_VARIABLE&&o.push([E.Msg.DELETE_VARIABLE.replace("%1",t),E.DELETE_VARIABLE_ID]),o},E.FieldVariable.prototype.onItemSelected_=function(t,e){if(t=e.getValue(),this.sourceBlock_&&this.sourceBlock_.workspace){if(t==E.RENAME_VARIABLE_ID)return void E.Variables.renameVariable(this.sourceBlock_.workspace,this.variable_);if(t==E.DELETE_VARIABLE_ID)return void this.sourceBlock_.workspace.deleteVariableById(this.variable_.getId())}this.setValue(t)},E.FieldVariable.prototype.referencesVariables=function(){return!0},E.fieldRegistry.register("field_variable",E.FieldVariable),E.utils.svgPaths={},E.utils.svgPaths.point=function(t,e){return" "+t+","+e+" "},E.utils.svgPaths.curve=function(t,e){return" "+t+e.join("")},E.utils.svgPaths.moveTo=function(t,e){return" M "+t+","+e+" "},E.utils.svgPaths.moveBy=function(t,e){return" m "+t+","+e+" "},E.utils.svgPaths.lineTo=function(t,e){return" l "+t+","+e+" "},E.utils.svgPaths.line=function(t){return" l"+t.join("")},E.utils.svgPaths.lineOnAxis=function(t,e){return" "+t+" "+e+" "},E.utils.svgPaths.arc=function(t,e,o,n){return t+" "+o+" "+o+" "+e+n},E.blockRendering.ConstantProvider=function(){this.NO_PADDING=0,this.SMALL_PADDING=3,this.MEDIUM_PADDING=5,this.MEDIUM_LARGE_PADDING=8,this.LARGE_PADDING=10,this.TALL_INPUT_FIELD_OFFSET_Y=this.MEDIUM_PADDING,this.TAB_HEIGHT=15,this.TAB_OFFSET_FROM_TOP=5,this.TAB_VERTICAL_OVERLAP=2.5,this.TAB_WIDTH=8,this.NOTCH_WIDTH=15,this.NOTCH_HEIGHT=4,this.MIN_BLOCK_WIDTH=12,this.EMPTY_BLOCK_SPACER_HEIGHT=16,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=this.DUMMY_INPUT_MIN_HEIGHT=this.TAB_HEIGHT,this.CORNER_RADIUS=8,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=15,this.STATEMENT_BOTTOM_SPACER=0,this.STATEMENT_INPUT_PADDING_LEFT=20,this.BETWEEN_STATEMENT_PADDING_Y=4,this.TOP_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.ADD_START_HATS=!1,this.START_HAT_HEIGHT=15,this.START_HAT_WIDTH=100,this.SPACER_DEFAULT_HEIGHT=15,this.MIN_BLOCK_HEIGHT=24,this.EMPTY_INLINE_INPUT_PADDING=14.5,this.EMPTY_INLINE_INPUT_HEIGHT=this.TAB_HEIGHT+11,this.EXTERNAL_VALUE_INPUT_PADDING=2,this.EMPTY_STATEMENT_INPUT_HEIGHT=this.MIN_BLOCK_HEIGHT,this.START_POINT=E.utils.svgPaths.moveBy(0,0),this.JAGGED_TEETH_HEIGHT=12,this.JAGGED_TEETH_WIDTH=6,this.FIELD_TEXT_FONTSIZE=11,this.FIELD_TEXT_FONTWEIGHT="normal",this.FIELD_TEXT_FONTFAMILY="sans-serif",this.FIELD_TEXT_BASELINE=this.FIELD_TEXT_HEIGHT=-1,this.FIELD_BORDER_RECT_RADIUS=4,this.FIELD_BORDER_RECT_HEIGHT=16,this.FIELD_BORDER_RECT_X_PADDING=5,this.FIELD_BORDER_RECT_Y_PADDING=3,this.FIELD_BORDER_RECT_COLOUR="#fff",this.FIELD_TEXT_BASELINE_CENTER=!E.utils.userAgent.IE&&!E.utils.userAgent.EDGE,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!1,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_DROPDOWN_SVG_ARROW_SIZE=12,this.FIELD_DROPDOWN_SVG_ARROW_DATAURI="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaGVpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLWFycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuNDEsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTDAuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNzFDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMCwxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNzlhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYzAuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMzdBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=",this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=!1,this.FIELD_COLOUR_DEFAULT_WIDTH=26,this.FIELD_COLOUR_DEFAULT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_CHECKBOX_X_OFFSET=this.FIELD_BORDER_RECT_X_PADDING-3,this.randomIdentifier=String(Math.random()).substring(2),this.embossFilterId="",this.embossFilter_=null,this.disabledPatternId="",this.disabledPattern_=null,this.debugFilterId="",this.cssNode_=this.debugFilter_=null,this.CURSOR_COLOUR="#cc0a0a",this.MARKER_COLOUR="#4286f4",this.CURSOR_WS_WIDTH=100,this.WS_CURSOR_HEIGHT=5,this.CURSOR_STACK_PADDING=10,this.CURSOR_BLOCK_PADDING=2,this.CURSOR_STROKE_WIDTH=4,this.FULL_BLOCK_FIELDS=!1,this.INSERTION_MARKER_COLOUR="#000000",this.INSERTION_MARKER_OPACITY=.2,this.SHAPES={PUZZLE:1,NOTCH:2}},E.blockRendering.ConstantProvider.prototype.init=function(){this.JAGGED_TEETH=this.makeJaggedTeeth(),this.NOTCH=this.makeNotch(),this.START_HAT=this.makeStartHat(),this.PUZZLE_TAB=this.makePuzzleTab(),this.INSIDE_CORNERS=this.makeInsideCorners(),this.OUTSIDE_CORNERS=this.makeOutsideCorners()},E.blockRendering.ConstantProvider.prototype.setTheme=function(t){this.blockStyles={};var e,o=t.blockStyles;for(e in o)this.blockStyles[e]=this.validatedBlockStyle_(o[e]);this.setDynamicProperties_(t)},E.blockRendering.ConstantProvider.prototype.setDynamicProperties_=function(t){this.setFontConstants_(t),this.setComponentConstants_(t),this.ADD_START_HATS=null!=t.startHats?t.startHats:this.ADD_START_HATS},E.blockRendering.ConstantProvider.prototype.setFontConstants_=function(t){this.FIELD_TEXT_FONTFAMILY=t.fontStyle&&null!=t.fontStyle.family?t.fontStyle.family:this.FIELD_TEXT_FONTFAMILY,this.FIELD_TEXT_FONTWEIGHT=t.fontStyle&&null!=t.fontStyle.weight?t.fontStyle.weight:this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTSIZE=t.fontStyle&&null!=t.fontStyle.size?t.fontStyle.size:this.FIELD_TEXT_FONTSIZE,t=E.utils.dom.measureFontMetrics("Hg",this.FIELD_TEXT_FONTSIZE+"pt",this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTFAMILY),this.FIELD_TEXT_HEIGHT=t.height,this.FIELD_TEXT_BASELINE=t.baseline},E.blockRendering.ConstantProvider.prototype.setComponentConstants_=function(t){this.CURSOR_COLOUR=t.getComponentStyle("cursorColour")||this.CURSOR_COLOUR,this.MARKER_COLOUR=t.getComponentStyle("markerColour")||this.MARKER_COLOUR,this.INSERTION_MARKER_COLOUR=t.getComponentStyle("insertionMarkerColour")||this.INSERTION_MARKER_COLOUR,this.INSERTION_MARKER_OPACITY=Number(t.getComponentStyle("insertionMarkerOpacity"))||this.INSERTION_MARKER_OPACITY},E.blockRendering.ConstantProvider.prototype.getBlockStyleForColour=function(t){var e="auto_"+t;return this.blockStyles[e]||(this.blockStyles[e]=this.createBlockStyle_(t)),{style:this.blockStyles[e],name:e}},E.blockRendering.ConstantProvider.prototype.getBlockStyle=function(t){return this.blockStyles[t||""]||(t&&0==t.indexOf("auto_")?this.getBlockStyleForColour(t.substring(5)).style:this.createBlockStyle_("#000000"))},E.blockRendering.ConstantProvider.prototype.createBlockStyle_=function(t){return this.validatedBlockStyle_({colourPrimary:t})},E.blockRendering.ConstantProvider.prototype.validatedBlockStyle_=function(t){var e={};return t&&E.utils.object.mixin(e,t),t=E.utils.parseBlockColour(e.colourPrimary||"#000"),e.colourPrimary=t.hex,e.colourSecondary=e.colourSecondary?E.utils.parseBlockColour(e.colourSecondary).hex:this.generateSecondaryColour_(e.colourPrimary),e.colourTertiary=e.colourTertiary?E.utils.parseBlockColour(e.colourTertiary).hex:this.generateTertiaryColour_(e.colourPrimary),e.hat=e.hat||"",e},E.blockRendering.ConstantProvider.prototype.generateSecondaryColour_=function(t){return E.utils.colour.blend("#fff",t,.6)||t},E.blockRendering.ConstantProvider.prototype.generateTertiaryColour_=function(t){return E.utils.colour.blend("#fff",t,.3)||t},E.blockRendering.ConstantProvider.prototype.dispose=function(){this.embossFilter_&&E.utils.dom.removeNode(this.embossFilter_),this.disabledPattern_&&E.utils.dom.removeNode(this.disabledPattern_),this.debugFilter_&&E.utils.dom.removeNode(this.debugFilter_),this.cssNode_=null},E.blockRendering.ConstantProvider.prototype.makeJaggedTeeth=function(){var t=this.JAGGED_TEETH_HEIGHT,e=this.JAGGED_TEETH_WIDTH;return{height:t,width:e,path:E.utils.svgPaths.line([E.utils.svgPaths.point(e,t/4),E.utils.svgPaths.point(2*-e,t/2),E.utils.svgPaths.point(e,t/4)])}},E.blockRendering.ConstantProvider.prototype.makeStartHat=function(){var t=this.START_HAT_HEIGHT,e=this.START_HAT_WIDTH;return{height:t,width:e,path:E.utils.svgPaths.curve("c",[E.utils.svgPaths.point(30,-t),E.utils.svgPaths.point(70,-t),E.utils.svgPaths.point(e,0)])}},E.blockRendering.ConstantProvider.prototype.makePuzzleTab=function(){function t(t){var e=-(t=t?-1:1),o=a/2,n=o+2.5,i=o+.5,r=E.utils.svgPaths.point(-s,t*o);return o=E.utils.svgPaths.point(s,t*o),E.utils.svgPaths.curve("c",[E.utils.svgPaths.point(0,t*n),E.utils.svgPaths.point(-s,e*i),r])+E.utils.svgPaths.curve("s",[E.utils.svgPaths.point(s,2.5*e),o])}var s=this.TAB_WIDTH,a=this.TAB_HEIGHT,e=t(!0),o=t(!1);return{type:this.SHAPES.PUZZLE,width:s,height:a,pathDown:o,pathUp:e}},E.blockRendering.ConstantProvider.prototype.makeNotch=function(){function t(t){return E.utils.svgPaths.line([E.utils.svgPaths.point(t*n,o),E.utils.svgPaths.point(3*t,0),E.utils.svgPaths.point(t*n,-o)])}var e=this.NOTCH_WIDTH,o=this.NOTCH_HEIGHT,n=(e-3)/2,i=t(1),r=t(-1);return{type:this.SHAPES.NOTCH,width:e,height:o,pathLeft:i,pathRight:r}},E.blockRendering.ConstantProvider.prototype.makeInsideCorners=function(){var t=this.CORNER_RADIUS;return{width:t,height:t,pathTop:E.utils.svgPaths.arc("a","0 0,0",t,E.utils.svgPaths.point(-t,t)),pathBottom:E.utils.svgPaths.arc("a","0 0,0",t,E.utils.svgPaths.point(t,t))}},E.blockRendering.ConstantProvider.prototype.makeOutsideCorners=function(){var t=this.CORNER_RADIUS,e=E.utils.svgPaths.moveBy(0,t)+E.utils.svgPaths.arc("a","0 0,1",t,E.utils.svgPaths.point(t,-t)),o=E.utils.svgPaths.arc("a","0 0,1",t,E.utils.svgPaths.point(t,t)),n=E.utils.svgPaths.arc("a","0 0,1",t,E.utils.svgPaths.point(-t,-t));return{topLeft:e,topRight:o,bottomRight:E.utils.svgPaths.arc("a","0 0,1",t,E.utils.svgPaths.point(-t,t)),bottomLeft:n,rightHeight:t}},E.blockRendering.ConstantProvider.prototype.shapeFor=function(t){switch(t.type){case E.INPUT_VALUE:case E.OUTPUT_VALUE:return this.PUZZLE_TAB;case E.PREVIOUS_STATEMENT:case E.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown connection type")}},E.blockRendering.ConstantProvider.prototype.createDom=function(t,e,o){this.injectCSS_(e,o),t=E.utils.dom.createSvgElement(E.utils.Svg.DEFS,{},t),e=E.utils.dom.createSvgElement(E.utils.Svg.FILTER,{id:"blocklyEmbossFilter"+this.randomIdentifier},t),E.utils.dom.createSvgElement(E.utils.Svg.FEGAUSSIANBLUR,{in:"SourceAlpha",stdDeviation:1,result:"blur"},e),o=E.utils.dom.createSvgElement(E.utils.Svg.FESPECULARLIGHTING,{in:"blur",surfaceScale:1,specularConstant:.5,specularExponent:10,"lighting-color":"white",result:"specOut"},e),E.utils.dom.createSvgElement(E.utils.Svg.FEPOINTLIGHT,{x:-5e3,y:-1e4,z:2e4},o),E.utils.dom.createSvgElement(E.utils.Svg.FECOMPOSITE,{in:"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"},e),E.utils.dom.createSvgElement(E.utils.Svg.FECOMPOSITE,{in:"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0},e),this.embossFilterId=e.id,this.embossFilter_=e,e=E.utils.dom.createSvgElement(E.utils.Svg.PATTERN,{id:"blocklyDisabledPattern"+this.randomIdentifier,patternUnits:"userSpaceOnUse",width:10,height:10},t),E.utils.dom.createSvgElement(E.utils.Svg.RECT,{width:10,height:10,fill:"#aaa"},e),E.utils.dom.createSvgElement(E.utils.Svg.PATH,{d:"M 0 0 L 10 10 M 10 0 L 0 10",stroke:"#cc0"},e),this.disabledPatternId=e.id,this.disabledPattern_=e,E.blockRendering.Debug&&(t=E.utils.dom.createSvgElement(E.utils.Svg.FILTER,{id:"blocklyDebugFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},t),e=E.utils.dom.createSvgElement(E.utils.Svg.FECOMPONENTTRANSFER,{result:"outBlur"},t),E.utils.dom.createSvgElement(E.utils.Svg.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},e),E.utils.dom.createSvgElement(E.utils.Svg.FEFLOOD,{"flood-color":"#ff0000","flood-opacity":.5,result:"outColor"},t),E.utils.dom.createSvgElement(E.utils.Svg.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),this.debugFilterId=t.id,this.debugFilter_=t)},E.blockRendering.ConstantProvider.prototype.injectCSS_=function(t,e){e=this.getCSS_(e),t="blockly-renderer-style-"+t,this.cssNode_=document.getElementById(t);var o=e.join("\n");this.cssNode_?this.cssNode_.firstChild.textContent=o:((e=document.createElement("style")).id=t,t=document.createTextNode(o),e.appendChild(t),document.head.insertBefore(e,document.head.firstChild),this.cssNode_=e)},E.blockRendering.ConstantProvider.prototype.getCSS_=function(t){return[t+" .blocklyText, ",t+" .blocklyFlyoutLabelText {","font: "+this.FIELD_TEXT_FONTWEIGHT+" "+this.FIELD_TEXT_FONTSIZE+"pt "+this.FIELD_TEXT_FONTFAMILY+";","}",t+" .blocklyText {","fill: #fff;","}",t+" .blocklyNonEditableText>rect,",t+" .blocklyEditableText>rect {","fill: "+this.FIELD_BORDER_RECT_COLOUR+";","fill-opacity: .6;","stroke: none;","}",t+" .blocklyNonEditableText>text,",t+" .blocklyEditableText>text {","fill: #000;","}",t+" .blocklyFlyoutLabelText {","fill: #000;","}",t+" .blocklyText.blocklyBubbleText {","fill: #000;","}",t+" .blocklyEditableText:not(.editing):hover>rect {","stroke: #fff;","stroke-width: 2;","}",t+" .blocklyHtmlInput {","font-family: "+this.FIELD_TEXT_FONTFAMILY+";","font-weight: "+this.FIELD_TEXT_FONTWEIGHT+";","}",t+" .blocklySelected>.blocklyPath {","stroke: #fc3;","stroke-width: 3px;","}",t+" .blocklyHighlightedConnectionPath {","stroke: #fc3;","}",t+" .blocklyReplaceable .blocklyPath {","fill-opacity: .5;","}",t+" .blocklyReplaceable .blocklyPathLight,",t+" .blocklyReplaceable .blocklyPathDark {","display: none;","}",t+" .blocklyInsertionMarker>.blocklyPath {","fill-opacity: "+this.INSERTION_MARKER_OPACITY+";","stroke: none;","}"]},E.blockRendering.MarkerSvg=function(t,e,o){this.workspace_=t,this.marker_=o,this.parent_=null,this.constants_=e,this.currentMarkerSvg=null,t=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR,this.colour_=o.colour||t},E.blockRendering.MarkerSvg.CURSOR_CLASS="blocklyCursor",E.blockRendering.MarkerSvg.MARKER_CLASS="blocklyMarker",E.blockRendering.MarkerSvg.HEIGHT_MULTIPLIER=.75,E.blockRendering.MarkerSvg.prototype.getSvgRoot=function(){return this.svgGroup_},E.blockRendering.MarkerSvg.prototype.getMarker=function(){return this.marker_},E.blockRendering.MarkerSvg.prototype.isCursor=function(){return"cursor"==this.marker_.type},E.blockRendering.MarkerSvg.prototype.createDom=function(){var t=this.isCursor()?E.blockRendering.MarkerSvg.CURSOR_CLASS:E.blockRendering.MarkerSvg.MARKER_CLASS;return this.svgGroup_=E.utils.dom.createSvgElement(E.utils.Svg.G,{class:t},null),this.createDomInternal_(),this.svgGroup_},E.blockRendering.MarkerSvg.prototype.setParent_=function(t){this.isCursor()?(this.parent_&&this.parent_.setCursorSvg(null),t.setCursorSvg(this.getSvgRoot())):(this.parent_&&this.parent_.setMarkerSvg(null),t.setMarkerSvg(this.getSvgRoot())),this.parent_=t},E.blockRendering.MarkerSvg.prototype.draw=function(t,e){if(e){this.constants_=this.workspace_.getRenderer().getConstants();var o=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR;this.colour_=this.marker_.colour||o,this.applyColour_(e),this.showAtLocation_(e),this.fireMarkerEvent_(t,e),void 0!==(t=this.currentMarkerSvg.childNodes[0])&&t.beginElement&&t.beginElement()}else this.hide()},E.blockRendering.MarkerSvg.prototype.showAtLocation_=function(t){var e=t.getLocation();t.getType()==E.ASTNode.types.BLOCK?this.showWithBlock_(t):t.getType()==E.ASTNode.types.OUTPUT?this.showWithOutput_(t):e.type==E.INPUT_VALUE?this.showWithInput_(t):e.type==E.NEXT_STATEMENT?this.showWithNext_(t):t.getType()==E.ASTNode.types.PREVIOUS?this.showWithPrevious_(t):t.getType()==E.ASTNode.types.FIELD?this.showWithField_(t):t.getType()==E.ASTNode.types.WORKSPACE?this.showWithCoordinates_(t):t.getType()==E.ASTNode.types.STACK&&this.showWithStack_(t)},E.blockRendering.MarkerSvg.prototype.showWithBlockPrevOutput_=function(t){var e=(t=t.getSourceBlock()).width,o=t.height,n=o*E.blockRendering.MarkerSvg.HEIGHT_MULTIPLIER,i=this.constants_.CURSOR_BLOCK_PADDING;if(t.previousConnection){var r=this.constants_.shapeFor(t.previousConnection);this.positionPrevious_(e,i,n,r)}else t.outputConnection?(r=this.constants_.shapeFor(t.outputConnection),this.positionOutput_(e,o,r)):this.positionBlock_(e,i,n);this.setParent_(t),this.showCurrent_()},E.blockRendering.MarkerSvg.prototype.showWithBlock_=function(t){this.showWithBlockPrevOutput_(t)},E.blockRendering.MarkerSvg.prototype.showWithPrevious_=function(t){this.showWithBlockPrevOutput_(t)},E.blockRendering.MarkerSvg.prototype.showWithOutput_=function(t){this.showWithBlockPrevOutput_(t)},E.blockRendering.MarkerSvg.prototype.showWithCoordinates_=function(t){var e=t.getWsCoordinate();t=e.x,e=e.y,this.workspace_.RTL&&(t-=this.constants_.CURSOR_WS_WIDTH),this.positionLine_(t,e,this.constants_.CURSOR_WS_WIDTH),this.setParent_(this.workspace_),this.showCurrent_()},E.blockRendering.MarkerSvg.prototype.showWithField_=function(t){var e=(t=t.getLocation()).getSize().width,o=t.getSize().height;this.positionRect_(0,0,e,o),this.setParent_(t),this.showCurrent_()},E.blockRendering.MarkerSvg.prototype.showWithInput_=function(t){var e=(t=t.getLocation()).getSourceBlock();this.positionInput_(t),this.setParent_(e),this.showCurrent_()},E.blockRendering.MarkerSvg.prototype.showWithNext_=function(t){var e=t.getLocation();t=e.getSourceBlock();var o=0;e=e.getOffsetInBlock().y;var n=t.getHeightWidth().width;this.workspace_.RTL&&(o=-n),this.positionLine_(o,e,n),this.setParent_(t),this.showCurrent_()},E.blockRendering.MarkerSvg.prototype.showWithStack_=function(t){var e=(t=t.getLocation()).getHeightWidth(),o=e.width+this.constants_.CURSOR_STACK_PADDING;e=e.height+this.constants_.CURSOR_STACK_PADDING;var n=-this.constants_.CURSOR_STACK_PADDING/2,i=-this.constants_.CURSOR_STACK_PADDING/2,r=n;this.workspace_.RTL&&(r=-(o+n)),this.positionRect_(r,i,o,e),this.setParent_(t),this.showCurrent_()},E.blockRendering.MarkerSvg.prototype.showCurrent_=function(){this.hide(),this.currentMarkerSvg.style.display=""},E.blockRendering.MarkerSvg.prototype.positionBlock_=function(t,e,o){t=E.utils.svgPaths.moveBy(-e,o)+E.utils.svgPaths.lineOnAxis("V",-e)+E.utils.svgPaths.lineOnAxis("H",t+2*e)+E.utils.svgPaths.lineOnAxis("V",o),this.markerBlock_.setAttribute("d",t),this.workspace_.RTL&&this.flipRtl_(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_},E.blockRendering.MarkerSvg.prototype.positionInput_=function(t){var e=t.getOffsetInBlock().x,o=t.getOffsetInBlock().y;t=E.utils.svgPaths.moveTo(0,0)+this.constants_.shapeFor(t).pathDown,this.markerInput_.setAttribute("d",t),this.markerInput_.setAttribute("transform","translate("+e+","+o+")"+(this.workspace_.RTL?" scale(-1 1)":"")),this.currentMarkerSvg=this.markerInput_},E.blockRendering.MarkerSvg.prototype.positionLine_=function(t,e,o){this.markerSvgLine_.setAttribute("x",t),this.markerSvgLine_.setAttribute("y",e),this.markerSvgLine_.setAttribute("width",o),this.currentMarkerSvg=this.markerSvgLine_},E.blockRendering.MarkerSvg.prototype.positionOutput_=function(t,e,o){t=E.utils.svgPaths.moveBy(t,0)+E.utils.svgPaths.lineOnAxis("h",-(t-o.width))+E.utils.svgPaths.lineOnAxis("v",this.constants_.TAB_OFFSET_FROM_TOP)+o.pathDown+E.utils.svgPaths.lineOnAxis("V",e)+E.utils.svgPaths.lineOnAxis("H",t),this.markerBlock_.setAttribute("d",t),this.workspace_.RTL&&this.flipRtl_(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_},E.blockRendering.MarkerSvg.prototype.positionPrevious_=function(t,e,o,n){t=E.utils.svgPaths.moveBy(-e,o)+E.utils.svgPaths.lineOnAxis("V",-e)+E.utils.svgPaths.lineOnAxis("H",this.constants_.NOTCH_OFFSET_LEFT)+n.pathLeft+E.utils.svgPaths.lineOnAxis("H",t+2*e)+E.utils.svgPaths.lineOnAxis("V",o),this.markerBlock_.setAttribute("d",t),this.workspace_.RTL&&this.flipRtl_(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_},E.blockRendering.MarkerSvg.prototype.positionRect_=function(t,e,o,n){this.markerSvgRect_.setAttribute("x",t),this.markerSvgRect_.setAttribute("y",e),this.markerSvgRect_.setAttribute("width",o),this.markerSvgRect_.setAttribute("height",n),this.currentMarkerSvg=this.markerSvgRect_},E.blockRendering.MarkerSvg.prototype.flipRtl_=function(t){t.setAttribute("transform","scale(-1 1)")},E.blockRendering.MarkerSvg.prototype.hide=function(){this.markerSvgLine_.style.display="none",this.markerSvgRect_.style.display="none",this.markerInput_.style.display="none",this.markerBlock_.style.display="none"},E.blockRendering.MarkerSvg.prototype.fireMarkerEvent_=function(t,e){var o=e.getSourceBlock(),n=this.isCursor()?"cursorMove":"markerMove";t=new E.Events.Ui(o,n,t,e),e.getType()==E.ASTNode.types.WORKSPACE&&(t.workspaceId=e.getLocation().id),E.Events.fire(t)},E.blockRendering.MarkerSvg.prototype.getBlinkProperties_=function(){return{attributeType:"XML",attributeName:"fill",dur:"1s",values:this.colour_+";transparent;transparent;",repeatCount:"indefinite"}},E.blockRendering.MarkerSvg.prototype.createDomInternal_=function(){if(this.markerSvg_=E.utils.dom.createSvgElement(E.utils.Svg.G,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT},this.svgGroup_),this.markerSvgLine_=E.utils.dom.createSvgElement(E.utils.Svg.RECT,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT,style:"display: none"},this.markerSvg_),this.markerSvgRect_=E.utils.dom.createSvgElement(E.utils.Svg.RECT,{class:"blocklyVerticalMarker",rx:10,ry:10,style:"display: none"},this.markerSvg_),this.markerInput_=E.utils.dom.createSvgElement(E.utils.Svg.PATH,{transform:"",style:"display: none"},this.markerSvg_),this.markerBlock_=E.utils.dom.createSvgElement(E.utils.Svg.PATH,{transform:"",style:"display: none",fill:"none","stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.isCursor()){var t=this.getBlinkProperties_();E.utils.dom.createSvgElement(E.utils.Svg.ANIMATE,t,this.markerSvgLine_),E.utils.dom.createSvgElement(E.utils.Svg.ANIMATE,t,this.markerInput_),t.attributeName="stroke",E.utils.dom.createSvgElement(E.utils.Svg.ANIMATE,t,this.markerBlock_)}return this.markerSvg_},E.blockRendering.MarkerSvg.prototype.applyColour_=function(t){this.markerSvgLine_.setAttribute("fill",this.colour_),this.markerSvgRect_.setAttribute("stroke",this.colour_),this.markerInput_.setAttribute("fill",this.colour_),this.markerBlock_.setAttribute("stroke",this.colour_),this.isCursor()&&(t=this.colour_+";transparent;transparent;",this.markerSvgLine_.firstChild.setAttribute("values",t),this.markerInput_.firstChild.setAttribute("values",t),this.markerBlock_.firstChild.setAttribute("values",t))},E.blockRendering.MarkerSvg.prototype.dispose=function(){this.svgGroup_&&E.utils.dom.removeNode(this.svgGroup_)},E.blockRendering.Types={NONE:0,FIELD:1,HAT:2,ICON:4,SPACER:8,BETWEEN_ROW_SPACER:16,IN_ROW_SPACER:32,EXTERNAL_VALUE_INPUT:64,INPUT:128,INLINE_INPUT:256,STATEMENT_INPUT:512,CONNECTION:1024,PREVIOUS_CONNECTION:2048,NEXT_CONNECTION:4096,OUTPUT_CONNECTION:8192,CORNER:16384,LEFT_SQUARE_CORNER:32768,LEFT_ROUND_CORNER:65536,RIGHT_SQUARE_CORNER:131072,RIGHT_ROUND_CORNER:262144,JAGGED_EDGE:524288,ROW:1048576,TOP_ROW:2097152,BOTTOM_ROW:4194304,INPUT_ROW:8388608},E.blockRendering.Types.LEFT_CORNER=E.blockRendering.Types.LEFT_SQUARE_CORNER|E.blockRendering.Types.LEFT_ROUND_CORNER,E.blockRendering.Types.RIGHT_CORNER=E.blockRendering.Types.RIGHT_SQUARE_CORNER|E.blockRendering.Types.RIGHT_ROUND_CORNER,E.blockRendering.Types.nextTypeValue_=16777216,E.blockRendering.Types.getType=function(t){return Object.prototype.hasOwnProperty.call(E.blockRendering.Types,t)||(E.blockRendering.Types[t]=E.blockRendering.Types.nextTypeValue_,E.blockRendering.Types.nextTypeValue_<<=1),E.blockRendering.Types[t]},E.blockRendering.Types.isField=function(t){return t.type&E.blockRendering.Types.FIELD},E.blockRendering.Types.isHat=function(t){return t.type&E.blockRendering.Types.HAT},E.blockRendering.Types.isIcon=function(t){return t.type&E.blockRendering.Types.ICON},E.blockRendering.Types.isSpacer=function(t){return t.type&E.blockRendering.Types.SPACER},E.blockRendering.Types.isInRowSpacer=function(t){return t.type&E.blockRendering.Types.IN_ROW_SPACER},E.blockRendering.Types.isInput=function(t){return t.type&E.blockRendering.Types.INPUT},E.blockRendering.Types.isExternalInput=function(t){return t.type&E.blockRendering.Types.EXTERNAL_VALUE_INPUT},E.blockRendering.Types.isInlineInput=function(t){return t.type&E.blockRendering.Types.INLINE_INPUT},E.blockRendering.Types.isStatementInput=function(t){return t.type&E.blockRendering.Types.STATEMENT_INPUT},E.blockRendering.Types.isPreviousConnection=function(t){return t.type&E.blockRendering.Types.PREVIOUS_CONNECTION},E.blockRendering.Types.isNextConnection=function(t){return t.type&E.blockRendering.Types.NEXT_CONNECTION},E.blockRendering.Types.isPreviousOrNextConnection=function(t){return t.type&(E.blockRendering.Types.PREVIOUS_CONNECTION|E.blockRendering.Types.NEXT_CONNECTION)},E.blockRendering.Types.isLeftRoundedCorner=function(t){return t.type&E.blockRendering.Types.LEFT_ROUND_CORNER},E.blockRendering.Types.isRightRoundedCorner=function(t){return t.type&E.blockRendering.Types.RIGHT_ROUND_CORNER},E.blockRendering.Types.isLeftSquareCorner=function(t){return t.type&E.blockRendering.Types.LEFT_SQUARE_CORNER},E.blockRendering.Types.isRightSquareCorner=function(t){return t.type&E.blockRendering.Types.RIGHT_SQUARE_CORNER},E.blockRendering.Types.isCorner=function(t){return t.type&E.blockRendering.Types.CORNER},E.blockRendering.Types.isJaggedEdge=function(t){return t.type&E.blockRendering.Types.JAGGED_EDGE},E.blockRendering.Types.isRow=function(t){return t.type&E.blockRendering.Types.ROW},E.blockRendering.Types.isBetweenRowSpacer=function(t){return t.type&E.blockRendering.Types.BETWEEN_ROW_SPACER},E.blockRendering.Types.isTopRow=function(t){return t.type&E.blockRendering.Types.TOP_ROW},E.blockRendering.Types.isBottomRow=function(t){return t.type&E.blockRendering.Types.BOTTOM_ROW},E.blockRendering.Types.isTopOrBottomRow=function(t){return t.type&(E.blockRendering.Types.TOP_ROW|E.blockRendering.Types.BOTTOM_ROW)},E.blockRendering.Types.isInputRow=function(t){return t.type&E.blockRendering.Types.INPUT_ROW},E.blockRendering.Measurable=function(t){this.height=this.width=0,this.type=E.blockRendering.Types.NONE,this.centerline=this.xPos=0,this.constants_=t,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT},E.blockRendering.Connection=function(t,e){E.blockRendering.Connection.superClass_.constructor.call(this,t),this.connectionModel=e,this.shape=this.constants_.shapeFor(e),this.isDynamicShape=!!this.shape.isDynamic,this.type|=E.blockRendering.Types.CONNECTION},E.utils.object.inherits(E.blockRendering.Connection,E.blockRendering.Measurable),E.blockRendering.OutputConnection=function(t,e){E.blockRendering.OutputConnection.superClass_.constructor.call(this,t,e),this.type|=E.blockRendering.Types.OUTPUT_CONNECTION,this.height=this.isDynamicShape?0:this.shape.height,this.startX=this.width=this.isDynamicShape?0:this.shape.width,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionOffsetX=0},E.utils.object.inherits(E.blockRendering.OutputConnection,E.blockRendering.Connection),E.blockRendering.PreviousConnection=function(t,e){E.blockRendering.PreviousConnection.superClass_.constructor.call(this,t,e),this.type|=E.blockRendering.Types.PREVIOUS_CONNECTION,this.height=this.shape.height,this.width=this.shape.width},E.utils.object.inherits(E.blockRendering.PreviousConnection,E.blockRendering.Connection),E.blockRendering.NextConnection=function(t,e){E.blockRendering.NextConnection.superClass_.constructor.call(this,t,e),this.type|=E.blockRendering.Types.NEXT_CONNECTION,this.height=this.shape.height,this.width=this.shape.width},E.utils.object.inherits(E.blockRendering.NextConnection,E.blockRendering.Connection),E.blockRendering.InputConnection=function(t,e){E.blockRendering.InputConnection.superClass_.constructor.call(this,t,e.connection),this.type|=E.blockRendering.Types.INPUT,this.input=e,this.align=e.align,(this.connectedBlock=e.connection&&e.connection.targetBlock()?e.connection.targetBlock():null)?(t=this.connectedBlock.getHeightWidth(),this.connectedBlockWidth=t.width,this.connectedBlockHeight=t.height):this.connectedBlockHeight=this.connectedBlockWidth=0,this.connectionOffsetY=this.connectionOffsetX=0},E.utils.object.inherits(E.blockRendering.InputConnection,E.blockRendering.Connection),E.blockRendering.InlineInput=function(t,e){E.blockRendering.InlineInput.superClass_.constructor.call(this,t,e),this.type|=E.blockRendering.Types.INLINE_INPUT,this.connectedBlock?(this.width=this.connectedBlockWidth,this.height=this.connectedBlockHeight):(this.height=this.constants_.EMPTY_INLINE_INPUT_HEIGHT,this.width=this.constants_.EMPTY_INLINE_INPUT_PADDING),this.connectionHeight=this.isDynamicShape?this.shape.height(this.height):this.shape.height,this.connectionWidth=this.isDynamicShape?this.shape.width(this.height):this.shape.width,this.connectedBlock||(this.width+=this.connectionWidth*(this.isDynamicShape?2:1)),this.connectionOffsetY=this.isDynamicShape?this.shape.connectionOffsetY(this.connectionHeight):this.constants_.TAB_OFFSET_FROM_TOP,this.connectionOffsetX=this.isDynamicShape?this.shape.connectionOffsetX(this.connectionWidth):0},E.utils.object.inherits(E.blockRendering.InlineInput,E.blockRendering.InputConnection),E.blockRendering.StatementInput=function(t,e){E.blockRendering.StatementInput.superClass_.constructor.call(this,t,e),this.type|=E.blockRendering.Types.STATEMENT_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight+this.constants_.STATEMENT_BOTTOM_SPACER:this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT,this.width=this.constants_.STATEMENT_INPUT_NOTCH_OFFSET+this.shape.width},E.utils.object.inherits(E.blockRendering.StatementInput,E.blockRendering.InputConnection),E.blockRendering.ExternalValueInput=function(t,e){E.blockRendering.ExternalValueInput.superClass_.constructor.call(this,t,e),this.type|=E.blockRendering.Types.EXTERNAL_VALUE_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight-this.constants_.TAB_OFFSET_FROM_TOP-this.constants_.MEDIUM_PADDING:this.shape.height,this.width=this.shape.width+this.constants_.EXTERNAL_VALUE_INPUT_PADDING,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionHeight=this.shape.height,this.connectionWidth=this.shape.width},E.utils.object.inherits(E.blockRendering.ExternalValueInput,E.blockRendering.InputConnection),E.blockRendering.Icon=function(t,e){E.blockRendering.Icon.superClass_.constructor.call(this,t),this.icon=e,this.isVisible=e.isVisible(),this.type|=E.blockRendering.Types.ICON,t=e.getCorrectedSize(),this.height=t.height,this.width=t.width},E.utils.object.inherits(E.blockRendering.Icon,E.blockRendering.Measurable),E.blockRendering.JaggedEdge=function(t){E.blockRendering.JaggedEdge.superClass_.constructor.call(this,t),this.type|=E.blockRendering.Types.JAGGED_EDGE,this.height=this.constants_.JAGGED_TEETH.height,this.width=this.constants_.JAGGED_TEETH.width},E.utils.object.inherits(E.blockRendering.JaggedEdge,E.blockRendering.Measurable),E.blockRendering.Field=function(t,e,o){E.blockRendering.Field.superClass_.constructor.call(this,t),this.field=e,this.isEditable=e.EDITABLE,this.flipRtl=e.getFlipRtl(),this.type|=E.blockRendering.Types.FIELD,t=this.field.getSize(),this.height=t.height,this.width=t.width,this.parentInput=o},E.utils.object.inherits(E.blockRendering.Field,E.blockRendering.Measurable),E.blockRendering.Hat=function(t){E.blockRendering.Hat.superClass_.constructor.call(this,t),this.type|=E.blockRendering.Types.HAT,this.height=this.constants_.START_HAT.height,this.width=this.constants_.START_HAT.width,this.ascenderHeight=this.height},E.utils.object.inherits(E.blockRendering.Hat,E.blockRendering.Measurable),E.blockRendering.SquareCorner=function(t,e){E.blockRendering.SquareCorner.superClass_.constructor.call(this,t),this.type=(e&&"left"!=e?E.blockRendering.Types.RIGHT_SQUARE_CORNER:E.blockRendering.Types.LEFT_SQUARE_CORNER)|E.blockRendering.Types.CORNER,this.width=this.height=this.constants_.NO_PADDING},E.utils.object.inherits(E.blockRendering.SquareCorner,E.blockRendering.Measurable),E.blockRendering.RoundCorner=function(t,e){E.blockRendering.RoundCorner.superClass_.constructor.call(this,t),this.type=(e&&"left"!=e?E.blockRendering.Types.RIGHT_ROUND_CORNER:E.blockRendering.Types.LEFT_ROUND_CORNER)|E.blockRendering.Types.CORNER,this.width=this.constants_.CORNER_RADIUS,this.height=this.constants_.CORNER_RADIUS/2},E.utils.object.inherits(E.blockRendering.RoundCorner,E.blockRendering.Measurable),E.blockRendering.InRowSpacer=function(t,e){E.blockRendering.InRowSpacer.superClass_.constructor.call(this,t),this.type=this.type|E.blockRendering.Types.SPACER|E.blockRendering.Types.IN_ROW_SPACER,this.width=e,this.height=this.constants_.SPACER_DEFAULT_HEIGHT},E.utils.object.inherits(E.blockRendering.InRowSpacer,E.blockRendering.Measurable),E.blockRendering.Row=function(t){this.type=E.blockRendering.Types.ROW,this.elements=[],this.xPos=this.yPos=this.widthWithConnectedBlocks=this.minWidth=this.minHeight=this.width=this.height=0,this.hasJaggedEdge=this.hasDummyInput=this.hasInlineInput=this.hasStatement=this.hasExternalInput=!1,this.constants_=t,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT,this.align=null},E.blockRendering.Row.prototype.measure=function(){throw Error("Unexpected attempt to measure a base Row.")},E.blockRendering.Row.prototype.getLastInput=function(){for(var t,e=this.elements.length-1;t=this.elements[e];e--)if(E.blockRendering.Types.isInput(t))return t;return null},E.blockRendering.Row.prototype.startsWithElemSpacer=function(){return!0},E.blockRendering.Row.prototype.endsWithElemSpacer=function(){return!0},E.blockRendering.Row.prototype.getFirstSpacer=function(){for(var t,e=0;t=this.elements[e];e++)if(E.blockRendering.Types.isSpacer(t))return t;return null},E.blockRendering.Row.prototype.getLastSpacer=function(){for(var t,e=this.elements.length-1;t=this.elements[e];e--)if(E.blockRendering.Types.isSpacer(t))return t;return null},E.blockRendering.TopRow=function(t){E.blockRendering.TopRow.superClass_.constructor.call(this,t),this.type|=E.blockRendering.Types.TOP_ROW,this.ascenderHeight=this.capline=0,this.hasPreviousConnection=!1,this.connection=null},E.utils.object.inherits(E.blockRendering.TopRow,E.blockRendering.Row),E.blockRendering.TopRow.prototype.hasLeftSquareCorner=function(t){var e=(t.hat?"cap"===t.hat:this.constants_.ADD_START_HATS)&&!t.outputConnection&&!t.previousConnection,o=t.getPreviousBlock();return!!t.outputConnection||e||!!o&&o.getNextBlock()==t},E.blockRendering.TopRow.prototype.hasRightSquareCorner=function(t){return!0},E.blockRendering.TopRow.prototype.measure=function(){for(var t,e=0,o=0,n=0,i=0;t=this.elements[i];i++)o+=t.width,E.blockRendering.Types.isSpacer(t)||(E.blockRendering.Types.isHat(t)?n=Math.max(n,t.ascenderHeight):e=Math.max(e,t.height));this.width=Math.max(this.minWidth,o),this.height=Math.max(this.minHeight,e)+n,this.capline=this.ascenderHeight=n,this.widthWithConnectedBlocks=this.width},E.blockRendering.TopRow.prototype.startsWithElemSpacer=function(){return!1},E.blockRendering.TopRow.prototype.endsWithElemSpacer=function(){return!1},E.blockRendering.BottomRow=function(t){E.blockRendering.BottomRow.superClass_.constructor.call(this,t),this.type|=E.blockRendering.Types.BOTTOM_ROW,this.hasNextConnection=!1,this.connection=null,this.baseline=this.descenderHeight=0},E.utils.object.inherits(E.blockRendering.BottomRow,E.blockRendering.Row),E.blockRendering.BottomRow.prototype.hasLeftSquareCorner=function(t){return!!t.outputConnection||!!t.getNextBlock()},E.blockRendering.BottomRow.prototype.hasRightSquareCorner=function(t){return!0},E.blockRendering.BottomRow.prototype.measure=function(){for(var t,e=0,o=0,n=0,i=0;t=this.elements[i];i++)o+=t.width,E.blockRendering.Types.isSpacer(t)||(E.blockRendering.Types.isNextConnection(t)?n=Math.max(n,t.height):e=Math.max(e,t.height));this.width=Math.max(this.minWidth,o),this.height=Math.max(this.minHeight,e)+n,this.descenderHeight=n,this.widthWithConnectedBlocks=this.width},E.blockRendering.BottomRow.prototype.startsWithElemSpacer=function(){return!1},E.blockRendering.BottomRow.prototype.endsWithElemSpacer=function(){return!1},E.blockRendering.SpacerRow=function(t,e,o){E.blockRendering.SpacerRow.superClass_.constructor.call(this,t),this.type=this.type|E.blockRendering.Types.SPACER|E.blockRendering.Types.BETWEEN_ROW_SPACER,this.width=o,this.height=e,this.followsStatement=!1,this.widthWithConnectedBlocks=0,this.elements=[new E.blockRendering.InRowSpacer(this.constants_,o)]},E.utils.object.inherits(E.blockRendering.SpacerRow,E.blockRendering.Row),E.blockRendering.SpacerRow.prototype.measure=function(){},E.blockRendering.InputRow=function(t){E.blockRendering.InputRow.superClass_.constructor.call(this,t),this.type|=E.blockRendering.Types.INPUT_ROW,this.connectedBlockWidths=0},E.utils.object.inherits(E.blockRendering.InputRow,E.blockRendering.Row),E.blockRendering.InputRow.prototype.measure=function(){this.width=this.minWidth,this.height=this.minHeight;for(var t,e=0,o=0;t=this.elements[o];o++)this.width+=t.width,E.blockRendering.Types.isInput(t)&&(E.blockRendering.Types.isStatementInput(t)?e+=t.connectedBlockWidth:E.blockRendering.Types.isExternalInput(t)&&0!=t.connectedBlockWidth&&(e+=t.connectedBlockWidth-t.connectionWidth)),E.blockRendering.Types.isSpacer(t)||(this.height=Math.max(this.height,t.height));this.connectedBlockWidths=e,this.widthWithConnectedBlocks=this.width+e},E.blockRendering.InputRow.prototype.endsWithElemSpacer=function(){return!this.hasExternalInput&&!this.hasStatement},E.blockRendering.RenderInfo=function(t,e){this.block_=e,this.renderer_=t,this.constants_=this.renderer_.getConstants(),this.outputConnection=e.outputConnection?new E.blockRendering.OutputConnection(this.constants_,e.outputConnection):null,this.isInline=e.getInputsInline()&&!e.isCollapsed(),this.isCollapsed=e.isCollapsed(),this.isInsertionMarker=e.isInsertionMarker(),this.RTL=e.RTL,this.statementEdge=this.width=this.widthWithChildren=this.height=0,this.rows=[],this.inputRows=[],this.hiddenIcons=[],this.topRow=new E.blockRendering.TopRow(this.constants_),this.bottomRow=new E.blockRendering.BottomRow(this.constants_),this.startY=this.startX=0},E.blockRendering.RenderInfo.prototype.getRenderer=function(){return this.renderer_},E.blockRendering.RenderInfo.prototype.measure=function(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()},E.blockRendering.RenderInfo.prototype.createRows_=function(){this.populateTopRow_(),this.rows.push(this.topRow);var t=new E.blockRendering.InputRow(this.constants_);this.inputRows.push(t);var e=this.block_.getIcons();if(e.length)for(var o,n=0;o=e[n];n++){var i=new E.blockRendering.Icon(this.constants_,o);this.isCollapsed&&o.collapseHidden?this.hiddenIcons.push(i):t.elements.push(i)}for(o=null,n=0;e=this.block_.inputList[n];n++)if(e.isVisible()){for(this.shouldStartNewRow_(e,o)&&(this.rows.push(t),t=new E.blockRendering.InputRow(this.constants_),this.inputRows.push(t)),o=0;i=e.fieldRow[o];o++)t.elements.push(new E.blockRendering.Field(this.constants_,i,e));this.addInput_(e,t),o=e}this.isCollapsed&&(t.hasJaggedEdge=!0,t.elements.push(new E.blockRendering.JaggedEdge(this.constants_))),(t.elements.length||t.hasDummyInput)&&this.rows.push(t),this.populateBottomRow_(),this.rows.push(this.bottomRow)},E.blockRendering.RenderInfo.prototype.populateTopRow_=function(){var t=!!this.block_.previousConnection,e=(this.block_.hat?"cap"===this.block_.hat:this.constants_.ADD_START_HATS)&&!this.outputConnection&&!t;this.topRow.hasLeftSquareCorner(this.block_)?this.topRow.elements.push(new E.blockRendering.SquareCorner(this.constants_)):this.topRow.elements.push(new E.blockRendering.RoundCorner(this.constants_)),e?(t=new E.blockRendering.Hat(this.constants_),this.topRow.elements.push(t),this.topRow.capline=t.ascenderHeight):t&&(this.topRow.hasPreviousConnection=!0,this.topRow.connection=new E.blockRendering.PreviousConnection(this.constants_,this.block_.previousConnection),this.topRow.elements.push(this.topRow.connection)),this.block_.inputList.length&&this.block_.inputList[0].type==E.NEXT_STATEMENT&&!this.block_.isCollapsed()?this.topRow.minHeight=this.constants_.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT:this.topRow.minHeight=this.constants_.TOP_ROW_MIN_HEIGHT,this.topRow.hasRightSquareCorner(this.block_)?this.topRow.elements.push(new E.blockRendering.SquareCorner(this.constants_,"right")):this.topRow.elements.push(new E.blockRendering.RoundCorner(this.constants_,"right"))},E.blockRendering.RenderInfo.prototype.populateBottomRow_=function(){this.bottomRow.hasNextConnection=!!this.block_.nextConnection,this.bottomRow.minHeight=this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1].type==E.NEXT_STATEMENT?this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT:this.constants_.BOTTOM_ROW_MIN_HEIGHT,this.bottomRow.hasLeftSquareCorner(this.block_)?this.bottomRow.elements.push(new E.blockRendering.SquareCorner(this.constants_)):this.bottomRow.elements.push(new E.blockRendering.RoundCorner(this.constants_)),this.bottomRow.hasNextConnection&&(this.bottomRow.connection=new E.blockRendering.NextConnection(this.constants_,this.block_.nextConnection),this.bottomRow.elements.push(this.bottomRow.connection)),this.bottomRow.hasRightSquareCorner(this.block_)?this.bottomRow.elements.push(new E.blockRendering.SquareCorner(this.constants_,"right")):this.bottomRow.elements.push(new E.blockRendering.RoundCorner(this.constants_,"right"))},E.blockRendering.RenderInfo.prototype.addInput_=function(t,e){this.isInline&&t.type==E.INPUT_VALUE?(e.elements.push(new E.blockRendering.InlineInput(this.constants_,t)),e.hasInlineInput=!0):t.type==E.NEXT_STATEMENT?(e.elements.push(new E.blockRendering.StatementInput(this.constants_,t)),e.hasStatement=!0):t.type==E.INPUT_VALUE?(e.elements.push(new E.blockRendering.ExternalValueInput(this.constants_,t)),e.hasExternalInput=!0):t.type==E.DUMMY_INPUT&&(e.minHeight=Math.max(e.minHeight,t.getSourceBlock()&&t.getSourceBlock().isShadow()?this.constants_.DUMMY_INPUT_SHADOW_MIN_HEIGHT:this.constants_.DUMMY_INPUT_MIN_HEIGHT),e.hasDummyInput=!0),null==e.align&&(e.align=t.align)},E.blockRendering.RenderInfo.prototype.shouldStartNewRow_=function(t,e){return!(!e||t.type!=E.NEXT_STATEMENT&&e.type!=E.NEXT_STATEMENT&&(t.type!=E.INPUT_VALUE&&t.type!=E.DUMMY_INPUT||this.isInline))},E.blockRendering.RenderInfo.prototype.addElemSpacing_=function(){for(var t,e=0;t=this.rows[e];e++){var o=t.elements;if(t.elements=[],t.startsWithElemSpacer()&&t.elements.push(new E.blockRendering.InRowSpacer(this.constants_,this.getInRowSpacing_(null,o[0]))),o.length){for(var n=0;n<o.length-1;n++){t.elements.push(o[n]);var i=this.getInRowSpacing_(o[n],o[n+1]);t.elements.push(new E.blockRendering.InRowSpacer(this.constants_,i))}t.elements.push(o[o.length-1]),t.endsWithElemSpacer()&&t.elements.push(new E.blockRendering.InRowSpacer(this.constants_,this.getInRowSpacing_(o[o.length-1],null)))}}},E.blockRendering.RenderInfo.prototype.getInRowSpacing_=function(t,e){if(!t&&e&&E.blockRendering.Types.isStatementInput(e))return this.constants_.STATEMENT_INPUT_PADDING_LEFT;if(t&&E.blockRendering.Types.isInput(t)&&!e){if(E.blockRendering.Types.isExternalInput(t))return this.constants_.NO_PADDING;if(E.blockRendering.Types.isInlineInput(t))return this.constants_.LARGE_PADDING;if(E.blockRendering.Types.isStatementInput(t))return this.constants_.NO_PADDING}return t&&E.blockRendering.Types.isLeftSquareCorner(t)&&e&&(E.blockRendering.Types.isPreviousConnection(e)||E.blockRendering.Types.isNextConnection(e))?e.notchOffset:t&&E.blockRendering.Types.isLeftRoundedCorner(t)&&e&&(E.blockRendering.Types.isPreviousConnection(e)||E.blockRendering.Types.isNextConnection(e))?e.notchOffset-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING},E.blockRendering.RenderInfo.prototype.computeBounds_=function(){for(var t,e=0,o=0,n=0,i=0;t=this.rows[i];i++){if(t.measure(),o=Math.max(o,t.width),t.hasStatement){var r=t.getLastInput();e=Math.max(e,t.width-r.width)}n=Math.max(n,t.widthWithConnectedBlocks)}for(this.statementEdge=e,this.width=o,i=0;t=this.rows[i];i++)t.hasStatement&&(t.statementEdge=this.statementEdge);this.widthWithChildren=Math.max(o,n),this.outputConnection&&(this.startX=this.outputConnection.width,this.width+=this.outputConnection.width,this.widthWithChildren+=this.outputConnection.width)},E.blockRendering.RenderInfo.prototype.alignRowElements_=function(){for(var t,e=0;t=this.rows[e];e++)if(t.hasStatement)this.alignStatementRow_(t);else{var o=t.width;0<(o=this.getDesiredRowWidth_(t)-o)&&this.addAlignmentPadding_(t,o),E.blockRendering.Types.isTopOrBottomRow(t)&&(t.widthWithConnectedBlocks=t.width)}},E.blockRendering.RenderInfo.prototype.getDesiredRowWidth_=function(t){return this.width-this.startX},E.blockRendering.RenderInfo.prototype.addAlignmentPadding_=function(t,e){var o=t.getFirstSpacer(),n=t.getLastSpacer();(t.hasExternalInput||t.hasStatement)&&(t.widthWithConnectedBlocks+=e),t.align==E.ALIGN_LEFT?n.width+=e:t.align==E.ALIGN_CENTRE?(o.width+=e/2,n.width+=e/2):t.align==E.ALIGN_RIGHT?o.width+=e:n.width+=e,t.width+=e},E.blockRendering.RenderInfo.prototype.alignStatementRow_=function(t){var e=t.getLastInput(),o=t.width-e.width,n=this.statementEdge;0<(o=n-o)&&this.addAlignmentPadding_(t,o),o=t.width,n=this.getDesiredRowWidth_(t),e.width+=n-o,e.height=Math.max(e.height,t.height),t.width+=n-o,t.widthWithConnectedBlocks=Math.max(t.width,this.statementEdge+t.connectedBlockWidths)},E.blockRendering.RenderInfo.prototype.addRowSpacing_=function(){var t=this.rows;this.rows=[];for(var e=0;e<t.length;e++)this.rows.push(t[e]),e!=t.length-1&&this.rows.push(this.makeSpacerRow_(t[e],t[e+1]))},E.blockRendering.RenderInfo.prototype.makeSpacerRow_=function(t,e){var o=this.getSpacerRowHeight_(t,e),n=this.getSpacerRowWidth_(t,e);return o=new E.blockRendering.SpacerRow(this.constants_,o,n),t.hasStatement&&(o.followsStatement=!0),e.hasStatement&&(o.precedesStatement=!0),o},E.blockRendering.RenderInfo.prototype.getSpacerRowWidth_=function(t,e){return this.width-this.startX},E.blockRendering.RenderInfo.prototype.getSpacerRowHeight_=function(t,e){return this.constants_.MEDIUM_PADDING},E.blockRendering.RenderInfo.prototype.getElemCenterline_=function(t,e){return E.blockRendering.Types.isSpacer(e)?t.yPos+e.height/2:E.blockRendering.Types.isBottomRow(t)?(t=t.yPos+t.height-t.descenderHeight,E.blockRendering.Types.isNextConnection(e)?t+e.height/2:t-e.height/2):E.blockRendering.Types.isTopRow(t)?E.blockRendering.Types.isHat(e)?t.capline-e.height/2:t.capline+e.height/2:t.yPos+t.height/2},E.blockRendering.RenderInfo.prototype.recordElemPositions_=function(t){for(var e,o=t.xPos,n=0;e=t.elements[n];n++)E.blockRendering.Types.isSpacer(e)&&(e.height=t.height),e.xPos=o,e.centerline=this.getElemCenterline_(t,e),o+=e.width},E.blockRendering.RenderInfo.prototype.finalize_=function(){for(var t,e=0,o=0,n=0;t=this.rows[n];n++)t.yPos=o,t.xPos=this.startX,o+=t.height,e=Math.max(e,t.widthWithConnectedBlocks),this.recordElemPositions_(t);this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(e=Math.max(e,this.block_.nextConnection.targetBlock().getHeightWidth().width)),this.widthWithChildren=e+this.startX,this.height=o,this.startY=this.topRow.capline,this.bottomRow.baseline=o-this.bottomRow.descenderHeight},E.blockRendering.Drawer=function(t,e){this.block_=t,this.info_=e,this.topLeft_=t.getRelativeToSurfaceXY(),this.inlinePath_=this.outlinePath_="",this.constants_=e.getRenderer().getConstants()},E.blockRendering.Drawer.prototype.draw=function(){this.hideHiddenIcons_(),this.drawOutline_(),this.drawInternals_(),this.block_.pathObject.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&this.block_.pathObject.flipRTL(),E.blockRendering.useDebugger&&this.block_.renderingDebugger.drawDebug(this.block_,this.info_),this.recordSizeOnBlock_()},E.blockRendering.Drawer.prototype.recordSizeOnBlock_=function(){this.block_.height=this.info_.height,this.block_.width=this.info_.widthWithChildren},E.blockRendering.Drawer.prototype.hideHiddenIcons_=function(){for(var t,e=0;t=this.info_.hiddenIcons[e];e++)t.icon.iconGroup_.setAttribute("display","none")},E.blockRendering.Drawer.prototype.drawOutline_=function(){this.drawTop_();for(var t=1;t<this.info_.rows.length-1;t++){var e=this.info_.rows[t];e.hasJaggedEdge?this.drawJaggedEdge_(e):e.hasStatement?this.drawStatementInput_(e):e.hasExternalInput?this.drawValueInput_(e):this.drawRightSideRow_(e)}this.drawBottom_(),this.drawLeft_()},E.blockRendering.Drawer.prototype.drawTop_=function(){var t=this.info_.topRow,e=t.elements;this.positionPreviousConnection_(),this.outlinePath_+=E.utils.svgPaths.moveBy(t.xPos,this.info_.startY);for(var o,n=0;o=e[n];n++)E.blockRendering.Types.isLeftRoundedCorner(o)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topLeft:E.blockRendering.Types.isRightRoundedCorner(o)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topRight:E.blockRendering.Types.isPreviousConnection(o)?this.outlinePath_+=o.shape.pathLeft:E.blockRendering.Types.isHat(o)?this.outlinePath_+=this.constants_.START_HAT.path:E.blockRendering.Types.isSpacer(o)&&(this.outlinePath_+=E.utils.svgPaths.lineOnAxis("h",o.width));this.outlinePath_+=E.utils.svgPaths.lineOnAxis("v",t.height)},E.blockRendering.Drawer.prototype.drawJaggedEdge_=function(t){this.outlinePath_+=this.constants_.JAGGED_TEETH.path+E.utils.svgPaths.lineOnAxis("v",t.height-this.constants_.JAGGED_TEETH.height)},E.blockRendering.Drawer.prototype.drawValueInput_=function(t){var e=t.getLastInput();this.positionExternalValueConnection_(t);var o="function"==typeof e.shape.pathDown?e.shape.pathDown(e.height):e.shape.pathDown;this.outlinePath_+=E.utils.svgPaths.lineOnAxis("H",e.xPos+e.width)+o+E.utils.svgPaths.lineOnAxis("v",t.height-e.connectionHeight)},E.blockRendering.Drawer.prototype.drawStatementInput_=function(t){var e=t.getLastInput(),o=e.xPos+e.notchOffset+e.shape.width;e=e.shape.pathRight+E.utils.svgPaths.lineOnAxis("h",-(e.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop;var n=t.height-2*this.constants_.INSIDE_CORNERS.height;this.outlinePath_+=E.utils.svgPaths.lineOnAxis("H",o)+e+E.utils.svgPaths.lineOnAxis("v",n)+this.constants_.INSIDE_CORNERS.pathBottom+E.utils.svgPaths.lineOnAxis("H",t.xPos+t.width),this.positionStatementInputConnection_(t)},E.blockRendering.Drawer.prototype.drawRightSideRow_=function(t){this.outlinePath_+=E.utils.svgPaths.lineOnAxis("V",t.yPos+t.height)},E.blockRendering.Drawer.prototype.drawBottom_=function(){var t=this.info_.bottomRow,e=t.elements;this.positionNextConnection_();for(var o,n=0,i="",r=e.length-1;o=e[r];r--)E.blockRendering.Types.isNextConnection(o)?i+=o.shape.pathRight:E.blockRendering.Types.isLeftSquareCorner(o)?i+=E.utils.svgPaths.lineOnAxis("H",t.xPos):E.blockRendering.Types.isLeftRoundedCorner(o)?i+=this.constants_.OUTSIDE_CORNERS.bottomLeft:E.blockRendering.Types.isRightRoundedCorner(o)?(i+=this.constants_.OUTSIDE_CORNERS.bottomRight,n=this.constants_.OUTSIDE_CORNERS.rightHeight):E.blockRendering.Types.isSpacer(o)&&(i+=E.utils.svgPaths.lineOnAxis("h",-1*o.width));this.outlinePath_+=E.utils.svgPaths.lineOnAxis("V",t.baseline-n),this.outlinePath_+=i},E.blockRendering.Drawer.prototype.drawLeft_=function(){var t=this.info_.outputConnection;if(this.positionOutputConnection_(),t){var e=t.connectionOffsetY+t.height;t="function"==typeof t.shape.pathUp?t.shape.pathUp(t.height):t.shape.pathUp,this.outlinePath_+=E.utils.svgPaths.lineOnAxis("V",e)+t}this.outlinePath_+="z"},E.blockRendering.Drawer.prototype.drawInternals_=function(){for(var t,e=0;t=this.info_.rows[e];e++)for(var o,n=0;o=t.elements[n];n++)E.blockRendering.Types.isInlineInput(o)?this.drawInlineInput_(o):(E.blockRendering.Types.isIcon(o)||E.blockRendering.Types.isField(o))&&this.layoutField_(o)},E.blockRendering.Drawer.prototype.layoutField_=function(t){if(E.blockRendering.Types.isField(t))var e=t.field.getSvgRoot();else E.blockRendering.Types.isIcon(t)&&(e=t.icon.iconGroup_);var o=t.centerline-t.height/2,n=t.xPos,i="";this.info_.RTL&&(n=-(n+t.width),t.flipRtl&&(n+=t.width,i="scale(-1 1)")),E.blockRendering.Types.isIcon(t)?(e.setAttribute("display","block"),e.setAttribute("transform","translate("+n+","+o+")"),t.icon.computeIconLocation()):e.setAttribute("transform","translate("+n+","+o+")"+i),this.info_.isInsertionMarker&&e.setAttribute("display","none")},E.blockRendering.Drawer.prototype.drawInlineInput_=function(t){var e=t.width,o=t.height,n=t.connectionOffsetY,i=t.connectionHeight+n;this.inlinePath_+=E.utils.svgPaths.moveTo(t.xPos+t.connectionWidth,t.centerline-o/2)+E.utils.svgPaths.lineOnAxis("v",n)+t.shape.pathDown+E.utils.svgPaths.lineOnAxis("v",o-i)+E.utils.svgPaths.lineOnAxis("h",e-t.connectionWidth)+E.utils.svgPaths.lineOnAxis("v",-o)+"z",this.positionInlineInputConnection_(t)},E.blockRendering.Drawer.prototype.positionInlineInputConnection_=function(t){var e=t.centerline-t.height/2;if(t.connectionModel){var o=t.xPos+t.connectionWidth+t.connectionOffsetX;this.info_.RTL&&(o*=-1),t.connectionModel.setOffsetInBlock(o,e+t.connectionOffsetY)}},E.blockRendering.Drawer.prototype.positionStatementInputConnection_=function(t){var e=t.getLastInput();if(e.connectionModel){var o=t.xPos+t.statementEdge+e.notchOffset;this.info_.RTL&&(o*=-1),e.connectionModel.setOffsetInBlock(o,t.yPos)}},E.blockRendering.Drawer.prototype.positionExternalValueConnection_=function(t){var e=t.getLastInput();if(e.connectionModel){var o=t.xPos+t.width;this.info_.RTL&&(o*=-1),e.connectionModel.setOffsetInBlock(o,t.yPos)}},E.blockRendering.Drawer.prototype.positionPreviousConnection_=function(){var t=this.info_.topRow;if(t.connection){var e=t.xPos+t.notchOffset;t.connection.connectionModel.setOffsetInBlock(this.info_.RTL?-e:e,0)}},E.blockRendering.Drawer.prototype.positionNextConnection_=function(){var t=this.info_.bottomRow;if(t.connection){var e=t.connection,o=e.xPos;e.connectionModel.setOffsetInBlock(this.info_.RTL?-o:o,t.baseline)}},E.blockRendering.Drawer.prototype.positionOutputConnection_=function(){if(this.info_.outputConnection){var t=this.info_.startX+this.info_.outputConnection.connectionOffsetX;this.block_.outputConnection.setOffsetInBlock(this.info_.RTL?-t:t,this.info_.outputConnection.connectionOffsetY)}},E.blockRendering.PathObject=function(t,e,o){this.constants=o,this.svgRoot=t,this.svgPath=E.utils.dom.createSvgElement(E.utils.Svg.PATH,{class:"blocklyPath"},this.svgRoot),this.style=e,this.markerSvg=this.cursorSvg=null},E.blockRendering.PathObject.prototype.setPath=function(t){this.svgPath.setAttribute("d",t)},E.blockRendering.PathObject.prototype.flipRTL=function(){this.svgPath.setAttribute("transform","scale(-1 1)")},E.blockRendering.PathObject.prototype.setCursorSvg=function(t){t?(this.svgRoot.appendChild(t),this.cursorSvg=t):this.cursorSvg=null},E.blockRendering.PathObject.prototype.setMarkerSvg=function(t){t?(this.cursorSvg?this.svgRoot.insertBefore(t,this.cursorSvg):this.svgRoot.appendChild(t),this.markerSvg=t):this.markerSvg=null},E.blockRendering.PathObject.prototype.applyColour=function(t){this.svgPath.setAttribute("stroke",this.style.colourTertiary),this.svgPath.setAttribute("fill",this.style.colourPrimary),this.updateShadow_(t.isShadow()),this.updateDisabled_(!t.isEnabled()||t.getInheritedDisabled())},E.blockRendering.PathObject.prototype.setStyle=function(t){this.style=t},E.blockRendering.PathObject.prototype.setClass_=function(t,e){e?E.utils.dom.addClass(this.svgRoot,t):E.utils.dom.removeClass(this.svgRoot,t)},E.blockRendering.PathObject.prototype.updateHighlighted=function(t){t?this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"):this.svgPath.setAttribute("filter","none")},E.blockRendering.PathObject.prototype.updateShadow_=function(t){t&&(this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary))},E.blockRendering.PathObject.prototype.updateDisabled_=function(t){this.setClass_("blocklyDisabled",t),t&&this.svgPath.setAttribute("fill","url(#"+this.constants.disabledPatternId+")")},E.blockRendering.PathObject.prototype.updateSelected=function(t){this.setClass_("blocklySelected",t)},E.blockRendering.PathObject.prototype.updateDraggingDelete=function(t){this.setClass_("blocklyDraggingDelete",t)},E.blockRendering.PathObject.prototype.updateInsertionMarker=function(t){this.setClass_("blocklyInsertionMarker",t)},E.blockRendering.PathObject.prototype.updateMovable=function(t){this.setClass_("blocklyDraggable",t)},E.blockRendering.PathObject.prototype.updateReplacementFade=function(t){this.setClass_("blocklyReplaceable",t)},E.blockRendering.PathObject.prototype.updateShapeForInputHighlight=function(t,e){},E.blockRendering.Renderer=function(t){this.name=t,this.overrides=this.constants_=null},E.blockRendering.Renderer.prototype.getClassName=function(){return this.name+"-renderer"},E.blockRendering.Renderer.prototype.init=function(t,e){this.constants_=this.makeConstants_(),e&&(this.overrides=e,E.utils.object.mixin(this.constants_,e)),this.constants_.setTheme(t),this.constants_.init()},E.blockRendering.Renderer.prototype.createDom=function(t,e){this.constants_.createDom(t,this.name+"-"+e.name,"."+this.getClassName()+"."+e.getClassName())},E.blockRendering.Renderer.prototype.refreshDom=function(t,e){var o=this.getConstants();o.dispose(),this.constants_=this.makeConstants_(),this.overrides&&E.utils.object.mixin(this.constants_,this.overrides),this.constants_.randomIdentifier=o.randomIdentifier,this.constants_.setTheme(e),this.constants_.init(),this.createDom(t,e)},E.blockRendering.Renderer.prototype.dispose=function(){this.constants_&&this.constants_.dispose()},E.blockRendering.Renderer.prototype.makeConstants_=function(){return new E.blockRendering.ConstantProvider},E.blockRendering.Renderer.prototype.makeRenderInfo_=function(t){return new E.blockRendering.RenderInfo(this,t)},E.blockRendering.Renderer.prototype.makeDrawer_=function(t,e){return new E.blockRendering.Drawer(t,e)},E.blockRendering.Renderer.prototype.makeDebugger_=function(){if(!E.blockRendering.Debug)throw Error("Missing require for Blockly.blockRendering.Debug");return new E.blockRendering.Debug(this.getConstants())},E.blockRendering.Renderer.prototype.makeMarkerDrawer=function(t,e){return new E.blockRendering.MarkerSvg(t,this.getConstants(),e)},E.blockRendering.Renderer.prototype.makePathObject=function(t,e){return new E.blockRendering.PathObject(t,e,this.constants_)},E.blockRendering.Renderer.prototype.getConstants=function(){return this.constants_},E.blockRendering.Renderer.prototype.shouldHighlightConnection=function(t){return!0},E.blockRendering.Renderer.prototype.orphanCanConnectAtEnd=function(t,e,o){return!!(t=o==E.OUTPUT_VALUE?(o=e.outputConnection,E.Connection.lastConnectionInRow(t,e)):(o=e.previousConnection,t.lastConnectionInStack()))&&o.getConnectionChecker().canConnect(t,o,!1)},E.blockRendering.Renderer.prototype.getConnectionPreviewMethod=function(t,e,o){return e.type==E.OUTPUT_VALUE||e.type==E.PREVIOUS_STATEMENT?!t.isConnected()||this.orphanCanConnectAtEnd(o,t.targetBlock(),e.type)?E.InsertionMarkerManager.PREVIEW_TYPE.INSERTION_MARKER:E.InsertionMarkerManager.PREVIEW_TYPE.REPLACEMENT_FADE:E.InsertionMarkerManager.PREVIEW_TYPE.INSERTION_MARKER},E.blockRendering.Renderer.prototype.render=function(t){E.blockRendering.useDebugger&&!t.renderingDebugger&&(t.renderingDebugger=this.makeDebugger_());var e=this.makeRenderInfo_(t);e.measure(),this.makeDrawer_(t,e).draw()},E.geras={},E.geras.ConstantProvider=function(){E.geras.ConstantProvider.superClass_.constructor.call(this),this.FIELD_TEXT_BASELINE_CENTER=!1,this.DARK_PATH_OFFSET=1,this.MAX_BOTTOM_WIDTH=30},E.utils.object.inherits(E.geras.ConstantProvider,E.blockRendering.ConstantProvider),E.geras.ConstantProvider.prototype.getCSS_=function(t){return E.geras.ConstantProvider.superClass_.getCSS_.call(this,t).concat([t+" .blocklyInsertionMarker>.blocklyPathLight,",t+" .blocklyInsertionMarker>.blocklyPathDark {","fill-opacity: "+this.INSERTION_MARKER_OPACITY+";","stroke: none;","}"])},E.geras.Highlighter=function(t){this.info_=t,this.inlineSteps_=this.steps_="",this.RTL_=this.info_.RTL,t=t.getRenderer(),this.constants_=t.getConstants(),this.highlightConstants_=t.getHighlightConstants(),this.highlightOffset_=this.highlightConstants_.OFFSET,this.outsideCornerPaths_=this.highlightConstants_.OUTSIDE_CORNER,this.insideCornerPaths_=this.highlightConstants_.INSIDE_CORNER,this.puzzleTabPaths_=this.highlightConstants_.PUZZLE_TAB,this.notchPaths_=this.highlightConstants_.NOTCH,this.startPaths_=this.highlightConstants_.START_HAT,this.jaggedTeethPaths_=this.highlightConstants_.JAGGED_TEETH},E.geras.Highlighter.prototype.getPath=function(){return this.steps_+"\n"+this.inlineSteps_},E.geras.Highlighter.prototype.drawTopCorner=function(t){this.steps_+=E.utils.svgPaths.moveBy(t.xPos,this.info_.startY);for(var e,o=0;e=t.elements[o];o++)E.blockRendering.Types.isLeftSquareCorner(e)?this.steps_+=this.highlightConstants_.START_POINT:E.blockRendering.Types.isLeftRoundedCorner(e)?this.steps_+=this.outsideCornerPaths_.topLeft(this.RTL_):E.blockRendering.Types.isPreviousConnection(e)?this.steps_+=this.notchPaths_.pathLeft:E.blockRendering.Types.isHat(e)?this.steps_+=this.startPaths_.path(this.RTL_):E.blockRendering.Types.isSpacer(e)&&0!=e.width&&(this.steps_+=E.utils.svgPaths.lineOnAxis("H",e.xPos+e.width-this.highlightOffset_));this.steps_+=E.utils.svgPaths.lineOnAxis("H",t.xPos+t.width-this.highlightOffset_)},E.geras.Highlighter.prototype.drawJaggedEdge_=function(t){this.info_.RTL&&(this.steps_+=this.jaggedTeethPaths_.pathLeft+E.utils.svgPaths.lineOnAxis("v",t.height-this.jaggedTeethPaths_.height-this.highlightOffset_))},E.geras.Highlighter.prototype.drawValueInput=function(t){var e=t.getLastInput();if(this.RTL_){var o=t.height-e.connectionHeight;this.steps_+=E.utils.svgPaths.moveTo(e.xPos+e.width-this.highlightOffset_,t.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)+E.utils.svgPaths.lineOnAxis("v",o)}else this.steps_+=E.utils.svgPaths.moveTo(e.xPos+e.width,t.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)},E.geras.Highlighter.prototype.drawStatementInput=function(t){var e=t.getLastInput();if(this.RTL_){var o=t.height-2*this.insideCornerPaths_.height;this.steps_+=E.utils.svgPaths.moveTo(e.xPos,t.yPos)+this.insideCornerPaths_.pathTop(this.RTL_)+E.utils.svgPaths.lineOnAxis("v",o)+this.insideCornerPaths_.pathBottom(this.RTL_)+E.utils.svgPaths.lineTo(t.width-e.xPos-this.insideCornerPaths_.width,0)}else this.steps_+=E.utils.svgPaths.moveTo(e.xPos,t.yPos+t.height)+this.insideCornerPaths_.pathBottom(this.RTL_)+E.utils.svgPaths.lineTo(t.width-e.xPos-this.insideCornerPaths_.width,0)},E.geras.Highlighter.prototype.drawRightSideRow=function(t){var e=t.xPos+t.width-this.highlightOffset_;t.followsStatement&&(this.steps_+=E.utils.svgPaths.lineOnAxis("H",e)),this.RTL_&&(this.steps_+=E.utils.svgPaths.lineOnAxis("H",e),t.height>this.highlightOffset_&&(this.steps_+=E.utils.svgPaths.lineOnAxis("V",t.yPos+t.height-this.highlightOffset_)))},E.geras.Highlighter.prototype.drawBottomRow=function(t){if(this.RTL_)this.steps_+=E.utils.svgPaths.lineOnAxis("V",t.baseline-this.highlightOffset_);else{var e=this.info_.bottomRow.elements[0];E.blockRendering.Types.isLeftSquareCorner(e)?this.steps_+=E.utils.svgPaths.moveTo(t.xPos+this.highlightOffset_,t.baseline-this.highlightOffset_):E.blockRendering.Types.isLeftRoundedCorner(e)&&(this.steps_+=E.utils.svgPaths.moveTo(t.xPos,t.baseline),this.steps_+=this.outsideCornerPaths_.bottomLeft())}},E.geras.Highlighter.prototype.drawLeft=function(){var t=this.info_.outputConnection;t&&(t=t.connectionOffsetY+t.height,this.RTL_?this.steps_+=E.utils.svgPaths.moveTo(this.info_.startX,t):(this.steps_+=E.utils.svgPaths.moveTo(this.info_.startX+this.highlightOffset_,this.info_.bottomRow.baseline-this.highlightOffset_),this.steps_+=E.utils.svgPaths.lineOnAxis("V",t)),this.steps_+=this.puzzleTabPaths_.pathUp(this.RTL_)),this.RTL_||(t=this.info_.topRow,E.blockRendering.Types.isLeftRoundedCorner(t.elements[0])?this.steps_+=E.utils.svgPaths.lineOnAxis("V",this.outsideCornerPaths_.height):this.steps_+=E.utils.svgPaths.lineOnAxis("V",t.capline+this.highlightOffset_))},E.geras.Highlighter.prototype.drawInlineInput=function(t){var e=this.highlightOffset_,o=t.xPos+t.connectionWidth,n=t.centerline-t.height/2,i=t.width-t.connectionWidth,r=n+e;this.RTL_?(n=t.connectionOffsetY-e,t=t.height-(t.connectionOffsetY+t.connectionHeight)+e,this.inlineSteps_+=E.utils.svgPaths.moveTo(o-e,r)+E.utils.svgPaths.lineOnAxis("v",n)+this.puzzleTabPaths_.pathDown(this.RTL_)+E.utils.svgPaths.lineOnAxis("v",t)+E.utils.svgPaths.lineOnAxis("h",i)):this.inlineSteps_+=E.utils.svgPaths.moveTo(t.xPos+t.width+e,r)+E.utils.svgPaths.lineOnAxis("v",t.height)+E.utils.svgPaths.lineOnAxis("h",-i)+E.utils.svgPaths.moveTo(o,n+t.connectionOffsetY)+this.puzzleTabPaths_.pathDown(this.RTL_)},E.geras.InlineInput=function(t,e){E.geras.InlineInput.superClass_.constructor.call(this,t,e),this.connectedBlock&&(this.width+=this.constants_.DARK_PATH_OFFSET,this.height+=this.constants_.DARK_PATH_OFFSET)},E.utils.object.inherits(E.geras.InlineInput,E.blockRendering.InlineInput),E.geras.StatementInput=function(t,e){E.geras.StatementInput.superClass_.constructor.call(this,t,e),this.connectedBlock&&(this.height+=this.constants_.DARK_PATH_OFFSET)},E.utils.object.inherits(E.geras.StatementInput,E.blockRendering.StatementInput),E.geras.RenderInfo=function(t,e){E.geras.RenderInfo.superClass_.constructor.call(this,t,e)},E.utils.object.inherits(E.geras.RenderInfo,E.blockRendering.RenderInfo),E.geras.RenderInfo.prototype.getRenderer=function(){return this.renderer_},E.geras.RenderInfo.prototype.populateBottomRow_=function(){E.geras.RenderInfo.superClass_.populateBottomRow_.call(this),this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1].type==E.NEXT_STATEMENT||(this.bottomRow.minHeight=this.constants_.MEDIUM_PADDING-this.constants_.DARK_PATH_OFFSET)},E.geras.RenderInfo.prototype.addInput_=function(t,e){this.isInline&&t.type==E.INPUT_VALUE?(e.elements.push(new E.geras.InlineInput(this.constants_,t)),e.hasInlineInput=!0):t.type==E.NEXT_STATEMENT?(e.elements.push(new E.geras.StatementInput(this.constants_,t)),e.hasStatement=!0):t.type==E.INPUT_VALUE?(e.elements.push(new E.blockRendering.ExternalValueInput(this.constants_,t)),e.hasExternalInput=!0):t.type==E.DUMMY_INPUT&&(e.minHeight=Math.max(e.minHeight,this.constants_.DUMMY_INPUT_MIN_HEIGHT),e.hasDummyInput=!0),this.isInline||null!=e.align||(e.align=t.align)},E.geras.RenderInfo.prototype.addElemSpacing_=function(){for(var t,e=!1,o=0;t=this.rows[o];o++)t.hasExternalInput&&(e=!0);for(o=0;t=this.rows[o];o++){var n=t.elements;if(t.elements=[],t.startsWithElemSpacer()&&t.elements.push(new E.blockRendering.InRowSpacer(this.constants_,this.getInRowSpacing_(null,n[0]))),n.length){for(var i=0;i<n.length-1;i++){t.elements.push(n[i]);var r=this.getInRowSpacing_(n[i],n[i+1]);t.elements.push(new E.blockRendering.InRowSpacer(this.constants_,r))}t.elements.push(n[n.length-1]),t.endsWithElemSpacer()&&(r=this.getInRowSpacing_(n[n.length-1],null),e&&t.hasDummyInput&&(r+=this.constants_.TAB_WIDTH),t.elements.push(new E.blockRendering.InRowSpacer(this.constants_,r)))}}},E.geras.RenderInfo.prototype.getInRowSpacing_=function(t,e){if(!t)return e&&E.blockRendering.Types.isField(e)&&e.isEditable?this.constants_.MEDIUM_PADDING:e&&E.blockRendering.Types.isInlineInput(e)?this.constants_.MEDIUM_LARGE_PADDING:e&&E.blockRendering.Types.isStatementInput(e)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!E.blockRendering.Types.isInput(t)&&(!e||E.blockRendering.Types.isStatementInput(e)))return E.blockRendering.Types.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:E.blockRendering.Types.isIcon(t)?2*this.constants_.LARGE_PADDING+1:E.blockRendering.Types.isHat(t)?this.constants_.NO_PADDING:E.blockRendering.Types.isPreviousOrNextConnection(t)?this.constants_.LARGE_PADDING:E.blockRendering.Types.isLeftRoundedCorner(t)?this.constants_.MIN_BLOCK_WIDTH:E.blockRendering.Types.isJaggedEdge(t)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(E.blockRendering.Types.isInput(t)&&!e){if(E.blockRendering.Types.isExternalInput(t))return this.constants_.NO_PADDING;if(E.blockRendering.Types.isInlineInput(t))return this.constants_.LARGE_PADDING;if(E.blockRendering.Types.isStatementInput(t))return this.constants_.NO_PADDING}if(!E.blockRendering.Types.isInput(t)&&e&&E.blockRendering.Types.isInput(e)){if(E.blockRendering.Types.isField(t)&&t.isEditable){if(E.blockRendering.Types.isInlineInput(e)||E.blockRendering.Types.isExternalInput(e))return this.constants_.SMALL_PADDING}else{if(E.blockRendering.Types.isInlineInput(e)||E.blockRendering.Types.isExternalInput(e))return this.constants_.MEDIUM_LARGE_PADDING;if(E.blockRendering.Types.isStatementInput(e))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(E.blockRendering.Types.isIcon(t)&&e&&!E.blockRendering.Types.isInput(e))return this.constants_.LARGE_PADDING;if(E.blockRendering.Types.isInlineInput(t)&&e&&E.blockRendering.Types.isField(e))return e.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(E.blockRendering.Types.isLeftSquareCorner(t)&&e){if(E.blockRendering.Types.isHat(e))return this.constants_.NO_PADDING;if(E.blockRendering.Types.isPreviousConnection(e))return e.notchOffset;if(E.blockRendering.Types.isNextConnection(e))return t=(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2,e.notchOffset+t}if(E.blockRendering.Types.isLeftRoundedCorner(t)&&e){if(E.blockRendering.Types.isPreviousConnection(e))return e.notchOffset-this.constants_.CORNER_RADIUS;if(E.blockRendering.Types.isNextConnection(e))return t=(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2,e.notchOffset-this.constants_.CORNER_RADIUS+t}return E.blockRendering.Types.isField(t)&&e&&E.blockRendering.Types.isField(e)&&t.isEditable==e.isEditable||e&&E.blockRendering.Types.isJaggedEdge(e)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING},E.geras.RenderInfo.prototype.getSpacerRowHeight_=function(t,e){return E.blockRendering.Types.isTopRow(t)&&E.blockRendering.Types.isBottomRow(e)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:E.blockRendering.Types.isTopRow(t)||E.blockRendering.Types.isBottomRow(e)?this.constants_.NO_PADDING:t.hasExternalInput&&e.hasExternalInput?this.constants_.LARGE_PADDING:!t.hasStatement&&e.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:t.hasStatement&&e.hasStatement||!t.hasStatement&&e.hasDummyInput||t.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING},E.geras.RenderInfo.prototype.getElemCenterline_=function(t,e){if(E.blockRendering.Types.isSpacer(e))return t.yPos+e.height/2;if(E.blockRendering.Types.isBottomRow(t))return t=t.yPos+t.height-t.descenderHeight,E.blockRendering.Types.isNextConnection(e)?t+e.height/2:t-e.height/2;if(E.blockRendering.Types.isTopRow(t))return E.blockRendering.Types.isHat(e)?t.capline-e.height/2:t.capline+e.height/2;var o=t.yPos;return E.blockRendering.Types.isField(e)||E.blockRendering.Types.isIcon(e)?(o+=e.height/2,(t.hasInlineInput||t.hasStatement)&&e.height+this.constants_.TALL_INPUT_FIELD_OFFSET_Y<=t.height&&(o+=this.constants_.TALL_INPUT_FIELD_OFFSET_Y)):o=E.blockRendering.Types.isInlineInput(e)?o+e.height/2:o+t.height/2,o},E.geras.RenderInfo.prototype.alignRowElements_=function(){if(this.isInline){for(var t,e=0,o=null,n=this.rows.length-1;t=this.rows[n];n--)t.nextRightEdge=e,E.blockRendering.Types.isInputRow(t)&&(t.hasStatement&&this.alignStatementRow_(t),o&&o.hasStatement&&t.width<o.width?t.nextRightEdge=o.width:e=t.width,o=t);for(n=e=0;t=this.rows[n];n++)t.hasStatement?e=this.getDesiredRowWidth_(t):E.blockRendering.Types.isSpacer(t)?t.width=Math.max(e,t.nextRightEdge):(0<(e=Math.max(e,t.nextRightEdge)-t.width)&&this.addAlignmentPadding_(t,e),e=t.width)}else E.geras.RenderInfo.superClass_.alignRowElements_.call(this)},E.geras.RenderInfo.prototype.getDesiredRowWidth_=function(t){return this.isInline&&t.hasStatement?this.statementEdge+this.constants_.MAX_BOTTOM_WIDTH+this.startX:E.geras.RenderInfo.superClass_.getDesiredRowWidth_.call(this,t)},E.geras.RenderInfo.prototype.finalize_=function(){for(var t,e=0,o=0,n=0;t=this.rows[n];n++){t.yPos=o,t.xPos=this.startX,o+=t.height,e=Math.max(e,t.widthWithConnectedBlocks);var i=o-this.topRow.ascenderHeight;t==this.bottomRow&&i<this.constants_.MIN_BLOCK_HEIGHT&&(i=this.constants_.MIN_BLOCK_HEIGHT-i,this.bottomRow.height+=i,o+=i),this.recordElemPositions_(t)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(e=Math.max(e,this.block_.nextConnection.targetBlock().getHeightWidth().width-this.constants_.DARK_PATH_OFFSET)),this.bottomRow.baseline=o-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX+this.constants_.DARK_PATH_OFFSET,this.width+=this.constants_.DARK_PATH_OFFSET,this.height=o+this.constants_.DARK_PATH_OFFSET,this.startY=this.topRow.capline},E.geras.Drawer=function(t,e){E.geras.Drawer.superClass_.constructor.call(this,t,e),this.highlighter_=new E.geras.Highlighter(e)},E.utils.object.inherits(E.geras.Drawer,E.blockRendering.Drawer),E.geras.Drawer.prototype.draw=function(){this.hideHiddenIcons_(),this.drawOutline_(),this.drawInternals_();var t=this.block_.pathObject;t.setPath(this.outlinePath_+"\n"+this.inlinePath_),t.setHighlightPath(this.highlighter_.getPath()),this.info_.RTL&&t.flipRTL(),E.blockRendering.useDebugger&&this.block_.renderingDebugger.drawDebug(this.block_,this.info_),this.recordSizeOnBlock_()},E.geras.Drawer.prototype.drawTop_=function(){this.highlighter_.drawTopCorner(this.info_.topRow),this.highlighter_.drawRightSideRow(this.info_.topRow),E.geras.Drawer.superClass_.drawTop_.call(this)},E.geras.Drawer.prototype.drawJaggedEdge_=function(t){this.highlighter_.drawJaggedEdge_(t),E.geras.Drawer.superClass_.drawJaggedEdge_.call(this,t)},E.geras.Drawer.prototype.drawValueInput_=function(t){this.highlighter_.drawValueInput(t),E.geras.Drawer.superClass_.drawValueInput_.call(this,t)},E.geras.Drawer.prototype.drawStatementInput_=function(t){this.highlighter_.drawStatementInput(t),E.geras.Drawer.superClass_.drawStatementInput_.call(this,t)},E.geras.Drawer.prototype.drawRightSideRow_=function(t){this.highlighter_.drawRightSideRow(t),this.outlinePath_+=E.utils.svgPaths.lineOnAxis("H",t.xPos+t.width)+E.utils.svgPaths.lineOnAxis("V",t.yPos+t.height)},E.geras.Drawer.prototype.drawBottom_=function(){this.highlighter_.drawBottomRow(this.info_.bottomRow),E.geras.Drawer.superClass_.drawBottom_.call(this)},E.geras.Drawer.prototype.drawLeft_=function(){this.highlighter_.drawLeft(),E.geras.Drawer.superClass_.drawLeft_.call(this)},E.geras.Drawer.prototype.drawInlineInput_=function(t){this.highlighter_.drawInlineInput(t),E.geras.Drawer.superClass_.drawInlineInput_.call(this,t)},E.geras.Drawer.prototype.positionInlineInputConnection_=function(t){var e=t.centerline-t.height/2;if(t.connectionModel){var o=t.xPos+t.connectionWidth+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(o*=-1),t.connectionModel.setOffsetInBlock(o,e+t.connectionOffsetY+this.constants_.DARK_PATH_OFFSET)}},E.geras.Drawer.prototype.positionStatementInputConnection_=function(t){var e=t.getLastInput();if(e.connectionModel){var o=t.xPos+t.statementEdge+e.notchOffset;o=this.info_.RTL?-1*o:o+this.constants_.DARK_PATH_OFFSET,e.connectionModel.setOffsetInBlock(o,t.yPos+this.constants_.DARK_PATH_OFFSET)}},E.geras.Drawer.prototype.positionExternalValueConnection_=function(t){var e=t.getLastInput();if(e.connectionModel){var o=t.xPos+t.width+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(o*=-1),e.connectionModel.setOffsetInBlock(o,t.yPos)}},E.geras.Drawer.prototype.positionNextConnection_=function(){var t=this.info_.bottomRow;if(t.connection){var e=t.connection,o=e.xPos;e.connectionModel.setOffsetInBlock((this.info_.RTL?-o:o)+this.constants_.DARK_PATH_OFFSET/2,t.baseline+this.constants_.DARK_PATH_OFFSET)}},E.geras.HighlightConstantProvider=function(t){this.constantProvider=t,this.OFFSET=.5,this.START_POINT=E.utils.svgPaths.moveBy(this.OFFSET,this.OFFSET)},E.geras.HighlightConstantProvider.prototype.init=function(){this.INSIDE_CORNER=this.makeInsideCorner(),this.OUTSIDE_CORNER=this.makeOutsideCorner(),this.PUZZLE_TAB=this.makePuzzleTab(),this.NOTCH=this.makeNotch(),this.JAGGED_TEETH=this.makeJaggedTeeth(),this.START_HAT=this.makeStartHat()},E.geras.HighlightConstantProvider.prototype.makeInsideCorner=function(){var t=this.constantProvider.CORNER_RADIUS,e=this.OFFSET,o=(1-Math.SQRT1_2)*(t+e)-e,n=E.utils.svgPaths.moveBy(o,o)+E.utils.svgPaths.arc("a","0 0,0",t,E.utils.svgPaths.point(-o-e,t-o)),i=E.utils.svgPaths.arc("a","0 0,0",t+e,E.utils.svgPaths.point(t+e,t+e)),r=E.utils.svgPaths.moveBy(o,-o)+E.utils.svgPaths.arc("a","0 0,0",t+e,E.utils.svgPaths.point(t-o,o+e));return{width:t+e,height:t,pathTop:function(t){return t?n:""},pathBottom:function(t){return t?i:r}}},E.geras.HighlightConstantProvider.prototype.makeOutsideCorner=function(){var t=this.constantProvider.CORNER_RADIUS,e=this.OFFSET,o=(1-Math.SQRT1_2)*(t-e)+e,n=E.utils.svgPaths.moveBy(o,o)+E.utils.svgPaths.arc("a","0 0,1",t-e,E.utils.svgPaths.point(t-o,-o+e)),i=E.utils.svgPaths.moveBy(e,t)+E.utils.svgPaths.arc("a","0 0,1",t-e,E.utils.svgPaths.point(t,-t+e)),r=-o,s=E.utils.svgPaths.moveBy(o,r)+E.utils.svgPaths.arc("a","0 0,1",t-e,E.utils.svgPaths.point(-o+e,-r-t));return{height:t,topLeft:function(t){return t?n:i},bottomLeft:function(){return s}}},E.geras.HighlightConstantProvider.prototype.makePuzzleTab=function(){var t=this.constantProvider.TAB_WIDTH,e=this.constantProvider.TAB_HEIGHT,o=E.utils.svgPaths.moveBy(-2,3.4-e)+E.utils.svgPaths.lineTo(-.45*t,-2.1),n=E.utils.svgPaths.lineOnAxis("v",2.5)+E.utils.svgPaths.moveBy(.97*-t,2.5)+E.utils.svgPaths.curve("q",[E.utils.svgPaths.point(.05*-t,10),E.utils.svgPaths.point(.3*t,9.5)])+E.utils.svgPaths.moveBy(.67*t,-1.9)+E.utils.svgPaths.lineOnAxis("v",2.5),i=E.utils.svgPaths.lineOnAxis("v",-1.5)+E.utils.svgPaths.moveBy(-.92*t,-.5)+E.utils.svgPaths.curve("q",[E.utils.svgPaths.point(-.19*t,-5.5),E.utils.svgPaths.point(0,-11)])+E.utils.svgPaths.moveBy(.92*t,1),r=E.utils.svgPaths.moveBy(-5,e-.7)+E.utils.svgPaths.lineTo(.46*t,-2.1);return{width:t,height:e,pathUp:function(t){return t?o:i},pathDown:function(t){return t?n:r}}},E.geras.HighlightConstantProvider.prototype.makeNotch=function(){return{pathLeft:E.utils.svgPaths.lineOnAxis("h",this.OFFSET)+this.constantProvider.NOTCH.pathLeft}},E.geras.HighlightConstantProvider.prototype.makeJaggedTeeth=function(){return{pathLeft:E.utils.svgPaths.lineTo(5.1,2.6)+E.utils.svgPaths.moveBy(-10.2,6.8)+E.utils.svgPaths.lineTo(5.1,2.6),height:12,width:10.2}},E.geras.HighlightConstantProvider.prototype.makeStartHat=function(){var t=this.constantProvider.START_HAT.height,e=E.utils.svgPaths.moveBy(25,-8.7)+E.utils.svgPaths.curve("c",[E.utils.svgPaths.point(29.7,-6.2),E.utils.svgPaths.point(57.2,-.5),E.utils.svgPaths.point(75,8.7)]),o=E.utils.svgPaths.curve("c",[E.utils.svgPaths.point(17.8,-9.2),E.utils.svgPaths.point(45.3,-14.9),E.utils.svgPaths.point(75,-8.7)])+E.utils.svgPaths.moveTo(100.5,t+.5);return{path:function(t){return t?e:o}}},E.geras.PathObject=function(t,e,o){this.constants=o,this.svgRoot=t,this.svgPathDark=E.utils.dom.createSvgElement(E.utils.Svg.PATH,{class:"blocklyPathDark",transform:"translate(1,1)"},this.svgRoot),this.svgPath=E.utils.dom.createSvgElement(E.utils.Svg.PATH,{class:"blocklyPath"},this.svgRoot),this.svgPathLight=E.utils.dom.createSvgElement(E.utils.Svg.PATH,{class:"blocklyPathLight"},this.svgRoot),this.colourDark="#000000",this.style=e},E.utils.object.inherits(E.geras.PathObject,E.blockRendering.PathObject),E.geras.PathObject.prototype.setPath=function(t){this.svgPath.setAttribute("d",t),this.svgPathDark.setAttribute("d",t)},E.geras.PathObject.prototype.setHighlightPath=function(t){this.svgPathLight.setAttribute("d",t)},E.geras.PathObject.prototype.flipRTL=function(){this.svgPath.setAttribute("transform","scale(-1 1)"),this.svgPathLight.setAttribute("transform","scale(-1 1)"),this.svgPathDark.setAttribute("transform","translate(1,1) scale(-1 1)")},E.geras.PathObject.prototype.applyColour=function(t){this.svgPathLight.style.display="",this.svgPathDark.style.display="",this.svgPathLight.setAttribute("stroke",this.style.colourTertiary),this.svgPathDark.setAttribute("fill",this.colourDark),E.geras.PathObject.superClass_.applyColour.call(this,t),this.svgPath.setAttribute("stroke","none")},E.geras.PathObject.prototype.setStyle=function(t){this.style=t,this.colourDark=E.utils.colour.blend("#000",this.style.colourPrimary,.2)||this.colourDark},E.geras.PathObject.prototype.updateHighlighted=function(t){t?(this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"),this.svgPathLight.style.display="none"):(this.svgPath.setAttribute("filter","none"),this.svgPathLight.style.display="inline")},E.geras.PathObject.prototype.updateShadow_=function(t){t&&(this.svgPathLight.style.display="none",this.svgPathDark.setAttribute("fill",this.style.colourSecondary),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary))},E.geras.PathObject.prototype.updateDisabled_=function(t){E.geras.PathObject.superClass_.updateDisabled_.call(this,t),t&&this.svgPath.setAttribute("stroke","none")},E.geras.Renderer=function(t){E.geras.Renderer.superClass_.constructor.call(this,t),this.highlightConstants_=null},E.utils.object.inherits(E.geras.Renderer,E.blockRendering.Renderer),E.geras.Renderer.prototype.init=function(t,e){E.geras.Renderer.superClass_.init.call(this,t,e),this.highlightConstants_=this.makeHighlightConstants_(),this.highlightConstants_.init()},E.geras.Renderer.prototype.refreshDom=function(t,e){E.geras.Renderer.superClass_.refreshDom.call(this,t,e),this.getHighlightConstants().init()},E.geras.Renderer.prototype.makeConstants_=function(){return new E.geras.ConstantProvider},E.geras.Renderer.prototype.makeRenderInfo_=function(t){return new E.geras.RenderInfo(this,t)},E.geras.Renderer.prototype.makeDrawer_=function(t,e){return new E.geras.Drawer(t,e)},E.geras.Renderer.prototype.makePathObject=function(t,e){return new E.geras.PathObject(t,e,this.getConstants())},E.geras.Renderer.prototype.makeHighlightConstants_=function(){return new E.geras.HighlightConstantProvider(this.getConstants())},E.geras.Renderer.prototype.getHighlightConstants=function(){return this.highlightConstants_},E.blockRendering.register("geras",E.geras.Renderer),E.thrasos={},E.thrasos.RenderInfo=function(t,e){E.thrasos.RenderInfo.superClass_.constructor.call(this,t,e)},E.utils.object.inherits(E.thrasos.RenderInfo,E.blockRendering.RenderInfo),E.thrasos.RenderInfo.prototype.getRenderer=function(){return this.renderer_},E.thrasos.RenderInfo.prototype.addElemSpacing_=function(){for(var t,e=!1,o=0;t=this.rows[o];o++)t.hasExternalInput&&(e=!0);for(o=0;t=this.rows[o];o++){var n=t.elements;t.elements=[],t.startsWithElemSpacer()&&t.elements.push(new E.blockRendering.InRowSpacer(this.constants_,this.getInRowSpacing_(null,n[0])));for(var i=0;i<n.length-1;i++){t.elements.push(n[i]);var r=this.getInRowSpacing_(n[i],n[i+1]);t.elements.push(new E.blockRendering.InRowSpacer(this.constants_,r))}t.elements.push(n[n.length-1]),t.endsWithElemSpacer()&&(r=this.getInRowSpacing_(n[n.length-1],null),e&&t.hasDummyInput&&(r+=this.constants_.TAB_WIDTH),t.elements.push(new E.blockRendering.InRowSpacer(this.constants_,r)))}},E.thrasos.RenderInfo.prototype.getInRowSpacing_=function(t,e){if(!t)return e&&E.blockRendering.Types.isField(e)&&e.isEditable?this.constants_.MEDIUM_PADDING:e&&E.blockRendering.Types.isInlineInput(e)?this.constants_.MEDIUM_LARGE_PADDING:e&&E.blockRendering.Types.isStatementInput(e)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!E.blockRendering.Types.isInput(t)&&!e)return E.blockRendering.Types.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:E.blockRendering.Types.isIcon(t)?2*this.constants_.LARGE_PADDING+1:E.blockRendering.Types.isHat(t)?this.constants_.NO_PADDING:E.blockRendering.Types.isPreviousOrNextConnection(t)?this.constants_.LARGE_PADDING:E.blockRendering.Types.isLeftRoundedCorner(t)?this.constants_.MIN_BLOCK_WIDTH:E.blockRendering.Types.isJaggedEdge(t)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(E.blockRendering.Types.isInput(t)&&!e){if(E.blockRendering.Types.isExternalInput(t))return this.constants_.NO_PADDING;if(E.blockRendering.Types.isInlineInput(t))return this.constants_.LARGE_PADDING;if(E.blockRendering.Types.isStatementInput(t))return this.constants_.NO_PADDING}if(!E.blockRendering.Types.isInput(t)&&e&&E.blockRendering.Types.isInput(e)){if(E.blockRendering.Types.isField(t)&&t.isEditable){if(E.blockRendering.Types.isInlineInput(e)||E.blockRendering.Types.isExternalInput(e))return this.constants_.SMALL_PADDING}else{if(E.blockRendering.Types.isInlineInput(e)||E.blockRendering.Types.isExternalInput(e))return this.constants_.MEDIUM_LARGE_PADDING;if(E.blockRendering.Types.isStatementInput(e))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(E.blockRendering.Types.isIcon(t)&&e&&!E.blockRendering.Types.isInput(e))return this.constants_.LARGE_PADDING;if(E.blockRendering.Types.isInlineInput(t)&&e&&E.blockRendering.Types.isField(e))return e.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(E.blockRendering.Types.isLeftSquareCorner(t)&&e){if(E.blockRendering.Types.isHat(e))return this.constants_.NO_PADDING;if(E.blockRendering.Types.isPreviousConnection(e)||E.blockRendering.Types.isNextConnection(e))return e.notchOffset}return E.blockRendering.Types.isLeftRoundedCorner(t)&&e?e.notchOffset-this.constants_.CORNER_RADIUS:E.blockRendering.Types.isField(t)&&e&&E.blockRendering.Types.isField(e)&&t.isEditable==e.isEditable||e&&E.blockRendering.Types.isJaggedEdge(e)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING},E.thrasos.RenderInfo.prototype.getSpacerRowHeight_=function(t,e){return E.blockRendering.Types.isTopRow(t)&&E.blockRendering.Types.isBottomRow(e)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:E.blockRendering.Types.isTopRow(t)||E.blockRendering.Types.isBottomRow(e)?this.constants_.NO_PADDING:t.hasExternalInput&&e.hasExternalInput?this.constants_.LARGE_PADDING:!t.hasStatement&&e.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:t.hasStatement&&e.hasStatement||t.hasDummyInput||e.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING},E.thrasos.RenderInfo.prototype.getElemCenterline_=function(t,e){if(E.blockRendering.Types.isSpacer(e))return t.yPos+e.height/2;if(E.blockRendering.Types.isBottomRow(t))return t=t.yPos+t.height-t.descenderHeight,E.blockRendering.Types.isNextConnection(e)?t+e.height/2:t-e.height/2;if(E.blockRendering.Types.isTopRow(t))return E.blockRendering.Types.isHat(e)?t.capline-e.height/2:t.capline+e.height/2;var o=t.yPos;return E.blockRendering.Types.isField(e)&&t.hasStatement?o+(this.constants_.TALL_INPUT_FIELD_OFFSET_Y+e.height/2):o+t.height/2},E.thrasos.RenderInfo.prototype.finalize_=function(){for(var t,e=0,o=0,n=0;t=this.rows[n];n++){t.yPos=o,t.xPos=this.startX,o+=t.height,e=Math.max(e,t.widthWithConnectedBlocks);var i=o-this.topRow.ascenderHeight;t==this.bottomRow&&i<this.constants_.MIN_BLOCK_HEIGHT&&(i=this.constants_.MIN_BLOCK_HEIGHT-i,this.bottomRow.height+=i,o+=i),this.recordElemPositions_(t)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(e=Math.max(e,this.block_.nextConnection.targetBlock().getHeightWidth().width)),this.bottomRow.baseline=o-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX,this.height=o,this.startY=this.topRow.capline},E.thrasos.Renderer=function(t){E.thrasos.Renderer.superClass_.constructor.call(this,t)},E.utils.object.inherits(E.thrasos.Renderer,E.blockRendering.Renderer),E.thrasos.Renderer.prototype.makeRenderInfo_=function(t){return new E.thrasos.RenderInfo(this,t)},E.blockRendering.register("thrasos",E.thrasos.Renderer),E.zelos={},E.zelos.ConstantProvider=function(){E.zelos.ConstantProvider.superClass_.constructor.call(this),this.SMALL_PADDING=this.GRID_UNIT=4,this.MEDIUM_PADDING=2*this.GRID_UNIT,this.MEDIUM_LARGE_PADDING=3*this.GRID_UNIT,this.LARGE_PADDING=4*this.GRID_UNIT,this.CORNER_RADIUS=1*this.GRID_UNIT,this.NOTCH_WIDTH=9*this.GRID_UNIT,this.NOTCH_HEIGHT=2*this.GRID_UNIT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=3*this.GRID_UNIT,this.MIN_BLOCK_WIDTH=2*this.GRID_UNIT,this.MIN_BLOCK_HEIGHT=12*this.GRID_UNIT,this.EMPTY_STATEMENT_INPUT_HEIGHT=6*this.GRID_UNIT,this.TAB_OFFSET_FROM_TOP=0,this.TOP_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=6*this.GRID_UNIT,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT,this.STATEMENT_INPUT_SPACER_MIN_WIDTH=40*this.GRID_UNIT,this.STATEMENT_INPUT_PADDING_LEFT=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_PADDING=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_MIN_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=6*this.GRID_UNIT,this.CURSOR_WS_WIDTH=20*this.GRID_UNIT,this.CURSOR_COLOUR="#ffa200",this.CURSOR_RADIUS=5,this.JAGGED_TEETH_WIDTH=this.JAGGED_TEETH_HEIGHT=0,this.START_HAT_HEIGHT=22,this.START_HAT_WIDTH=96,this.SHAPES={HEXAGONAL:1,ROUND:2,SQUARE:3,PUZZLE:4,NOTCH:5},this.SHAPE_IN_SHAPE_PADDING={1:{0:5*this.GRID_UNIT,1:2*this.GRID_UNIT,2:5*this.GRID_UNIT,3:5*this.GRID_UNIT},2:{0:3*this.GRID_UNIT,1:3*this.GRID_UNIT,2:1*this.GRID_UNIT,3:2*this.GRID_UNIT},3:{0:2*this.GRID_UNIT,1:2*this.GRID_UNIT,2:2*this.GRID_UNIT,3:2*this.GRID_UNIT}},this.FULL_BLOCK_FIELDS=!0,this.FIELD_TEXT_FONTSIZE=3*this.GRID_UNIT,this.FIELD_TEXT_FONTWEIGHT="bold",this.FIELD_TEXT_FONTFAMILY='"Helvetica Neue", "Segoe UI", Helvetica, sans-serif',this.FIELD_BORDER_RECT_RADIUS=this.CORNER_RADIUS,this.FIELD_BORDER_RECT_X_PADDING=2*this.GRID_UNIT,this.FIELD_BORDER_RECT_Y_PADDING=1.625*this.GRID_UNIT,this.FIELD_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!0,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=!0,this.FIELD_COLOUR_DEFAULT_WIDTH=2*this.GRID_UNIT,this.FIELD_COLOUR_DEFAULT_HEIGHT=4*this.GRID_UNIT,this.FIELD_CHECKBOX_X_OFFSET=1*this.GRID_UNIT,this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH=12*this.GRID_UNIT,this.SELECTED_GLOW_COLOUR="#fff200",this.SELECTED_GLOW_SIZE=.5,this.REPLACEMENT_GLOW_COLOUR="#fff200",this.REPLACEMENT_GLOW_SIZE=2,this.selectedGlowFilterId="",this.selectedGlowFilter_=null,this.replacementGlowFilterId="",this.replacementGlowFilter_=null},E.utils.object.inherits(E.zelos.ConstantProvider,E.blockRendering.ConstantProvider),E.zelos.ConstantProvider.prototype.setFontConstants_=function(t){E.zelos.ConstantProvider.superClass_.setFontConstants_.call(this,t),this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT=this.FIELD_TEXT_HEIGHT+2*this.FIELD_BORDER_RECT_Y_PADDING},E.zelos.ConstantProvider.prototype.init=function(){E.zelos.ConstantProvider.superClass_.init.call(this),this.HEXAGONAL=this.makeHexagonal(),this.ROUNDED=this.makeRounded(),this.SQUARED=this.makeSquared(),this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT+this.INSIDE_CORNERS.rightWidth},E.zelos.ConstantProvider.prototype.setDynamicProperties_=function(t){E.zelos.ConstantProvider.superClass_.setDynamicProperties_.call(this,t),this.SELECTED_GLOW_COLOUR=t.getComponentStyle("selectedGlowColour")||this.SELECTED_GLOW_COLOUR;var e=Number(t.getComponentStyle("selectedGlowSize"));this.SELECTED_GLOW_SIZE=e&&!isNaN(e)?e:this.SELECTED_GLOW_SIZE,this.REPLACEMENT_GLOW_COLOUR=t.getComponentStyle("replacementGlowColour")||this.REPLACEMENT_GLOW_COLOUR,this.REPLACEMENT_GLOW_SIZE=(t=Number(t.getComponentStyle("replacementGlowSize")))&&!isNaN(t)?t:this.REPLACEMENT_GLOW_SIZE},E.zelos.ConstantProvider.prototype.dispose=function(){E.zelos.ConstantProvider.superClass_.dispose.call(this),this.selectedGlowFilter_&&E.utils.dom.removeNode(this.selectedGlowFilter_),this.replacementGlowFilter_&&E.utils.dom.removeNode(this.replacementGlowFilter_)},E.zelos.ConstantProvider.prototype.makeStartHat=function(){var t=this.START_HAT_HEIGHT,e=this.START_HAT_WIDTH;return{height:t,width:e,path:E.utils.svgPaths.curve("c",[E.utils.svgPaths.point(25,-t),E.utils.svgPaths.point(71,-t),E.utils.svgPaths.point(e,0)])}},E.zelos.ConstantProvider.prototype.makeHexagonal=function(){function e(t,e,o){var n=t/2;return n=i<n?i:n,o=o?-1:1,t=(e?-1:1)*t/2,E.utils.svgPaths.lineTo(-o*n,t)+E.utils.svgPaths.lineTo(o*n,t)}var i=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;return{type:this.SHAPES.HEXAGONAL,isDynamic:!0,width:function(t){return i<(t/=2)?i:t},height:function(t){return t},connectionOffsetY:function(t){return t/2},connectionOffsetX:function(t){return-t},pathDown:function(t){return e(t,!1,!1)},pathUp:function(t){return e(t,!0,!1)},pathRightDown:function(t){return e(t,!1,!0)},pathRightUp:function(t){return e(t,!1,!0)}}},E.zelos.ConstantProvider.prototype.makeRounded=function(){function e(t,e,o){var n=i<t?t-i:0;return t=(i<t?i:t)/2,E.utils.svgPaths.arc("a","0 0,1",t,E.utils.svgPaths.point((e?-1:1)*t,(e?-1:1)*t))+E.utils.svgPaths.lineOnAxis("v",(o?1:-1)*n)+E.utils.svgPaths.arc("a","0 0,1",t,E.utils.svgPaths.point((e?1:-1)*t,(e?-1:1)*t))}var o=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,i=2*o;return{type:this.SHAPES.ROUND,isDynamic:!0,width:function(t){return o<(t/=2)?o:t},height:function(t){return t},connectionOffsetY:function(t){return t/2},connectionOffsetX:function(t){return-t},pathDown:function(t){return e(t,!1,!1)},pathUp:function(t){return e(t,!0,!1)},pathRightDown:function(t){return e(t,!1,!0)},pathRightUp:function(t){return e(t,!1,!0)}}},E.zelos.ConstantProvider.prototype.makeSquared=function(){function e(t,e,o){return t-=2*n,E.utils.svgPaths.arc("a","0 0,1",n,E.utils.svgPaths.point((e?-1:1)*n,(e?-1:1)*n))+E.utils.svgPaths.lineOnAxis("v",(o?1:-1)*t)+E.utils.svgPaths.arc("a","0 0,1",n,E.utils.svgPaths.point((e?1:-1)*n,(e?-1:1)*n))}var n=this.CORNER_RADIUS;return{type:this.SHAPES.SQUARE,isDynamic:!0,width:function(t){return n},height:function(t){return t},connectionOffsetY:function(t){return t/2},connectionOffsetX:function(t){return-t},pathDown:function(t){return e(t,!1,!1)},pathUp:function(t){return e(t,!0,!1)},pathRightDown:function(t){return e(t,!1,!0)},pathRightUp:function(t){return e(t,!1,!0)}}},E.zelos.ConstantProvider.prototype.shapeFor=function(t){var e=t.getCheck();switch(!e&&t.targetConnection&&(e=t.targetConnection.getCheck()),t.type){case E.INPUT_VALUE:case E.OUTPUT_VALUE:if(null!=(t=t.getSourceBlock().getOutputShape()))switch(t){case this.SHAPES.HEXAGONAL:return this.HEXAGONAL;case this.SHAPES.ROUND:return this.ROUNDED;case this.SHAPES.SQUARE:return this.SQUARED}return e&&-1!=e.indexOf("Boolean")?this.HEXAGONAL:(e&&-1!=e.indexOf("Number")||e&&e.indexOf("String"),this.ROUNDED);case E.PREVIOUS_STATEMENT:case E.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown type")}},E.zelos.ConstantProvider.prototype.makeNotch=function(){function t(t){return E.utils.svgPaths.curve("c",[E.utils.svgPaths.point(t*i/2,0),E.utils.svgPaths.point(t*i*3/4,s/2),E.utils.svgPaths.point(t*i,s)])+E.utils.svgPaths.line([E.utils.svgPaths.point(t*i,r)])+E.utils.svgPaths.curve("c",[E.utils.svgPaths.point(t*i/4,s/2),E.utils.svgPaths.point(t*i/2,s),E.utils.svgPaths.point(t*i,s)])+E.utils.svgPaths.lineOnAxis("h",t*n)+E.utils.svgPaths.curve("c",[E.utils.svgPaths.point(t*i/2,0),E.utils.svgPaths.point(t*i*3/4,-s/2),E.utils.svgPaths.point(t*i,-s)])+E.utils.svgPaths.line([E.utils.svgPaths.point(t*i,-r)])+E.utils.svgPaths.curve("c",[E.utils.svgPaths.point(t*i/4,-s/2),E.utils.svgPaths.point(t*i/2,-s),E.utils.svgPaths.point(t*i,-s)])}var e=this.NOTCH_WIDTH,o=this.NOTCH_HEIGHT,n=e/3,i=n/3,r=o/2,s=r/2,a=t(1),l=t(-1);return{type:this.SHAPES.NOTCH,width:e,height:o,pathLeft:a,pathRight:l}},E.zelos.ConstantProvider.prototype.makeInsideCorners=function(){var t=this.CORNER_RADIUS,e=E.utils.svgPaths.arc("a","0 0,0",t,E.utils.svgPaths.point(-t,t)),o=E.utils.svgPaths.arc("a","0 0,1",t,E.utils.svgPaths.point(-t,t));return{width:t,height:t,pathTop:e,pathBottom:E.utils.svgPaths.arc("a","0 0,0",t,E.utils.svgPaths.point(t,t)),rightWidth:t,rightHeight:t,pathTopRight:o,pathBottomRight:E.utils.svgPaths.arc("a","0 0,1",t,E.utils.svgPaths.point(t,t))}},E.zelos.ConstantProvider.prototype.generateSecondaryColour_=function(t){return E.utils.colour.blend("#000",t,.15)||t},E.zelos.ConstantProvider.prototype.generateTertiaryColour_=function(t){return E.utils.colour.blend("#000",t,.25)||t},E.zelos.ConstantProvider.prototype.createDom=function(t,e,o){E.zelos.ConstantProvider.superClass_.createDom.call(this,t,e,o),t=E.utils.dom.createSvgElement(E.utils.Svg.DEFS,{},t),e=E.utils.dom.createSvgElement(E.utils.Svg.FILTER,{id:"blocklySelectedGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},t),E.utils.dom.createSvgElement(E.utils.Svg.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.SELECTED_GLOW_SIZE},e),o=E.utils.dom.createSvgElement(E.utils.Svg.FECOMPONENTTRANSFER,{result:"outBlur"},e),E.utils.dom.createSvgElement(E.utils.Svg.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},o),E.utils.dom.createSvgElement(E.utils.Svg.FEFLOOD,{"flood-color":this.SELECTED_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},e),E.utils.dom.createSvgElement(E.utils.Svg.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),this.selectedGlowFilterId=e.id,this.selectedGlowFilter_=e,t=E.utils.dom.createSvgElement(E.utils.Svg.FILTER,{id:"blocklyReplacementGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},t),E.utils.dom.createSvgElement(E.utils.Svg.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.REPLACEMENT_GLOW_SIZE},t),e=E.utils.dom.createSvgElement(E.utils.Svg.FECOMPONENTTRANSFER,{result:"outBlur"},t),E.utils.dom.createSvgElement(E.utils.Svg.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},e),E.utils.dom.createSvgElement(E.utils.Svg.FEFLOOD,{"flood-color":this.REPLACEMENT_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},t),E.utils.dom.createSvgElement(E.utils.Svg.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),E.utils.dom.createSvgElement(E.utils.Svg.FECOMPOSITE,{in:"SourceGraphic",in2:"outGlow",operator:"over"},t),this.replacementGlowFilterId=t.id,this.replacementGlowFilter_=t},E.zelos.ConstantProvider.prototype.getCSS_=function(t){return[t+" .blocklyText,",t+" .blocklyFlyoutLabelText {","font: "+this.FIELD_TEXT_FONTWEIGHT+" "+this.FIELD_TEXT_FONTSIZE+"pt "+this.FIELD_TEXT_FONTFAMILY+";","}",t+" .blocklyText {","fill: #fff;","}",t+" .blocklyNonEditableText>rect:not(.blocklyDropdownRect),",t+" .blocklyEditableText>rect:not(.blocklyDropdownRect) {","fill: "+this.FIELD_BORDER_RECT_COLOUR+";","}",t+" .blocklyNonEditableText>text,",t+" .blocklyEditableText>text,",t+" .blocklyNonEditableText>g>text,",t+" .blocklyEditableText>g>text {","fill: #575E75;","}",t+" .blocklyFlyoutLabelText {","fill: #575E75;","}",t+" .blocklyText.blocklyBubbleText {","fill: #575E75;","}",t+" .blocklyDraggable:not(.blocklyDisabled)"," .blocklyEditableText:not(.editing):hover>rect,",t+" .blocklyDraggable:not(.blocklyDisabled)"," .blocklyEditableText:not(.editing):hover>.blocklyPath {","stroke: #fff;","stroke-width: 2;","}",t+" .blocklyHtmlInput {","font-family: "+this.FIELD_TEXT_FONTFAMILY+";","font-weight: "+this.FIELD_TEXT_FONTWEIGHT+";","color: #575E75;","}",t+" .blocklyDropdownText {","fill: #fff !important;","}",t+".blocklyWidgetDiv .goog-menuitem,",t+".blocklyDropDownDiv .goog-menuitem {","font-family: "+this.FIELD_TEXT_FONTFAMILY+";","}",t+".blocklyDropDownDiv .goog-menuitem-content {","color: #fff;","}",t+" .blocklyHighlightedConnectionPath {","stroke: "+this.SELECTED_GLOW_COLOUR+";","}",t+" .blocklyDisabled > .blocklyOutlinePath {","fill: url(#blocklyDisabledPattern"+this.randomIdentifier+")","}",t+" .blocklyInsertionMarker>.blocklyPath {","fill-opacity: "+this.INSERTION_MARKER_OPACITY+";","stroke: none;","}"]},E.zelos.TopRow=function(t){E.zelos.TopRow.superClass_.constructor.call(this,t)},E.utils.object.inherits(E.zelos.TopRow,E.blockRendering.TopRow),E.zelos.TopRow.prototype.endsWithElemSpacer=function(){return!1},E.zelos.TopRow.prototype.hasLeftSquareCorner=function(t){var e=(t.hat?"cap"===t.hat:this.constants_.ADD_START_HATS)&&!t.outputConnection&&!t.previousConnection;return!!t.outputConnection||e},E.zelos.TopRow.prototype.hasRightSquareCorner=function(t){return!!t.outputConnection&&!t.statementInputCount&&!t.nextConnection},E.zelos.BottomRow=function(t){E.zelos.BottomRow.superClass_.constructor.call(this,t)},E.utils.object.inherits(E.zelos.BottomRow,E.blockRendering.BottomRow),E.zelos.BottomRow.prototype.endsWithElemSpacer=function(){return!1},E.zelos.BottomRow.prototype.hasLeftSquareCorner=function(t){return!!t.outputConnection},E.zelos.BottomRow.prototype.hasRightSquareCorner=function(t){return!!t.outputConnection&&!t.statementInputCount&&!t.nextConnection},E.zelos.RightConnectionShape=function(t){E.zelos.RightConnectionShape.superClass_.constructor.call(this,t),this.type|=E.blockRendering.Types.getType("RIGHT_CONNECTION"),this.width=this.height=0},E.utils.object.inherits(E.zelos.RightConnectionShape,E.blockRendering.Measurable),E.zelos.StatementInput=function(t,e){if(E.zelos.StatementInput.superClass_.constructor.call(this,t,e),this.connectedBlock){for(t=this.connectedBlock;t.getNextBlock();)t=t.getNextBlock();t.nextConnection||(this.height=this.connectedBlockHeight,this.connectedBottomNextConnection=!0)}},E.utils.object.inherits(E.zelos.StatementInput,E.blockRendering.StatementInput),E.zelos.RenderInfo=function(t,e){E.zelos.RenderInfo.superClass_.constructor.call(this,t,e),this.topRow=new E.zelos.TopRow(this.constants_),this.bottomRow=new E.zelos.BottomRow(this.constants_),this.isInline=!0,this.isMultiRow=!e.getInputsInline()||e.isCollapsed(),this.hasStatementInput=0<e.statementInputCount,this.rightSide=this.outputConnection?new E.zelos.RightConnectionShape(this.constants_):null},E.utils.object.inherits(E.zelos.RenderInfo,E.blockRendering.RenderInfo),E.zelos.RenderInfo.prototype.getRenderer=function(){return this.renderer_},E.zelos.RenderInfo.prototype.measure=function(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.adjustXPosition_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()},E.zelos.RenderInfo.prototype.shouldStartNewRow_=function(t,e){return!!e&&(t.type==E.NEXT_STATEMENT||e.type==E.NEXT_STATEMENT||(t.type==E.INPUT_VALUE||t.type==E.DUMMY_INPUT)&&(!this.isInline||this.isMultiRow))},E.zelos.RenderInfo.prototype.getDesiredRowWidth_=function(t){return t.hasStatement?this.width-this.startX-(this.constants_.INSIDE_CORNERS.rightWidth||0):E.zelos.RenderInfo.superClass_.getDesiredRowWidth_.call(this,t)},E.zelos.RenderInfo.prototype.getInRowSpacing_=function(t,e){return t&&e||!this.outputConnection||!this.outputConnection.isDynamicShape||this.hasStatementInput||this.bottomRow.hasNextConnection?!t&&e&&E.blockRendering.Types.isStatementInput(e)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:t&&E.blockRendering.Types.isLeftRoundedCorner(t)&&e&&(E.blockRendering.Types.isPreviousConnection(e)||E.blockRendering.Types.isNextConnection(e))?e.notchOffset-this.constants_.CORNER_RADIUS:t&&E.blockRendering.Types.isLeftSquareCorner(t)&&e&&E.blockRendering.Types.isHat(e)?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:this.constants_.NO_PADDING},E.zelos.RenderInfo.prototype.getSpacerRowHeight_=function(t,e){if(E.blockRendering.Types.isTopRow(t)&&E.blockRendering.Types.isBottomRow(e))return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;var o=E.blockRendering.Types.isInputRow(t)&&t.hasStatement,n=E.blockRendering.Types.isInputRow(e)&&e.hasStatement;return n||o?(t=Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.INSIDE_CORNERS.rightHeight||0),n&&o?Math.max(t,this.constants_.DUMMY_INPUT_MIN_HEIGHT):t):E.blockRendering.Types.isTopRow(t)?t.hasPreviousConnection||this.outputConnection&&!this.hasStatementInput?this.constants_.NO_PADDING:Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):E.blockRendering.Types.isBottomRow(e)?this.outputConnection?!e.hasNextConnection&&this.hasStatementInput?Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):this.constants_.NO_PADDING:Math.max(this.topRow.minHeight,Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.CORNER_RADIUS))-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING},E.zelos.RenderInfo.prototype.getSpacerRowWidth_=function(t,e){var o=this.width-this.startX;return E.blockRendering.Types.isInputRow(t)&&t.hasStatement||E.blockRendering.Types.isInputRow(e)&&e.hasStatement?Math.max(o,this.constants_.STATEMENT_INPUT_SPACER_MIN_WIDTH):o},E.zelos.RenderInfo.prototype.getElemCenterline_=function(t,e){if(t.hasStatement&&!E.blockRendering.Types.isSpacer(e)&&!E.blockRendering.Types.isStatementInput(e))return t.yPos+this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT/2;if(E.blockRendering.Types.isInlineInput(e)){var o=e.connectedBlock;if(o&&o.outputConnection&&o.nextConnection)return t.yPos+o.height/2}return E.zelos.RenderInfo.superClass_.getElemCenterline_.call(this,t,e)},E.zelos.RenderInfo.prototype.addInput_=function(t,e){t.type==E.DUMMY_INPUT&&e.hasDummyInput&&e.align==E.ALIGN_LEFT&&t.align==E.ALIGN_RIGHT&&(e.rightAlignedDummyInput=t),E.zelos.RenderInfo.superClass_.addInput_.call(this,t,e)},E.zelos.RenderInfo.prototype.addAlignmentPadding_=function(t,e){if(t.rightAlignedDummyInput){for(var o,n,i=0;(n=t.elements[i])&&(E.blockRendering.Types.isSpacer(n)&&(o=n),!E.blockRendering.Types.isField(n)||n.parentInput!=t.rightAlignedDummyInput);i++);if(o)return o.width+=e,void(t.width+=e)}E.zelos.RenderInfo.superClass_.addAlignmentPadding_.call(this,t,e)},E.zelos.RenderInfo.prototype.adjustXPosition_=function(){for(var t=this.constants_.NOTCH_OFFSET_LEFT+this.constants_.NOTCH_WIDTH,e=t,o=2;o<this.rows.length-1;o+=2){var n=this.rows[o-1],i=this.rows[o],r=this.rows[o+1];if(n=2==o?!!this.topRow.hasPreviousConnection:!!n.followsStatement,r=o+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!r.precedesStatement,E.blockRendering.Types.isInputRow(i)&&i.hasStatement)i.measure(),e=i.width-i.getLastInput().width+t;else if(n&&(2==o||r)&&E.blockRendering.Types.isInputRow(i)&&!i.hasStatement){r=i.xPos,n=null;for(var s,a=0;s=i.elements[a];a++)E.blockRendering.Types.isSpacer(s)&&(n=s),!(n&&(E.blockRendering.Types.isField(s)||E.blockRendering.Types.isInput(s))&&r<e)||E.blockRendering.Types.isField(s)&&(s.field instanceof E.FieldLabel||s.field instanceof E.FieldImage)||(n.width+=e-r),r+=s.width}}},E.zelos.RenderInfo.prototype.finalizeOutputConnection_=function(){if(this.outputConnection&&this.outputConnection.isDynamicShape){for(var t,e=0,o=0;t=this.rows[o];o++)t.yPos=e,e+=t.height;this.height=e,o=this.bottomRow.hasNextConnection?this.height-this.bottomRow.descenderHeight:this.height,e=this.outputConnection.shape.height(o),o=this.outputConnection.shape.width(o),this.outputConnection.height=e,this.outputConnection.width=o,this.outputConnection.startX=o,this.outputConnection.connectionOffsetY=this.outputConnection.shape.connectionOffsetY(e),this.outputConnection.connectionOffsetX=this.outputConnection.shape.connectionOffsetX(o),t=0,this.hasStatementInput||this.bottomRow.hasNextConnection||(t=o,this.rightSide.height=e,this.rightSide.width=t,this.rightSide.centerline=e/2,this.rightSide.xPos=this.width+t),this.startX=o,this.width+=o+t,this.widthWithChildren+=o+t}},E.zelos.RenderInfo.prototype.finalizeHorizontalAlignment_=function(){if(this.outputConnection&&!this.hasStatementInput&&!this.bottomRow.hasNextConnection){for(var t,e=0,o=0;t=this.rows[o];o++)if(E.blockRendering.Types.isInputRow(t)){e=t.elements[t.elements.length-2];var n=this.getNegativeSpacing_(t.elements[1]),i=this.getNegativeSpacing_(e);e=n+i;var r=this.constants_.MIN_BLOCK_WIDTH+2*this.outputConnection.width;this.width-e<r&&(i=n=(e=this.width-r)/2),t.elements.unshift(new E.blockRendering.InRowSpacer(this.constants_,-n)),t.elements.push(new E.blockRendering.InRowSpacer(this.constants_,-i))}if(e)for(this.width-=e,this.widthWithChildren-=e,this.rightSide.xPos-=e,o=0;t=this.rows[o];o++)E.blockRendering.Types.isTopOrBottomRow(t)&&(t.elements[1].width-=e,t.elements[1].widthWithConnectedBlocks-=e),t.width-=e,t.widthWithConnectedBlocks-=e}},E.zelos.RenderInfo.prototype.getNegativeSpacing_=function(t){if(!t)return 0;var e=this.outputConnection.width,o=this.outputConnection.shape.type,n=this.constants_;if(this.isMultiRow&&1<this.inputRows.length)switch(o){case n.SHAPES.ROUND:return o=this.constants_.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,e-(o=this.height/2>o?o:this.height/2)*(1-Math.sin(Math.acos((o-this.constants_.SMALL_PADDING)/o)));default:return 0}if(E.blockRendering.Types.isInlineInput(t)){var i=t.connectedBlock;return t=i?i.pathObject.outputShapeType:t.shape.type,i&&i.outputConnection&&(i.statementInputCount||i.nextConnection)||o==n.SHAPES.HEXAGONAL&&o!=t?0:e-this.constants_.SHAPE_IN_SHAPE_PADDING[o][t]}return E.blockRendering.Types.isField(t)?o==n.SHAPES.ROUND&&t.field instanceof E.FieldTextInput?e-2.75*n.GRID_UNIT:e-this.constants_.SHAPE_IN_SHAPE_PADDING[o][0]:E.blockRendering.Types.isIcon(t)?this.constants_.SMALL_PADDING:0},E.zelos.RenderInfo.prototype.finalizeVerticalAlignment_=function(){if(!this.outputConnection)for(var t=2;t<this.rows.length-1;t+=2){var e=this.rows[t-1],o=this.rows[t],n=this.rows[t+1],i=2==t,r=t+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!n.precedesStatement;if(i?this.topRow.hasPreviousConnection:e.followsStatement){var s=3==o.elements.length&&(o.elements[1].field instanceof E.FieldLabel||o.elements[1].field instanceof E.FieldImage);if(!i&&s)e.height-=this.constants_.SMALL_PADDING,n.height-=this.constants_.SMALL_PADDING,o.height-=this.constants_.MEDIUM_PADDING;else if(i||r){if(r){for(i=!1,r=0;s=o.elements[r];r++)if(E.blockRendering.Types.isInlineInput(s)&&s.connectedBlock&&!s.connectedBlock.isShadow()&&40<=s.connectedBlock.getHeightWidth().height){i=!0;break}i&&(e.height-=this.constants_.SMALL_PADDING,n.height-=this.constants_.SMALL_PADDING)}}else e.height+=this.constants_.SMALL_PADDING}}},E.zelos.RenderInfo.prototype.finalize_=function(){this.finalizeOutputConnection_(),this.finalizeHorizontalAlignment_(),this.finalizeVerticalAlignment_(),E.zelos.RenderInfo.superClass_.finalize_.call(this),this.rightSide&&(this.widthWithChildren+=this.rightSide.width)},E.zelos.Drawer=function(t,e){E.zelos.Drawer.superClass_.constructor.call(this,t,e)},E.utils.object.inherits(E.zelos.Drawer,E.blockRendering.Drawer),E.zelos.Drawer.prototype.draw=function(){var t=this.block_.pathObject;t.beginDrawing(),this.hideHiddenIcons_(),this.drawOutline_(),this.drawInternals_(),t.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&t.flipRTL(),E.blockRendering.useDebugger&&this.block_.renderingDebugger.drawDebug(this.block_,this.info_),this.recordSizeOnBlock_(),this.info_.outputConnection&&(t.outputShapeType=this.info_.outputConnection.shape.type),t.endDrawing()},E.zelos.Drawer.prototype.drawOutline_=function(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape&&!this.info_.hasStatementInput&&!this.info_.bottomRow.hasNextConnection?(this.drawFlatTop_(),this.drawRightDynamicConnection_(),this.drawFlatBottom_(),this.drawLeftDynamicConnection_()):E.zelos.Drawer.superClass_.drawOutline_.call(this)},E.zelos.Drawer.prototype.drawLeft_=function(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape?this.drawLeftDynamicConnection_():E.zelos.Drawer.superClass_.drawLeft_.call(this)},E.zelos.Drawer.prototype.drawRightSideRow_=function(t){if(!(t.height<=0))if(t.precedesStatement||t.followsStatement){var e=this.constants_.INSIDE_CORNERS.rightHeight;e=t.height-(t.precedesStatement?e:0),this.outlinePath_+=(t.followsStatement?this.constants_.INSIDE_CORNERS.pathBottomRight:"")+(0<e?E.utils.svgPaths.lineOnAxis("V",t.yPos+e):"")+(t.precedesStatement?this.constants_.INSIDE_CORNERS.pathTopRight:"")}else this.outlinePath_+=E.utils.svgPaths.lineOnAxis("V",t.yPos+t.height)},E.zelos.Drawer.prototype.drawRightDynamicConnection_=function(){this.outlinePath_+=this.info_.outputConnection.shape.pathRightDown(this.info_.outputConnection.height)},E.zelos.Drawer.prototype.drawLeftDynamicConnection_=function(){this.positionOutputConnection_(),this.outlinePath_+=this.info_.outputConnection.shape.pathUp(this.info_.outputConnection.height),this.outlinePath_+="z"},E.zelos.Drawer.prototype.drawFlatTop_=function(){var t=this.info_.topRow;this.positionPreviousConnection_(),this.outlinePath_+=E.utils.svgPaths.moveBy(t.xPos,this.info_.startY),this.outlinePath_+=E.utils.svgPaths.lineOnAxis("h",t.width)},E.zelos.Drawer.prototype.drawFlatBottom_=function(){var t=this.info_.bottomRow;this.positionNextConnection_(),this.outlinePath_+=E.utils.svgPaths.lineOnAxis("V",t.baseline),this.outlinePath_+=E.utils.svgPaths.lineOnAxis("h",-t.width)},E.zelos.Drawer.prototype.drawInlineInput_=function(t){this.positionInlineInputConnection_(t);var e=t.input.name;if(!t.connectedBlock&&!this.info_.isInsertionMarker){var o=t.width-2*t.connectionWidth;t=E.utils.svgPaths.moveTo(t.xPos+t.connectionWidth,t.centerline-t.height/2)+E.utils.svgPaths.lineOnAxis("h",o)+t.shape.pathRightDown(t.height)+E.utils.svgPaths.lineOnAxis("h",-o)+t.shape.pathUp(t.height)+"z",this.block_.pathObject.setOutlinePath(e,t)}},E.zelos.Drawer.prototype.drawStatementInput_=function(t){var e=t.getLastInput(),o=e.xPos+e.notchOffset+e.shape.width,n=e.shape.pathRight+E.utils.svgPaths.lineOnAxis("h",-(e.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop,i=t.height-2*this.constants_.INSIDE_CORNERS.height;e=this.constants_.INSIDE_CORNERS.pathBottom+E.utils.svgPaths.lineOnAxis("h",e.notchOffset-this.constants_.INSIDE_CORNERS.width)+(e.connectedBottomNextConnection?"":e.shape.pathLeft),this.outlinePath_+=E.utils.svgPaths.lineOnAxis("H",o)+n+E.utils.svgPaths.lineOnAxis("v",i)+e+E.utils.svgPaths.lineOnAxis("H",t.xPos+t.width),this.positionStatementInputConnection_(t)},E.zelos.PathObject=function(t,e,o){E.zelos.PathObject.superClass_.constructor.call(this,t,e,o),this.constants=o,this.svgPathSelected_=null,this.outlines_={},this.outputShapeType=this.remainingOutlines_=null},E.utils.object.inherits(E.zelos.PathObject,E.blockRendering.PathObject),E.zelos.PathObject.prototype.setPath=function(t){E.zelos.PathObject.superClass_.setPath.call(this,t),this.svgPathSelected_&&this.svgPathSelected_.setAttribute("d",t)},E.zelos.PathObject.prototype.applyColour=function(t){E.zelos.PathObject.superClass_.applyColour.call(this,t),t.isShadow()&&t.getParent()&&this.svgPath.setAttribute("stroke",t.getParent().style.colourTertiary),t=0;for(var e,o=Object.keys(this.outlines_);e=o[t];t++)this.outlines_[e].setAttribute("fill",this.style.colourTertiary)},E.zelos.PathObject.prototype.flipRTL=function(){E.zelos.PathObject.superClass_.flipRTL.call(this);for(var t,e=0,o=Object.keys(this.outlines_);t=o[e];e++)this.outlines_[t].setAttribute("transform","scale(-1 1)")},E.zelos.PathObject.prototype.updateSelected=function(t){this.setClass_("blocklySelected",t),t?this.svgPathSelected_||(this.svgPathSelected_=this.svgPath.cloneNode(!0),this.svgPathSelected_.setAttribute("fill","none"),this.svgPathSelected_.setAttribute("filter","url(#"+this.constants.selectedGlowFilterId+")"),this.svgRoot.appendChild(this.svgPathSelected_)):this.svgPathSelected_&&(this.svgRoot.removeChild(this.svgPathSelected_),this.svgPathSelected_=null)},E.zelos.PathObject.prototype.updateReplacementFade=function(t){this.setClass_("blocklyReplaceable",t),t?this.svgPath.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):this.svgPath.removeAttribute("filter")},E.zelos.PathObject.prototype.updateShapeForInputHighlight=function(t,e){t=t.getParentInput().name,(t=this.getOutlinePath_(t))&&(e?t.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):t.removeAttribute("filter"))},E.zelos.PathObject.prototype.beginDrawing=function(){this.remainingOutlines_={};for(var t,e=0,o=Object.keys(this.outlines_);t=o[e];e++)this.remainingOutlines_[t]=1},E.zelos.PathObject.prototype.endDrawing=function(){if(this.remainingOutlines_)for(var t,e=0,o=Object.keys(this.remainingOutlines_);t=o[e];e++)this.removeOutlinePath_(t);this.remainingOutlines_=null},E.zelos.PathObject.prototype.setOutlinePath=function(t,e){(t=this.getOutlinePath_(t)).setAttribute("d",e),t.setAttribute("fill",this.style.colourTertiary)},E.zelos.PathObject.prototype.getOutlinePath_=function(t){return this.outlines_[t]||(this.outlines_[t]=E.utils.dom.createSvgElement(E.utils.Svg.PATH,{class:"blocklyOutlinePath",d:""},this.svgRoot)),this.remainingOutlines_&&delete this.remainingOutlines_[t],this.outlines_[t]},E.zelos.PathObject.prototype.removeOutlinePath_=function(t){this.outlines_[t].parentNode.removeChild(this.outlines_[t]),delete this.outlines_[t]},E.zelos.MarkerSvg=function(t,e,o){E.zelos.MarkerSvg.superClass_.constructor.call(this,t,e,o)},E.utils.object.inherits(E.zelos.MarkerSvg,E.blockRendering.MarkerSvg),E.zelos.MarkerSvg.prototype.showWithInputOutput_=function(t){var e=t.getSourceBlock();t=t.getLocation().getOffsetInBlock(),this.positionCircle_(t.x,t.y),this.setParent_(e),this.showCurrent_()},E.zelos.MarkerSvg.prototype.showWithOutput_=function(t){this.showWithInputOutput_(t)},E.zelos.MarkerSvg.prototype.showWithInput_=function(t){this.showWithInputOutput_(t)},E.zelos.MarkerSvg.prototype.showWithBlock_=function(t){var e=(t=t.getLocation()).getHeightWidth();this.positionRect_(0,0,e.width,e.height),this.setParent_(t),this.showCurrent_()},E.zelos.MarkerSvg.prototype.positionCircle_=function(t,e){this.markerCircle_.setAttribute("cx",t),this.markerCircle_.setAttribute("cy",e),this.currentMarkerSvg=this.markerCircle_},E.zelos.MarkerSvg.prototype.hide=function(){E.zelos.MarkerSvg.superClass_.hide.call(this),this.markerCircle_.style.display="none"},E.zelos.MarkerSvg.prototype.createDomInternal_=function(){if(E.zelos.MarkerSvg.superClass_.createDomInternal_.call(this),this.markerCircle_=E.utils.dom.createSvgElement(E.utils.Svg.CIRCLE,{r:this.constants_.CURSOR_RADIUS,style:"display: none","stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.isCursor()){var t=this.getBlinkProperties_();E.utils.dom.createSvgElement(E.utils.Svg.ANIMATE,t,this.markerCircle_)}return this.markerSvg_},E.zelos.MarkerSvg.prototype.applyColour_=function(t){E.zelos.MarkerSvg.superClass_.applyColour_.call(this,t),this.markerCircle_.setAttribute("fill",this.colour_),this.markerCircle_.setAttribute("stroke",this.colour_),this.isCursor()&&this.markerCircle_.firstChild.setAttribute("values",this.colour_+";transparent;transparent;")},E.zelos.Renderer=function(t){E.zelos.Renderer.superClass_.constructor.call(this,t)},E.utils.object.inherits(E.zelos.Renderer,E.blockRendering.Renderer),E.zelos.Renderer.prototype.makeConstants_=function(){return new E.zelos.ConstantProvider},E.zelos.Renderer.prototype.makeRenderInfo_=function(t){return new E.zelos.RenderInfo(this,t)},E.zelos.Renderer.prototype.makeDrawer_=function(t,e){return new E.zelos.Drawer(t,e)},E.zelos.Renderer.prototype.makeMarkerDrawer=function(t,e){return new E.zelos.MarkerSvg(t,this.getConstants(),e)},E.zelos.Renderer.prototype.makePathObject=function(t,e){return new E.zelos.PathObject(t,e,this.getConstants())},E.zelos.Renderer.prototype.shouldHighlightConnection=function(t){return t.type!=E.INPUT_VALUE&&t.type!==E.OUTPUT_VALUE},E.zelos.Renderer.prototype.getConnectionPreviewMethod=function(t,e,o){return e.type==E.OUTPUT_VALUE?t.isConnected()?E.InsertionMarkerManager.PREVIEW_TYPE.REPLACEMENT_FADE:E.InsertionMarkerManager.PREVIEW_TYPE.INPUT_OUTLINE:E.zelos.Renderer.superClass_.getConnectionPreviewMethod(t,e,o)},E.blockRendering.register("zelos",E.zelos.Renderer),E.Themes.Dark=E.Theme.defineTheme("dark",{base:E.Themes.Classic,componentStyles:{workspaceBackgroundColour:"#1e1e1e",toolboxBackgroundColour:"blackBackground",toolboxForegroundColour:"#fff",flyoutBackgroundColour:"#252526",flyoutForegroundColour:"#ccc",flyoutOpacity:1,scrollbarColour:"#797979",insertionMarkerColour:"#fff",insertionMarkerOpacity:.3,scrollbarOpacity:.4,cursorColour:"#d0d0d0",blackBackground:"#333"}}),E.Themes.Deuteranopia={},E.Themes.Deuteranopia.defaultBlockStyles={colour_blocks:{colourPrimary:"#f2a72c",colourSecondary:"#f1c172",colourTertiary:"#da921c"},list_blocks:{colourPrimary:"#7d65ab",colourSecondary:"#a88be0",colourTertiary:"#66518e"},logic_blocks:{colourPrimary:"#9fd2f1",colourSecondary:"#c0e0f4",colourTertiary:"#74bae5"},loop_blocks:{colourPrimary:"#795a07",colourSecondary:"#ac8726",colourTertiary:"#c4a03f"},math_blocks:{colourPrimary:"#e6da39",colourSecondary:"#f3ec8e",colourTertiary:"#f2eeb7"},procedure_blocks:{colourPrimary:"#590721",colourSecondary:"#8c475d",colourTertiary:"#885464"},text_blocks:{colourPrimary:"#058863",colourSecondary:"#5ecfaf",colourTertiary:"#04684c"},variable_blocks:{colourPrimary:"#47025a",colourSecondary:"#820fa1",colourTertiary:"#8e579d"},variable_dynamic_blocks:{colourPrimary:"#47025a",colourSecondary:"#820fa1",colourTertiary:"#8e579d"}},E.Themes.Deuteranopia.categoryStyles={colour_category:{colour:"#f2a72c"},list_category:{colour:"#7d65ab"},logic_category:{colour:"#9fd2f1"},loop_category:{colour:"#795a07"},math_category:{colour:"#e6da39"},procedure_category:{colour:"#590721"},text_category:{colour:"#058863"},variable_category:{colour:"#47025a"},variable_dynamic_category:{colour:"#47025a"}},E.Themes.Deuteranopia=new E.Theme("deuteranopia",E.Themes.Deuteranopia.defaultBlockStyles,E.Themes.Deuteranopia.categoryStyles),E.Themes.HighContrast={},E.Themes.HighContrast.defaultBlockStyles={colour_blocks:{colourPrimary:"#a52714",colourSecondary:"#FB9B8C",colourTertiary:"#FBE1DD"},list_blocks:{colourPrimary:"#4a148c",colourSecondary:"#AD7BE9",colourTertiary:"#CDB6E9"},logic_blocks:{colourPrimary:"#01579b",colourSecondary:"#64C7FF",colourTertiary:"#C5EAFF"},loop_blocks:{colourPrimary:"#33691e",colourSecondary:"#9AFF78",colourTertiary:"#E1FFD7"},math_blocks:{colourPrimary:"#1a237e",colourSecondary:"#8A9EFF",colourTertiary:"#DCE2FF"},procedure_blocks:{colourPrimary:"#006064",colourSecondary:"#77E6EE",colourTertiary:"#CFECEE"},text_blocks:{colourPrimary:"#004d40",colourSecondary:"#5ae27c",colourTertiary:"#D2FFDD"},variable_blocks:{colourPrimary:"#880e4f",colourSecondary:"#FF73BE",colourTertiary:"#FFD4EB"},variable_dynamic_blocks:{colourPrimary:"#880e4f",colourSecondary:"#FF73BE",colourTertiary:"#FFD4EB"},hat_blocks:{colourPrimary:"#880e4f",colourSecondary:"#FF73BE",colourTertiary:"#FFD4EB",hat:"cap"}},E.Themes.HighContrast.categoryStyles={colour_category:{colour:"#a52714"},list_category:{colour:"#4a148c"},logic_category:{colour:"#01579b"},loop_category:{colour:"#33691e"},math_category:{colour:"#1a237e"},procedure_category:{colour:"#006064"},text_category:{colour:"#004d40"},variable_category:{colour:"#880e4f"},variable_dynamic_category:{colour:"#880e4f"}},E.Themes.HighContrast=new E.Theme("highcontrast",E.Themes.HighContrast.defaultBlockStyles,E.Themes.HighContrast.categoryStyles),E.Themes.HighContrast.setComponentStyle("selectedGlowColour","#000000"),E.Themes.HighContrast.setComponentStyle("selectedGlowSize",1),E.Themes.HighContrast.setComponentStyle("replacementGlowColour","#000000"),E.Themes.HighContrast.setFontStyle({family:null,weight:null,size:16}),E.Themes.Tritanopia={},E.Themes.Tritanopia.defaultBlockStyles={colour_blocks:{colourPrimary:"#05427f",colourSecondary:"#2974c0",colourTertiary:"#2d74bb"},list_blocks:{colourPrimary:"#b69ce8",colourSecondary:"#ccbaef",colourTertiary:"#9176c5"},logic_blocks:{colourPrimary:"#9fd2f1",colourSecondary:"#c0e0f4",colourTertiary:"#74bae5"},loop_blocks:{colourPrimary:"#aa1846",colourSecondary:"#d36185",colourTertiary:"#7c1636"},math_blocks:{colourPrimary:"#e6da39",colourSecondary:"#f3ec8e",colourTertiary:"#f2eeb7"},procedure_blocks:{colourPrimary:"#590721",colourSecondary:"#8c475d",colourTertiary:"#885464"},text_blocks:{colourPrimary:"#058863",colourSecondary:"#5ecfaf",colourTertiary:"#04684c"},variable_blocks:{colourPrimary:"#4b2d84",colourSecondary:"#816ea7",colourTertiary:"#83759e"},variable_dynamic_blocks:{colourPrimary:"#4b2d84",colourSecondary:"#816ea7",colourTertiary:"#83759e"}},E.Themes.Tritanopia.categoryStyles={colour_category:{colour:"#05427f"},list_category:{colour:"#b69ce8"},logic_category:{colour:"#9fd2f1"},loop_category:{colour:"#aa1846"},math_category:{colour:"#e6da39"},procedure_category:{colour:"#590721"},text_category:{colour:"#058863"},variable_category:{colour:"#4b2d84"},variable_dynamic_category:{colour:"#4b2d84"}},E.Themes.Tritanopia=new E.Theme("tritanopia",E.Themes.Tritanopia.defaultBlockStyles,E.Themes.Tritanopia.categoryStyles),E.requires={},E})?e.apply(r,o):e)||(i.exports=n)}).call(this,t(31))},345:function(t,e,o){var n=o(79).f,i=o(135),r=o(50)("toStringTag");t.exports=function(t,e,o){t&&!i(t=o?t:t.prototype,r)&&n(t,r,{configurable:!0,value:e})}},346:function(t,e,o){var s=o(10),n=o(204),a=o(39),l=o(879),i="["+l+"]",r=RegExp("^"+i+i+"*"),c=RegExp(i+i+"*$"),u=function(t,e,o){var n={},i=a(function(){return!!l[t]()||""!=""[t]()}),r=n[t]=i?e(h):l[t];o&&(n[o]=r),s(s.P+s.F*i,"String",n)},h=u.trim=function(t,e){return t=String(n(t)),1&e&&(t=t.replace(r,"")),2&e&&(t=t.replace(c,"")),t};t.exports=u},347:function(t,e){t.exports={}},348:function(t,e,o){"use strict";var n=o(38),i=o(79),r=o(78),s=o(50)("species");t.exports=function(t){var e=n[t];r&&e&&!e[s]&&i.f(e,s,{configurable:!0,get:function(){return this}})}},3488:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,i=(n=o(2464))&&n.__esModule?n:{default:n};var r=function(i){function t(t,e,o){var n;return e&&(n=function(t){this.getSourceBlock()&&!this.getSourceBlock().isInsertionMarker_&&this.value_!==t&&e(t)}),i.call(this,t,n)||this}!function(t,e){t.prototype=Object.create(e.prototype),(t.prototype.constructor=t).__proto__=e}(t,i);var e=t.prototype;return e.doClassValidation_=function(t){return"???"===t?t:i.prototype.doClassValidation_.call(this,t)},e.doValueUpdate_=function(t){"???"===t?(this.value_=t,this.isDirty_=!0,this.selectedOption_=["???",""]):i.prototype.doValueUpdate_.call(this,t)},t}(i.default.FieldDropdown);e.default=r,t.exports=e.default},349:function(t,e){t.exports=function(t,e,o,n){if(!(t instanceof e)||void 0!==n&&n in t)throw TypeError(o+": incorrect invocation!");return t}},350:function(t,e,o){var i=o(123);t.exports=function(t,e,o){for(var n in e)i(t,n,e[n],o);return t}},38:function(t,e){var o=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=o)},39:function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},40:function(t,e,o){var n=o(41);t.exports=function(t){if(!n(t))throw TypeError(t+" is not an object!");return t}},41:function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},4597:function(t,e,o){o(114),o(48),t.exports=o(4598)},4598:function(t,e,o){"use strict";var n=s(o(2464)),i=s(o(4600));o(4601),o(4603);var r=s(o(4605));function s(t){return t&&t.__esModule?t:{default:t}}n.default.setLocale(i.default),window.Blockly=(0,r.default)(n.default)},4599:function(t,e,o){var n,i,r;i=[o(3367)],void 0===(r="function"==typeof(n=function(t){
/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
"use strict";return t})?n.apply(e,i):n)||(t.exports=r)},4600:function(t,e,o){var n,i,r;i=[o(2464)],void 0===(r="function"==typeof(n=function(t){return(t={Msg:{}}).Msg.ADD_COMMENT="Add Comment",t.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE="Can't delete the variable '%1' because it's part of the definition of the function '%2'",t.Msg.CHANGE_VALUE_TITLE="Change value:",t.Msg.CLEAN_UP="Clean up Blocks",t.Msg.COLLAPSED_WARNINGS_WARNING="Collapsed blocks contain warnings.",t.Msg.COLLAPSE_ALL="Collapse Blocks",t.Msg.COLLAPSE_BLOCK="Collapse Block",t.Msg.COLOUR_BLEND_COLOUR1="colour 1",t.Msg.COLOUR_BLEND_COLOUR2="colour 2",t.Msg.COLOUR_BLEND_HELPURL="https://meyerweb.com/eric/tools/color-blend/#:::rgbp",t.Msg.COLOUR_BLEND_RATIO="ratio",t.Msg.COLOUR_BLEND_TITLE="blend",t.Msg.COLOUR_BLEND_TOOLTIP="Blends two colours together with a given ratio (0.0 - 1.0).",t.Msg.COLOUR_PICKER_HELPURL="https://en.wikipedia.org/wiki/Color",t.Msg.COLOUR_PICKER_TOOLTIP="Choose a colour from the palette.",t.Msg.COLOUR_RANDOM_HELPURL="http://randomcolour.com",t.Msg.COLOUR_RANDOM_TITLE="random colour",t.Msg.COLOUR_RANDOM_TOOLTIP="Choose a colour at random.",t.Msg.COLOUR_RGB_BLUE="blue",t.Msg.COLOUR_RGB_GREEN="green",t.Msg.COLOUR_RGB_HELPURL="https://www.december.com/html/spec/colorpercompact.html",t.Msg.COLOUR_RGB_RED="red",t.Msg.COLOUR_RGB_TITLE="colour with",t.Msg.COLOUR_RGB_TOOLTIP="Create a colour with the specified amount of red, green, and blue. All values must be between 0 and 100.",t.Msg.CONTROLS_FLOW_STATEMENTS_HELPURL="https://github.com/google/blockly/wiki/Loops#loop-termination-blocks",t.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK="break out of loop",t.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE="continue with next iteration of loop",t.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK="Break out of the containing loop.",t.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE="Skip the rest of this loop, and continue with the next iteration.",t.Msg.CONTROLS_FLOW_STATEMENTS_WARNING="Warning: This block may only be used within a loop.",t.Msg.CONTROLS_FOREACH_HELPURL="https://github.com/google/blockly/wiki/Loops#for-each",t.Msg.CONTROLS_FOREACH_TITLE="for each item %1 in list %2",t.Msg.CONTROLS_FOREACH_TOOLTIP="For each item in a list, set the variable '%1' to the item, and then do some statements.",t.Msg.CONTROLS_FOR_HELPURL="https://github.com/google/blockly/wiki/Loops#count-with",t.Msg.CONTROLS_FOR_TITLE="count with %1 from %2 to %3 by %4",t.Msg.CONTROLS_FOR_TOOLTIP="Have the variable '%1' take on the values from the start number to the end number, counting by the specified interval, and do the specified blocks.",t.Msg.CONTROLS_IF_ELSEIF_TOOLTIP="Add a condition to the if block.",t.Msg.CONTROLS_IF_ELSE_TOOLTIP="Add a final, catch-all condition to the if block.",t.Msg.CONTROLS_IF_HELPURL="https://github.com/google/blockly/wiki/IfElse",t.Msg.CONTROLS_IF_IF_TOOLTIP="Add, remove, or reorder sections to reconfigure this if block.",t.Msg.CONTROLS_IF_MSG_ELSE="else",t.Msg.CONTROLS_IF_MSG_ELSEIF="else if",t.Msg.CONTROLS_IF_MSG_IF="if",t.Msg.CONTROLS_IF_TOOLTIP_1="If a value is true, then do some statements.",t.Msg.CONTROLS_IF_TOOLTIP_2="If a value is true, then do the first block of statements. Otherwise, do the second block of statements.",t.Msg.CONTROLS_IF_TOOLTIP_3="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements.",t.Msg.CONTROLS_IF_TOOLTIP_4="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements. If none of the values are true, do the last block of statements.",t.Msg.CONTROLS_REPEAT_HELPURL="https://en.wikipedia.org/wiki/For_loop",t.Msg.CONTROLS_REPEAT_INPUT_DO="do",t.Msg.CONTROLS_REPEAT_TITLE="repeat %1 times",t.Msg.CONTROLS_REPEAT_TOOLTIP="Do some statements several times.",t.Msg.CONTROLS_WHILEUNTIL_HELPURL="https://github.com/google/blockly/wiki/Loops#repeat",t.Msg.CONTROLS_WHILEUNTIL_OPERATOR_UNTIL="repeat until",t.Msg.CONTROLS_WHILEUNTIL_OPERATOR_WHILE="repeat while",t.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL="While a value is false, then do some statements.",t.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_WHILE="While a value is true, then do some statements.",t.Msg.DELETE_ALL_BLOCKS="Delete all %1 blocks?",t.Msg.DELETE_BLOCK="Delete Block",t.Msg.DELETE_VARIABLE="Delete the '%1' variable",t.Msg.DELETE_VARIABLE_CONFIRMATION="Delete %1 uses of the '%2' variable?",t.Msg.DELETE_X_BLOCKS="Delete %1 Blocks",t.Msg.DISABLE_BLOCK="Disable Block",t.Msg.DUPLICATE_BLOCK="Duplicate",t.Msg.DUPLICATE_COMMENT="Duplicate Comment",t.Msg.ENABLE_BLOCK="Enable Block",t.Msg.EXPAND_ALL="Expand Blocks",t.Msg.EXPAND_BLOCK="Expand Block",t.Msg.EXTERNAL_INPUTS="External Inputs",t.Msg.HELP="Help",t.Msg.INLINE_INPUTS="Inline Inputs",t.Msg.IOS_CANCEL="Cancel",t.Msg.IOS_ERROR="Error",t.Msg.IOS_OK="OK",t.Msg.IOS_PROCEDURES_ADD_INPUT="+ Add Input",t.Msg.IOS_PROCEDURES_ALLOW_STATEMENTS="Allow statements",t.Msg.IOS_PROCEDURES_DUPLICATE_INPUTS_ERROR="This function has duplicate inputs.",t.Msg.IOS_PROCEDURES_INPUTS="INPUTS",t.Msg.IOS_VARIABLES_ADD_BUTTON="Add",t.Msg.IOS_VARIABLES_ADD_VARIABLE="+ Add Variable",t.Msg.IOS_VARIABLES_DELETE_BUTTON="Delete",t.Msg.IOS_VARIABLES_EMPTY_NAME_ERROR="You can't use an empty variable name.",t.Msg.IOS_VARIABLES_RENAME_BUTTON="Rename",t.Msg.IOS_VARIABLES_VARIABLE_NAME="Variable name",t.Msg.LISTS_CREATE_EMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#create-empty-list",t.Msg.LISTS_CREATE_EMPTY_TITLE="create empty list",t.Msg.LISTS_CREATE_EMPTY_TOOLTIP="Returns a list, of length 0, containing no data records",t.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD="list",t.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP="Add, remove, or reorder sections to reconfigure this list block.",t.Msg.LISTS_CREATE_WITH_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",t.Msg.LISTS_CREATE_WITH_INPUT_WITH="create list with",t.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP="Add an item to the list.",t.Msg.LISTS_CREATE_WITH_TOOLTIP="Create a list with any number of items.",t.Msg.LISTS_GET_INDEX_FIRST="first",t.Msg.LISTS_GET_INDEX_FROM_END="# from end",t.Msg.LISTS_GET_INDEX_FROM_START="#",t.Msg.LISTS_GET_INDEX_GET="get",t.Msg.LISTS_GET_INDEX_GET_REMOVE="get and remove",t.Msg.LISTS_GET_INDEX_LAST="last",t.Msg.LISTS_GET_INDEX_RANDOM="random",t.Msg.LISTS_GET_INDEX_REMOVE="remove",t.Msg.LISTS_GET_INDEX_TAIL="",t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST="Returns the first item in a list.",t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM="Returns the item at the specified position in a list.",t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST="Returns the last item in a list.",t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM="Returns a random item in a list.",t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST="Removes and returns the first item in a list.",t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM="Removes and returns the item at the specified position in a list.",t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST="Removes and returns the last item in a list.",t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM="Removes and returns a random item in a list.",t.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST="Removes the first item in a list.",t.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM="Removes the item at the specified position in a list.",t.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST="Removes the last item in a list.",t.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM="Removes a random item in a list.",t.Msg.LISTS_GET_SUBLIST_END_FROM_END="to # from end",t.Msg.LISTS_GET_SUBLIST_END_FROM_START="to #",t.Msg.LISTS_GET_SUBLIST_END_LAST="to last",t.Msg.LISTS_GET_SUBLIST_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-a-sublist",t.Msg.LISTS_GET_SUBLIST_START_FIRST="get sub-list from first",t.Msg.LISTS_GET_SUBLIST_START_FROM_END="get sub-list from # from end",t.Msg.LISTS_GET_SUBLIST_START_FROM_START="get sub-list from #",t.Msg.LISTS_GET_SUBLIST_TAIL="",t.Msg.LISTS_GET_SUBLIST_TOOLTIP="Creates a copy of the specified portion of a list.",t.Msg.LISTS_INDEX_FROM_END_TOOLTIP="%1 is the last item.",t.Msg.LISTS_INDEX_FROM_START_TOOLTIP="%1 is the first item.",t.Msg.LISTS_INDEX_OF_FIRST="find first occurrence of item",t.Msg.LISTS_INDEX_OF_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list",t.Msg.LISTS_INDEX_OF_LAST="find last occurrence of item",t.Msg.LISTS_INDEX_OF_TOOLTIP="Returns the index of the first/last occurrence of the item in the list. Returns %1 if item is not found.",t.Msg.LISTS_INLIST="in list",t.Msg.LISTS_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#is-empty",t.Msg.LISTS_ISEMPTY_TITLE="%1 is empty",t.Msg.LISTS_ISEMPTY_TOOLTIP="Returns true if the list is empty.",t.Msg.LISTS_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Lists#length-of",t.Msg.LISTS_LENGTH_TITLE="length of %1",t.Msg.LISTS_LENGTH_TOOLTIP="Returns the length of a list.",t.Msg.LISTS_REPEAT_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",t.Msg.LISTS_REPEAT_TITLE="create list with item %1 repeated %2 times",t.Msg.LISTS_REPEAT_TOOLTIP="Creates a list consisting of the given value repeated the specified number of times.",t.Msg.LISTS_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Lists#reversing-a-list",t.Msg.LISTS_REVERSE_MESSAGE0="reverse %1",t.Msg.LISTS_REVERSE_TOOLTIP="Reverse a copy of a list.",t.Msg.LISTS_SET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#in-list--set",t.Msg.LISTS_SET_INDEX_INPUT_TO="as",t.Msg.LISTS_SET_INDEX_INSERT="insert at",t.Msg.LISTS_SET_INDEX_SET="set",t.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST="Inserts the item at the start of a list.",t.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM="Inserts the item at the specified position in a list.",t.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST="Append the item to the end of a list.",t.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM="Inserts the item randomly in a list.",t.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST="Sets the first item in a list.",t.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM="Sets the item at the specified position in a list.",t.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST="Sets the last item in a list.",t.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM="Sets a random item in a list.",t.Msg.LISTS_SORT_HELPURL="https://github.com/google/blockly/wiki/Lists#sorting-a-list",t.Msg.LISTS_SORT_ORDER_ASCENDING="ascending",t.Msg.LISTS_SORT_ORDER_DESCENDING="descending",t.Msg.LISTS_SORT_TITLE="sort %1 %2 %3",t.Msg.LISTS_SORT_TOOLTIP="Sort a copy of a list.",t.Msg.LISTS_SORT_TYPE_IGNORECASE="alphabetic, ignore case",t.Msg.LISTS_SORT_TYPE_NUMERIC="numeric",t.Msg.LISTS_SORT_TYPE_TEXT="alphabetic",t.Msg.LISTS_SPLIT_HELPURL="https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists",t.Msg.LISTS_SPLIT_LIST_FROM_TEXT="make list from text",t.Msg.LISTS_SPLIT_TEXT_FROM_LIST="make text from list",t.Msg.LISTS_SPLIT_TOOLTIP_JOIN="Join a list of texts into one text, separated by a delimiter.",t.Msg.LISTS_SPLIT_TOOLTIP_SPLIT="Split text into a list of texts, breaking at each delimiter.",t.Msg.LISTS_SPLIT_WITH_DELIMITER="with delimiter",t.Msg.LOGIC_BOOLEAN_FALSE="false",t.Msg.LOGIC_BOOLEAN_HELPURL="https://github.com/google/blockly/wiki/Logic#values",t.Msg.LOGIC_BOOLEAN_TOOLTIP="Returns either true or false.",t.Msg.LOGIC_BOOLEAN_TRUE="true",t.Msg.LOGIC_COMPARE_HELPURL="https://en.wikipedia.org/wiki/Inequality_(mathematics)",t.Msg.LOGIC_COMPARE_TOOLTIP_EQ="Return true if both inputs equal each other.",t.Msg.LOGIC_COMPARE_TOOLTIP_GT="Return true if the first input is greater than the second input.",t.Msg.LOGIC_COMPARE_TOOLTIP_GTE="Return true if the first input is greater than or equal to the second input.",t.Msg.LOGIC_COMPARE_TOOLTIP_LT="Return true if the first input is smaller than the second input.",t.Msg.LOGIC_COMPARE_TOOLTIP_LTE="Return true if the first input is smaller than or equal to the second input.",t.Msg.LOGIC_COMPARE_TOOLTIP_NEQ="Return true if both inputs are not equal to each other.",t.Msg.LOGIC_NEGATE_HELPURL="https://github.com/google/blockly/wiki/Logic#not",t.Msg.LOGIC_NEGATE_TITLE="not %1",t.Msg.LOGIC_NEGATE_TOOLTIP="Returns true if the input is false. Returns false if the input is true.",t.Msg.LOGIC_NULL="null",t.Msg.LOGIC_NULL_HELPURL="https://en.wikipedia.org/wiki/Nullable_type",t.Msg.LOGIC_NULL_TOOLTIP="Returns null.",t.Msg.LOGIC_OPERATION_AND="and",t.Msg.LOGIC_OPERATION_HELPURL="https://github.com/google/blockly/wiki/Logic#logical-operations",t.Msg.LOGIC_OPERATION_OR="or",t.Msg.LOGIC_OPERATION_TOOLTIP_AND="Return true if both inputs are true.",t.Msg.LOGIC_OPERATION_TOOLTIP_OR="Return true if at least one of the inputs is true.",t.Msg.LOGIC_TERNARY_CONDITION="test",t.Msg.LOGIC_TERNARY_HELPURL="https://en.wikipedia.org/wiki/%3F:",t.Msg.LOGIC_TERNARY_IF_FALSE="if false",t.Msg.LOGIC_TERNARY_IF_TRUE="if true",t.Msg.LOGIC_TERNARY_TOOLTIP="Check the condition in 'test'. If the condition is true, returns the 'if true' value; otherwise returns the 'if false' value.",t.Msg.MATH_ADDITION_SYMBOL="+",t.Msg.MATH_ARITHMETIC_HELPURL="https://en.wikipedia.org/wiki/Arithmetic",t.Msg.MATH_ARITHMETIC_TOOLTIP_ADD="Return the sum of the two numbers.",t.Msg.MATH_ARITHMETIC_TOOLTIP_DIVIDE="Return the quotient of the two numbers.",t.Msg.MATH_ARITHMETIC_TOOLTIP_MINUS="Return the difference of the two numbers.",t.Msg.MATH_ARITHMETIC_TOOLTIP_MULTIPLY="Return the product of the two numbers.",t.Msg.MATH_ARITHMETIC_TOOLTIP_POWER="Return the first number raised to the power of the second number.",t.Msg.MATH_ATAN2_HELPURL="https://en.wikipedia.org/wiki/Atan2",t.Msg.MATH_ATAN2_TITLE="atan2 of X:%1 Y:%2",t.Msg.MATH_ATAN2_TOOLTIP="Return the arctangent of point (X, Y) in degrees from -180 to 180.",t.Msg.MATH_CHANGE_HELPURL="https://en.wikipedia.org/wiki/Programming_idiom#Incrementing_a_counter",t.Msg.MATH_CHANGE_TITLE="change %1 by %2",t.Msg.MATH_CHANGE_TOOLTIP="Add a number to variable '%1'.",t.Msg.MATH_CONSTANT_HELPURL="https://en.wikipedia.org/wiki/Mathematical_constant",t.Msg.MATH_CONSTANT_TOOLTIP="Return one of the common constants:  (3.141), e (2.718),  (1.618), sqrt(2) (1.414), sqrt() (0.707), or  (infinity).",t.Msg.MATH_CONSTRAIN_HELPURL="https://en.wikipedia.org/wiki/Clamping_(graphics)",t.Msg.MATH_CONSTRAIN_TITLE="constrain %1 low %2 high %3",t.Msg.MATH_CONSTRAIN_TOOLTIP="Constrain a number to be between the specified limits (inclusive).",t.Msg.MATH_DIVISION_SYMBOL="",t.Msg.MATH_IS_DIVISIBLE_BY="is divisible by",t.Msg.MATH_IS_EVEN="is even",t.Msg.MATH_IS_NEGATIVE="is negative",t.Msg.MATH_IS_ODD="is odd",t.Msg.MATH_IS_POSITIVE="is positive",t.Msg.MATH_IS_PRIME="is prime",t.Msg.MATH_IS_TOOLTIP="Check if a number is an even, odd, prime, whole, positive, negative, or if it is divisible by certain number. Returns true or false.",t.Msg.MATH_IS_WHOLE="is whole",t.Msg.MATH_MODULO_HELPURL="https://en.wikipedia.org/wiki/Modulo_operation",t.Msg.MATH_MODULO_TITLE="remainder of %1  %2",t.Msg.MATH_MODULO_TOOLTIP="Return the remainder from dividing the two numbers.",t.Msg.MATH_MULTIPLICATION_SYMBOL="",t.Msg.MATH_NUMBER_HELPURL="https://en.wikipedia.org/wiki/Number",t.Msg.MATH_NUMBER_TOOLTIP="A number.",t.Msg.MATH_ONLIST_HELPURL="",t.Msg.MATH_ONLIST_OPERATOR_AVERAGE="average of list",t.Msg.MATH_ONLIST_OPERATOR_MAX="max of list",t.Msg.MATH_ONLIST_OPERATOR_MEDIAN="median of list",t.Msg.MATH_ONLIST_OPERATOR_MIN="min of list",t.Msg.MATH_ONLIST_OPERATOR_MODE="modes of list",t.Msg.MATH_ONLIST_OPERATOR_RANDOM="random item of list",t.Msg.MATH_ONLIST_OPERATOR_STD_DEV="standard deviation of list",t.Msg.MATH_ONLIST_OPERATOR_SUM="sum of list",t.Msg.MATH_ONLIST_TOOLTIP_AVERAGE="Return the average (arithmetic mean) of the numeric values in the list.",t.Msg.MATH_ONLIST_TOOLTIP_MAX="Return the largest number in the list.",t.Msg.MATH_ONLIST_TOOLTIP_MEDIAN="Return the median number in the list.",t.Msg.MATH_ONLIST_TOOLTIP_MIN="Return the smallest number in the list.",t.Msg.MATH_ONLIST_TOOLTIP_MODE="Return a list of the most common item(s) in the list.",t.Msg.MATH_ONLIST_TOOLTIP_RANDOM="Return a random element from the list.",t.Msg.MATH_ONLIST_TOOLTIP_STD_DEV="Return the standard deviation of the list.",t.Msg.MATH_ONLIST_TOOLTIP_SUM="Return the sum of all the numbers in the list.",t.Msg.MATH_POWER_SYMBOL="^",t.Msg.MATH_RANDOM_FLOAT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",t.Msg.MATH_RANDOM_FLOAT_TITLE_RANDOM="random fraction",t.Msg.MATH_RANDOM_FLOAT_TOOLTIP="Return a random fraction between 0.0 (inclusive) and 1.0 (exclusive).",t.Msg.MATH_RANDOM_INT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",t.Msg.MATH_RANDOM_INT_TITLE="random integer from %1 to %2",t.Msg.MATH_RANDOM_INT_TOOLTIP="Return a random integer between the two specified limits, inclusive.",t.Msg.MATH_ROUND_HELPURL="https://en.wikipedia.org/wiki/Rounding",t.Msg.MATH_ROUND_OPERATOR_ROUND="round",t.Msg.MATH_ROUND_OPERATOR_ROUNDDOWN="round down",t.Msg.MATH_ROUND_OPERATOR_ROUNDUP="round up",t.Msg.MATH_ROUND_TOOLTIP="Round a number up or down.",t.Msg.MATH_SINGLE_HELPURL="https://en.wikipedia.org/wiki/Square_root",t.Msg.MATH_SINGLE_OP_ABSOLUTE="absolute",t.Msg.MATH_SINGLE_OP_ROOT="square root",t.Msg.MATH_SINGLE_TOOLTIP_ABS="Return the absolute value of a number.",t.Msg.MATH_SINGLE_TOOLTIP_EXP="Return e to the power of a number.",t.Msg.MATH_SINGLE_TOOLTIP_LN="Return the natural logarithm of a number.",t.Msg.MATH_SINGLE_TOOLTIP_LOG10="Return the base 10 logarithm of a number.",t.Msg.MATH_SINGLE_TOOLTIP_NEG="Return the negation of a number.",t.Msg.MATH_SINGLE_TOOLTIP_POW10="Return 10 to the power of a number.",t.Msg.MATH_SINGLE_TOOLTIP_ROOT="Return the square root of a number.",t.Msg.MATH_SUBTRACTION_SYMBOL="-",t.Msg.MATH_TRIG_ACOS="acos",t.Msg.MATH_TRIG_ASIN="asin",t.Msg.MATH_TRIG_ATAN="atan",t.Msg.MATH_TRIG_COS="cos",t.Msg.MATH_TRIG_HELPURL="https://en.wikipedia.org/wiki/Trigonometric_functions",t.Msg.MATH_TRIG_SIN="sin",t.Msg.MATH_TRIG_TAN="tan",t.Msg.MATH_TRIG_TOOLTIP_ACOS="Return the arccosine of a number.",t.Msg.MATH_TRIG_TOOLTIP_ASIN="Return the arcsine of a number.",t.Msg.MATH_TRIG_TOOLTIP_ATAN="Return the arctangent of a number.",t.Msg.MATH_TRIG_TOOLTIP_COS="Return the cosine of a degree (not radian).",t.Msg.MATH_TRIG_TOOLTIP_SIN="Return the sine of a degree (not radian).",t.Msg.MATH_TRIG_TOOLTIP_TAN="Return the tangent of a degree (not radian).",t.Msg.NEW_COLOUR_VARIABLE="Create colour variable...",t.Msg.NEW_NUMBER_VARIABLE="Create number variable...",t.Msg.NEW_STRING_VARIABLE="Create string variable...",t.Msg.NEW_VARIABLE="Create variable...",t.Msg.NEW_VARIABLE_TITLE="New variable name:",t.Msg.NEW_VARIABLE_TYPE_TITLE="New variable type:",t.Msg.ORDINAL_NUMBER_SUFFIX="",t.Msg.PROCEDURES_ALLOW_STATEMENTS="allow statements",t.Msg.PROCEDURES_BEFORE_PARAMS="with:",t.Msg.PROCEDURES_CALLNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",t.Msg.PROCEDURES_CALLNORETURN_TOOLTIP="Run the user-defined function '%1'.",t.Msg.PROCEDURES_CALLRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",t.Msg.PROCEDURES_CALLRETURN_TOOLTIP="Run the user-defined function '%1' and use its output.",t.Msg.PROCEDURES_CALL_BEFORE_PARAMS="with:",t.Msg.PROCEDURES_CREATE_DO="Create '%1'",t.Msg.PROCEDURES_DEFNORETURN_COMMENT="Describe this function...",t.Msg.PROCEDURES_DEFNORETURN_DO="",t.Msg.PROCEDURES_DEFNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",t.Msg.PROCEDURES_DEFNORETURN_PROCEDURE="do something",t.Msg.PROCEDURES_DEFNORETURN_TITLE="to",t.Msg.PROCEDURES_DEFNORETURN_TOOLTIP="Creates a function with no output.",t.Msg.PROCEDURES_DEFRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",t.Msg.PROCEDURES_DEFRETURN_RETURN="return",t.Msg.PROCEDURES_DEFRETURN_TOOLTIP="Creates a function with an output.",t.Msg.PROCEDURES_DEF_DUPLICATE_WARNING="Warning: This function has duplicate parameters.",t.Msg.PROCEDURES_HIGHLIGHT_DEF="Highlight function definition",t.Msg.PROCEDURES_IFRETURN_HELPURL="http://c2.com/cgi/wiki?GuardClause",t.Msg.PROCEDURES_IFRETURN_TOOLTIP="If a value is true, then return a second value.",t.Msg.PROCEDURES_IFRETURN_WARNING="Warning: This block may be used only within a function definition.",t.Msg.PROCEDURES_MUTATORARG_TITLE="input name:",t.Msg.PROCEDURES_MUTATORARG_TOOLTIP="Add an input to the function.",t.Msg.PROCEDURES_MUTATORCONTAINER_TITLE="inputs",t.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP="Add, remove, or reorder inputs to this function.",t.Msg.REDO="Redo",t.Msg.REMOVE_COMMENT="Remove Comment",t.Msg.RENAME_VARIABLE="Rename variable...",t.Msg.RENAME_VARIABLE_TITLE="Rename all '%1' variables to:",t.Msg.TEXT_APPEND_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",t.Msg.TEXT_APPEND_TITLE="to %1 append text %2",t.Msg.TEXT_APPEND_TOOLTIP="Append some text to variable '%1'.",t.Msg.TEXT_CHANGECASE_HELPURL="https://github.com/google/blockly/wiki/Text#adjusting-text-case",t.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE="to lower case",t.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE="to Title Case",t.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE="to UPPER CASE",t.Msg.TEXT_CHANGECASE_TOOLTIP="Return a copy of the text in a different case.",t.Msg.TEXT_CHARAT_FIRST="get first letter",t.Msg.TEXT_CHARAT_FROM_END="get letter # from end",t.Msg.TEXT_CHARAT_FROM_START="get letter #",t.Msg.TEXT_CHARAT_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-text",t.Msg.TEXT_CHARAT_LAST="get last letter",t.Msg.TEXT_CHARAT_RANDOM="get random letter",t.Msg.TEXT_CHARAT_TAIL="",t.Msg.TEXT_CHARAT_TITLE="in text %1 %2",t.Msg.TEXT_CHARAT_TOOLTIP="Returns the letter at the specified position.",t.Msg.TEXT_COUNT_HELPURL="https://github.com/google/blockly/wiki/Text#counting-substrings",t.Msg.TEXT_COUNT_MESSAGE0="count %1 in %2",t.Msg.TEXT_COUNT_TOOLTIP="Count how many times some text occurs within some other text.",t.Msg.TEXT_CREATE_JOIN_ITEM_TOOLTIP="Add an item to the text.",t.Msg.TEXT_CREATE_JOIN_TITLE_JOIN="join",t.Msg.TEXT_CREATE_JOIN_TOOLTIP="Add, remove, or reorder sections to reconfigure this text block.",t.Msg.TEXT_GET_SUBSTRING_END_FROM_END="to letter # from end",t.Msg.TEXT_GET_SUBSTRING_END_FROM_START="to letter #",t.Msg.TEXT_GET_SUBSTRING_END_LAST="to last letter",t.Msg.TEXT_GET_SUBSTRING_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text",t.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT="in text",t.Msg.TEXT_GET_SUBSTRING_START_FIRST="get substring from first letter",t.Msg.TEXT_GET_SUBSTRING_START_FROM_END="get substring from letter # from end",t.Msg.TEXT_GET_SUBSTRING_START_FROM_START="get substring from letter #",t.Msg.TEXT_GET_SUBSTRING_TAIL="",t.Msg.TEXT_GET_SUBSTRING_TOOLTIP="Returns a specified portion of the text.",t.Msg.TEXT_INDEXOF_HELPURL="https://github.com/google/blockly/wiki/Text#finding-text",t.Msg.TEXT_INDEXOF_OPERATOR_FIRST="find first occurrence of text",t.Msg.TEXT_INDEXOF_OPERATOR_LAST="find last occurrence of text",t.Msg.TEXT_INDEXOF_TITLE="in text %1 %2 %3",t.Msg.TEXT_INDEXOF_TOOLTIP="Returns the index of the first/last occurrence of the first text in the second text. Returns %1 if text is not found.",t.Msg.TEXT_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Text#checking-for-empty-text",t.Msg.TEXT_ISEMPTY_TITLE="%1 is empty",t.Msg.TEXT_ISEMPTY_TOOLTIP="Returns true if the provided text is empty.",t.Msg.TEXT_JOIN_HELPURL="https://github.com/google/blockly/wiki/Text#text-creation",t.Msg.TEXT_JOIN_TITLE_CREATEWITH="create text with",t.Msg.TEXT_JOIN_TOOLTIP="Create a piece of text by joining together any number of items.",t.Msg.TEXT_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",t.Msg.TEXT_LENGTH_TITLE="length of %1",t.Msg.TEXT_LENGTH_TOOLTIP="Returns the number of letters (including spaces) in the provided text.",t.Msg.TEXT_PRINT_HELPURL="https://github.com/google/blockly/wiki/Text#printing-text",t.Msg.TEXT_PRINT_TITLE="print %1",t.Msg.TEXT_PRINT_TOOLTIP="Print the specified text, number or other value.",t.Msg.TEXT_PROMPT_HELPURL="https://github.com/google/blockly/wiki/Text#getting-input-from-the-user",t.Msg.TEXT_PROMPT_TOOLTIP_NUMBER="Prompt for user for a number.",t.Msg.TEXT_PROMPT_TOOLTIP_TEXT="Prompt for user for some text.",t.Msg.TEXT_PROMPT_TYPE_NUMBER="prompt for number with message",t.Msg.TEXT_PROMPT_TYPE_TEXT="prompt for text with message",t.Msg.TEXT_REPLACE_HELPURL="https://github.com/google/blockly/wiki/Text#replacing-substrings",t.Msg.TEXT_REPLACE_MESSAGE0="replace %1 with %2 in %3",t.Msg.TEXT_REPLACE_TOOLTIP="Replace all occurances of some text within some other text.",t.Msg.TEXT_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Text#reversing-text",t.Msg.TEXT_REVERSE_MESSAGE0="reverse %1",t.Msg.TEXT_REVERSE_TOOLTIP="Reverses the order of the characters in the text.",t.Msg.TEXT_TEXT_HELPURL="https://en.wikipedia.org/wiki/String_(computer_science)",t.Msg.TEXT_TEXT_TOOLTIP="A letter, word, or line of text.",t.Msg.TEXT_TRIM_HELPURL="https://github.com/google/blockly/wiki/Text#trimming-removing-spaces",t.Msg.TEXT_TRIM_OPERATOR_BOTH="trim spaces from both sides of",t.Msg.TEXT_TRIM_OPERATOR_LEFT="trim spaces from left side of",t.Msg.TEXT_TRIM_OPERATOR_RIGHT="trim spaces from right side of",t.Msg.TEXT_TRIM_TOOLTIP="Return a copy of the text with spaces removed from one or both ends.",t.Msg.TODAY="Today",t.Msg.UNDO="Undo",t.Msg.UNNAMED_KEY="unnamed",t.Msg.VARIABLES_DEFAULT_NAME="item",t.Msg.VARIABLES_GET_CREATE_SET="Create 'set %1'",t.Msg.VARIABLES_GET_HELPURL="https://github.com/google/blockly/wiki/Variables#get",t.Msg.VARIABLES_GET_TOOLTIP="Returns the value of this variable.",t.Msg.VARIABLES_SET="set %1 to %2",t.Msg.VARIABLES_SET_CREATE_GET="Create 'get %1'",t.Msg.VARIABLES_SET_HELPURL="https://github.com/google/blockly/wiki/Variables#set",t.Msg.VARIABLES_SET_TOOLTIP="Sets this variable to be equal to the input.",t.Msg.VARIABLE_ALREADY_EXISTS="A variable named '%1' already exists.",t.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE="A variable named '%1' already exists for another type: '%2'.",t.Msg.WORKSPACE_ARIA_LABEL="Blockly Workspace",t.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT="Say something...",t.Msg.CONTROLS_FOREACH_INPUT_DO=t.Msg.CONTROLS_REPEAT_INPUT_DO,t.Msg.CONTROLS_FOR_INPUT_DO=t.Msg.CONTROLS_REPEAT_INPUT_DO,t.Msg.CONTROLS_IF_ELSEIF_TITLE_ELSEIF=t.Msg.CONTROLS_IF_MSG_ELSEIF,t.Msg.CONTROLS_IF_ELSE_TITLE_ELSE=t.Msg.CONTROLS_IF_MSG_ELSE,t.Msg.CONTROLS_IF_IF_TITLE_IF=t.Msg.CONTROLS_IF_MSG_IF,t.Msg.CONTROLS_IF_MSG_THEN=t.Msg.CONTROLS_REPEAT_INPUT_DO,t.Msg.CONTROLS_WHILEUNTIL_INPUT_DO=t.Msg.CONTROLS_REPEAT_INPUT_DO,t.Msg.LISTS_CREATE_WITH_ITEM_TITLE=t.Msg.VARIABLES_DEFAULT_NAME,t.Msg.LISTS_GET_INDEX_HELPURL=t.Msg.LISTS_INDEX_OF_HELPURL,t.Msg.LISTS_GET_INDEX_INPUT_IN_LIST=t.Msg.LISTS_INLIST,t.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST=t.Msg.LISTS_INLIST,t.Msg.LISTS_INDEX_OF_INPUT_IN_LIST=t.Msg.LISTS_INLIST,t.Msg.LISTS_SET_INDEX_INPUT_IN_LIST=t.Msg.LISTS_INLIST,t.Msg.MATH_CHANGE_TITLE_ITEM=t.Msg.VARIABLES_DEFAULT_NAME,t.Msg.PROCEDURES_DEFRETURN_COMMENT=t.Msg.PROCEDURES_DEFNORETURN_COMMENT,t.Msg.PROCEDURES_DEFRETURN_DO=t.Msg.PROCEDURES_DEFNORETURN_DO,t.Msg.PROCEDURES_DEFRETURN_PROCEDURE=t.Msg.PROCEDURES_DEFNORETURN_PROCEDURE,t.Msg.PROCEDURES_DEFRETURN_TITLE=t.Msg.PROCEDURES_DEFNORETURN_TITLE,t.Msg.TEXT_APPEND_VARIABLE=t.Msg.VARIABLES_DEFAULT_NAME,t.Msg.TEXT_CREATE_JOIN_ITEM_TITLE_ITEM=t.Msg.VARIABLES_DEFAULT_NAME,t.Msg.MATH_HUE="230",t.Msg.LOOPS_HUE="120",t.Msg.LISTS_HUE="260",t.Msg.LOGIC_HUE="210",t.Msg.VARIABLES_HUE="330",t.Msg.TEXTS_HUE="160",t.Msg.PROCEDURES_HUE="290",t.Msg.COLOUR_HUE="20",t.Msg.VARIABLES_DYNAMIC_HUE="310",t.Msg})?n.apply(e,i):n)||(t.exports=r)},4601:function(t,e,o){var n,i,r;i=[o(4602)],void 0===(r="function"==typeof(n=function(t){
/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
"use strict";return t.Blocks={},t.Blocks})?n.apply(e,i):n)||(t.exports=r)},4602:function(t,e,o){var n,i,r;i=[o(3367)],void 0===(r="function"==typeof(n=function(a){"use strict";return a.Blocks.colour={},a.Constants={},a.Constants.Colour={},a.Constants.Colour.HUE=20,a.defineBlocksWithJsonArray([{type:"colour_picker",message0:"%1",args0:[{type:"field_colour",name:"COLOUR",colour:"#ff0000"}],output:"Colour",helpUrl:"%{BKY_COLOUR_PICKER_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_PICKER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"colour_random",message0:"%{BKY_COLOUR_RANDOM_TITLE}",output:"Colour",helpUrl:"%{BKY_COLOUR_RANDOM_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RANDOM_TOOLTIP}"},{type:"colour_rgb",message0:"%{BKY_COLOUR_RGB_TITLE} %{BKY_COLOUR_RGB_RED} %1 %{BKY_COLOUR_RGB_GREEN} %2 %{BKY_COLOUR_RGB_BLUE} %3",args0:[{type:"input_value",name:"RED",check:"Number",align:"RIGHT"},{type:"input_value",name:"GREEN",check:"Number",align:"RIGHT"},{type:"input_value",name:"BLUE",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_RGB_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RGB_TOOLTIP}"},{type:"colour_blend",message0:"%{BKY_COLOUR_BLEND_TITLE} %{BKY_COLOUR_BLEND_COLOUR1} %1 %{BKY_COLOUR_BLEND_COLOUR2} %2 %{BKY_COLOUR_BLEND_RATIO} %3",args0:[{type:"input_value",name:"COLOUR1",check:"Colour",align:"RIGHT"},{type:"input_value",name:"COLOUR2",check:"Colour",align:"RIGHT"},{type:"input_value",name:"RATIO",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_BLEND_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_BLEND_TOOLTIP}"}]),a.Blocks.lists={},a.Constants.Lists={},a.Constants.Lists.HUE=260,a.defineBlocksWithJsonArray([{type:"lists_create_empty",message0:"%{BKY_LISTS_CREATE_EMPTY_TITLE}",output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_CREATE_EMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_CREATE_EMPTY_HELPURL}"},{type:"lists_repeat",message0:"%{BKY_LISTS_REPEAT_TITLE}",args0:[{type:"input_value",name:"ITEM"},{type:"input_value",name:"NUM",check:"Number"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_LISTS_REPEAT_HELPURL}"},{type:"lists_reverse",message0:"%{BKY_LISTS_REVERSE_MESSAGE0}",args0:[{type:"input_value",name:"LIST",check:"Array"}],output:"Array",inputsInline:!0,style:"list_blocks",tooltip:"%{BKY_LISTS_REVERSE_TOOLTIP}",helpUrl:"%{BKY_LISTS_REVERSE_HELPURL}"},{type:"lists_isEmpty",message0:"%{BKY_LISTS_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"list_blocks",tooltip:"%{BKY_LISTS_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_ISEMPTY_HELPURL}"},{type:"lists_length",message0:"%{BKY_LISTS_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"list_blocks",tooltip:"%{BKY_LISTS_LENGTH_TOOLTIP}",helpUrl:"%{BKY_LISTS_LENGTH_HELPURL}"}]),a.Blocks.lists_create_with={init:function(){this.setHelpUrl(a.Msg.LISTS_CREATE_WITH_HELPURL),this.setStyle("list_blocks"),this.itemCount_=3,this.updateShape_(),this.setOutput(!0,"Array"),this.setMutator(new a.Mutator(["lists_create_with_item"])),this.setTooltip(a.Msg.LISTS_CREATE_WITH_TOOLTIP)},mutationToDom:function(){var t=a.utils.xml.createElement("mutation");return t.setAttribute("items",this.itemCount_),t},domToMutation:function(t){this.itemCount_=parseInt(t.getAttribute("items"),10),this.updateShape_()},decompose:function(t){var e=t.newBlock("lists_create_with_container");e.initSvg();for(var o=e.getInput("STACK").connection,n=0;n<this.itemCount_;n++){var i=t.newBlock("lists_create_with_item");i.initSvg(),o.connect(i.previousConnection),o=i.nextConnection}return e},compose:function(t){var e=t.getInputTargetBlock("STACK");for(t=[];e;)t.push(e.valueConnection_),e=e.nextConnection&&e.nextConnection.targetBlock();for(e=0;e<this.itemCount_;e++){var o=this.getInput("ADD"+e).connection.targetConnection;o&&-1==t.indexOf(o)&&o.disconnect()}for(this.itemCount_=t.length,this.updateShape_(),e=0;e<this.itemCount_;e++)a.Mutator.reconnect(t[e],this,"ADD"+e)},saveConnections:function(t){t=t.getInputTargetBlock("STACK");for(var e=0;t;){var o=this.getInput("ADD"+e);t.valueConnection_=o&&o.connection.targetConnection,e++,t=t.nextConnection&&t.nextConnection.targetBlock()}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(a.Msg.LISTS_CREATE_EMPTY_TITLE);for(var t=0;t<this.itemCount_;t++)if(!this.getInput("ADD"+t)){var e=this.appendValueInput("ADD"+t).setAlign(a.ALIGN_RIGHT);0==t&&e.appendField(a.Msg.LISTS_CREATE_WITH_INPUT_WITH)}for(;this.getInput("ADD"+t);)this.removeInput("ADD"+t),t++}},a.Blocks.lists_create_with_container={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(a.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD),this.appendStatementInput("STACK"),this.setTooltip(a.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP),this.contextMenu=!1}},a.Blocks.lists_create_with_item={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(a.Msg.LISTS_CREATE_WITH_ITEM_TITLE),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(a.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP),this.contextMenu=!1}},a.Blocks.lists_indexOf={init:function(){var t=[[a.Msg.LISTS_INDEX_OF_FIRST,"FIRST"],[a.Msg.LISTS_INDEX_OF_LAST,"LAST"]];this.setHelpUrl(a.Msg.LISTS_INDEX_OF_HELPURL),this.setStyle("list_blocks"),this.setOutput(!0,"Number"),this.appendValueInput("VALUE").setCheck("Array").appendField(a.Msg.LISTS_INDEX_OF_INPUT_IN_LIST),this.appendValueInput("FIND").appendField(new a.FieldDropdown(t),"END"),this.setInputsInline(!0);var e=this;this.setTooltip(function(){return a.Msg.LISTS_INDEX_OF_TOOLTIP.replace("%1",e.workspace.options.oneBasedIndex?"0":"-1")})}},a.Blocks.lists_getIndex={init:function(){var t=[[a.Msg.LISTS_GET_INDEX_GET,"GET"],[a.Msg.LISTS_GET_INDEX_GET_REMOVE,"GET_REMOVE"],[a.Msg.LISTS_GET_INDEX_REMOVE,"REMOVE"]];this.WHERE_OPTIONS=[[a.Msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[a.Msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[a.Msg.LISTS_GET_INDEX_FIRST,"FIRST"],[a.Msg.LISTS_GET_INDEX_LAST,"LAST"],[a.Msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(a.Msg.LISTS_GET_INDEX_HELPURL),this.setStyle("list_blocks"),t=new a.FieldDropdown(t,function(t){t="REMOVE"==t,this.getSourceBlock().updateStatement_(t)}),this.appendValueInput("VALUE").setCheck("Array").appendField(a.Msg.LISTS_GET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(t,"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),a.Msg.LISTS_GET_INDEX_TAIL&&this.appendDummyInput("TAIL").appendField(a.Msg.LISTS_GET_INDEX_TAIL),this.setInputsInline(!0),this.setOutput(!0),this.updateAt_(!0);var n=this;this.setTooltip(function(){var t=n.getFieldValue("MODE"),e=n.getFieldValue("WHERE"),o="";switch(t+" "+e){case"GET FROM_START":case"GET FROM_END":o=a.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM;break;case"GET FIRST":o=a.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST;break;case"GET LAST":o=a.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST;break;case"GET RANDOM":o=a.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM;break;case"GET_REMOVE FROM_START":case"GET_REMOVE FROM_END":o=a.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM;break;case"GET_REMOVE FIRST":o=a.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST;break;case"GET_REMOVE LAST":o=a.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST;break;case"GET_REMOVE RANDOM":o=a.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM;break;case"REMOVE FROM_START":case"REMOVE FROM_END":o=a.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM;break;case"REMOVE FIRST":o=a.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST;break;case"REMOVE LAST":o=a.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST;break;case"REMOVE RANDOM":o=a.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM}return"FROM_START"!=e&&"FROM_END"!=e||(o+="  "+("FROM_START"==e?a.Msg.LISTS_INDEX_FROM_START_TOOLTIP:a.Msg.LISTS_INDEX_FROM_END_TOOLTIP).replace("%1",n.workspace.options.oneBasedIndex?"#1":"#0")),o})},mutationToDom:function(){var t=a.utils.xml.createElement("mutation");t.setAttribute("statement",!this.outputConnection);var e=this.getInput("AT").type==a.INPUT_VALUE;return t.setAttribute("at",e),t},domToMutation:function(t){var e="true"==t.getAttribute("statement");this.updateStatement_(e),t="false"!=t.getAttribute("at"),this.updateAt_(t)},updateStatement_:function(t){t!=!this.outputConnection&&(this.unplug(!0,!0),t?(this.setOutput(!1),this.setPreviousStatement(!0),this.setNextStatement(!0)):(this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0)))},updateAt_:function(n){this.removeInput("AT"),this.removeInput("ORDINAL",!0),n?(this.appendValueInput("AT").setCheck("Number"),a.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(a.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");var t=new a.FieldDropdown(this.WHERE_OPTIONS,function(t){var e="FROM_START"==t||"FROM_END"==t;if(e!=n){var o=this.getSourceBlock();return o.updateAt_(e),o.setFieldValue(t,"WHERE"),null}});this.getInput("AT").appendField(t,"WHERE"),a.Msg.LISTS_GET_INDEX_TAIL&&this.moveInputBefore("TAIL",null)}},a.Blocks.lists_setIndex={init:function(){var t=[[a.Msg.LISTS_SET_INDEX_SET,"SET"],[a.Msg.LISTS_SET_INDEX_INSERT,"INSERT"]];this.WHERE_OPTIONS=[[a.Msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[a.Msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[a.Msg.LISTS_GET_INDEX_FIRST,"FIRST"],[a.Msg.LISTS_GET_INDEX_LAST,"LAST"],[a.Msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(a.Msg.LISTS_SET_INDEX_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(a.Msg.LISTS_SET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(new a.FieldDropdown(t),"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),this.appendValueInput("TO").appendField(a.Msg.LISTS_SET_INDEX_INPUT_TO),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(a.Msg.LISTS_SET_INDEX_TOOLTIP),this.updateAt_(!0);var n=this;this.setTooltip(function(){var t=n.getFieldValue("MODE"),e=n.getFieldValue("WHERE"),o="";switch(t+" "+e){case"SET FROM_START":case"SET FROM_END":o=a.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM;break;case"SET FIRST":o=a.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST;break;case"SET LAST":o=a.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST;break;case"SET RANDOM":o=a.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM;break;case"INSERT FROM_START":case"INSERT FROM_END":o=a.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM;break;case"INSERT FIRST":o=a.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST;break;case"INSERT LAST":o=a.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST;break;case"INSERT RANDOM":o=a.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM}return"FROM_START"!=e&&"FROM_END"!=e||(o+="  "+a.Msg.LISTS_INDEX_FROM_START_TOOLTIP.replace("%1",n.workspace.options.oneBasedIndex?"#1":"#0")),o})},mutationToDom:function(){var t=a.utils.xml.createElement("mutation"),e=this.getInput("AT").type==a.INPUT_VALUE;return t.setAttribute("at",e),t},domToMutation:function(t){t="false"!=t.getAttribute("at"),this.updateAt_(t)},updateAt_:function(n){this.removeInput("AT"),this.removeInput("ORDINAL",!0),n?(this.appendValueInput("AT").setCheck("Number"),a.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(a.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");var t=new a.FieldDropdown(this.WHERE_OPTIONS,function(t){var e="FROM_START"==t||"FROM_END"==t;if(e!=n){var o=this.getSourceBlock();return o.updateAt_(e),o.setFieldValue(t,"WHERE"),null}});this.moveInputBefore("AT","TO"),this.getInput("ORDINAL")&&this.moveInputBefore("ORDINAL","TO"),this.getInput("AT").appendField(t,"WHERE")}},a.Blocks.lists_getSublist={init:function(){this.WHERE_OPTIONS_1=[[a.Msg.LISTS_GET_SUBLIST_START_FROM_START,"FROM_START"],[a.Msg.LISTS_GET_SUBLIST_START_FROM_END,"FROM_END"],[a.Msg.LISTS_GET_SUBLIST_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[a.Msg.LISTS_GET_SUBLIST_END_FROM_START,"FROM_START"],[a.Msg.LISTS_GET_SUBLIST_END_FROM_END,"FROM_END"],[a.Msg.LISTS_GET_SUBLIST_END_LAST,"LAST"]],this.setHelpUrl(a.Msg.LISTS_GET_SUBLIST_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(a.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),a.Msg.LISTS_GET_SUBLIST_TAIL&&this.appendDummyInput("TAIL").appendField(a.Msg.LISTS_GET_SUBLIST_TAIL),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(a.Msg.LISTS_GET_SUBLIST_TOOLTIP)},mutationToDom:function(){var t=a.utils.xml.createElement("mutation"),e=this.getInput("AT1").type==a.INPUT_VALUE;return t.setAttribute("at1",e),e=this.getInput("AT2").type==a.INPUT_VALUE,t.setAttribute("at2",e),t},domToMutation:function(t){var e="true"==t.getAttribute("at1");t="true"==t.getAttribute("at2"),this.updateAt_(1,e),this.updateAt_(2,t)},updateAt_:function(n,i){this.removeInput("AT"+n),this.removeInput("ORDINAL"+n,!0),i?(this.appendValueInput("AT"+n).setCheck("Number"),a.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+n).appendField(a.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+n);var t=new a.FieldDropdown(this["WHERE_OPTIONS_"+n],function(t){var e="FROM_START"==t||"FROM_END"==t;if(e!=i){var o=this.getSourceBlock();return o.updateAt_(n,e),o.setFieldValue(t,"WHERE"+n),null}});this.getInput("AT"+n).appendField(t,"WHERE"+n),1==n&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2")),a.Msg.LISTS_GET_SUBLIST_TAIL&&this.moveInputBefore("TAIL",null)}},a.Blocks.lists_sort={init:function(){this.jsonInit({message0:a.Msg.LISTS_SORT_TITLE,args0:[{type:"field_dropdown",name:"TYPE",options:[[a.Msg.LISTS_SORT_TYPE_NUMERIC,"NUMERIC"],[a.Msg.LISTS_SORT_TYPE_TEXT,"TEXT"],[a.Msg.LISTS_SORT_TYPE_IGNORECASE,"IGNORE_CASE"]]},{type:"field_dropdown",name:"DIRECTION",options:[[a.Msg.LISTS_SORT_ORDER_ASCENDING,"1"],[a.Msg.LISTS_SORT_ORDER_DESCENDING,"-1"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Array",style:"list_blocks",tooltip:a.Msg.LISTS_SORT_TOOLTIP,helpUrl:a.Msg.LISTS_SORT_HELPURL})}},a.Blocks.lists_split={init:function(){var e=this,t=new a.FieldDropdown([[a.Msg.LISTS_SPLIT_LIST_FROM_TEXT,"SPLIT"],[a.Msg.LISTS_SPLIT_TEXT_FROM_LIST,"JOIN"]],function(t){e.updateType_(t)});this.setHelpUrl(a.Msg.LISTS_SPLIT_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("INPUT").setCheck("String").appendField(t,"MODE"),this.appendValueInput("DELIM").setCheck("String").appendField(a.Msg.LISTS_SPLIT_WITH_DELIMITER),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.setTooltip(function(){var t=e.getFieldValue("MODE");if("SPLIT"==t)return a.Msg.LISTS_SPLIT_TOOLTIP_SPLIT;if("JOIN"==t)return a.Msg.LISTS_SPLIT_TOOLTIP_JOIN;throw Error("Unknown mode: "+t)})},updateType_:function(t){if(this.getFieldValue("MODE")!=t){var e=this.getInput("INPUT").connection;e.setShadowDom(null);var o=e.targetBlock();o&&(e.disconnect(),o.isShadow()?o.dispose():this.bumpNeighbours())}"SPLIT"==t?(this.outputConnection.setCheck("Array"),this.getInput("INPUT").setCheck("String")):(this.outputConnection.setCheck("String"),this.getInput("INPUT").setCheck("Array"))},mutationToDom:function(){var t=a.utils.xml.createElement("mutation");return t.setAttribute("mode",this.getFieldValue("MODE")),t},domToMutation:function(t){this.updateType_(t.getAttribute("mode"))}},a.Blocks.logic={},a.Constants.Logic={},a.Constants.Logic.HUE=210,a.defineBlocksWithJsonArray([{type:"logic_boolean",message0:"%1",args0:[{type:"field_dropdown",name:"BOOL",options:[["%{BKY_LOGIC_BOOLEAN_TRUE}","TRUE"],["%{BKY_LOGIC_BOOLEAN_FALSE}","FALSE"]]}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_BOOLEAN_TOOLTIP}",helpUrl:"%{BKY_LOGIC_BOOLEAN_HELPURL}"},{type:"controls_if",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],previousStatement:null,nextStatement:null,style:"logic_blocks",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",mutator:"controls_if_mutator",extensions:["controls_if_tooltip"]},{type:"controls_ifelse",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],message2:"%{BKY_CONTROLS_IF_MSG_ELSE} %1",args2:[{type:"input_statement",name:"ELSE"}],previousStatement:null,nextStatement:null,style:"logic_blocks",tooltip:"%{BKYCONTROLS_IF_TOOLTIP_2}",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",extensions:["controls_if_tooltip"]},{type:"logic_compare",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A"},{type:"field_dropdown",name:"OP",options:[["=","EQ"],["","NEQ"],["<","LT"],["","LTE"],[">","GT"],["","GTE"]]},{type:"input_value",name:"B"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_COMPARE_HELPURL}",extensions:["logic_compare","logic_op_tooltip"]},{type:"logic_operation",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Boolean"},{type:"field_dropdown",name:"OP",options:[["%{BKY_LOGIC_OPERATION_AND}","AND"],["%{BKY_LOGIC_OPERATION_OR}","OR"]]},{type:"input_value",name:"B",check:"Boolean"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_OPERATION_HELPURL}",extensions:["logic_op_tooltip"]},{type:"logic_negate",message0:"%{BKY_LOGIC_NEGATE_TITLE}",args0:[{type:"input_value",name:"BOOL",check:"Boolean"}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_NEGATE_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NEGATE_HELPURL}"},{type:"logic_null",message0:"%{BKY_LOGIC_NULL}",output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_NULL_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NULL_HELPURL}"},{type:"logic_ternary",message0:"%{BKY_LOGIC_TERNARY_CONDITION} %1",args0:[{type:"input_value",name:"IF",check:"Boolean"}],message1:"%{BKY_LOGIC_TERNARY_IF_TRUE} %1",args1:[{type:"input_value",name:"THEN"}],message2:"%{BKY_LOGIC_TERNARY_IF_FALSE} %1",args2:[{type:"input_value",name:"ELSE"}],output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_TERNARY_TOOLTIP}",helpUrl:"%{BKY_LOGIC_TERNARY_HELPURL}",extensions:["logic_ternary"]}]),a.defineBlocksWithJsonArray([{type:"controls_if_if",message0:"%{BKY_CONTROLS_IF_IF_TITLE_IF}",nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_IF_TOOLTIP}"},{type:"controls_if_elseif",message0:"%{BKY_CONTROLS_IF_ELSEIF_TITLE_ELSEIF}",previousStatement:null,nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSEIF_TOOLTIP}"},{type:"controls_if_else",message0:"%{BKY_CONTROLS_IF_ELSE_TITLE_ELSE}",previousStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSE_TOOLTIP}"}]),a.Constants.Logic.TOOLTIPS_BY_OP={EQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_EQ}",NEQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_NEQ}",LT:"%{BKY_LOGIC_COMPARE_TOOLTIP_LT}",LTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_LTE}",GT:"%{BKY_LOGIC_COMPARE_TOOLTIP_GT}",GTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_GTE}",AND:"%{BKY_LOGIC_OPERATION_TOOLTIP_AND}",OR:"%{BKY_LOGIC_OPERATION_TOOLTIP_OR}"},a.Extensions.register("logic_op_tooltip",a.Extensions.buildTooltipForDropdown("OP",a.Constants.Logic.TOOLTIPS_BY_OP)),a.Constants.Logic.CONTROLS_IF_MUTATOR_MIXIN={elseifCount_:0,elseCount_:0,suppressPrefixSuffix:!0,mutationToDom:function(){if(!this.elseifCount_&&!this.elseCount_)return null;var t=a.utils.xml.createElement("mutation");return this.elseifCount_&&t.setAttribute("elseif",this.elseifCount_),this.elseCount_&&t.setAttribute("else",1),t},domToMutation:function(t){this.elseifCount_=parseInt(t.getAttribute("elseif"),10)||0,this.elseCount_=parseInt(t.getAttribute("else"),10)||0,this.rebuildShape_()},decompose:function(t){var e=t.newBlock("controls_if_if");e.initSvg();for(var o=e.nextConnection,n=1;n<=this.elseifCount_;n++){var i=t.newBlock("controls_if_elseif");i.initSvg(),o.connect(i.previousConnection),o=i.nextConnection}return this.elseCount_&&((t=t.newBlock("controls_if_else")).initSvg(),o.connect(t.previousConnection)),e},compose:function(t){t=t.nextConnection.targetBlock(),this.elseCount_=this.elseifCount_=0;for(var e=[null],o=[null],n=null;t;){switch(t.type){case"controls_if_elseif":this.elseifCount_++,e.push(t.valueConnection_),o.push(t.statementConnection_);break;case"controls_if_else":this.elseCount_++,n=t.statementConnection_;break;default:throw TypeError("Unknown block type: "+t.type)}t=t.nextConnection&&t.nextConnection.targetBlock()}this.updateShape_(),this.reconnectChildBlocks_(e,o,n)},saveConnections:function(t){t=t.nextConnection.targetBlock();for(var e=1;t;){switch(t.type){case"controls_if_elseif":var o=this.getInput("IF"+e),n=this.getInput("DO"+e);t.valueConnection_=o&&o.connection.targetConnection,t.statementConnection_=n&&n.connection.targetConnection,e++;break;case"controls_if_else":n=this.getInput("ELSE"),t.statementConnection_=n&&n.connection.targetConnection;break;default:throw TypeError("Unknown block type: "+t.type)}t=t.nextConnection&&t.nextConnection.targetBlock()}},rebuildShape_:function(){var t=[null],e=[null],o=null;this.getInput("ELSE")&&(o=this.getInput("ELSE").connection.targetConnection);for(var n=1;this.getInput("IF"+n);){var i=this.getInput("IF"+n),r=this.getInput("DO"+n);t.push(i.connection.targetConnection),e.push(r.connection.targetConnection),n++}this.updateShape_(),this.reconnectChildBlocks_(t,e,o)},updateShape_:function(){this.getInput("ELSE")&&this.removeInput("ELSE");for(var t=1;this.getInput("IF"+t);)this.removeInput("IF"+t),this.removeInput("DO"+t),t++;for(t=1;t<=this.elseifCount_;t++)this.appendValueInput("IF"+t).setCheck("Boolean").appendField(a.Msg.CONTROLS_IF_MSG_ELSEIF),this.appendStatementInput("DO"+t).appendField(a.Msg.CONTROLS_IF_MSG_THEN);this.elseCount_&&this.appendStatementInput("ELSE").appendField(a.Msg.CONTROLS_IF_MSG_ELSE)},reconnectChildBlocks_:function(t,e,o){for(var n=1;n<=this.elseifCount_;n++)a.Mutator.reconnect(t[n],this,"IF"+n),a.Mutator.reconnect(e[n],this,"DO"+n);a.Mutator.reconnect(o,this,"ELSE")}},a.Extensions.registerMutator("controls_if_mutator",a.Constants.Logic.CONTROLS_IF_MUTATOR_MIXIN,null,["controls_if_elseif","controls_if_else"]),a.Constants.Logic.CONTROLS_IF_TOOLTIP_EXTENSION=function(){this.setTooltip(function(){return this.elseifCount_||this.elseCount_?!this.elseifCount_&&this.elseCount_?a.Msg.CONTROLS_IF_TOOLTIP_2:this.elseifCount_&&!this.elseCount_?a.Msg.CONTROLS_IF_TOOLTIP_3:this.elseifCount_&&this.elseCount_?a.Msg.CONTROLS_IF_TOOLTIP_4:"":a.Msg.CONTROLS_IF_TOOLTIP_1}.bind(this))},a.Extensions.register("controls_if_tooltip",a.Constants.Logic.CONTROLS_IF_TOOLTIP_EXTENSION),a.Constants.Logic.LOGIC_COMPARE_ONCHANGE_MIXIN={onchange:function(t){this.prevBlocks_||(this.prevBlocks_=[null,null]);var e=this.getInputTargetBlock("A"),o=this.getInputTargetBlock("B");e&&o&&!this.workspace.connectionChecker.doTypeChecks(e.outputConnection,o.outputConnection)&&(a.Events.setGroup(t.group),(t=this.prevBlocks_[0])!==e&&(e.unplug(),!t||t.isDisposed()||t.isShadow()||this.getInput("A").connection.connect(t.outputConnection)),(e=this.prevBlocks_[1])!==o&&(o.unplug(),!e||e.isDisposed()||e.isShadow()||this.getInput("B").connection.connect(e.outputConnection)),this.bumpNeighbours(),a.Events.setGroup(!1)),this.prevBlocks_[0]=this.getInputTargetBlock("A"),this.prevBlocks_[1]=this.getInputTargetBlock("B")}},a.Constants.Logic.LOGIC_COMPARE_EXTENSION=function(){this.mixin(a.Constants.Logic.LOGIC_COMPARE_ONCHANGE_MIXIN)},a.Extensions.register("logic_compare",a.Constants.Logic.LOGIC_COMPARE_EXTENSION),a.Constants.Logic.LOGIC_TERNARY_ONCHANGE_MIXIN={prevParentConnection_:null,onchange:function(t){var e=this.getInputTargetBlock("THEN"),o=this.getInputTargetBlock("ELSE"),n=this.outputConnection.targetConnection;if((e||o)&&n)for(var i=0;i<2;i++){var r=1==i?e:o;r&&!r.workspace.connectionChecker.doTypeChecks(r.outputConnection,n)&&(a.Events.setGroup(t.group),n===this.prevParentConnection_?(this.unplug(),n.getSourceBlock().bumpNeighbours()):(r.unplug(),r.bumpNeighbours()),a.Events.setGroup(!1))}this.prevParentConnection_=n}},a.Extensions.registerMixin("logic_ternary",a.Constants.Logic.LOGIC_TERNARY_ONCHANGE_MIXIN),a.Blocks.loops={},a.Constants.Loops={},a.Constants.Loops.HUE=120,a.defineBlocksWithJsonArray([{type:"controls_repeat_ext",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"input_value",name:"TIMES",check:"Number"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_repeat",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"field_number",name:"TIMES",value:10,min:0,precision:1}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_whileUntil",message0:"%1 %2",args0:[{type:"field_dropdown",name:"MODE",options:[["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_WHILE}","WHILE"],["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_UNTIL}","UNTIL"]]},{type:"input_value",name:"BOOL",check:"Boolean"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_WHILEUNTIL_HELPURL}",extensions:["controls_whileUntil_tooltip"]},{type:"controls_for",message0:"%{BKY_CONTROLS_FOR_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"FROM",check:"Number",align:"RIGHT"},{type:"input_value",name:"TO",check:"Number",align:"RIGHT"},{type:"input_value",name:"BY",check:"Number",align:"RIGHT"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],inputsInline:!0,previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOR_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_for_tooltip"]},{type:"controls_forEach",message0:"%{BKY_CONTROLS_FOREACH_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"LIST",check:"Array"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOREACH_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_forEach_tooltip"]},{type:"controls_flow_statements",message0:"%1",args0:[{type:"field_dropdown",name:"FLOW",options:[["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK}","BREAK"],["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE}","CONTINUE"]]}],previousStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FLOW_STATEMENTS_HELPURL}",extensions:["controls_flow_tooltip","controls_flow_in_loop_check"]}]),a.Constants.Loops.WHILE_UNTIL_TOOLTIPS={WHILE:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_WHILE}",UNTIL:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL}"},a.Extensions.register("controls_whileUntil_tooltip",a.Extensions.buildTooltipForDropdown("MODE",a.Constants.Loops.WHILE_UNTIL_TOOLTIPS)),a.Constants.Loops.BREAK_CONTINUE_TOOLTIPS={BREAK:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK}",CONTINUE:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE}"},a.Extensions.register("controls_flow_tooltip",a.Extensions.buildTooltipForDropdown("FLOW",a.Constants.Loops.BREAK_CONTINUE_TOOLTIPS)),a.Constants.Loops.CUSTOM_CONTEXT_MENU_CREATE_VARIABLES_GET_MIXIN={customContextMenu:function(t){if(!this.isInFlyout){var e=this.getField("VAR").getVariable(),o=e.name;if(!this.isCollapsed()&&null!=o){var n={enabled:!0};n.text=a.Msg.VARIABLES_SET_CREATE_GET.replace("%1",o),e=a.Variables.generateVariableFieldDom(e),(o=a.utils.xml.createElement("block")).setAttribute("type","variables_get"),o.appendChild(e),n.callback=a.ContextMenu.callbackFactory(this,o),t.push(n)}}}},a.Extensions.registerMixin("contextMenu_newGetVariableBlock",a.Constants.Loops.CUSTOM_CONTEXT_MENU_CREATE_VARIABLES_GET_MIXIN),a.Extensions.register("controls_for_tooltip",a.Extensions.buildTooltipWithFieldText("%{BKY_CONTROLS_FOR_TOOLTIP}","VAR")),a.Extensions.register("controls_forEach_tooltip",a.Extensions.buildTooltipWithFieldText("%{BKY_CONTROLS_FOREACH_TOOLTIP}","VAR")),a.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN={LOOP_TYPES:["controls_repeat","controls_repeat_ext","controls_forEach","controls_for","controls_whileUntil"],suppressPrefixSuffix:!0,getSurroundLoop:function(t){do{if(-1!=a.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN.LOOP_TYPES.indexOf(t.type))return t;t=t.getSurroundParent()}while(t);return null},onchange:function(t){if(this.workspace.isDragging&&!this.workspace.isDragging()&&t.type==a.Events.BLOCK_MOVE&&t.blockId==this.id){var e=a.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN.getSurroundLoop(this);if(this.setWarningText(e?null:a.Msg.CONTROLS_FLOW_STATEMENTS_WARNING),!this.isInFlyout){var o=a.Events.getGroup();a.Events.setGroup(t.group),this.setEnabled(e),a.Events.setGroup(o)}}}},a.Extensions.registerMixin("controls_flow_in_loop_check",a.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN),a.Blocks.math={},a.Constants.Math={},a.Constants.Math.HUE=230,a.defineBlocksWithJsonArray([{type:"math_number",message0:"%1",args0:[{type:"field_number",name:"NUM",value:0}],output:"Number",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",style:"math_blocks",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_arithmetic",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Number"},{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ADDITION_SYMBOL}","ADD"],["%{BKY_MATH_SUBTRACTION_SYMBOL}","MINUS"],["%{BKY_MATH_MULTIPLICATION_SYMBOL}","MULTIPLY"],["%{BKY_MATH_DIVISION_SYMBOL}","DIVIDE"],["%{BKY_MATH_POWER_SYMBOL}","POWER"]]},{type:"input_value",name:"B",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ARITHMETIC_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_single",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_SINGLE_OP_ROOT}","ROOT"],["%{BKY_MATH_SINGLE_OP_ABSOLUTE}","ABS"],["-","NEG"],["ln","LN"],["log10","LOG10"],["e^","EXP"],["10^","POW10"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_SINGLE_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_trig",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_TRIG_SIN}","SIN"],["%{BKY_MATH_TRIG_COS}","COS"],["%{BKY_MATH_TRIG_TAN}","TAN"],["%{BKY_MATH_TRIG_ASIN}","ASIN"],["%{BKY_MATH_TRIG_ACOS}","ACOS"],["%{BKY_MATH_TRIG_ATAN}","ATAN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_TRIG_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_constant",message0:"%1",args0:[{type:"field_dropdown",name:"CONSTANT",options:[["","PI"],["e","E"],["","GOLDEN_RATIO"],["sqrt(2)","SQRT2"],["sqrt()","SQRT1_2"],["","INFINITY"]]}],output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTANT_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTANT_HELPURL}"},{type:"math_number_property",message0:"%1 %2",args0:[{type:"input_value",name:"NUMBER_TO_CHECK",check:"Number"},{type:"field_dropdown",name:"PROPERTY",options:[["%{BKY_MATH_IS_EVEN}","EVEN"],["%{BKY_MATH_IS_ODD}","ODD"],["%{BKY_MATH_IS_PRIME}","PRIME"],["%{BKY_MATH_IS_WHOLE}","WHOLE"],["%{BKY_MATH_IS_POSITIVE}","POSITIVE"],["%{BKY_MATH_IS_NEGATIVE}","NEGATIVE"],["%{BKY_MATH_IS_DIVISIBLE_BY}","DIVISIBLE_BY"]]}],inputsInline:!0,output:"Boolean",style:"math_blocks",tooltip:"%{BKY_MATH_IS_TOOLTIP}",mutator:"math_is_divisibleby_mutator"},{type:"math_change",message0:"%{BKY_MATH_CHANGE_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_MATH_CHANGE_TITLE_ITEM}"},{type:"input_value",name:"DELTA",check:"Number"}],previousStatement:null,nextStatement:null,style:"variable_blocks",helpUrl:"%{BKY_MATH_CHANGE_HELPURL}",extensions:["math_change_tooltip"]},{type:"math_round",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ROUND_OPERATOR_ROUND}","ROUND"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDUP}","ROUNDUP"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDDOWN}","ROUNDDOWN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ROUND_HELPURL}",tooltip:"%{BKY_MATH_ROUND_TOOLTIP}"},{type:"math_on_list",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ONLIST_OPERATOR_SUM}","SUM"],["%{BKY_MATH_ONLIST_OPERATOR_MIN}","MIN"],["%{BKY_MATH_ONLIST_OPERATOR_MAX}","MAX"],["%{BKY_MATH_ONLIST_OPERATOR_AVERAGE}","AVERAGE"],["%{BKY_MATH_ONLIST_OPERATOR_MEDIAN}","MEDIAN"],["%{BKY_MATH_ONLIST_OPERATOR_MODE}","MODE"],["%{BKY_MATH_ONLIST_OPERATOR_STD_DEV}","STD_DEV"],["%{BKY_MATH_ONLIST_OPERATOR_RANDOM}","RANDOM"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ONLIST_HELPURL}",mutator:"math_modes_of_list_mutator",extensions:["math_op_tooltip"]},{type:"math_modulo",message0:"%{BKY_MATH_MODULO_TITLE}",args0:[{type:"input_value",name:"DIVIDEND",check:"Number"},{type:"input_value",name:"DIVISOR",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_MODULO_TOOLTIP}",helpUrl:"%{BKY_MATH_MODULO_HELPURL}"},{type:"math_constrain",message0:"%{BKY_MATH_CONSTRAIN_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"Number"},{type:"input_value",name:"LOW",check:"Number"},{type:"input_value",name:"HIGH",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTRAIN_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTRAIN_HELPURL}"},{type:"math_random_int",message0:"%{BKY_MATH_RANDOM_INT_TITLE}",args0:[{type:"input_value",name:"FROM",check:"Number"},{type:"input_value",name:"TO",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_INT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_INT_HELPURL}"},{type:"math_random_float",message0:"%{BKY_MATH_RANDOM_FLOAT_TITLE_RANDOM}",output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_FLOAT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_FLOAT_HELPURL}"},{type:"math_atan2",message0:"%{BKY_MATH_ATAN2_TITLE}",args0:[{type:"input_value",name:"X",check:"Number"},{type:"input_value",name:"Y",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_ATAN2_TOOLTIP}",helpUrl:"%{BKY_MATH_ATAN2_HELPURL}"}]),a.Constants.Math.TOOLTIPS_BY_OP={ADD:"%{BKY_MATH_ARITHMETIC_TOOLTIP_ADD}",MINUS:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MINUS}",MULTIPLY:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MULTIPLY}",DIVIDE:"%{BKY_MATH_ARITHMETIC_TOOLTIP_DIVIDE}",POWER:"%{BKY_MATH_ARITHMETIC_TOOLTIP_POWER}",ROOT:"%{BKY_MATH_SINGLE_TOOLTIP_ROOT}",ABS:"%{BKY_MATH_SINGLE_TOOLTIP_ABS}",NEG:"%{BKY_MATH_SINGLE_TOOLTIP_NEG}",LN:"%{BKY_MATH_SINGLE_TOOLTIP_LN}",LOG10:"%{BKY_MATH_SINGLE_TOOLTIP_LOG10}",EXP:"%{BKY_MATH_SINGLE_TOOLTIP_EXP}",POW10:"%{BKY_MATH_SINGLE_TOOLTIP_POW10}",SIN:"%{BKY_MATH_TRIG_TOOLTIP_SIN}",COS:"%{BKY_MATH_TRIG_TOOLTIP_COS}",TAN:"%{BKY_MATH_TRIG_TOOLTIP_TAN}",ASIN:"%{BKY_MATH_TRIG_TOOLTIP_ASIN}",ACOS:"%{BKY_MATH_TRIG_TOOLTIP_ACOS}",ATAN:"%{BKY_MATH_TRIG_TOOLTIP_ATAN}",SUM:"%{BKY_MATH_ONLIST_TOOLTIP_SUM}",MIN:"%{BKY_MATH_ONLIST_TOOLTIP_MIN}",MAX:"%{BKY_MATH_ONLIST_TOOLTIP_MAX}",AVERAGE:"%{BKY_MATH_ONLIST_TOOLTIP_AVERAGE}",MEDIAN:"%{BKY_MATH_ONLIST_TOOLTIP_MEDIAN}",MODE:"%{BKY_MATH_ONLIST_TOOLTIP_MODE}",STD_DEV:"%{BKY_MATH_ONLIST_TOOLTIP_STD_DEV}",RANDOM:"%{BKY_MATH_ONLIST_TOOLTIP_RANDOM}"},a.Extensions.register("math_op_tooltip",a.Extensions.buildTooltipForDropdown("OP",a.Constants.Math.TOOLTIPS_BY_OP)),a.Constants.Math.IS_DIVISIBLEBY_MUTATOR_MIXIN={mutationToDom:function(){var t=a.utils.xml.createElement("mutation"),e="DIVISIBLE_BY"==this.getFieldValue("PROPERTY");return t.setAttribute("divisor_input",e),t},domToMutation:function(t){t="true"==t.getAttribute("divisor_input"),this.updateShape_(t)},updateShape_:function(t){var e=this.getInput("DIVISOR");t?e||this.appendValueInput("DIVISOR").setCheck("Number"):e&&this.removeInput("DIVISOR")}},a.Constants.Math.IS_DIVISIBLE_MUTATOR_EXTENSION=function(){this.getField("PROPERTY").setValidator(function(t){t="DIVISIBLE_BY"==t,this.getSourceBlock().updateShape_(t)})},a.Extensions.registerMutator("math_is_divisibleby_mutator",a.Constants.Math.IS_DIVISIBLEBY_MUTATOR_MIXIN,a.Constants.Math.IS_DIVISIBLE_MUTATOR_EXTENSION),a.Extensions.register("math_change_tooltip",a.Extensions.buildTooltipWithFieldText("%{BKY_MATH_CHANGE_TOOLTIP}","VAR")),a.Constants.Math.LIST_MODES_MUTATOR_MIXIN={updateType_:function(t){"MODE"==t?this.outputConnection.setCheck("Array"):this.outputConnection.setCheck("Number")},mutationToDom:function(){var t=a.utils.xml.createElement("mutation");return t.setAttribute("op",this.getFieldValue("OP")),t},domToMutation:function(t){this.updateType_(t.getAttribute("op"))}},a.Constants.Math.LIST_MODES_MUTATOR_EXTENSION=function(){this.getField("OP").setValidator(function(t){this.updateType_(t)}.bind(this))},a.Extensions.registerMutator("math_modes_of_list_mutator",a.Constants.Math.LIST_MODES_MUTATOR_MIXIN,a.Constants.Math.LIST_MODES_MUTATOR_EXTENSION),a.Blocks.procedures={},a.Blocks.procedures_defnoreturn={init:function(){var t=new a.FieldTextInput("",a.Procedures.rename);t.setSpellcheck(!1),this.appendDummyInput().appendField(a.Msg.PROCEDURES_DEFNORETURN_TITLE).appendField(t,"NAME").appendField("","PARAMS"),this.setMutator(new a.Mutator(["procedures_mutatorarg"])),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&a.Msg.PROCEDURES_DEFNORETURN_COMMENT&&this.setCommentText(a.Msg.PROCEDURES_DEFNORETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(a.Msg.PROCEDURES_DEFNORETURN_TOOLTIP),this.setHelpUrl(a.Msg.PROCEDURES_DEFNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},setStatements_:function(t){this.hasStatements_!==t&&(t?(this.appendStatementInput("STACK").appendField(a.Msg.PROCEDURES_DEFNORETURN_DO),this.getInput("RETURN")&&this.moveInputBefore("STACK","RETURN")):this.removeInput("STACK",!0),this.hasStatements_=t)},updateParams_:function(){var t="";this.arguments_.length&&(t=a.Msg.PROCEDURES_BEFORE_PARAMS+" "+this.arguments_.join(", ")),a.Events.disable();try{this.setFieldValue(t,"PARAMS")}finally{a.Events.enable()}},mutationToDom:function(t){var e=a.utils.xml.createElement("mutation");t&&e.setAttribute("name",this.getFieldValue("NAME"));for(var o=0;o<this.argumentVarModels_.length;o++){var n=a.utils.xml.createElement("arg"),i=this.argumentVarModels_[o];n.setAttribute("name",i.name),n.setAttribute("varid",i.getId()),t&&this.paramIds_&&n.setAttribute("paramId",this.paramIds_[o]),e.appendChild(n)}return this.hasStatements_||e.setAttribute("statements","false"),e},domToMutation:function(t){this.arguments_=[],this.argumentVarModels_=[];for(var e,o=0;e=t.childNodes[o];o++)if("arg"==e.nodeName.toLowerCase()){var n=e.getAttribute("name");e=e.getAttribute("varid")||e.getAttribute("varId"),this.arguments_.push(n),null!=(e=a.Variables.getOrCreateVariablePackage(this.workspace,e,n,""))?this.argumentVarModels_.push(e):console.log("Failed to create a variable with name "+n+", ignoring.")}this.updateParams_(),a.Procedures.mutateCallers(this),this.setStatements_("false"!==t.getAttribute("statements"))},decompose:function(t){var e=a.utils.xml.createElement("block");e.setAttribute("type","procedures_mutatorcontainer");var o=a.utils.xml.createElement("statement");o.setAttribute("name","STACK"),e.appendChild(o);for(var n=0;n<this.arguments_.length;n++){var i=a.utils.xml.createElement("block");i.setAttribute("type","procedures_mutatorarg");var r=a.utils.xml.createElement("field");r.setAttribute("name","NAME");var s=a.utils.xml.createTextNode(this.arguments_[n]);r.appendChild(s),i.appendChild(r),r=a.utils.xml.createElement("next"),i.appendChild(r),o.appendChild(i),o=r}return t=a.Xml.domToBlock(e,t),"procedures_defreturn"==this.type?t.setFieldValue(this.hasStatements_,"STATEMENTS"):t.removeInput("STATEMENT_INPUT"),a.Procedures.mutateCallers(this),t},compose:function(t){this.arguments_=[],this.paramIds_=[],this.argumentVarModels_=[];for(var e=t.getInputTargetBlock("STACK");e;){var o=e.getFieldValue("NAME");this.arguments_.push(o),o=this.workspace.getVariable(o,""),this.argumentVarModels_.push(o),this.paramIds_.push(e.id),e=e.nextConnection&&e.nextConnection.targetBlock()}this.updateParams_(),a.Procedures.mutateCallers(this),null!==(t=t.getFieldValue("STATEMENTS"))&&(t="TRUE"==t,this.hasStatements_!=t)&&(t?(this.setStatements_(!0),a.Mutator.reconnect(this.statementConnection_,this,"STACK"),this.statementConnection_=null):(t=this.getInput("STACK").connection,(this.statementConnection_=t.targetConnection)&&((t=t.targetBlock()).unplug(),t.bumpNeighbours()),this.setStatements_(!1)))},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!1]},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},renameVarById:function(t,e){var o=this.workspace.getVariableById(t);if(""==o.type){o=o.name,e=this.workspace.getVariableById(e);for(var n=!1,i=0;i<this.argumentVarModels_.length;i++)this.argumentVarModels_[i].getId()==t&&(this.arguments_[i]=e.name,this.argumentVarModels_[i]=e,n=!0);n&&(this.displayRenamedVar_(o,e.name),a.Procedures.mutateCallers(this))}},updateVarName:function(t){for(var e=t.name,o=!1,n=0;n<this.argumentVarModels_.length;n++)if(this.argumentVarModels_[n].getId()==t.getId()){var i=this.arguments_[n];this.arguments_[n]=e,o=!0}o&&(this.displayRenamedVar_(i,e),a.Procedures.mutateCallers(this))},displayRenamedVar_:function(t,e){if(this.updateParams_(),this.mutator&&this.mutator.isVisible())for(var o,n=this.mutator.workspace_.getAllBlocks(!1),i=0;o=n[i];i++)"procedures_mutatorarg"==o.type&&a.Names.equals(t,o.getFieldValue("NAME"))&&o.setFieldValue(e,"NAME")},customContextMenu:function(t){if(!this.isInFlyout){var e={enabled:!0},o=this.getFieldValue("NAME");e.text=a.Msg.PROCEDURES_CREATE_DO.replace("%1",o);var n=a.utils.xml.createElement("mutation");for(n.setAttribute("name",o),o=0;o<this.arguments_.length;o++){var i=a.utils.xml.createElement("arg");i.setAttribute("name",this.arguments_[o]),n.appendChild(i)}if((o=a.utils.xml.createElement("block")).setAttribute("type",this.callType_),o.appendChild(n),e.callback=a.ContextMenu.callbackFactory(this,o),t.push(e),!this.isCollapsed())for(o=0;o<this.argumentVarModels_.length;o++)e={enabled:!0},n=this.argumentVarModels_[o],e.text=a.Msg.VARIABLES_SET_CREATE_GET.replace("%1",n.name),n=a.Variables.generateVariableFieldDom(n),(i=a.utils.xml.createElement("block")).setAttribute("type","variables_get"),i.appendChild(n),e.callback=a.ContextMenu.callbackFactory(this,i),t.push(e)}},callType_:"procedures_callnoreturn"},a.Blocks.procedures_defreturn={init:function(){var t=new a.FieldTextInput("",a.Procedures.rename);t.setSpellcheck(!1),this.appendDummyInput().appendField(a.Msg.PROCEDURES_DEFRETURN_TITLE).appendField(t,"NAME").appendField("","PARAMS"),this.appendValueInput("RETURN").setAlign(a.ALIGN_RIGHT).appendField(a.Msg.PROCEDURES_DEFRETURN_RETURN),this.setMutator(new a.Mutator(["procedures_mutatorarg"])),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&a.Msg.PROCEDURES_DEFRETURN_COMMENT&&this.setCommentText(a.Msg.PROCEDURES_DEFRETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(a.Msg.PROCEDURES_DEFRETURN_TOOLTIP),this.setHelpUrl(a.Msg.PROCEDURES_DEFRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},setStatements_:a.Blocks.procedures_defnoreturn.setStatements_,updateParams_:a.Blocks.procedures_defnoreturn.updateParams_,mutationToDom:a.Blocks.procedures_defnoreturn.mutationToDom,domToMutation:a.Blocks.procedures_defnoreturn.domToMutation,decompose:a.Blocks.procedures_defnoreturn.decompose,compose:a.Blocks.procedures_defnoreturn.compose,getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!0]},getVars:a.Blocks.procedures_defnoreturn.getVars,getVarModels:a.Blocks.procedures_defnoreturn.getVarModels,renameVarById:a.Blocks.procedures_defnoreturn.renameVarById,updateVarName:a.Blocks.procedures_defnoreturn.updateVarName,displayRenamedVar_:a.Blocks.procedures_defnoreturn.displayRenamedVar_,customContextMenu:a.Blocks.procedures_defnoreturn.customContextMenu,callType_:"procedures_callreturn"},a.Blocks.procedures_mutatorcontainer={init:function(){this.appendDummyInput().appendField(a.Msg.PROCEDURES_MUTATORCONTAINER_TITLE),this.appendStatementInput("STACK"),this.appendDummyInput("STATEMENT_INPUT").appendField(a.Msg.PROCEDURES_ALLOW_STATEMENTS).appendField(new a.FieldCheckbox("TRUE"),"STATEMENTS"),this.setStyle("procedure_blocks"),this.setTooltip(a.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP),this.contextMenu=!1}},a.Blocks.procedures_mutatorarg={init:function(){var t=new a.FieldTextInput(a.Procedures.DEFAULT_ARG,this.validator_);t.oldShowEditorFn_=t.showEditor_,t.showEditor_=function(){this.createdVariables_=[],this.oldShowEditorFn_()},this.appendDummyInput().appendField(a.Msg.PROCEDURES_MUTATORARG_TITLE).appendField(t,"NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(a.Msg.PROCEDURES_MUTATORARG_TOOLTIP),this.contextMenu=!1,t.onFinishEditing_=this.deleteIntermediateVars_,t.createdVariables_=[],t.onFinishEditing_("x")},validator_:function(t){var e=this.getSourceBlock(),o=a.Mutator.findParentWs(e.workspace);if(!(t=t.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,"")))return null;for(var n=(e.workspace.targetWorkspace||e.workspace).getAllBlocks(!1),i=t.toLowerCase(),r=0;r<n.length;r++)if(n[r].id!=this.getSourceBlock().id){var s=n[r].getFieldValue("NAME");if(s&&s.toLowerCase()==i)return null}return e.isInFlyout||((e=o.getVariable(t,""))&&e.name!=t&&o.renameVariableById(e.getId(),t),e||(e=o.createVariable(t,""))&&this.createdVariables_&&this.createdVariables_.push(e)),t},deleteIntermediateVars_:function(t){var e=a.Mutator.findParentWs(this.getSourceBlock().workspace);if(e)for(var o=0;o<this.createdVariables_.length;o++){var n=this.createdVariables_[o];n.name!=t&&e.deleteVariableById(n.getId())}}},a.Blocks.procedures_callnoreturn={init:function(){this.appendDummyInput("TOPROW").appendField(this.id,"NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(a.Msg.PROCEDURES_CALLNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null,this.previousEnabledState_=!0},getProcedureCall:function(){return this.getFieldValue("NAME")},renameProcedure:function(t,e){a.Names.equals(t,this.getProcedureCall())&&(this.setFieldValue(e,"NAME"),this.setTooltip((this.outputConnection?a.Msg.PROCEDURES_CALLRETURN_TOOLTIP:a.Msg.PROCEDURES_CALLNORETURN_TOOLTIP).replace("%1",e)))},setProcedureParameters_:function(t,e){var o=a.Procedures.getDefinition(this.getProcedureCall(),this.workspace),n=o&&o.mutator&&o.mutator.isVisible();if(n||(this.quarkConnections_={},this.quarkIds_=null),e)if(t.join("\n")==this.arguments_.join("\n"))this.quarkIds_=e;else{if(e.length!=t.length)throw RangeError("paramNames and paramIds must be the same length.");this.setCollapsed(!1),this.quarkIds_||(this.quarkConnections_={},this.quarkIds_=[]),o=this.rendered,this.rendered=!1;for(var i=0;i<this.arguments_.length;i++){var r=this.getInput("ARG"+i);r&&(r=r.connection.targetConnection,this.quarkConnections_[this.quarkIds_[i]]=r,n&&r&&-1==e.indexOf(this.quarkIds_[i])&&(r.disconnect(),r.getSourceBlock().bumpNeighbours()))}for(this.arguments_=[].concat(t),this.argumentVarModels_=[],i=0;i<this.arguments_.length;i++)t=a.Variables.getOrCreateVariablePackage(this.workspace,null,this.arguments_[i],""),this.argumentVarModels_.push(t);if(this.updateShape_(),this.quarkIds_=e)for(i=0;i<this.arguments_.length;i++)(e=this.quarkIds_[i])in this.quarkConnections_&&(r=this.quarkConnections_[e],a.Mutator.reconnect(r,this,"ARG"+i)||delete this.quarkConnections_[e]);(this.rendered=o)&&this.render()}},updateShape_:function(){for(var t=0;t<this.arguments_.length;t++){var e=this.getField("ARGNAME"+t);if(e){a.Events.disable();try{e.setValue(this.arguments_[t])}finally{a.Events.enable()}}else e=new a.FieldLabel(this.arguments_[t]),this.appendValueInput("ARG"+t).setAlign(a.ALIGN_RIGHT).appendField(e,"ARGNAME"+t).init()}for(;this.getInput("ARG"+t);)this.removeInput("ARG"+t),t++;(t=this.getInput("TOPROW"))&&(this.arguments_.length?this.getField("WITH")||(t.appendField(a.Msg.PROCEDURES_CALL_BEFORE_PARAMS,"WITH"),t.init()):this.getField("WITH")&&t.removeField("WITH"))},mutationToDom:function(){var t=a.utils.xml.createElement("mutation");t.setAttribute("name",this.getProcedureCall());for(var e=0;e<this.arguments_.length;e++){var o=a.utils.xml.createElement("arg");o.setAttribute("name",this.arguments_[e]),t.appendChild(o)}return t},domToMutation:function(t){var e=t.getAttribute("name");this.renameProcedure(this.getProcedureCall(),e),e=[];for(var o,n=[],i=0;o=t.childNodes[i];i++)"arg"==o.nodeName.toLowerCase()&&(e.push(o.getAttribute("name")),n.push(o.getAttribute("paramId")));this.setProcedureParameters_(e,n)},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},onchange:function(t){if(this.workspace&&!this.workspace.isFlyout&&t.recordUndo)if(t.type==a.Events.BLOCK_CREATE&&-1!=t.ids.indexOf(this.id)){var e=this.getProcedureCall();if(!(e=a.Procedures.getDefinition(e,this.workspace))||e.type==this.defType_&&JSON.stringify(e.getVars())==JSON.stringify(this.arguments_)||(e=null),!e){a.Events.setGroup(t.group),t=a.utils.xml.createElement("xml"),(e=a.utils.xml.createElement("block")).setAttribute("type",this.defType_);var o=this.getRelativeToSurfaceXY(),n=o.y+2*a.SNAP_RADIUS;e.setAttribute("x",o.x+a.SNAP_RADIUS*(this.RTL?-1:1)),e.setAttribute("y",n),o=this.mutationToDom(),e.appendChild(o),(o=a.utils.xml.createElement("field")).setAttribute("name","NAME"),o.appendChild(a.utils.xml.createTextNode(this.getProcedureCall())),e.appendChild(o),t.appendChild(e),a.Xml.domToWorkspace(t,this.workspace),a.Events.setGroup(!1)}}else t.type==a.Events.BLOCK_DELETE?(e=this.getProcedureCall(),(e=a.Procedures.getDefinition(e,this.workspace))||(a.Events.setGroup(t.group),this.dispose(!0),a.Events.setGroup(!1))):t.type==a.Events.CHANGE&&"disabled"==t.element&&(e=this.getProcedureCall(),(e=a.Procedures.getDefinition(e,this.workspace))&&e.id==t.blockId&&((e=a.Events.getGroup())&&console.log("Saw an existing group while responding to a definition change"),a.Events.setGroup(t.group),t.newValue?(this.previousEnabledState_=this.isEnabled(),this.setEnabled(!1)):this.setEnabled(this.previousEnabledState_),a.Events.setGroup(e)))},customContextMenu:function(t){if(this.workspace.isMovable()){var e={enabled:!0};e.text=a.Msg.PROCEDURES_HIGHLIGHT_DEF;var o=this.getProcedureCall(),n=this.workspace;e.callback=function(){var t=a.Procedures.getDefinition(o,n);t&&(n.centerOnBlock(t.id),t.select())},t.push(e)}},defType_:"procedures_defnoreturn"},a.Blocks.procedures_callreturn={init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setOutput(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(a.Msg.PROCEDURES_CALLRETURN_HELPURL),this.arguments_=[],this.quarkConnections_={},this.quarkIds_=null,this.previousEnabledState_=!0},getProcedureCall:a.Blocks.procedures_callnoreturn.getProcedureCall,renameProcedure:a.Blocks.procedures_callnoreturn.renameProcedure,setProcedureParameters_:a.Blocks.procedures_callnoreturn.setProcedureParameters_,updateShape_:a.Blocks.procedures_callnoreturn.updateShape_,mutationToDom:a.Blocks.procedures_callnoreturn.mutationToDom,domToMutation:a.Blocks.procedures_callnoreturn.domToMutation,getVars:a.Blocks.procedures_callnoreturn.getVars,getVarModels:a.Blocks.procedures_callnoreturn.getVarModels,onchange:a.Blocks.procedures_callnoreturn.onchange,customContextMenu:a.Blocks.procedures_callnoreturn.customContextMenu,defType_:"procedures_defreturn"},a.Blocks.procedures_ifreturn={init:function(){this.appendValueInput("CONDITION").setCheck("Boolean").appendField(a.Msg.CONTROLS_IF_MSG_IF),this.appendValueInput("VALUE").appendField(a.Msg.PROCEDURES_DEFRETURN_RETURN),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(a.Msg.PROCEDURES_IFRETURN_TOOLTIP),this.setHelpUrl(a.Msg.PROCEDURES_IFRETURN_HELPURL),this.hasReturnValue_=!0},mutationToDom:function(){var t=a.utils.xml.createElement("mutation");return t.setAttribute("value",Number(this.hasReturnValue_)),t},domToMutation:function(t){this.hasReturnValue_=1==t.getAttribute("value"),this.hasReturnValue_||(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(a.Msg.PROCEDURES_DEFRETURN_RETURN))},onchange:function(t){if(this.workspace.isDragging&&!this.workspace.isDragging()){t=!1;var e=this;do{if(-1!=this.FUNCTION_TYPES.indexOf(e.type)){t=!0;break}e=e.getSurroundParent()}while(e);t?("procedures_defnoreturn"==e.type&&this.hasReturnValue_?(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(a.Msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!1):"procedures_defreturn"!=e.type||this.hasReturnValue_||(this.removeInput("VALUE"),this.appendValueInput("VALUE").appendField(a.Msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!0),this.setWarningText(null),this.isInFlyout||this.setEnabled(!0)):(this.setWarningText(a.Msg.PROCEDURES_IFRETURN_WARNING),this.isInFlyout||this.getInheritedDisabled()||this.setEnabled(!1))}},FUNCTION_TYPES:["procedures_defnoreturn","procedures_defreturn"]},a.Blocks.texts={},a.Constants.Text={},a.Constants.Text.HUE=160,a.defineBlocksWithJsonArray([{type:"text",message0:"%1",args0:[{type:"field_input",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["text_quotes","parent_tooltip_when_inline"]},{type:"text_multiline",message0:"%1 %2",args0:[{type:"field_image",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAARCAYAAADpPU2iAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAdhgAAHYYBXaITgQAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMS42/U4J6AAAAP1JREFUOE+Vks0KQUEYhjmRIja4ABtZ2dm5A3t3Ia6AUm7CylYuQRaUhZSlLZJiQbFAyRnPN33y01HOW08z8873zpwzM4F3GWOCruvGIE4/rLaV+Nq1hVGMBqzhqlxgCys4wJA65xnogMHsQ5lujnYHTejBBCK2mE4abjCgMGhNxHgDFWjDSG07kdfVa2pZMf4ZyMAdWmpZMfYOsLiDMYMjlMB+K613QISRhTnITnsYg5yUd0DETmEoMlkFOeIT/A58iyK5E18BuTBfgYXfwNJv4P9/oEBerLylOnRhygmGdPpTTBZAPkde61lbQe4moWUvYUZYLfUNftIY4zwA5X2Z9AYnQrEAAAAASUVORK5CYII=",width:12,height:17,alt:""},{type:"field_multilinetext",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"text_join",message0:"",output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_JOIN_HELPURL}",tooltip:"%{BKY_TEXT_JOIN_TOOLTIP}",mutator:"text_join_mutator"},{type:"text_create_join_container",message0:"%{BKY_TEXT_CREATE_JOIN_TITLE_JOIN} %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"STACK"}],style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_TOOLTIP}",enableContextMenu:!1},{type:"text_create_join_item",message0:"%{BKY_TEXT_CREATE_JOIN_ITEM_TITLE_ITEM}",previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_ITEM_TOOLTIP}",enableContextMenu:!1},{type:"text_append",message0:"%{BKY_TEXT_APPEND_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_TEXT_APPEND_VARIABLE}"},{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",extensions:["text_append_tooltip"]},{type:"text_length",message0:"%{BKY_TEXT_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"text_blocks",tooltip:"%{BKY_TEXT_LENGTH_TOOLTIP}",helpUrl:"%{BKY_TEXT_LENGTH_HELPURL}"},{type:"text_isEmpty",message0:"%{BKY_TEXT_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"text_blocks",tooltip:"%{BKY_TEXT_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_TEXT_ISEMPTY_HELPURL}"},{type:"text_indexOf",message0:"%{BKY_TEXT_INDEXOF_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"END",options:[["%{BKY_TEXT_INDEXOF_OPERATOR_FIRST}","FIRST"],["%{BKY_TEXT_INDEXOF_OPERATOR_LAST}","LAST"]]},{type:"input_value",name:"FIND",check:"String"}],output:"Number",style:"text_blocks",helpUrl:"%{BKY_TEXT_INDEXOF_HELPURL}",inputsInline:!0,extensions:["text_indexOf_tooltip"]},{type:"text_charAt",message0:"%{BKY_TEXT_CHARAT_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"WHERE",options:[["%{BKY_TEXT_CHARAT_FROM_START}","FROM_START"],["%{BKY_TEXT_CHARAT_FROM_END}","FROM_END"],["%{BKY_TEXT_CHARAT_FIRST}","FIRST"],["%{BKY_TEXT_CHARAT_LAST}","LAST"],["%{BKY_TEXT_CHARAT_RANDOM}","RANDOM"]]}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_CHARAT_HELPURL}",inputsInline:!0,mutator:"text_charAt_mutator"}]),a.Blocks.text_getSubstring={init:function(){this.WHERE_OPTIONS_1=[[a.Msg.TEXT_GET_SUBSTRING_START_FROM_START,"FROM_START"],[a.Msg.TEXT_GET_SUBSTRING_START_FROM_END,"FROM_END"],[a.Msg.TEXT_GET_SUBSTRING_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[a.Msg.TEXT_GET_SUBSTRING_END_FROM_START,"FROM_START"],[a.Msg.TEXT_GET_SUBSTRING_END_FROM_END,"FROM_END"],[a.Msg.TEXT_GET_SUBSTRING_END_LAST,"LAST"]],this.setHelpUrl(a.Msg.TEXT_GET_SUBSTRING_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("STRING").setCheck("String").appendField(a.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),a.Msg.TEXT_GET_SUBSTRING_TAIL&&this.appendDummyInput("TAIL").appendField(a.Msg.TEXT_GET_SUBSTRING_TAIL),this.setInputsInline(!0),this.setOutput(!0,"String"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(a.Msg.TEXT_GET_SUBSTRING_TOOLTIP)},mutationToDom:function(){var t=a.utils.xml.createElement("mutation"),e=this.getInput("AT1").type==a.INPUT_VALUE;return t.setAttribute("at1",e),e=this.getInput("AT2").type==a.INPUT_VALUE,t.setAttribute("at2",e),t},domToMutation:function(t){var e="true"==t.getAttribute("at1");t="true"==t.getAttribute("at2"),this.updateAt_(1,e),this.updateAt_(2,t)},updateAt_:function(n,i){this.removeInput("AT"+n),this.removeInput("ORDINAL"+n,!0),i?(this.appendValueInput("AT"+n).setCheck("Number"),a.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+n).appendField(a.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+n),2==n&&a.Msg.TEXT_GET_SUBSTRING_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(a.Msg.TEXT_GET_SUBSTRING_TAIL));var t=new a.FieldDropdown(this["WHERE_OPTIONS_"+n],function(t){var e="FROM_START"==t||"FROM_END"==t;if(e!=i){var o=this.getSourceBlock();return o.updateAt_(n,e),o.setFieldValue(t,"WHERE"+n),null}});this.getInput("AT"+n).appendField(t,"WHERE"+n),1==n&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2"))}},a.Blocks.text_changeCase={init:function(){var t=[[a.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE,"UPPERCASE"],[a.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE,"LOWERCASE"],[a.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE,"TITLECASE"]];this.setHelpUrl(a.Msg.TEXT_CHANGECASE_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(new a.FieldDropdown(t),"CASE"),this.setOutput(!0,"String"),this.setTooltip(a.Msg.TEXT_CHANGECASE_TOOLTIP)}},a.Blocks.text_trim={init:function(){var t=[[a.Msg.TEXT_TRIM_OPERATOR_BOTH,"BOTH"],[a.Msg.TEXT_TRIM_OPERATOR_LEFT,"LEFT"],[a.Msg.TEXT_TRIM_OPERATOR_RIGHT,"RIGHT"]];this.setHelpUrl(a.Msg.TEXT_TRIM_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(new a.FieldDropdown(t),"MODE"),this.setOutput(!0,"String"),this.setTooltip(a.Msg.TEXT_TRIM_TOOLTIP)}},a.Blocks.text_print={init:function(){this.jsonInit({message0:a.Msg.TEXT_PRINT_TITLE,args0:[{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:a.Msg.TEXT_PRINT_TOOLTIP,helpUrl:a.Msg.TEXT_PRINT_HELPURL})}},a.Blocks.text_prompt_ext={init:function(){var t=[[a.Msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[a.Msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(a.Msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks");var e=this;t=new a.FieldDropdown(t,function(t){e.updateType_(t)}),this.appendValueInput("TEXT").appendField(t,"TYPE"),this.setOutput(!0,"String"),this.setTooltip(function(){return"TEXT"==e.getFieldValue("TYPE")?a.Msg.TEXT_PROMPT_TOOLTIP_TEXT:a.Msg.TEXT_PROMPT_TOOLTIP_NUMBER})},updateType_:function(t){this.outputConnection.setCheck("NUMBER"==t?"Number":"String")},mutationToDom:function(){var t=a.utils.xml.createElement("mutation");return t.setAttribute("type",this.getFieldValue("TYPE")),t},domToMutation:function(t){this.updateType_(t.getAttribute("type"))}},a.Blocks.text_prompt={init:function(){this.mixin(a.Constants.Text.QUOTE_IMAGE_MIXIN);var t=[[a.Msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[a.Msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]],e=this;this.setHelpUrl(a.Msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),t=new a.FieldDropdown(t,function(t){e.updateType_(t)}),this.appendDummyInput().appendField(t,"TYPE").appendField(this.newQuote_(!0)).appendField(new a.FieldTextInput(""),"TEXT").appendField(this.newQuote_(!1)),this.setOutput(!0,"String"),this.setTooltip(function(){return"TEXT"==e.getFieldValue("TYPE")?a.Msg.TEXT_PROMPT_TOOLTIP_TEXT:a.Msg.TEXT_PROMPT_TOOLTIP_NUMBER})},updateType_:a.Blocks.text_prompt_ext.updateType_,mutationToDom:a.Blocks.text_prompt_ext.mutationToDom,domToMutation:a.Blocks.text_prompt_ext.domToMutation},a.Blocks.text_count={init:function(){this.jsonInit({message0:a.Msg.TEXT_COUNT_MESSAGE0,args0:[{type:"input_value",name:"SUB",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"Number",inputsInline:!0,style:"text_blocks",tooltip:a.Msg.TEXT_COUNT_TOOLTIP,helpUrl:a.Msg.TEXT_COUNT_HELPURL})}},a.Blocks.text_replace={init:function(){this.jsonInit({message0:a.Msg.TEXT_REPLACE_MESSAGE0,args0:[{type:"input_value",name:"FROM",check:"String"},{type:"input_value",name:"TO",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:a.Msg.TEXT_REPLACE_TOOLTIP,helpUrl:a.Msg.TEXT_REPLACE_HELPURL})}},a.Blocks.text_reverse={init:function(){this.jsonInit({message0:a.Msg.TEXT_REVERSE_MESSAGE0,args0:[{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:a.Msg.TEXT_REVERSE_TOOLTIP,helpUrl:a.Msg.TEXT_REVERSE_HELPURL})}},a.Constants.Text.QUOTE_IMAGE_MIXIN={QUOTE_IMAGE_LEFT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAn0lEQVQI1z3OMa5BURSF4f/cQhAKjUQhuQmFNwGJEUi0RKN5rU7FHKhpjEH3TEMtkdBSCY1EIv8r7nFX9e29V7EBAOvu7RPjwmWGH/VuF8CyN9/OAdvqIXYLvtRaNjx9mMTDyo+NjAN1HNcl9ZQ5oQMM3dgDUqDo1l8DzvwmtZN7mnD+PkmLa+4mhrxVA9fRowBWmVBhFy5gYEjKMfz9AylsaRRgGzvZAAAAAElFTkSuQmCC",QUOTE_IMAGE_RIGHT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAqUlEQVQI1z3KvUpCcRiA8ef9E4JNHhI0aFEacm1o0BsI0Slx8wa8gLauoDnoBhq7DcfWhggONDmJJgqCPA7neJ7p934EOOKOnM8Q7PDElo/4x4lFb2DmuUjcUzS3URnGib9qaPNbuXvBO3sGPHJDRG6fGVdMSeWDP2q99FQdFrz26Gu5Tq7dFMzUvbXy8KXeAj57cOklgA+u1B5AoslLtGIHQMaCVnwDnADZIFIrXsoXrgAAAABJRU5ErkJggg==",QUOTE_IMAGE_WIDTH:12,QUOTE_IMAGE_HEIGHT:12,quoteField_:function(t){for(var e,o=0;e=this.inputList[o];o++)for(var n,i=0;n=e.fieldRow[i];i++)if(t==n.name)return e.insertFieldAt(i,this.newQuote_(!0)),void e.insertFieldAt(i+2,this.newQuote_(!1));console.warn('field named "'+t+'" not found in '+this.toDevString())},newQuote_:function(t){return t=this.RTL?!t:t,new a.FieldImage(t?this.QUOTE_IMAGE_LEFT_DATAURI:this.QUOTE_IMAGE_RIGHT_DATAURI,this.QUOTE_IMAGE_WIDTH,this.QUOTE_IMAGE_HEIGHT,t?"":"")}},a.Constants.Text.TEXT_QUOTES_EXTENSION=function(){this.mixin(a.Constants.Text.QUOTE_IMAGE_MIXIN),this.quoteField_("TEXT")},a.Constants.Text.TEXT_JOIN_MUTATOR_MIXIN={mutationToDom:function(){var t=a.utils.xml.createElement("mutation");return t.setAttribute("items",this.itemCount_),t},domToMutation:function(t){this.itemCount_=parseInt(t.getAttribute("items"),10),this.updateShape_()},decompose:function(t){var e=t.newBlock("text_create_join_container");e.initSvg();for(var o=e.getInput("STACK").connection,n=0;n<this.itemCount_;n++){var i=t.newBlock("text_create_join_item");i.initSvg(),o.connect(i.previousConnection),o=i.nextConnection}return e},compose:function(t){var e=t.getInputTargetBlock("STACK");for(t=[];e;)t.push(e.valueConnection_),e=e.nextConnection&&e.nextConnection.targetBlock();for(e=0;e<this.itemCount_;e++){var o=this.getInput("ADD"+e).connection.targetConnection;o&&-1==t.indexOf(o)&&o.disconnect()}for(this.itemCount_=t.length,this.updateShape_(),e=0;e<this.itemCount_;e++)a.Mutator.reconnect(t[e],this,"ADD"+e)},saveConnections:function(t){t=t.getInputTargetBlock("STACK");for(var e=0;t;){var o=this.getInput("ADD"+e);t.valueConnection_=o&&o.connection.targetConnection,e++,t=t.nextConnection&&t.nextConnection.targetBlock()}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(this.newQuote_(!0)).appendField(this.newQuote_(!1));for(var t=0;t<this.itemCount_;t++)if(!this.getInput("ADD"+t)){var e=this.appendValueInput("ADD"+t).setAlign(a.ALIGN_RIGHT);0==t&&e.appendField(a.Msg.TEXT_JOIN_TITLE_CREATEWITH)}for(;this.getInput("ADD"+t);)this.removeInput("ADD"+t),t++}},a.Constants.Text.TEXT_JOIN_EXTENSION=function(){this.mixin(a.Constants.Text.QUOTE_IMAGE_MIXIN),this.itemCount_=2,this.updateShape_(),this.setMutator(new a.Mutator(["text_create_join_item"]))},a.Extensions.register("text_append_tooltip",a.Extensions.buildTooltipWithFieldText("%{BKY_TEXT_APPEND_TOOLTIP}","VAR")),a.Constants.Text.TEXT_INDEXOF_TOOLTIP_EXTENSION=function(){var t=this;this.setTooltip(function(){return a.Msg.TEXT_INDEXOF_TOOLTIP.replace("%1",t.workspace.options.oneBasedIndex?"0":"-1")})},a.Constants.Text.TEXT_CHARAT_MUTATOR_MIXIN={mutationToDom:function(){var t=a.utils.xml.createElement("mutation");return t.setAttribute("at",!!this.isAt_),t},domToMutation:function(t){t="false"!=t.getAttribute("at"),this.updateAt_(t)},updateAt_:function(t){this.removeInput("AT",!0),this.removeInput("ORDINAL",!0),t&&(this.appendValueInput("AT").setCheck("Number"),a.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(a.Msg.ORDINAL_NUMBER_SUFFIX)),a.Msg.TEXT_CHARAT_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(a.Msg.TEXT_CHARAT_TAIL)),this.isAt_=t}},a.Constants.Text.TEXT_CHARAT_EXTENSION=function(){this.getField("WHERE").setValidator(function(t){(t="FROM_START"==t||"FROM_END"==t)!=this.isAt_&&this.getSourceBlock().updateAt_(t)}),this.updateAt_(!0);var o=this;this.setTooltip(function(){var t=o.getFieldValue("WHERE"),e=a.Msg.TEXT_CHARAT_TOOLTIP;return("FROM_START"==t||"FROM_END"==t)&&(t="FROM_START"==t?a.Msg.LISTS_INDEX_FROM_START_TOOLTIP:a.Msg.LISTS_INDEX_FROM_END_TOOLTIP)&&(e+="  "+t.replace("%1",o.workspace.options.oneBasedIndex?"#1":"#0")),e})},a.Extensions.register("text_indexOf_tooltip",a.Constants.Text.TEXT_INDEXOF_TOOLTIP_EXTENSION),a.Extensions.register("text_quotes",a.Constants.Text.TEXT_QUOTES_EXTENSION),a.Extensions.registerMutator("text_join_mutator",a.Constants.Text.TEXT_JOIN_MUTATOR_MIXIN,a.Constants.Text.TEXT_JOIN_EXTENSION),a.Extensions.registerMutator("text_charAt_mutator",a.Constants.Text.TEXT_CHARAT_MUTATOR_MIXIN,a.Constants.Text.TEXT_CHARAT_EXTENSION),a.Blocks.variables={},a.Constants.Variables={},a.Constants.Variables.HUE=330,a.defineBlocksWithJsonArray([{type:"variables_get",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableSetterGetter"]},{type:"variables_set",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableSetterGetter"]}]),a.Constants.Variables.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN={customContextMenu:function(t){if(this.isInFlyout)"variables_get"!=this.type&&"variables_get_reporter"!=this.type||(e={text:a.Msg.RENAME_VARIABLE,enabled:!0,callback:a.Constants.Variables.RENAME_OPTION_CALLBACK_FACTORY(this)},i=this.getField("VAR").getText(),n={text:a.Msg.DELETE_VARIABLE.replace("%1",i),enabled:!0,callback:a.Constants.Variables.DELETE_OPTION_CALLBACK_FACTORY(this)},t.unshift(e),t.unshift(n));else{if("variables_get"==this.type)var e="variables_set",o=a.Msg.VARIABLES_GET_CREATE_SET;else e="variables_get",o=a.Msg.VARIABLES_SET_CREATE_GET;var n={enabled:0<this.workspace.remainingCapacity()},i=this.getField("VAR").getText();n.text=o.replace("%1",i),(o=a.utils.xml.createElement("field")).setAttribute("name","VAR"),o.appendChild(a.utils.xml.createTextNode(i)),(i=a.utils.xml.createElement("block")).setAttribute("type",e),i.appendChild(o),n.callback=a.ContextMenu.callbackFactory(this,i),t.push(n)}}},a.Constants.Variables.RENAME_OPTION_CALLBACK_FACTORY=function(o){return function(){var t=o.workspace,e=o.getField("VAR").getVariable();a.Variables.renameVariable(t,e)}},a.Constants.Variables.DELETE_OPTION_CALLBACK_FACTORY=function(o){return function(){var t=o.workspace,e=o.getField("VAR").getVariable();t.deleteVariableById(e.getId()),t.refreshToolboxSelection()}},a.Extensions.registerMixin("contextMenu_variableSetterGetter",a.Constants.Variables.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN),a.Constants.VariablesDynamic={},a.Constants.VariablesDynamic.HUE=310,a.defineBlocksWithJsonArray([{type:"variables_get_dynamic",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_dynamic_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableDynamicSetterGetter"]},{type:"variables_set_dynamic",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_dynamic_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableDynamicSetterGetter"]}]),a.Constants.VariablesDynamic.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN={customContextMenu:function(t){if(this.isInFlyout)"variables_get_dynamic"!=this.type&&"variables_get_reporter_dynamic"!=this.type||(e={text:a.Msg.RENAME_VARIABLE,enabled:!0,callback:a.Constants.Variables.RENAME_OPTION_CALLBACK_FACTORY(this)},r=this.getField("VAR").getText(),i={text:a.Msg.DELETE_VARIABLE.replace("%1",r),enabled:!0,callback:a.Constants.Variables.DELETE_OPTION_CALLBACK_FACTORY(this)},t.unshift(e),t.unshift(i));else{var e=this.getFieldValue("VAR"),o=this.workspace.getVariableById(e).type;if("variables_get_dynamic"==this.type){e="variables_set_dynamic";var n=a.Msg.VARIABLES_GET_CREATE_SET}else e="variables_get_dynamic",n=a.Msg.VARIABLES_SET_CREATE_GET;var i={enabled:0<this.workspace.remainingCapacity()},r=this.getField("VAR").getText();i.text=n.replace("%1",r),(n=a.utils.xml.createElement("field")).setAttribute("name","VAR"),n.setAttribute("variabletype",o),n.appendChild(a.utils.xml.createTextNode(r)),(r=a.utils.xml.createElement("block")).setAttribute("type",e),r.appendChild(n),i.callback=a.ContextMenu.callbackFactory(this,r),t.push(i)}},onchange:function(t){t=this.getFieldValue("VAR"),t=a.Variables.getVariable(this.workspace,t),"variables_get_dynamic"==this.type?this.outputConnection.setCheck(t.type):this.getInput("VALUE").connection.setCheck(t.type)}},a.Constants.VariablesDynamic.RENAME_OPTION_CALLBACK_FACTORY=function(o){return function(){var t=o.workspace,e=o.getField("VAR").getVariable();a.Variables.renameVariable(t,e)}},a.Constants.VariablesDynamic.DELETE_OPTION_CALLBACK_FACTORY=function(o){return function(){var t=o.workspace,e=o.getField("VAR").getVariable();t.deleteVariableById(e.getId()),t.refreshToolboxSelection()}},a.Extensions.registerMixin("contextMenu_variableDynamicSetterGetter",a.Constants.VariablesDynamic.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN),a.Blocks})?n.apply(e,i):n)||(t.exports=r)},4603:function(t,e,o){var n,i,r;i=[o(2464),o(4604)],void 0===(r="function"==typeof(n=function(t,e){
/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
"use strict";return t.JavaScript=e})?n.apply(e,i):n)||(t.exports=r)},4604:function(t,e,o){var n,i,r;i=[o(3367)],void 0===(r="function"==typeof(n=function(u){"use strict";return u.JavaScript=new u.Generator("JavaScript"),u.JavaScript.addReservedWords("break,case,catch,class,const,continue,debugger,default,delete,do,else,export,extends,finally,for,function,if,import,in,instanceof,new,return,super,switch,this,throw,try,typeof,var,void,while,with,yield,enum,implements,interface,let,package,private,protected,public,static,await,null,true,false,arguments,"+Object.getOwnPropertyNames(u.utils.global).join(",")),u.JavaScript.ORDER_ATOMIC=0,u.JavaScript.ORDER_NEW=1.1,u.JavaScript.ORDER_MEMBER=1.2,u.JavaScript.ORDER_FUNCTION_CALL=2,u.JavaScript.ORDER_INCREMENT=3,u.JavaScript.ORDER_DECREMENT=3,u.JavaScript.ORDER_BITWISE_NOT=4.1,u.JavaScript.ORDER_UNARY_PLUS=4.2,u.JavaScript.ORDER_UNARY_NEGATION=4.3,u.JavaScript.ORDER_LOGICAL_NOT=4.4,u.JavaScript.ORDER_TYPEOF=4.5,u.JavaScript.ORDER_VOID=4.6,u.JavaScript.ORDER_DELETE=4.7,u.JavaScript.ORDER_AWAIT=4.8,u.JavaScript.ORDER_EXPONENTIATION=5,u.JavaScript.ORDER_MULTIPLICATION=5.1,u.JavaScript.ORDER_DIVISION=5.2,u.JavaScript.ORDER_MODULUS=5.3,u.JavaScript.ORDER_SUBTRACTION=6.1,u.JavaScript.ORDER_ADDITION=6.2,u.JavaScript.ORDER_BITWISE_SHIFT=7,u.JavaScript.ORDER_RELATIONAL=8,u.JavaScript.ORDER_IN=8,u.JavaScript.ORDER_INSTANCEOF=8,u.JavaScript.ORDER_EQUALITY=9,u.JavaScript.ORDER_BITWISE_AND=10,u.JavaScript.ORDER_BITWISE_XOR=11,u.JavaScript.ORDER_BITWISE_OR=12,u.JavaScript.ORDER_LOGICAL_AND=13,u.JavaScript.ORDER_LOGICAL_OR=14,u.JavaScript.ORDER_CONDITIONAL=15,u.JavaScript.ORDER_ASSIGNMENT=16,u.JavaScript.ORDER_YIELD=17,u.JavaScript.ORDER_COMMA=18,u.JavaScript.ORDER_NONE=99,u.JavaScript.ORDER_OVERRIDES=[[u.JavaScript.ORDER_FUNCTION_CALL,u.JavaScript.ORDER_MEMBER],[u.JavaScript.ORDER_FUNCTION_CALL,u.JavaScript.ORDER_FUNCTION_CALL],[u.JavaScript.ORDER_MEMBER,u.JavaScript.ORDER_MEMBER],[u.JavaScript.ORDER_MEMBER,u.JavaScript.ORDER_FUNCTION_CALL],[u.JavaScript.ORDER_LOGICAL_NOT,u.JavaScript.ORDER_LOGICAL_NOT],[u.JavaScript.ORDER_MULTIPLICATION,u.JavaScript.ORDER_MULTIPLICATION],[u.JavaScript.ORDER_ADDITION,u.JavaScript.ORDER_ADDITION],[u.JavaScript.ORDER_LOGICAL_AND,u.JavaScript.ORDER_LOGICAL_AND],[u.JavaScript.ORDER_LOGICAL_OR,u.JavaScript.ORDER_LOGICAL_OR]],u.JavaScript.init=function(t){u.JavaScript.definitions_=Object.create(null),u.JavaScript.functionNames_=Object.create(null),u.JavaScript.variableDB_?u.JavaScript.variableDB_.reset():u.JavaScript.variableDB_=new u.Names(u.JavaScript.RESERVED_WORDS_),u.JavaScript.variableDB_.setVariableMap(t.getVariableMap());for(var e=[],o=u.Variables.allDeveloperVariables(t),n=0;n<o.length;n++)e.push(u.JavaScript.variableDB_.getName(o[n],u.Names.DEVELOPER_VARIABLE_TYPE));for(t=u.Variables.allUsedVarModels(t),n=0;n<t.length;n++)e.push(u.JavaScript.variableDB_.getName(t[n].getId(),u.VARIABLE_CATEGORY_NAME));e.length&&(u.JavaScript.definitions_.variables="var "+e.join(", ")+";")},u.JavaScript.finish=function(t){var e,o=[];for(e in u.JavaScript.definitions_)o.push(u.JavaScript.definitions_[e]);return delete u.JavaScript.definitions_,delete u.JavaScript.functionNames_,u.JavaScript.variableDB_.reset(),o.join("\n\n")+"\n\n\n"+t},u.JavaScript.scrubNakedValue=function(t){return t+";\n"},u.JavaScript.quote_=function(t){return"'"+(t=t.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/'/g,"\\'"))+"'"},u.JavaScript.multiline_quote_=function(t){return t.split(/\n/g).map(u.JavaScript.quote_).join(" + '\\n' +\n")},u.JavaScript.scrub_=function(t,e,o){var n="";if(!t.outputConnection||!t.outputConnection.targetConnection){var i=t.getCommentText();i&&(i=u.utils.string.wrap(i,u.JavaScript.COMMENT_WRAP-3),n+=u.JavaScript.prefixLines(i+"\n","// "));for(var r=0;r<t.inputList.length;r++)t.inputList[r].type==u.INPUT_VALUE&&(i=t.inputList[r].connection.targetBlock())&&(i=u.JavaScript.allNestedComments(i))&&(n+=u.JavaScript.prefixLines(i,"// "))}return t=t.nextConnection&&t.nextConnection.targetBlock(),n+e+(o=o?"":u.JavaScript.blockToCode(t))},u.JavaScript.getAdjusted=function(t,e,o,n,i){o=o||0,i=i||u.JavaScript.ORDER_NONE,t.workspace.options.oneBasedIndex&&o--;var r=t.workspace.options.oneBasedIndex?"1":"0";if(t=0<o?u.JavaScript.valueToCode(t,e,u.JavaScript.ORDER_ADDITION)||r:o<0?u.JavaScript.valueToCode(t,e,u.JavaScript.ORDER_SUBTRACTION)||r:n?u.JavaScript.valueToCode(t,e,u.JavaScript.ORDER_UNARY_NEGATION)||r:u.JavaScript.valueToCode(t,e,i)||r,u.isNumber(t))t=Number(t)+o,n&&(t=-t);else{if(0<o){t=t+" + "+o;var s=u.JavaScript.ORDER_ADDITION}else o<0&&(t=t+" - "+-o,s=u.JavaScript.ORDER_SUBTRACTION);n&&(t=o?"-("+t+")":"-"+t,s=u.JavaScript.ORDER_UNARY_NEGATION),s=Math.floor(s),i=Math.floor(i),s&&s<=i&&(t="("+t+")")}return t},u.JavaScript.colour={},u.JavaScript.colour_picker=function(t){return[u.JavaScript.quote_(t.getFieldValue("COLOUR")),u.JavaScript.ORDER_ATOMIC]},u.JavaScript.colour_random=function(t){return[u.JavaScript.provideFunction_("colourRandom",["function "+u.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"() {","  var num = Math.floor(Math.random() * Math.pow(2, 24));","  return '#' + ('00000' + num.toString(16)).substr(-6);","}"])+"()",u.JavaScript.ORDER_FUNCTION_CALL]},u.JavaScript.colour_rgb=function(t){var e=u.JavaScript.valueToCode(t,"RED",u.JavaScript.ORDER_COMMA)||0,o=u.JavaScript.valueToCode(t,"GREEN",u.JavaScript.ORDER_COMMA)||0;return t=u.JavaScript.valueToCode(t,"BLUE",u.JavaScript.ORDER_COMMA)||0,[u.JavaScript.provideFunction_("colourRgb",["function "+u.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(r, g, b) {","  r = Math.max(Math.min(Number(r), 100), 0) * 2.55;","  g = Math.max(Math.min(Number(g), 100), 0) * 2.55;","  b = Math.max(Math.min(Number(b), 100), 0) * 2.55;","  r = ('0' + (Math.round(r) || 0).toString(16)).slice(-2);","  g = ('0' + (Math.round(g) || 0).toString(16)).slice(-2);","  b = ('0' + (Math.round(b) || 0).toString(16)).slice(-2);","  return '#' + r + g + b;","}"])+"("+e+", "+o+", "+t+")",u.JavaScript.ORDER_FUNCTION_CALL]},u.JavaScript.colour_blend=function(t){var e=u.JavaScript.valueToCode(t,"COLOUR1",u.JavaScript.ORDER_COMMA)||"'#000000'",o=u.JavaScript.valueToCode(t,"COLOUR2",u.JavaScript.ORDER_COMMA)||"'#000000'";return t=u.JavaScript.valueToCode(t,"RATIO",u.JavaScript.ORDER_COMMA)||.5,[u.JavaScript.provideFunction_("colourBlend",["function "+u.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(c1, c2, ratio) {","  ratio = Math.max(Math.min(Number(ratio), 1), 0);","  var r1 = parseInt(c1.substring(1, 3), 16);","  var g1 = parseInt(c1.substring(3, 5), 16);","  var b1 = parseInt(c1.substring(5, 7), 16);","  var r2 = parseInt(c2.substring(1, 3), 16);","  var g2 = parseInt(c2.substring(3, 5), 16);","  var b2 = parseInt(c2.substring(5, 7), 16);","  var r = Math.round(r1 * (1 - ratio) + r2 * ratio);","  var g = Math.round(g1 * (1 - ratio) + g2 * ratio);","  var b = Math.round(b1 * (1 - ratio) + b2 * ratio);","  r = ('0' + (r || 0).toString(16)).slice(-2);","  g = ('0' + (g || 0).toString(16)).slice(-2);","  b = ('0' + (b || 0).toString(16)).slice(-2);","  return '#' + r + g + b;","}"])+"("+e+", "+o+", "+t+")",u.JavaScript.ORDER_FUNCTION_CALL]},u.JavaScript.lists={},u.JavaScript.lists_create_empty=function(t){return["[]",u.JavaScript.ORDER_ATOMIC]},u.JavaScript.lists_create_with=function(t){for(var e=Array(t.itemCount_),o=0;o<t.itemCount_;o++)e[o]=u.JavaScript.valueToCode(t,"ADD"+o,u.JavaScript.ORDER_COMMA)||"null";return["["+e.join(", ")+"]",u.JavaScript.ORDER_ATOMIC]},u.JavaScript.lists_repeat=function(t){return[u.JavaScript.provideFunction_("listsRepeat",["function "+u.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(value, n) {","  var array = [];","  for (var i = 0; i < n; i++) {","    array[i] = value;","  }","  return array;","}"])+"("+(u.JavaScript.valueToCode(t,"ITEM",u.JavaScript.ORDER_COMMA)||"null")+", "+(t=u.JavaScript.valueToCode(t,"NUM",u.JavaScript.ORDER_COMMA)||"0")+")",u.JavaScript.ORDER_FUNCTION_CALL]},u.JavaScript.lists_length=function(t){return[(u.JavaScript.valueToCode(t,"VALUE",u.JavaScript.ORDER_MEMBER)||"[]")+".length",u.JavaScript.ORDER_MEMBER]},u.JavaScript.lists_isEmpty=function(t){return["!"+(u.JavaScript.valueToCode(t,"VALUE",u.JavaScript.ORDER_MEMBER)||"[]")+".length",u.JavaScript.ORDER_LOGICAL_NOT]},u.JavaScript.lists_indexOf=function(t){var e="FIRST"==t.getFieldValue("END")?"indexOf":"lastIndexOf",o=u.JavaScript.valueToCode(t,"FIND",u.JavaScript.ORDER_NONE)||"''";return e=(u.JavaScript.valueToCode(t,"VALUE",u.JavaScript.ORDER_MEMBER)||"[]")+"."+e+"("+o+")",t.workspace.options.oneBasedIndex?[e+" + 1",u.JavaScript.ORDER_ADDITION]:[e,u.JavaScript.ORDER_FUNCTION_CALL]},u.JavaScript.lists_getIndex=function(t){var e=t.getFieldValue("MODE")||"GET",o=t.getFieldValue("WHERE")||"FROM_START",n=u.JavaScript.valueToCode(t,"VALUE","RANDOM"==o?u.JavaScript.ORDER_COMMA:u.JavaScript.ORDER_MEMBER)||"[]";switch(o){case"FIRST":if("GET"==e)return[n+"[0]",u.JavaScript.ORDER_MEMBER];if("GET_REMOVE"==e)return[n+".shift()",u.JavaScript.ORDER_MEMBER];if("REMOVE"==e)return n+".shift();\n";break;case"LAST":if("GET"==e)return[n+".slice(-1)[0]",u.JavaScript.ORDER_MEMBER];if("GET_REMOVE"==e)return[n+".pop()",u.JavaScript.ORDER_MEMBER];if("REMOVE"==e)return n+".pop();\n";break;case"FROM_START":if(t=u.JavaScript.getAdjusted(t,"AT"),"GET"==e)return[n+"["+t+"]",u.JavaScript.ORDER_MEMBER];if("GET_REMOVE"==e)return[n+".splice("+t+", 1)[0]",u.JavaScript.ORDER_FUNCTION_CALL];if("REMOVE"==e)return n+".splice("+t+", 1);\n";break;case"FROM_END":if(t=u.JavaScript.getAdjusted(t,"AT",1,!0),"GET"==e)return[n+".slice("+t+")[0]",u.JavaScript.ORDER_FUNCTION_CALL];if("GET_REMOVE"==e)return[n+".splice("+t+", 1)[0]",u.JavaScript.ORDER_FUNCTION_CALL];if("REMOVE"==e)return n+".splice("+t+", 1);";break;case"RANDOM":if(n=u.JavaScript.provideFunction_("listsGetRandomItem",["function "+u.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(list, remove) {","  var x = Math.floor(Math.random() * list.length);","  if (remove) {","    return list.splice(x, 1)[0];","  } else {","    return list[x];","  }","}"])+"("+n+", "+("GET"!=e)+")","GET"==e||"GET_REMOVE"==e)return[n,u.JavaScript.ORDER_FUNCTION_CALL];if("REMOVE"==e)return n+";\n"}throw Error("Unhandled combination (lists_getIndex).")},u.JavaScript.lists_setIndex=function(t){function e(){if(o.match(/^\w+$/))return"";var t=u.JavaScript.variableDB_.getDistinctName("tmpList",u.VARIABLE_CATEGORY_NAME),e="var "+t+" = "+o+";\n";return o=t,e}var o=u.JavaScript.valueToCode(t,"LIST",u.JavaScript.ORDER_MEMBER)||"[]",n=t.getFieldValue("MODE")||"GET",i=t.getFieldValue("WHERE")||"FROM_START",r=u.JavaScript.valueToCode(t,"TO",u.JavaScript.ORDER_ASSIGNMENT)||"null";switch(i){case"FIRST":if("SET"==n)return o+"[0] = "+r+";\n";if("INSERT"==n)return o+".unshift("+r+");\n";break;case"LAST":if("SET"==n)return(t=e())+(o+"[")+o+".length - 1] = "+r+";\n";if("INSERT"==n)return o+".push("+r+");\n";break;case"FROM_START":if(i=u.JavaScript.getAdjusted(t,"AT"),"SET"==n)return o+"["+i+"] = "+r+";\n";if("INSERT"==n)return o+".splice("+i+", 0, "+r+");\n";break;case"FROM_END":if(i=u.JavaScript.getAdjusted(t,"AT",1,!1,u.JavaScript.ORDER_SUBTRACTION),t=e(),"SET"==n)return t+(o+"[")+o+".length - "+i+"] = "+r+";\n";if("INSERT"==n)return t+(o+".splice(")+o+".length - "+i+", 0, "+r+");\n";break;case"RANDOM":if(t=e(),t+="var "+(i=u.JavaScript.variableDB_.getDistinctName("tmpX",u.VARIABLE_CATEGORY_NAME))+" = Math.floor(Math.random() * "+o+".length);\n","SET"==n)return t+(o+"[")+i+"] = "+r+";\n";if("INSERT"==n)return t+(o+".splice(")+i+", 0, "+r+");\n"}throw Error("Unhandled combination (lists_setIndex).")},u.JavaScript.lists.getIndex_=function(t,e,o){return"FIRST"==e?"0":"FROM_END"==e?t+".length - 1 - "+o:"LAST"==e?t+".length - 1":o},u.JavaScript.lists_getSublist=function(t){var e=u.JavaScript.valueToCode(t,"LIST",u.JavaScript.ORDER_MEMBER)||"[]",o=t.getFieldValue("WHERE1"),n=t.getFieldValue("WHERE2");if("FIRST"==o&&"LAST"==n)e+=".slice(0)";else if(e.match(/^\w+$/)||"FROM_END"!=o&&"FROM_START"==n){switch(o){case"FROM_START":var i=u.JavaScript.getAdjusted(t,"AT1");break;case"FROM_END":i=e+".length - "+(i=u.JavaScript.getAdjusted(t,"AT1",1,!1,u.JavaScript.ORDER_SUBTRACTION));break;case"FIRST":i="0";break;default:throw Error("Unhandled option (lists_getSublist).")}switch(n){case"FROM_START":t=u.JavaScript.getAdjusted(t,"AT2",1);break;case"FROM_END":t=e+".length - "+(t=u.JavaScript.getAdjusted(t,"AT2",0,!1,u.JavaScript.ORDER_SUBTRACTION));break;case"LAST":t=e+".length";break;default:throw Error("Unhandled option (lists_getSublist).")}e=e+".slice("+i+", "+t+")"}else{i=u.JavaScript.getAdjusted(t,"AT1"),t=u.JavaScript.getAdjusted(t,"AT2");var r=u.JavaScript.lists.getIndex_,s={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};e=u.JavaScript.provideFunction_("subsequence"+s[o]+s[n],["function "+u.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(sequence"+("FROM_END"==o||"FROM_START"==o?", at1":"")+("FROM_END"==n||"FROM_START"==n?", at2":"")+") {","  var start = "+r("sequence",o,"at1")+";","  var end = "+r("sequence",n,"at2")+" + 1;","  return sequence.slice(start, end);","}"])+"("+e+("FROM_END"==o||"FROM_START"==o?", "+i:"")+("FROM_END"==n||"FROM_START"==n?", "+t:"")+")"}return[e,u.JavaScript.ORDER_FUNCTION_CALL]},u.JavaScript.lists_sort=function(t){var e=u.JavaScript.valueToCode(t,"LIST",u.JavaScript.ORDER_FUNCTION_CALL)||"[]",o="1"===t.getFieldValue("DIRECTION")?1:-1;return t=t.getFieldValue("TYPE"),[e+".slice().sort("+u.JavaScript.provideFunction_("listsGetSortCompare",["function "+u.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(type, direction) {","  var compareFuncs = {",'    "NUMERIC": function(a, b) {',"        return Number(a) - Number(b); },",'    "TEXT": function(a, b) {',"        return a.toString() > b.toString() ? 1 : -1; },",'    "IGNORE_CASE": function(a, b) {',"        return a.toString().toLowerCase() > b.toString().toLowerCase() ? 1 : -1; },","  };","  var compare = compareFuncs[type];","  return function(a, b) { return compare(a, b) * direction; }","}"])+'("'+t+'", '+o+"))",u.JavaScript.ORDER_FUNCTION_CALL]},u.JavaScript.lists_split=function(t){var e=u.JavaScript.valueToCode(t,"INPUT",u.JavaScript.ORDER_MEMBER),o=u.JavaScript.valueToCode(t,"DELIM",u.JavaScript.ORDER_NONE)||"''";if("SPLIT"==(t=t.getFieldValue("MODE")))e||(e="''"),t="split";else{if("JOIN"!=t)throw Error("Unknown mode: "+t);e||(e="[]"),t="join"}return[e+"."+t+"("+o+")",u.JavaScript.ORDER_FUNCTION_CALL]},u.JavaScript.lists_reverse=function(t){return[(u.JavaScript.valueToCode(t,"LIST",u.JavaScript.ORDER_FUNCTION_CALL)||"[]")+".slice().reverse()",u.JavaScript.ORDER_FUNCTION_CALL]},u.JavaScript.logic={},u.JavaScript.controls_if=function(t){var e=0,o="";u.JavaScript.STATEMENT_PREFIX&&(o+=u.JavaScript.injectId(u.JavaScript.STATEMENT_PREFIX,t));do{var n=u.JavaScript.valueToCode(t,"IF"+e,u.JavaScript.ORDER_NONE)||"false",i=u.JavaScript.statementToCode(t,"DO"+e);u.JavaScript.STATEMENT_SUFFIX&&(i=u.JavaScript.prefixLines(u.JavaScript.injectId(u.JavaScript.STATEMENT_SUFFIX,t),u.JavaScript.INDENT)+i),o+=(0<e?" else ":"")+"if ("+n+") {\n"+i+"}",++e}while(t.getInput("IF"+e));return(t.getInput("ELSE")||u.JavaScript.STATEMENT_SUFFIX)&&(i=u.JavaScript.statementToCode(t,"ELSE"),u.JavaScript.STATEMENT_SUFFIX&&(i=u.JavaScript.prefixLines(u.JavaScript.injectId(u.JavaScript.STATEMENT_SUFFIX,t),u.JavaScript.INDENT)+i),o+=" else {\n"+i+"}"),o+"\n"},u.JavaScript.controls_ifelse=u.JavaScript.controls_if,u.JavaScript.logic_compare=function(t){var e={EQ:"==",NEQ:"!=",LT:"<",LTE:"<=",GT:">",GTE:">="}[t.getFieldValue("OP")],o="=="==e||"!="==e?u.JavaScript.ORDER_EQUALITY:u.JavaScript.ORDER_RELATIONAL;return[(u.JavaScript.valueToCode(t,"A",o)||"0")+" "+e+" "+(t=u.JavaScript.valueToCode(t,"B",o)||"0"),o]},u.JavaScript.logic_operation=function(t){var e="AND"==t.getFieldValue("OP")?"&&":"||",o="&&"==e?u.JavaScript.ORDER_LOGICAL_AND:u.JavaScript.ORDER_LOGICAL_OR,n=u.JavaScript.valueToCode(t,"A",o);if(t=u.JavaScript.valueToCode(t,"B",o),n||t){var i="&&"==e?"true":"false";n||(n=i),t||(t=i)}else t=n="false";return[n+" "+e+" "+t,o]},u.JavaScript.logic_negate=function(t){var e=u.JavaScript.ORDER_LOGICAL_NOT;return["!"+(u.JavaScript.valueToCode(t,"BOOL",e)||"true"),e]},u.JavaScript.logic_boolean=function(t){return["TRUE"==t.getFieldValue("BOOL")?"true":"false",u.JavaScript.ORDER_ATOMIC]},u.JavaScript.logic_null=function(t){return["null",u.JavaScript.ORDER_ATOMIC]},u.JavaScript.logic_ternary=function(t){return[(u.JavaScript.valueToCode(t,"IF",u.JavaScript.ORDER_CONDITIONAL)||"false")+" ? "+(u.JavaScript.valueToCode(t,"THEN",u.JavaScript.ORDER_CONDITIONAL)||"null")+" : "+(t=u.JavaScript.valueToCode(t,"ELSE",u.JavaScript.ORDER_CONDITIONAL)||"null"),u.JavaScript.ORDER_CONDITIONAL]},u.JavaScript.loops={},u.JavaScript.controls_repeat_ext=function(t){var e=t.getField("TIMES")?String(Number(t.getFieldValue("TIMES"))):u.JavaScript.valueToCode(t,"TIMES",u.JavaScript.ORDER_ASSIGNMENT)||"0",o=u.JavaScript.statementToCode(t,"DO");o=u.JavaScript.addLoopTrap(o,t),t="";var n=u.JavaScript.variableDB_.getDistinctName("count",u.VARIABLE_CATEGORY_NAME),i=e;return e.match(/^\w+$/)||u.isNumber(e)||(t+="var "+(i=u.JavaScript.variableDB_.getDistinctName("repeat_end",u.VARIABLE_CATEGORY_NAME))+" = "+e+";\n"),t+"for (var "+n+" = 0; "+n+" < "+i+"; "+n+"++) {\n"+o+"}\n"},u.JavaScript.controls_repeat=u.JavaScript.controls_repeat_ext,u.JavaScript.controls_whileUntil=function(t){var e="UNTIL"==t.getFieldValue("MODE"),o=u.JavaScript.valueToCode(t,"BOOL",e?u.JavaScript.ORDER_LOGICAL_NOT:u.JavaScript.ORDER_NONE)||"false",n=u.JavaScript.statementToCode(t,"DO");return e&&(o="!"+o),"while ("+o+") {\n"+(n=u.JavaScript.addLoopTrap(n,t))+"}\n"},u.JavaScript.controls_for=function(t){var e=u.JavaScript.variableDB_.getName(t.getFieldValue("VAR"),u.VARIABLE_CATEGORY_NAME),o=u.JavaScript.valueToCode(t,"FROM",u.JavaScript.ORDER_ASSIGNMENT)||"0",n=u.JavaScript.valueToCode(t,"TO",u.JavaScript.ORDER_ASSIGNMENT)||"0",i=u.JavaScript.valueToCode(t,"BY",u.JavaScript.ORDER_ASSIGNMENT)||"1",r=u.JavaScript.statementToCode(t,"DO");if(r=u.JavaScript.addLoopTrap(r,t),u.isNumber(o)&&u.isNumber(n)&&u.isNumber(i)){var s=Number(o)<=Number(n);t="for ("+e+" = "+o+"; "+e+(s?" <= ":" >= ")+n+"; "+e,t=(1==(e=Math.abs(Number(i)))?t+(s?"++":"--"):t+(s?" += ":" -= ")+e)+") {\n"+r+"}\n"}else t="",(s=o).match(/^\w+$/)||u.isNumber(o)||(t+="var "+(s=u.JavaScript.variableDB_.getDistinctName(e+"_start",u.VARIABLE_CATEGORY_NAME))+" = "+o+";\n"),(o=n).match(/^\w+$/)||u.isNumber(n)||(t+="var "+(o=u.JavaScript.variableDB_.getDistinctName(e+"_end",u.VARIABLE_CATEGORY_NAME))+" = "+n+";\n"),t+="var "+(n=u.JavaScript.variableDB_.getDistinctName(e+"_inc",u.VARIABLE_CATEGORY_NAME))+" = ",t=(t=u.isNumber(i)?t+(Math.abs(i)+";\n"):t+"Math.abs("+i+");\n")+"if ("+s+" > "+o+") {\n"+(u.JavaScript.INDENT+n)+" = -"+n+";\n",t+="}\n",t+="for ("+e+" = "+s+"; "+n+" >= 0 ? "+e+" <= "+o+" : "+e+" >= "+o+"; "+e+" += "+n+") {\n"+r+"}\n";return t},u.JavaScript.controls_forEach=function(t){var e=u.JavaScript.variableDB_.getName(t.getFieldValue("VAR"),u.VARIABLE_CATEGORY_NAME),o=u.JavaScript.valueToCode(t,"LIST",u.JavaScript.ORDER_ASSIGNMENT)||"[]",n=u.JavaScript.statementToCode(t,"DO");n=u.JavaScript.addLoopTrap(n,t),t="";var i=o;return o.match(/^\w+$/)||(t+="var "+(i=u.JavaScript.variableDB_.getDistinctName(e+"_list",u.VARIABLE_CATEGORY_NAME))+" = "+o+";\n"),t+"for (var "+(o=u.JavaScript.variableDB_.getDistinctName(e+"_index",u.VARIABLE_CATEGORY_NAME))+" in "+i+") {\n"+(n=u.JavaScript.INDENT+e+" = "+i+"["+o+"];\n"+n)+"}\n"},u.JavaScript.controls_flow_statements=function(t){var e="";if(u.JavaScript.STATEMENT_PREFIX&&(e+=u.JavaScript.injectId(u.JavaScript.STATEMENT_PREFIX,t)),u.JavaScript.STATEMENT_SUFFIX&&(e+=u.JavaScript.injectId(u.JavaScript.STATEMENT_SUFFIX,t)),u.JavaScript.STATEMENT_PREFIX){var o=u.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN.getSurroundLoop(t);o&&!o.suppressPrefixSuffix&&(e+=u.JavaScript.injectId(u.JavaScript.STATEMENT_PREFIX,o))}switch(t.getFieldValue("FLOW")){case"BREAK":return e+"break;\n";case"CONTINUE":return e+"continue;\n"}throw Error("Unknown flow statement.")},u.JavaScript.math={},u.JavaScript.math_number=function(t){return[t=Number(t.getFieldValue("NUM")),0<=t?u.JavaScript.ORDER_ATOMIC:u.JavaScript.ORDER_UNARY_NEGATION]},u.JavaScript.math_arithmetic=function(t){var e={ADD:[" + ",u.JavaScript.ORDER_ADDITION],MINUS:[" - ",u.JavaScript.ORDER_SUBTRACTION],MULTIPLY:[" * ",u.JavaScript.ORDER_MULTIPLICATION],DIVIDE:[" / ",u.JavaScript.ORDER_DIVISION],POWER:[null,u.JavaScript.ORDER_COMMA]}[t.getFieldValue("OP")],o=e[0];e=e[1];var n=u.JavaScript.valueToCode(t,"A",e)||"0";return t=u.JavaScript.valueToCode(t,"B",e)||"0",o?[n+o+t,e]:["Math.pow("+n+", "+t+")",u.JavaScript.ORDER_FUNCTION_CALL]},u.JavaScript.math_single=function(t){var e=t.getFieldValue("OP");if("NEG"==e)return"-"==(t=u.JavaScript.valueToCode(t,"NUM",u.JavaScript.ORDER_UNARY_NEGATION)||"0")[0]&&(t=" "+t),["-"+t,u.JavaScript.ORDER_UNARY_NEGATION];switch(t="SIN"==e||"COS"==e||"TAN"==e?u.JavaScript.valueToCode(t,"NUM",u.JavaScript.ORDER_DIVISION)||"0":u.JavaScript.valueToCode(t,"NUM",u.JavaScript.ORDER_NONE)||"0",e){case"ABS":var o="Math.abs("+t+")";break;case"ROOT":o="Math.sqrt("+t+")";break;case"LN":o="Math.log("+t+")";break;case"EXP":o="Math.exp("+t+")";break;case"POW10":o="Math.pow(10,"+t+")";break;case"ROUND":o="Math.round("+t+")";break;case"ROUNDUP":o="Math.ceil("+t+")";break;case"ROUNDDOWN":o="Math.floor("+t+")";break;case"SIN":o="Math.sin("+t+" / 180 * Math.PI)";break;case"COS":o="Math.cos("+t+" / 180 * Math.PI)";break;case"TAN":o="Math.tan("+t+" / 180 * Math.PI)"}if(o)return[o,u.JavaScript.ORDER_FUNCTION_CALL];switch(e){case"LOG10":o="Math.log("+t+") / Math.log(10)";break;case"ASIN":o="Math.asin("+t+") / Math.PI * 180";break;case"ACOS":o="Math.acos("+t+") / Math.PI * 180";break;case"ATAN":o="Math.atan("+t+") / Math.PI * 180";break;default:throw Error("Unknown math operator: "+e)}return[o,u.JavaScript.ORDER_DIVISION]},u.JavaScript.math_constant=function(t){return{PI:["Math.PI",u.JavaScript.ORDER_MEMBER],E:["Math.E",u.JavaScript.ORDER_MEMBER],GOLDEN_RATIO:["(1 + Math.sqrt(5)) / 2",u.JavaScript.ORDER_DIVISION],SQRT2:["Math.SQRT2",u.JavaScript.ORDER_MEMBER],SQRT1_2:["Math.SQRT1_2",u.JavaScript.ORDER_MEMBER],INFINITY:["Infinity",u.JavaScript.ORDER_ATOMIC]}[t.getFieldValue("CONSTANT")]},u.JavaScript.math_number_property=function(t){var e=u.JavaScript.valueToCode(t,"NUMBER_TO_CHECK",u.JavaScript.ORDER_MODULUS)||"0",o=t.getFieldValue("PROPERTY");if("PRIME"==o)return[u.JavaScript.provideFunction_("mathIsPrime",["function "+u.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(n) {","  // https://en.wikipedia.org/wiki/Primality_test#Naive_methods","  if (n == 2 || n == 3) {","    return true;","  }","  // False if n is NaN, negative, is 1, or not whole.","  // And false if n is divisible by 2 or 3.","  if (isNaN(n) || n <= 1 || n % 1 != 0 || n % 2 == 0 || n % 3 == 0) {","    return false;","  }","  // Check all the numbers of form 6k +/- 1, up to sqrt(n).","  for (var x = 6; x <= Math.sqrt(n) + 1; x += 6) {","    if (n % (x - 1) == 0 || n % (x + 1) == 0) {","      return false;","    }","  }","  return true;","}"])+"("+e+")",u.JavaScript.ORDER_FUNCTION_CALL];switch(o){case"EVEN":var n=e+" % 2 == 0";break;case"ODD":n=e+" % 2 == 1";break;case"WHOLE":n=e+" % 1 == 0";break;case"POSITIVE":n=e+" > 0";break;case"NEGATIVE":n=e+" < 0";break;case"DIVISIBLE_BY":n=e+" % "+(t=u.JavaScript.valueToCode(t,"DIVISOR",u.JavaScript.ORDER_MODULUS)||"0")+" == 0"}return[n,u.JavaScript.ORDER_EQUALITY]},u.JavaScript.math_change=function(t){var e=u.JavaScript.valueToCode(t,"DELTA",u.JavaScript.ORDER_ADDITION)||"0";return(t=u.JavaScript.variableDB_.getName(t.getFieldValue("VAR"),u.VARIABLE_CATEGORY_NAME))+" = (typeof "+t+" == 'number' ? "+t+" : 0) + "+e+";\n"},u.JavaScript.math_round=u.JavaScript.math_single,u.JavaScript.math_trig=u.JavaScript.math_single,u.JavaScript.math_on_list=function(t){var e=t.getFieldValue("OP");switch(e){case"SUM":t=u.JavaScript.valueToCode(t,"LIST",u.JavaScript.ORDER_MEMBER)||"[]",t+=".reduce(function(x, y) {return x + y;})";break;case"MIN":t="Math.min.apply(null, "+(t=u.JavaScript.valueToCode(t,"LIST",u.JavaScript.ORDER_COMMA)||"[]")+")";break;case"MAX":t="Math.max.apply(null, "+(t=u.JavaScript.valueToCode(t,"LIST",u.JavaScript.ORDER_COMMA)||"[]")+")";break;case"AVERAGE":t=(e=u.JavaScript.provideFunction_("mathMean",["function "+u.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(myList) {","  return myList.reduce(function(x, y) {return x + y;}) / myList.length;","}"]))+"("+(t=u.JavaScript.valueToCode(t,"LIST",u.JavaScript.ORDER_NONE)||"[]")+")";break;case"MEDIAN":t=(e=u.JavaScript.provideFunction_("mathMedian",["function "+u.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(myList) {","  var localList = myList.filter(function (x) {return typeof x == 'number';});","  if (!localList.length) return null;","  localList.sort(function(a, b) {return b - a;});","  if (localList.length % 2 == 0) {","    return (localList[localList.length / 2 - 1] + localList[localList.length / 2]) / 2;","  } else {","    return localList[(localList.length - 1) / 2];","  }","}"]))+"("+(t=u.JavaScript.valueToCode(t,"LIST",u.JavaScript.ORDER_NONE)||"[]")+")";break;case"MODE":t=(e=u.JavaScript.provideFunction_("mathModes",["function "+u.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(values) {","  var modes = [];","  var counts = [];","  var maxCount = 0;","  for (var i = 0; i < values.length; i++) {","    var value = values[i];","    var found = false;","    var thisCount;","    for (var j = 0; j < counts.length; j++) {","      if (counts[j][0] === value) {","        thisCount = ++counts[j][1];","        found = true;","        break;","      }","    }","    if (!found) {","      counts.push([value, 1]);","      thisCount = 1;","    }","    maxCount = Math.max(thisCount, maxCount);","  }","  for (var j = 0; j < counts.length; j++) {","    if (counts[j][1] == maxCount) {","        modes.push(counts[j][0]);","    }","  }","  return modes;","}"]))+"("+(t=u.JavaScript.valueToCode(t,"LIST",u.JavaScript.ORDER_NONE)||"[]")+")";break;case"STD_DEV":t=(e=u.JavaScript.provideFunction_("mathStandardDeviation",["function "+u.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(numbers) {","  var n = numbers.length;","  if (!n) return null;","  var mean = numbers.reduce(function(x, y) {return x + y;}) / n;","  var variance = 0;","  for (var j = 0; j < n; j++) {","    variance += Math.pow(numbers[j] - mean, 2);","  }","  variance = variance / n;","  return Math.sqrt(variance);","}"]))+"("+(t=u.JavaScript.valueToCode(t,"LIST",u.JavaScript.ORDER_NONE)||"[]")+")";break;case"RANDOM":t=(e=u.JavaScript.provideFunction_("mathRandomList",["function "+u.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(list) {","  var x = Math.floor(Math.random() * list.length);","  return list[x];","}"]))+"("+(t=u.JavaScript.valueToCode(t,"LIST",u.JavaScript.ORDER_NONE)||"[]")+")";break;default:throw Error("Unknown operator: "+e)}return[t,u.JavaScript.ORDER_FUNCTION_CALL]},u.JavaScript.math_modulo=function(t){return[(u.JavaScript.valueToCode(t,"DIVIDEND",u.JavaScript.ORDER_MODULUS)||"0")+" % "+(t=u.JavaScript.valueToCode(t,"DIVISOR",u.JavaScript.ORDER_MODULUS)||"0"),u.JavaScript.ORDER_MODULUS]},u.JavaScript.math_constrain=function(t){return["Math.min(Math.max("+(u.JavaScript.valueToCode(t,"VALUE",u.JavaScript.ORDER_COMMA)||"0")+", "+(u.JavaScript.valueToCode(t,"LOW",u.JavaScript.ORDER_COMMA)||"0")+"), "+(t=u.JavaScript.valueToCode(t,"HIGH",u.JavaScript.ORDER_COMMA)||"Infinity")+")",u.JavaScript.ORDER_FUNCTION_CALL]},u.JavaScript.math_random_int=function(t){var e=u.JavaScript.valueToCode(t,"FROM",u.JavaScript.ORDER_COMMA)||"0";return t=u.JavaScript.valueToCode(t,"TO",u.JavaScript.ORDER_COMMA)||"0",[u.JavaScript.provideFunction_("mathRandomInt",["function "+u.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(a, b) {","  if (a > b) {","    // Swap a and b to ensure a is smaller.","    var c = a;","    a = b;","    b = c;","  }","  return Math.floor(Math.random() * (b - a + 1) + a);","}"])+"("+e+", "+t+")",u.JavaScript.ORDER_FUNCTION_CALL]},u.JavaScript.math_random_float=function(t){return["Math.random()",u.JavaScript.ORDER_FUNCTION_CALL]},u.JavaScript.math_atan2=function(t){var e=u.JavaScript.valueToCode(t,"X",u.JavaScript.ORDER_COMMA)||"0";return["Math.atan2("+(u.JavaScript.valueToCode(t,"Y",u.JavaScript.ORDER_COMMA)||"0")+", "+e+") / Math.PI * 180",u.JavaScript.ORDER_DIVISION]},u.JavaScript.procedures={},u.JavaScript.procedures_defreturn=function(t){var e=u.JavaScript.variableDB_.getName(t.getFieldValue("NAME"),u.PROCEDURE_CATEGORY_NAME),o="";u.JavaScript.STATEMENT_PREFIX&&(o+=u.JavaScript.injectId(u.JavaScript.STATEMENT_PREFIX,t)),u.JavaScript.STATEMENT_SUFFIX&&(o+=u.JavaScript.injectId(u.JavaScript.STATEMENT_SUFFIX,t)),o&&(o=u.JavaScript.prefixLines(o,u.JavaScript.INDENT));var n="";u.JavaScript.INFINITE_LOOP_TRAP&&(n=u.JavaScript.prefixLines(u.JavaScript.injectId(u.JavaScript.INFINITE_LOOP_TRAP,t),u.JavaScript.INDENT));var i=u.JavaScript.statementToCode(t,"STACK"),r=u.JavaScript.valueToCode(t,"RETURN",u.JavaScript.ORDER_NONE)||"",s="";i&&r&&(s=o),r&&(r=u.JavaScript.INDENT+"return "+r+";\n");for(var a=[],l=t.getVars(),c=0;c<l.length;c++)a[c]=u.JavaScript.variableDB_.getName(l[c],u.VARIABLE_CATEGORY_NAME);return o="function "+e+"("+a.join(", ")+") {\n"+o+n+i+s+r+"}",o=u.JavaScript.scrub_(t,o),u.JavaScript.definitions_["%"+e]=o,null},u.JavaScript.procedures_defnoreturn=u.JavaScript.procedures_defreturn,u.JavaScript.procedures_callreturn=function(t){for(var e=u.JavaScript.variableDB_.getName(t.getFieldValue("NAME"),u.PROCEDURE_CATEGORY_NAME),o=[],n=t.getVars(),i=0;i<n.length;i++)o[i]=u.JavaScript.valueToCode(t,"ARG"+i,u.JavaScript.ORDER_COMMA)||"null";return[e+"("+o.join(", ")+")",u.JavaScript.ORDER_FUNCTION_CALL]},u.JavaScript.procedures_callnoreturn=function(t){return u.JavaScript.procedures_callreturn(t)[0]+";\n"},u.JavaScript.procedures_ifreturn=function(t){var e="if ("+(u.JavaScript.valueToCode(t,"CONDITION",u.JavaScript.ORDER_NONE)||"false")+") {\n";return u.JavaScript.STATEMENT_SUFFIX&&(e+=u.JavaScript.prefixLines(u.JavaScript.injectId(u.JavaScript.STATEMENT_SUFFIX,t),u.JavaScript.INDENT)),t.hasReturnValue_?(t=u.JavaScript.valueToCode(t,"VALUE",u.JavaScript.ORDER_NONE)||"null",e+=u.JavaScript.INDENT+"return "+t+";\n"):e+=u.JavaScript.INDENT+"return;\n",e+"}\n"},u.JavaScript.texts={},u.JavaScript.text=function(t){return[u.JavaScript.quote_(t.getFieldValue("TEXT")),u.JavaScript.ORDER_ATOMIC]},u.JavaScript.text_multiline=function(t){return-1!=(t=u.JavaScript.multiline_quote_(t.getFieldValue("TEXT"))).indexOf("\n")&&(t="("+t+")"),[t,u.JavaScript.ORDER_ATOMIC]},u.JavaScript.text.forceString_=function(t){return u.JavaScript.text.forceString_.strRegExp.test(t)?t:"String("+t+")"},u.JavaScript.text.forceString_.strRegExp=/^\s*'([^']|\\')*'\s*$/,u.JavaScript.text_join=function(t){switch(t.itemCount_){case 0:return["''",u.JavaScript.ORDER_ATOMIC];case 1:return t=u.JavaScript.valueToCode(t,"ADD0",u.JavaScript.ORDER_NONE)||"''",[t=u.JavaScript.text.forceString_(t),u.JavaScript.ORDER_FUNCTION_CALL];case 2:var e=u.JavaScript.valueToCode(t,"ADD0",u.JavaScript.ORDER_NONE)||"''";return t=u.JavaScript.valueToCode(t,"ADD1",u.JavaScript.ORDER_NONE)||"''",[t=u.JavaScript.text.forceString_(e)+" + "+u.JavaScript.text.forceString_(t),u.JavaScript.ORDER_ADDITION];default:e=Array(t.itemCount_);for(var o=0;o<t.itemCount_;o++)e[o]=u.JavaScript.valueToCode(t,"ADD"+o,u.JavaScript.ORDER_COMMA)||"''";return[t="["+e.join(",")+"].join('')",u.JavaScript.ORDER_FUNCTION_CALL]}},u.JavaScript.text_append=function(t){var e=u.JavaScript.variableDB_.getName(t.getFieldValue("VAR"),u.VARIABLE_CATEGORY_NAME);return t=u.JavaScript.valueToCode(t,"TEXT",u.JavaScript.ORDER_NONE)||"''",e+" += "+u.JavaScript.text.forceString_(t)+";\n"},u.JavaScript.text_length=function(t){return[(u.JavaScript.valueToCode(t,"VALUE",u.JavaScript.ORDER_FUNCTION_CALL)||"''")+".length",u.JavaScript.ORDER_MEMBER]},u.JavaScript.text_isEmpty=function(t){return["!"+(u.JavaScript.valueToCode(t,"VALUE",u.JavaScript.ORDER_MEMBER)||"''")+".length",u.JavaScript.ORDER_LOGICAL_NOT]},u.JavaScript.text_indexOf=function(t){var e="FIRST"==t.getFieldValue("END")?"indexOf":"lastIndexOf",o=u.JavaScript.valueToCode(t,"FIND",u.JavaScript.ORDER_NONE)||"''";return e=(u.JavaScript.valueToCode(t,"VALUE",u.JavaScript.ORDER_MEMBER)||"''")+"."+e+"("+o+")",t.workspace.options.oneBasedIndex?[e+" + 1",u.JavaScript.ORDER_ADDITION]:[e,u.JavaScript.ORDER_FUNCTION_CALL]},u.JavaScript.text_charAt=function(t){var e=t.getFieldValue("WHERE")||"FROM_START",o=u.JavaScript.valueToCode(t,"VALUE","RANDOM"==e?u.JavaScript.ORDER_NONE:u.JavaScript.ORDER_MEMBER)||"''";switch(e){case"FIRST":return[o+".charAt(0)",u.JavaScript.ORDER_FUNCTION_CALL];case"LAST":return[o+".slice(-1)",u.JavaScript.ORDER_FUNCTION_CALL];case"FROM_START":return[o+".charAt("+(t=u.JavaScript.getAdjusted(t,"AT"))+")",u.JavaScript.ORDER_FUNCTION_CALL];case"FROM_END":return[o+".slice("+(t=u.JavaScript.getAdjusted(t,"AT",1,!0))+").charAt(0)",u.JavaScript.ORDER_FUNCTION_CALL];case"RANDOM":return[u.JavaScript.provideFunction_("textRandomLetter",["function "+u.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(text) {","  var x = Math.floor(Math.random() * text.length);","  return text[x];","}"])+"("+o+")",u.JavaScript.ORDER_FUNCTION_CALL]}throw Error("Unhandled option (text_charAt).")},u.JavaScript.text.getIndex_=function(t,e,o){return"FIRST"==e?"0":"FROM_END"==e?t+".length - 1 - "+o:"LAST"==e?t+".length - 1":o},u.JavaScript.text_getSubstring=function(t){var e=u.JavaScript.valueToCode(t,"STRING",u.JavaScript.ORDER_FUNCTION_CALL)||"''",o=t.getFieldValue("WHERE1"),n=t.getFieldValue("WHERE2");if("FIRST"!=o||"LAST"!=n)if(e.match(/^'?\w+'?$/)||"FROM_END"!=o&&"LAST"!=o&&"FROM_END"!=n&&"LAST"!=n){switch(o){case"FROM_START":var i=u.JavaScript.getAdjusted(t,"AT1");break;case"FROM_END":i=e+".length - "+(i=u.JavaScript.getAdjusted(t,"AT1",1,!1,u.JavaScript.ORDER_SUBTRACTION));break;case"FIRST":i="0";break;default:throw Error("Unhandled option (text_getSubstring).")}switch(n){case"FROM_START":t=u.JavaScript.getAdjusted(t,"AT2",1);break;case"FROM_END":t=e+".length - "+(t=u.JavaScript.getAdjusted(t,"AT2",0,!1,u.JavaScript.ORDER_SUBTRACTION));break;case"LAST":t=e+".length";break;default:throw Error("Unhandled option (text_getSubstring).")}e=e+".slice("+i+", "+t+")"}else{i=u.JavaScript.getAdjusted(t,"AT1"),t=u.JavaScript.getAdjusted(t,"AT2");var r=u.JavaScript.text.getIndex_,s={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};e=u.JavaScript.provideFunction_("subsequence"+s[o]+s[n],["function "+u.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(sequence"+("FROM_END"==o||"FROM_START"==o?", at1":"")+("FROM_END"==n||"FROM_START"==n?", at2":"")+") {","  var start = "+r("sequence",o,"at1")+";","  var end = "+r("sequence",n,"at2")+" + 1;","  return sequence.slice(start, end);","}"])+"("+e+("FROM_END"==o||"FROM_START"==o?", "+i:"")+("FROM_END"==n||"FROM_START"==n?", "+t:"")+")"}return[e,u.JavaScript.ORDER_FUNCTION_CALL]},u.JavaScript.text_changeCase=function(t){var e={UPPERCASE:".toUpperCase()",LOWERCASE:".toLowerCase()",TITLECASE:null}[t.getFieldValue("CASE")];return t=u.JavaScript.valueToCode(t,"TEXT",e?u.JavaScript.ORDER_MEMBER:u.JavaScript.ORDER_NONE)||"''",[e?t+e:u.JavaScript.provideFunction_("textToTitleCase",["function "+u.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(str) {","  return str.replace(/\\S+/g,","      function(txt) {return txt[0].toUpperCase() + txt.substring(1).toLowerCase();});","}"])+"("+t+")",u.JavaScript.ORDER_FUNCTION_CALL]},u.JavaScript.text_trim=function(t){var e={LEFT:".replace(/^[\\s\\xa0]+/, '')",RIGHT:".replace(/[\\s\\xa0]+$/, '')",BOTH:".trim()"}[t.getFieldValue("MODE")];return[(u.JavaScript.valueToCode(t,"TEXT",u.JavaScript.ORDER_MEMBER)||"''")+e,u.JavaScript.ORDER_FUNCTION_CALL]},u.JavaScript.text_print=function(t){return"window.alert("+(u.JavaScript.valueToCode(t,"TEXT",u.JavaScript.ORDER_NONE)||"''")+");\n"},u.JavaScript.text_prompt_ext=function(t){var e="window.prompt("+(t.getField("TEXT")?u.JavaScript.quote_(t.getFieldValue("TEXT")):u.JavaScript.valueToCode(t,"TEXT",u.JavaScript.ORDER_NONE)||"''")+")";return"NUMBER"==t.getFieldValue("TYPE")&&(e="Number("+e+")"),[e,u.JavaScript.ORDER_FUNCTION_CALL]},u.JavaScript.text_prompt=u.JavaScript.text_prompt_ext,u.JavaScript.text_count=function(t){var e=u.JavaScript.valueToCode(t,"TEXT",u.JavaScript.ORDER_MEMBER)||"''";return t=u.JavaScript.valueToCode(t,"SUB",u.JavaScript.ORDER_NONE)||"''",[u.JavaScript.provideFunction_("textCount",["function "+u.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(haystack, needle) {","  if (needle.length === 0) {","    return haystack.length + 1;","  } else {","    return haystack.split(needle).length - 1;","  }","}"])+"("+e+", "+t+")",u.JavaScript.ORDER_SUBTRACTION]},u.JavaScript.text_replace=function(t){var e=u.JavaScript.valueToCode(t,"TEXT",u.JavaScript.ORDER_MEMBER)||"''",o=u.JavaScript.valueToCode(t,"FROM",u.JavaScript.ORDER_NONE)||"''";return t=u.JavaScript.valueToCode(t,"TO",u.JavaScript.ORDER_NONE)||"''",[u.JavaScript.provideFunction_("textReplace",["function "+u.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(haystack, needle, replacement) {",'  needle = needle.replace(/([-()\\[\\]{}+?*.$\\^|,:#<!\\\\])/g,"\\\\$1")','                 .replace(/\\x08/g,"\\\\x08");',"  return haystack.replace(new RegExp(needle, 'g'), replacement);","}"])+"("+e+", "+o+", "+t+")",u.JavaScript.ORDER_MEMBER]},u.JavaScript.text_reverse=function(t){return[(u.JavaScript.valueToCode(t,"TEXT",u.JavaScript.ORDER_MEMBER)||"''")+".split('').reverse().join('')",u.JavaScript.ORDER_MEMBER]},u.JavaScript.variables={},u.JavaScript.variables_get=function(t){return[u.JavaScript.variableDB_.getName(t.getFieldValue("VAR"),u.VARIABLE_CATEGORY_NAME),u.JavaScript.ORDER_ATOMIC]},u.JavaScript.variables_set=function(t){var e=u.JavaScript.valueToCode(t,"VALUE",u.JavaScript.ORDER_ASSIGNMENT)||"0";return u.JavaScript.variableDB_.getName(t.getFieldValue("VAR"),u.VARIABLE_CATEGORY_NAME)+" = "+e+";\n"},u.JavaScript.variablesDynamic={},u.JavaScript.variables_get_dynamic=u.JavaScript.variables_get,u.JavaScript.variables_set_dynamic=u.JavaScript.variables_set,u.JavaScript})?n.apply(e,i):n)||(t.exports=r)},4605:function(t,e,o){"use strict";var n=o(33),r=i(o(147)),s=i(o(4606)),a=i(o(4607)),l=i(o(3488)),c=o(4609),u=i(o(4610)),h=i(o(4611)),p=i(o(4612)),_=i(o(4613)),d=i(o(4614)),g=i(o(4615)),f=i(o(4616));function i(t){return t&&t.__esModule?t:{default:t}}var T=function(t){this.version=n.BlocklyVersion.GOOGLE,this.blockly_=t,this.uidCounter_=0,this.wrapReadOnlyProperty=function(t){Object.defineProperty(this,t,{get:function(){return this.blockly_[t]}})},this.wrapSettableProperty=function(e){Object.defineProperty(this,e,{get:function(){return this.blockly_[e]},set:function(t){this.blockly_[e]=t}})}};t.exports=function(t){var i=new T(t);return i.wrapReadOnlyProperty("ALIGN_CENTRE"),i.wrapReadOnlyProperty("ALIGN_LEFT"),i.wrapReadOnlyProperty("ALIGN_RIGHT"),i.wrapReadOnlyProperty("applab_locale"),i.wrapReadOnlyProperty("bindEvent_"),i.wrapReadOnlyProperty("blockRendering"),i.wrapReadOnlyProperty("Block"),i.wrapReadOnlyProperty("BlockFieldHelper"),i.wrapReadOnlyProperty("Blocks"),i.wrapReadOnlyProperty("BlockSvg"),i.wrapReadOnlyProperty("BlockValueType"),i.wrapReadOnlyProperty("common_locale"),i.wrapReadOnlyProperty("Connection"),i.wrapReadOnlyProperty("ContextMenu"),i.wrapReadOnlyProperty("contractEditor"),i.wrapReadOnlyProperty("createSvgElement"),i.wrapReadOnlyProperty("Css"),i.wrapReadOnlyProperty("disableVariableEditing"),i.wrapReadOnlyProperty("Events"),i.wrapReadOnlyProperty("FieldAngleDropdown"),i.wrapReadOnlyProperty("FieldAngleInput"),i.wrapReadOnlyProperty("FieldAngleTextInput"),i.wrapReadOnlyProperty("FieldButton"),i.wrapReadOnlyProperty("FieldColour"),i.wrapReadOnlyProperty("FieldColourDropdown"),i.wrapReadOnlyProperty("FieldDropdown"),i.wrapReadOnlyProperty("FieldIcon"),i.wrapReadOnlyProperty("FieldImage"),i.wrapReadOnlyProperty("FieldImageDropdown"),i.wrapReadOnlyProperty("FieldLabel"),i.wrapReadOnlyProperty("FieldParameter"),i.wrapReadOnlyProperty("FieldRectangularDropdown"),i.wrapReadOnlyProperty("FieldTextInput"),i.wrapReadOnlyProperty("FieldVariable"),i.wrapReadOnlyProperty("fish_locale"),i.wrapReadOnlyProperty("Flyout"),i.wrapReadOnlyProperty("FunctionalBlockUtils"),i.wrapReadOnlyProperty("FunctionalTypeColors"),i.wrapReadOnlyProperty("FunctionEditor"),i.wrapReadOnlyProperty("functionEditor"),i.wrapReadOnlyProperty("gamelab_locale"),i.wrapReadOnlyProperty("getMainWorkspace"),i.wrapReadOnlyProperty("Generator"),i.wrapReadOnlyProperty("geras"),i.wrapReadOnlyProperty("getRelativeXY"),i.wrapReadOnlyProperty("googlecode"),i.wrapReadOnlyProperty("hasCategories"),i.wrapReadOnlyProperty("html"),i.wrapReadOnlyProperty("Input"),i.wrapReadOnlyProperty("INPUT_VALUE"),i.wrapReadOnlyProperty("js"),i.wrapReadOnlyProperty("modalBlockSpace"),i.wrapReadOnlyProperty("Msg"),i.wrapReadOnlyProperty("Names"),i.wrapReadOnlyProperty("netsim_locale"),i.wrapReadOnlyProperty("Procedures"),i.wrapReadOnlyProperty("removeChangeListener"),i.wrapReadOnlyProperty("RTL"),i.wrapReadOnlyProperty("Scrollbar"),i.wrapReadOnlyProperty("selected"),i.wrapReadOnlyProperty("svgResize"),i.wrapReadOnlyProperty("tutorialExplorer_locale"),i.wrapReadOnlyProperty("useContractEditor"),i.wrapReadOnlyProperty("useModalFunctionEditor"),i.wrapReadOnlyProperty("utils"),i.wrapReadOnlyProperty("Trashcan"),i.wrapReadOnlyProperty("Variables"),i.wrapReadOnlyProperty("weblab_locale"),i.wrapReadOnlyProperty("Workspace"),i.wrapReadOnlyProperty("WorkspaceSvg"),i.wrapReadOnlyProperty("Xml"),i.blockly_.BlockDragger=s.default,i.blockly_.BlockSvg=a.default,i.blockly_.FieldDropdown=l.default,i.blockly_.FieldImageDropdown=c.CdoFieldImageDropdown,i.blockly_.Input=u.default,i.geras.PathObject=h.default,i.blockly_.Scrollbar=p.default,i.blockly_.Trashcan=d.default,i.blockly_.WorkspaceSvg=g.default,Object.defineProperty(i,"mainBlockSpace",{get:function(){return this.blockly_.mainWorkspace}}),Object.defineProperty(i,"mainBlockSpaceEditor",{get:function(){return this.blockly_.mainWorkspace}}),Object.defineProperty(i,"SVG_NS",{get:function(){return this.blockly_.utils.dom.SVG_NS}}),i.wrapSettableProperty("assetUrl"),i.wrapSettableProperty("behaviorEditor"),i.wrapSettableProperty("BROKEN_CONTROL_POINTS"),i.wrapSettableProperty("BUMP_UNCONNECTED"),i.wrapSettableProperty("HSV_SATURATION"),i.wrapSettableProperty("JavaScript"),i.wrapSettableProperty("readOnly"),i.wrapSettableProperty("showUnusedBlocks"),i.wrapSettableProperty("typeHints"),i.wrapSettableProperty("valueTypeTabShapeMap"),Object.defineProperty(i,"SNAP_RADIUS",{get:function(){return this.blockly_.SNAP_RADIUS},set:function(t){this.blockly_.SNAP_RADIUS=t,this.blockly_.CONNECTING_SNAP_RADIUS=t}}),i.getGenerator=function(){return this.JavaScript},i.findEmptyContainerBlock=function(){},i.BlockSpace={EVENTS:{MAIN_BLOCK_SPACE_CREATED:"mainBlockSpaceCreated",EVENT_BLOCKS_IMPORTED:"blocksImported",BLOCK_SPACE_CHANGE:"blockSpaceChange",BLOCK_SPACE_SCROLLED:"blockSpaceScrolled",RUN_BUTTON_CLICKED:"runButtonClicked"},onMainBlockSpaceCreated:function(){},createReadOnlyBlockSpace:function(t,e,o){var n=new Blockly.WorkspaceSvg({readOnly:!0,theme:_.default,plugins:{}}),i=Blockly.utils.dom.createSvgElement("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:html":"http://www.w3.org/1999/xhtml","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",class:"geras-renderer modern-theme readOnlyBlockSpace"},null);t.appendChild(i),i.appendChild(n.createDom()),Blockly.Xml.domToBlockSpace(n,e);var r=i.getBBox();return i.setAttribute("height",r.height+r.y),i.setAttribute("width",r.width+r.x),n}},i.Generator.blockSpaceToCode=function(t,e){var o=i.mainBlockSpace.getTopBlocks(!0);e&&("string"==typeof e&&(e=[e]),o=o.filter(function(t){return e.includes(t.type)}));var n=[];return o.forEach(function(t){n.push(i.JavaScript.blockToCode(t))}),n.join("\n")},i.inject=function(t,e,o){var n=function(i){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},e=Object.keys(Object(r));"function"==typeof Object.getOwnPropertySymbols&&(e=e.concat(Object.getOwnPropertySymbols(r).filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),e.forEach(function(t){var e,o,n;e=i,n=r[o=t],o in e?Object.defineProperty(e,o,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[o]=n})}return i}({},e,{theme:_.default,trashcan:!0,move:{wheel:!0,drag:!0,scrollbars:!0}});return t.style.height="calc(100% - ".concat(r.default["workspace-headers-height"],"px)"),i.editBlocks=e.editBlocks,i.blockly_.inject(t,n)},i.fireUiEvent=function(t,e,o){"resize"===e&&i.svgResize(i.getMainWorkspace())},(0,f.default)(i),i}},4606:function(t,e,o){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=function(n){function t(){return n.apply(this,arguments)||this}!function(t,e){t.prototype=Object.create(e.prototype),(t.prototype.constructor=t).__proto__=e}(t,n);var e=t.prototype;return e.dragBlock=function(t,e){n.prototype.dragBlock.call(this,t,e),!!Blockly.mainBlockSpace.currentGesture_.flyout_?this.workspace_.hideTrashcan():(this.workspace_.showTrashcan(),this.draggingBlock_.isDeletable()?this.workspace_.trashcan.setDisabled(!1):this.workspace_.trashcan.setDisabled(!0))},e.endBlockDrag=function(t,e){if(!this.draggedConnectionManager_.wouldDeleteBlock()){var o=this.draggingBlock_.getRelativeToSurfaceXY();o.x<0&&(e.x-=o.x),o.y<0&&(e.y-=o.y)}n.prototype.endBlockDrag.call(this,t,e),this.workspace_.trashcan.setDisabled(!1),this.workspace_.hideTrashcan()},e.updateCursorDuringBlockDrag_=function(){n.prototype.updateCursorDuringBlockDrag_.call(this),this.draggedConnectionManager_.wouldDeleteBlock()&&this.workspace_.trashcan.setLidOpen(!0)},t}(((n=o(2464))&&n.__esModule?n:{default:n}).default.BlockDragger);e.default=i,t.exports=e.default},4607:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(o(2464)),r=i(o(4608));function i(t){return t&&t.__esModule?t:{default:t}}var s=function(i){function t(t,e,o){var n;return void 0===(n=i.call(this,t,e,++Blockly.uidCounter_)||this).svgGroup_.dataset&&n.svgGroup_.setAttribute("data-id",n.id),n.canDisconnectFromParent_=!0,n}!function(t,e){t.prototype=Object.create(e.prototype),(t.prototype.constructor=t).__proto__=e}(t,i);var e=t.prototype;return e.addUnusedBlockFrame=function(t){this.unusedSvg_||(this.unusedSvg_=new r.default(this,t)),this.unusedSvg_.render(this.svgGroup_)},e.isVisible=function(){return!0},e.setCanDisconnectFromParent=function(t){this.canDisconnectFromParent_=t},e.customContextMenu=function(t){if(Blockly.editBlocks){var e={text:this.deletable_?"Make Undeletable to Users":"Make Deletable to Users",enabled:!0,callback:function(){this.setDeletable(!this.isDeletable()),Blockly.ContextMenu.hide()}.bind(this)},o={text:this.movable_?"Make Immovable to Users":"Make Movable to Users",enabled:!0,callback:function(){this.setMovable(!this.isMovable()),Blockly.ContextMenu.hide()}.bind(this)},n={text:this.editable_?"Make Uneditable":"Make editable",enabled:!0,callback:function(){this.setEditable(!this.isEditable()),Blockly.ContextMenu.hide()}.bind(this)},i={text:this.canDisconnectFromParent_?"Lock to Parent Block":"Unlock from Parent Block",enabled:!0,callback:function(){this.setCanDisconnectFromParent(!this.canDisconnectFromParent_),Blockly.ContextMenu.hide()}.bind(this)};t.push(e),t.push(o),t.push(n),t.push(i)}},e.dispose=function(){i.prototype.dispose.call(this),this.removeUnusedBlockFrame()},e.getTitles=function(){var e=[];return this.inputList.forEach(function(t){t.fieldRow.forEach(function(t){e.push(t)})}),e},e.getTitleValue=function(t){return i.prototype.getFieldValue.call(this,t)},e.isUserVisible=function(){return!1},e.onMouseDown_=function(t){(Blockly.utils.isRightButton(t)||this.canDisconnectFromParent_)&&i.prototype.onMouseDown_.call(this,t)},e.render=function(){i.prototype.render.call(this),this.removeUnusedBlockFrame()},e.removeUnusedBlockFrame=function(){this.unusedSvg_&&(this.unusedSvg_.dispose(),this.unusedSvg_=null)},e.setHSV=function(t,e,o){return i.prototype.setColour.call(this,Blockly.utils.colour.hsvToHex(t,e,255*o))},t}(n.default.BlockSvg);e.default=s,t.exports=e.default},4608:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,i=(n=o(3))&&n.__esModule?n:{default:n};var r=function(){function t(t,e){this.block_=t,this.helpClickFunc_=e,this.frameGroup_=void 0,this.frameClipRect_=void 0,this.frameBase_=void 0,this.frameHeader_=void 0,this.frameText_=void 0,this.frameHelp_=void 0,this.initChildren()}var e=t.prototype;return e.initChildren=function(){this.frameGroup_=Blockly.utils.dom.createSvgElement("g",{class:"blocklyUnusedFrame"});var t=Blockly.utils.dom.createSvgElement("clipPath",{id:"frameClip".concat(this.block_.id)},this.frameGroup_);this.frameClipRect_=Blockly.utils.dom.createSvgElement("rect",{x:-15,y:-35,height:25},t),this.frameBase_=Blockly.utils.dom.createSvgElement("rect",{x:-15,y:-35,fill:"#e7e8ea",stroke:"#c6cacd",rx:15,ry:15},this.frameGroup_),this.frameHeader_=Blockly.utils.dom.createSvgElement("rect",{x:-15,y:-35,fill:"#c6cacd",rx:15,ry:15,"clip-path":"url(#frameClip".concat(this.block_.id,")")},this.frameGroup_);var e=-22.5;Blockly.utils.userAgent.IE&&(e+=4),this.frameText_=Blockly.utils.dom.createSvgElement("text",{class:"blocklyText",style:"font-size: 12pt;fill: #000",y:e,"dominant-baseline":"central"},this.frameGroup_),this.frameText_.appendChild(document.createTextNode(i.default.unusedCode())),this.frameHelp_=Blockly.utils.dom.createSvgElement("g",{class:"blocklyHelp"},this.frameGroup_),Blockly.utils.dom.createSvgElement("circle",{fill:"#7665a0",r:9.375},this.frameHelp_),Blockly.utils.dom.createSvgElement("text",{class:"blocklyText",y:Blockly.utils.userAgent.IE?4:0},this.frameHelp_).appendChild(document.createTextNode("?"))},e.getPadding=function(){return{top:35,right:15,bottom:5,left:15}},e.bindClickEvent=function(){this.isbound_||(this.isbound_=!0,Blockly.bindEvent_(this.frameHelp_,"mousedown",this,function(t){Blockly.utils.isRightButton(t)||(this.helpClickFunc_(t),t.stopPropagation(),t.preventDefault())}))},e.render=function(t){this.frameGroup_.remove();var e=t.getBoundingClientRect();t.prepend(this.frameGroup_),Blockly.utils.dom.addClass(this.frameGroup_,"hidden");var o=this.frameGroup_;setTimeout(function(){Blockly.utils.dom.removeClass(o,"hidden")},0),this.bindClickEvent();var n=this.frameText_.getBoundingClientRect().width+this.frameHelp_.getBoundingClientRect().width,i=Math.max(e.width,n)+30,r=e.height+10+5+25;this.frameClipRect_.setAttribute("width",i),this.frameBase_.setAttribute("width",i),this.frameBase_.setAttribute("height",r),this.frameHeader_.setAttribute("width",i),this.frameHeader_.setAttribute("height",r),Blockly.RTL&&(this.frameClipRect_.setAttribute("x",15-i),this.frameHeader_.setAttribute("x",15-i),this.frameBase_.setAttribute("x",15-i),this.frameText_.setAttribute("x",30-i)),this.frameHelp_.setAttribute("transform","translate("+(i-30)+","+-22.5+")")},e.dispose=function(){this.frameGroup_.remove(),this.frameGroup_=void 0,this.frameClipRect_=void 0,this.frameBase_=void 0,this.frameHeader_=void 0,this.frameText_=void 0,this.frameHelp_=void 0},t}();e.default=r,t.exports=e.default},4609:function(t,e,o){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),e.__TestInterface=e.CdoFieldImageDropdown=void 0;var i=function(r){function t(t,e,o,n){var i=s(t,e,o);return r.call(this,i)||this}return function(t,e){t.prototype=Object.create(e.prototype),(t.prototype.constructor=t).__proto__=e}(t,r),t}(((n=o(3488))&&n.__esModule?n:{default:n}).default);function s(t,i,r){var s=[];return t.forEach(function(t){var e=t[0],o=t[1],n={src:e,width:i,height:r,alt:o};s.push([n,o])}),s}e.CdoFieldImageDropdown=i;var r={fixMenuGenerator:s};e.__TestInterface=r},4610:function(t,e,o){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=function(o){function t(){return o.apply(this,arguments)||this}return function(t,e){t.prototype=Object.create(e.prototype),(t.prototype.constructor=t).__proto__=e}(t,o),t.prototype.appendTitle=function(t,e){return o.prototype.appendField.call(this,t,e)},t}(((n=o(2464))&&n.__esModule?n:{default:n}).default.Input);e.default=i,t.exports=e.default},4611:function(t,e,o){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=function(t){function e(){return t.apply(this,arguments)||this}!function(t,e){t.prototype=Object.create(e.prototype),(t.prototype.constructor=t).__proto__=e}(e,t);var o=e.prototype;return o.updateDisabled_=function(t){this.setClass_("blocklyDisabled",t)},o.updateHighlighted=function(t){this.setClass_("blocklySelected",t)},e}(((n=o(2464))&&n.__esModule?n:{default:n}).default.geras.PathObject);e.default=i,t.exports=e.default},4612:function(t,e,o){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=function(e){function t(){return e.apply(this,arguments)||this}!function(t,e){t.prototype=Object.create(e.prototype),(t.prototype.constructor=t).__proto__=e}(t,e);var o=t.prototype;return o.resizeViewVertical=function(t){this.setScrollViewSize_(Math.max(0,t.viewHeight));var e=t.absoluteLeft+.5;this.workspace_.RTL||(e+=t.viewWidth-Blockly.Scrollbar.scrollbarThickness-1);var o=t.absoluteTop+.5;this.setPosition(e,o),this.resizeContentVertical(t)},o.resizeContentVertical=function(t){this.setVisible(this.scrollViewSize_<t.contentHeight),e.prototype.resizeContentVertical.call(this,t)},o.resizeContentHorizontal=function(t){this.setVisible(!1),e.prototype.resizeContentHorizontal.call(this,t)},o.setVisible=function(t){var e=t!==this.isVisible();this.isVisible_=t,e&&this.updateDisplay_()},t}(((n=o(2464))&&n.__esModule?n:{default:n}).default.Scrollbar);e.default=i,t.exports=e.default},4613:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,i=(n=o(2464))&&n.__esModule?n:{default:n};var r=i.default.Theme.defineTheme("modern",{base:i.default.Themes.Classic,blockStyles:{},categoryStyles:{},componentStyles:{toolboxBackgroundColour:"#DDDDDD"},fontStyle:{family:'"Gotham 4r", sans-serif'},startHats:null});e.default=r,t.exports=e.default},4614:function(t,e,o){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=function(e){function o(){return e.apply(this,arguments)||this}!function(t,e){t.prototype=Object.create(e.prototype),(t.prototype.constructor=t).__proto__=e}(o,e);var t=o.prototype;return t.createDom=function(){return e.prototype.createDom.call(this),Array.prototype.forEach.call(this.svgGroup_.childNodes,function(t){"image"===t.nodeName&&t.setAttributeNS(Blockly.utils.dom.XLINK_NS,"xlink:href",o.TRASH_URL)}),this.notAllowed_=Blockly.utils.dom.createSvgElement("g",{},this.svgGroup_),Blockly.utils.dom.createSvgElement("line",{x1:0,y1:10,x2:45,y2:60,stroke:"#c00","stroke-width":5},this.notAllowed_),Blockly.utils.dom.createSvgElement("circle",{cx:22,cy:33,r:33,stroke:"#c00","stroke-width":5,fill:"none"},this.notAllowed_),this.svgGroup_},t.dispose=function(){e.prototype.dispose.call(this),this.notAllowed_=null},t.position=function(){if(this.verticalSpacing_){var t=this.workspace_.getMetrics();t&&(this.left_=Math.round(t.flyoutWidth/2-this.WIDTH_/2),this.top_=this.verticalSpacing_,this.svgGroup_.setAttribute("transform","translate("+this.left_+","+this.top_+")"))}},t.setDisabled=function(t){var e=t?"visible":"hidden";this.notAllowed_.setAttribute("visibility",e)},t.setLidAngle_=function(t){var e=!this.workspace_.RTL;this.svgLid_.setAttribute("transform","rotate("+(e?-t:t)+","+(e?4:this.WIDTH_-4)+","+(this.LID_HEIGHT_-2)+")")},t.onDelete_=function(t){t.type===Blockly.Events.BLOCK_DELETE&&this.workspace_.hideTrashcan(),e.prototype.onDelete_.call(this,t)},o}(((n=o(2464))&&n.__esModule?n:{default:n}).default.Trashcan);(e.default=i).TRASH_URL="/blockly/media/trash.png",t.exports=e.default},4615:function(t,e,o){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=function(t){function e(){return t.apply(this,arguments)||this}!function(t,e){t.prototype=Object.create(e.prototype),(t.prototype.constructor=t).__proto__=e}(e,t);var o=e.prototype;return o.addTrashcan=function(){if(!Blockly.Trashcan)throw Error("Missing require for Blockly.Trashcan");this.trashcan=new Blockly.Trashcan(this);var t=this.trashcan.createDom();this.flyout_.svgGroup_.appendChild(t),this.hideTrashcan()},o.addUnusedBlocksHelpListener=function(e){Blockly.mainBlockSpace.addChangeListener(Blockly.Events.disableOrphans),Blockly.bindEvent_(Blockly.mainBlockSpace.getCanvas(),Blockly.BlockSpace.EVENTS.RUN_BUTTON_CLICKED,Blockly.mainBlockSpace,function(){this.getTopBlocks().forEach(function(t){t.disabled&&t.addUnusedBlockFrame(e)})})},o.getAllUsedBlocks=function(){return t.prototype.getAllBlocks.call(this).filter(function(t){return!t.disabled})},o.getToolboxWidth=function(){return Blockly.mainBlockSpace.getMetrics().toolboxWidth},o.hideTrashcan=function(){Array.prototype.forEach.call(document.querySelectorAll(".blocklyFlyout .blocklyWorkspace"),function(t){t.style.visibility="visible"}),Array.prototype.forEach.call(document.querySelectorAll(".blocklyTrash"),function(t){t.style.visibility="hidden"})},o.isReadOnly=function(){return!1},o.setEnableToolbox=function(){},o.showTrashcan=function(){Array.prototype.forEach.call(document.querySelectorAll(".blocklyFlyout .blocklyWorkspace"),function(t){t.style.visibility="hidden"}),Array.prototype.forEach.call(document.querySelectorAll(".blocklyTrash"),function(t){t.style.visibility="visible"})},o.traceOn=function(){},e}(((n=o(2464))&&n.__esModule?n:{default:n}).default.WorkspaceSvg);(e.default=i).prototype.blockSpaceEditor={blockLimits:{blockLimitExceeded:function(){return!1},getLimit:function(){}},svgResize:function(){}},i.getContentDimensionsBounded_=function(t,e){var o=Blockly.WorkspaceSvg.getContentDimensionsExact_(t),n=e.width,i=e.height;return o.bottom+=100,{left:0,top:0,height:Math.max(o.bottom,i),width:n}},t.exports=e.default},4616:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(i){i.Xml.originalBlockToDom=i.Xml.blockToDom,i.Xml.blockToDom=function(t,e){var o=i.Xml.originalBlockToDom(t);return t.canDisconnectFromParent_||o.setAttribute("can_disconnect_from_parent",!1),e&&Blockly.Xml.deleteNext(o),o},i.Xml.originalDomToBlock=i.Xml.domToBlock,i.Xml.domToBlock=function(t,e){var o=i.Xml.originalDomToBlock(t,e),n=t.getAttribute("can_disconnect_from_parent");return n&&(o.canDisconnectFromParent_="true"===n),o},i.Xml.fieldToDom_=function(t){if(t.isSerializable()){var e=Blockly.utils.xml.createElement("title");return e.setAttribute("name",t.name||""),t.toXml(e)}return null},i.Xml.domToBlockSpace=function(i,t){var e=i.getMetrics(),o=e?e.viewWidth:0,n={x:i.RTL?o-16:16,y:16},r=function(t){var e=t.blockly_block.getHeightWidth();isNaN(t.x)?t.x=n.x:t.x=i.RTL?o-t.x:t.x,isNaN(t.y)&&(t.y=n.y,n.y+=e.height+10),t.blockly_block.moveTo(new Blockly.utils.Coordinate(t.x,t.y))},s=[];return Array.prototype.forEach.call(t.childNodes,function(t){var e=Blockly.Xml.domToBlock(t,i),o=parseInt(t.getAttribute("x"),10),n=parseInt(t.getAttribute("y"),10);s.push({blockly_block:e,x:o,y:n})}),s.filter(function(t){return t.blockly_block.isVisible()}).forEach(r),s.filter(function(t){return!t.blockly_block.isVisible()}).forEach(r),i.render(),s},i.Xml.blockSpaceToDom=i.Xml.workspaceToDom,i.Xml.blockToDomWithXY=i.Xml.blockToDom},t.exports=e.default},48:function(t,e){!function(t){"use strict";if(!t.fetch){var e="URLSearchParams"in t,o="Symbol"in t&&"iterator"in Symbol,s="FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),n="FormData"in t,i="ArrayBuffer"in t;if(i)var r=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],a=function(t){return t&&DataView.prototype.isPrototypeOf(t)},l=ArrayBuffer.isView||function(t){return t&&-1<r.indexOf(Object.prototype.toString.call(t))};d.prototype.append=function(t,e){t=h(t),e=p(e);var o=this.map[t];this.map[t]=o?o+","+e:e},d.prototype.delete=function(t){delete this.map[h(t)]},d.prototype.get=function(t){return t=h(t),this.has(t)?this.map[t]:null},d.prototype.has=function(t){return this.map.hasOwnProperty(h(t))},d.prototype.set=function(t,e){this.map[h(t)]=p(e)},d.prototype.forEach=function(t,e){for(var o in this.map)this.map.hasOwnProperty(o)&&t.call(e,this.map[o],o,this)},d.prototype.keys=function(){var o=[];return this.forEach(function(t,e){o.push(e)}),_(o)},d.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),_(e)},d.prototype.entries=function(){var o=[];return this.forEach(function(t,e){o.push([e,t])}),_(o)},o&&(d.prototype[Symbol.iterator]=d.prototype.entries);var c=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];y.prototype.clone=function(){return new y(this,{body:this._bodyInit})},E.call(y.prototype),E.call(b.prototype),b.prototype.clone=function(){return new b(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})},b.error=function(){var t=new b(null,{status:0,statusText:""});return t.type="error",t};var u=[301,302,303,307,308];b.redirect=function(t,e){if(-1===u.indexOf(e))throw new RangeError("Invalid status code");return new b(null,{status:e,headers:{location:t}})},t.Headers=d,t.Request=y,t.Response=b,t.fetch=function(i,r){return new Promise(function(o,t){var e=new y(i,r),n=new XMLHttpRequest;n.onload=function(){var t={status:n.status,statusText:n.statusText,headers:function(t){var i=new d;return t.split(/\r?\n/).forEach(function(t){var e=t.split(":"),o=e.shift().trim();if(o){var n=e.join(":").trim();i.append(o,n)}}),i}(n.getAllResponseHeaders()||"")};t.url="responseURL"in n?n.responseURL:t.headers.get("X-Request-URL");var e="response"in n?n.response:n.responseText;o(new b(e,t))},n.onerror=function(){t(new TypeError("Network request failed"))},n.ontimeout=function(){t(new TypeError("Network request failed"))},n.open(e.method,e.url,!0),"include"===e.credentials&&(n.withCredentials=!0),"responseType"in n&&s&&(n.responseType="blob"),e.headers.forEach(function(t,e){n.setRequestHeader(e,t)}),n.send(void 0===e._bodyInit?null:e._bodyInit)})},t.fetch.polyfill=!0}function h(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function p(t){return"string"!=typeof t&&(t=String(t)),t}function _(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return o&&(t[Symbol.iterator]=function(){return t}),t}function d(e){this.map={},e instanceof d?e.forEach(function(t,e){this.append(e,t)},this):Array.isArray(e)?e.forEach(function(t){this.append(t[0],t[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function g(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function f(o){return new Promise(function(t,e){o.onload=function(){t(o.result)},o.onerror=function(){e(o.error)}})}function T(t){var e=new FileReader,o=f(e);return e.readAsArrayBuffer(t),o}function v(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function E(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t)if("string"==typeof t)this._bodyText=t;else if(s&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(n&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(e&&URLSearchParams.prototype.isPrototypeOf(t))this._bodyText=t.toString();else if(i&&s&&a(t))this._bodyArrayBuffer=v(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!i||!ArrayBuffer.prototype.isPrototypeOf(t)&&!l(t))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=v(t)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):e&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},s&&(this.blob=function(){var t=g(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?g(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(T)}),this.text=function(){var t=g(this);if(t)return t;if(this._bodyBlob)return function(t){var e=new FileReader,o=f(e);return e.readAsText(t),o}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),o=new Array(e.length),n=0;n<e.length;n++)o[n]=String.fromCharCode(e[n]);return o.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},n&&(this.formData=function(){return this.text().then(m)}),this.json=function(){return this.text().then(JSON.parse)},this}function y(t,e){var o=(e=e||{}).body;if(t instanceof y){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new d(t.headers)),this.method=t.method,this.mode=t.mode,o||null==t._bodyInit||(o=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new d(e.headers)),this.method=function(t){var e=t.toUpperCase();return-1<c.indexOf(e)?e:t}(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(o)}function m(t){var i=new FormData;return t.trim().split("&").forEach(function(t){if(t){var e=t.split("="),o=e.shift().replace(/\+/g," "),n=e.join("=").replace(/\+/g," ");i.append(decodeURIComponent(o),decodeURIComponent(n))}}),i}function b(t,e){e||(e={}),this.type="default",this.status="status"in e?e.status:200,this.ok=200<=this.status&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new d(e.headers),this.url=e.url||"",this._initBody(t)}}("undefined"!=typeof self?self:this)},481:function(t,e,o){var n=o(203);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==n(t)?t.split(""):Object(t)}},482:function(t,e){e.f={}.propertyIsEnumerable},483:function(t,e,o){var i=o(203),r=o(50)("toStringTag"),s="Arguments"==i(function(){return arguments}());t.exports=function(t){var e,o,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(o=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),r))?o:s?i(e):"Object"==(n=i(e))&&"function"==typeof e.callee?"Arguments":n}},484:function(t,e,o){var i=o(40),r=o(170),s=o(50)("species");t.exports=function(t,e){var o,n=i(t).constructor;return void 0===n||null==(o=i(n)[s])?e:r(o)}},49:function(t,e,o){"use strict";var s=o(11),a=n(o(132)),r=n(o(62));function n(t){return t&&t.__esModule?t:{default:t}}var l=o(75),i=t.exports,c="experimentsList",u="experiments";i.REDUX_LOGGING="reduxLogging",i.SCHOOL_AUTOCOMPLETE_DROPDOWN_NEW_SEARCH="schoolAutocompleteDropdownNewSearch",i.SHOW_UNPUBLISHED_FIREBASE_TABLES="showUnpublishedFirebaseTables",i.MICROBIT="microbit",i.TEACHER_DASHBOARD_SECTION_BUTTONS="teacher-dashboard-section-buttons",i.TEACHER_DASHBOARD_SECTION_BUTTONS_ALTERNATE_TEXT="teacher-dashboard-section-buttons-alternate-text",i.TEXT_TO_SPEECH_BLOCK="text-to-speech-block",i.FINISH_DIALOG_METRICS="finish-dialog-metrics",i.I18N_TRACKING="i18n-tracking",i.SPRITELAB_INPUT="spritelabInput",i.TIME_SPENT="time-spent",i.APPLAB_ML="applab-ml",i.BYPASS_DIALOG_POPUP="bypass-dialog-popup",i.getQueryString_=function(){return window.location.search},i.getStoredExperiments_=function(){var t=a.default.get("_experiments"+window.cookieEnvSuffix),e=t?JSON.parse(decodeURIComponent(t)).map(function(t){return{key:t}}):[];try{var o=localStorage.getItem(c),n=o?JSON.parse(o):[],i=Date.now(),r=n.filter(function(t){return t.key&&(void 0===t.expiration||t.expiration>i)});return r.length<n.length&&(0,s.trySetLocalStorage)(c,JSON.stringify(r)),e.concat(r)}catch(t){return e}},i.getEnabledExperiments=function(){return this.getStoredExperiments_().map(function(t){return t.key})},i.setEnabled=function(e,t){var o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:void 0,n=this.getStoredExperiments_(),i=n.findIndex(function(t){return t.key===e});if(t)i<0?(n.push({key:e,expiration:o}),(0,r.default)(u,"enable",e)):n[i].expiration=o;else{if(!(0<=i))return;n.splice(i,1),(0,r.default)(u,"disable",e)}(0,s.trySetLocalStorage)(c,JSON.stringify(n))},i.isEnabled=function(e){var t=this.getStoredExperiments_().some(function(t){return t.key===e})||!!(window.appOptions&&window.appOptions.experiments&&window.appOptions.experiments.includes(e)),o=l.parse(this.getQueryString_()),n=o.enableExperiments,i=o.disableExperiments,r=o.tempEnableExperiments;n&&(0<=n.split(",").indexOf(e)&&(t=!0,this.setEnabled(e,!0)));i&&(0<=i.split(",").indexOf(e)&&(t=!1,this.setEnabled(e,!1)));if(r){var s=new Date;s.setHours(s.getHours()+12);var a=s.getTime();0<=r.split(",").indexOf(e)&&(t=!0,this.setEnabled(e,!0,a))}return t}},50:function(t,e,o){var n=o(617)("wks"),i=o(305),r=o(38).Symbol,s="function"==typeof r;(t.exports=function(t){return n[t]||(n[t]=s&&r[t]||(s?r:i)("Symbol."+t))}).store=n},59:function(t,e,o){var n=o(171),i=Math.min;t.exports=function(t){return 0<t?i(n(t),9007199254740991):0}},617:function(t,e,o){var n=o(73),i=o(38),r="__core-js_shared__",s=i[r]||(i[r]={});(t.exports=function(t,e){return s[t]||(s[t]=void 0!==e?e:{})})("versions",[]).push({version:n.version,mode:o(306)?"pure":"global",copyright:" 2019 Denis Pushkarev (zloirock.ru)"})},618:function(t,e,o){var l=o(137),c=o(59),u=o(308);t.exports=function(a){return function(t,e,o){var n,i=l(t),r=c(i.length),s=u(o,r);if(a&&e!=e){for(;s<r;)if((n=i[s++])!=n)return!0}else for(;s<r;s++)if((a||s in i)&&i[s]===e)return a||s||0;return!a&&-1}}},619:function(t,e){e.f=Object.getOwnPropertySymbols},62:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){var t;0;(t=window).trackEvent.apply(t,arguments)},t.exports=e.default},620:function(t,e,o){var n=o(203);t.exports=Array.isArray||function(t){return"Array"==n(t)}},621:function(t,e,o){var r=o(50)("iterator"),s=!1;try{var n=[7][r]();n.return=function(){s=!0},Array.from(n,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!s)return!1;var o=!1;try{var n=[7],i=n[r]();i.next=function(){return{done:o=!0}},n[r]=function(){return i},t(n)}catch(t){}return o}},622:function(t,e,o){"use strict";var n=o(40);t.exports=function(){var t=n(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},623:function(t,e,o){"use strict";var i=o(483),r=RegExp.prototype.exec;t.exports=function(t,e){var o=t.exec;if("function"==typeof o){var n=o.call(t,e);if("object"!=typeof n)throw new TypeError("RegExp exec method returned something other than an Object or null");return n}if("RegExp"!==i(t))throw new TypeError("RegExp#exec called on incompatible receiver");return r.call(t,e)}},624:function(t,e,o){"use strict";o(1150);var u=o(123),h=o(136),p=o(39),_=o(204),d=o(50),g=o(894),f=d("species"),T=!p(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}),v=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var o="ab".split(t);return 2===o.length&&"a"===o[0]&&"b"===o[1]}();t.exports=function(o,t,e){var n=d(o),r=!p(function(){var t={};return t[n]=function(){return 7},7!=""[o](t)}),i=r?!p(function(){var t=!1,e=/a/;return e.exec=function(){return t=!0,null},"split"===o&&(e.constructor={},e.constructor[f]=function(){return e}),e[n](""),!t}):void 0;if(!r||!i||"replace"===o&&!T||"split"===o&&!v){var s=/./[n],a=e(_,n,""[o],function(t,e,o,n,i){return e.exec===g?r&&!i?{done:!0,value:s.call(e,o,n)}:{done:!0,value:t.call(o,e,n)}:{done:!1}}),l=a[0],c=a[1];u(String.prototype,o,l),h(RegExp.prototype,n,2==t?function(t,e){return c.call(t,this,e)}:function(t){return c.call(t,this)})}}},625:function(t,e,o){var p=o(169),_=o(1145),d=o(889),g=o(40),f=o(59),T=o(891),v={},E={};(e=t.exports=function(t,e,o,n,i){var r,s,a,l,c=i?function(){return t}:T(t),u=p(o,n,e?2:1),h=0;if("function"!=typeof c)throw TypeError(t+" is not iterable!");if(d(c)){for(r=f(t.length);h<r;h++)if((l=e?u(g(s=t[h])[0],s[1]):u(t[h]))===v||l===E)return l}else for(a=c.call(t);!(s=a.next()).done;)if((l=_(a,u,s.value,e))===v||l===E)return l}).BREAK=v,e.RETURN=E},626:function(t,e,o){var n=o(38).navigator;t.exports=n&&n.userAgent||""},627:function(t,e,o){"use strict";var T=o(38),v=o(10),E=o(123),y=o(350),m=o(258),b=o(625),S=o(349),I=o(41),R=o(39),C=o(621),k=o(345),O=o(880);t.exports=function(n,t,e,o,i,r){var s=T[n],a=s,l=i?"set":"add",c=a&&a.prototype,u={},h=function(t){var o=c[t];E(c,t,"delete"==t?function(t){return!(r&&!I(t))&&o.call(this,0===t?0:t)}:"has"==t?function(t){return!(r&&!I(t))&&o.call(this,0===t?0:t)}:"get"==t?function(t){return r&&!I(t)?void 0:o.call(this,0===t?0:t)}:"add"==t?function(t){return o.call(this,0===t?0:t),this}:function(t,e){return o.call(this,0===t?0:t,e),this})};if("function"==typeof a&&(r||c.forEach&&!R(function(){(new a).entries().next()}))){var p=new a,_=p[l](r?{}:-0,1)!=p,d=R(function(){p.has(1)}),g=C(function(t){new a(t)}),f=!r&&R(function(){for(var t=new a,e=5;e--;)t[l](e,e);return!t.has(-0)});g||(((a=t(function(t,e){S(t,a,n);var o=O(new s,t,a);return null!=e&&b(e,i,o[l],o),o})).prototype=c).constructor=a),(d||f)&&(h("delete"),h("has"),i&&h("get")),(f||_)&&h(l),r&&c.clear&&delete c.clear}else a=o.getConstructor(t,n,i,l),y(a.prototype,e),m.NEED=!0;return k(a,n),u[n]=a,v(v.G+v.W+v.F*(a!=s),u),r||o.setStrong(a,n,i),a}},628:function(t,e,o){for(var n,i=o(38),r=o(136),s=o(305),a=s("typed_array"),l=s("view"),c=!(!i.ArrayBuffer||!i.DataView),u=c,h=0,p="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");h<9;)(n=i[p[h++]])?(r(n.prototype,a,!0),r(n.prototype,l,!0)):u=!1;t.exports={ABV:c,CONSTR:u,TYPED:a,VIEW:l}},629:function(t,e,o){
/*!
 * PEP v0.4.3 | https://github.com/jquery/PEP
 * Copyright jQuery Foundation and other contributors | http://jquery.org/license
 */
t.exports=function(){"use strict";var s=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","pageX","pageY"],a=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0];function i(t,e){e=e||Object.create(null);var o=document.createEvent("Event");o.initEvent(t,e.bubbles||!1,e.cancelable||!1);for(var n,i=2;i<s.length;i++)n=s[i],o[n]=e[n]||a[i];o.buttons=e.buttons||0;var r=0;return r=e.pressure&&o.buttons?e.pressure:o.buttons?.5:0,o.x=o.clientX,o.y=o.clientY,o.pointerId=e.pointerId||0,o.width=e.width||0,o.height=e.height||0,o.pressure=r,o.tiltX=e.tiltX||0,o.tiltY=e.tiltY||0,o.twist=e.twist||0,o.tangentialPressure=e.tangentialPressure||0,o.pointerType=e.pointerType||"",o.hwTimestamp=e.hwTimestamp||0,o.isPrimary=e.isPrimary||!1,o}var t=window.Map&&window.Map.prototype.forEach?Map:e;function e(){this.array=[],this.size=0}var r=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","buttons","pointerId","width","height","pressure","tiltX","tiltY","pointerType","hwTimestamp","isPrimary","type","target","currentTarget","which","pageX","pageY","timeStamp"],l=[!(e.prototype={set:function(t,e){if(void 0===e)return this.delete(t);this.has(t)||this.size++,this.array[t]=e},has:function(t){return void 0!==this.array[t]},delete:function(t){this.has(t)&&(delete this.array[t],this.size--)},get:function(t){return this.array[t]},clear:function(){this.array.length=0,this.size=0},forEach:function(o,n){return this.array.forEach(function(t,e){o.call(n,t,e,this)},this)}}),!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,"",null,null,0,0,0,0],o={pointerover:1,pointerout:1,pointerenter:1,pointerleave:1},c="undefined"!=typeof SVGElementInstance,u={pointermap:new t,eventMap:Object.create(null),captureInfo:Object.create(null),eventSources:Object.create(null),eventSourceList:[],registerSource:function(t,e){var o=e,n=o.events;n&&(n.forEach(function(t){o[t]&&(this.eventMap[t]=o[t].bind(o))},this),this.eventSources[t]=o,this.eventSourceList.push(o))},register:function(t){for(var e,o=this.eventSourceList.length,n=0;n<o&&(e=this.eventSourceList[n]);n++)e.register.call(e,t)},unregister:function(t){for(var e,o=this.eventSourceList.length,n=0;n<o&&(e=this.eventSourceList[n]);n++)e.unregister.call(e,t)},contains:function(t,e){try{return t.contains(e)}catch(t){return!1}},down:function(t){t.bubbles=!0,this.fireEvent("pointerdown",t)},move:function(t){t.bubbles=!0,this.fireEvent("pointermove",t)},up:function(t){t.bubbles=!0,this.fireEvent("pointerup",t)},enter:function(t){t.bubbles=!1,this.fireEvent("pointerenter",t)},leave:function(t){t.bubbles=!1,this.fireEvent("pointerleave",t)},over:function(t){t.bubbles=!0,this.fireEvent("pointerover",t)},out:function(t){t.bubbles=!0,this.fireEvent("pointerout",t)},cancel:function(t){t.bubbles=!0,this.fireEvent("pointercancel",t)},leaveOut:function(t){this.out(t),this.propagate(t,this.leave,!1)},enterOver:function(t){this.over(t),this.propagate(t,this.enter,!0)},eventHandler:function(t){if(!t._handledByPE){var e=t.type,o=this.eventMap&&this.eventMap[e];o&&o(t),t._handledByPE=!0}},listen:function(e,t){t.forEach(function(t){this.addEvent(e,t)},this)},unlisten:function(e,t){t.forEach(function(t){this.removeEvent(e,t)},this)},addEvent:function(t,e){t.addEventListener(e,this.boundHandler)},removeEvent:function(t,e){t.removeEventListener(e,this.boundHandler)},makeEvent:function(t,e){this.captureInfo[e.pointerId]&&(e.relatedTarget=null);var o=new i(t,e);return e.preventDefault&&(o.preventDefault=e.preventDefault),o._target=o._target||e.target,o},fireEvent:function(t,e){var o=this.makeEvent(t,e);return this.dispatchEvent(o)},cloneEvent:function(t){for(var e,o=Object.create(null),n=0;n<r.length;n++)o[e=r[n]]=t[e]||l[n],!c||"target"!==e&&"relatedTarget"!==e||o[e]instanceof SVGElementInstance&&(o[e]=o[e].correspondingUseElement);return t.preventDefault&&(o.preventDefault=function(){t.preventDefault()}),o},getTarget:function(t){var e=this.captureInfo[t.pointerId];return e?t._target!==e&&t.type in o?void 0:e:t._target},propagate:function(e,o,t){for(var n=e.target,i=[];n!==document&&!n.contains(e.relatedTarget);)if(i.push(n),!(n=n.parentNode))return;t&&i.reverse(),i.forEach(function(t){e.target=t,o.call(this,e)},this)},setCapture:function(t,e,o){this.captureInfo[t]&&this.releaseCapture(t,o),this.captureInfo[t]=e,this.implicitRelease=this.releaseCapture.bind(this,t,o),document.addEventListener("pointerup",this.implicitRelease),document.addEventListener("pointercancel",this.implicitRelease);var n=new i("gotpointercapture");n.pointerId=t,n._target=e,o||this.asyncDispatchEvent(n)},releaseCapture:function(t,e){var o=this.captureInfo[t];if(o){this.captureInfo[t]=void 0,document.removeEventListener("pointerup",this.implicitRelease),document.removeEventListener("pointercancel",this.implicitRelease);var n=new i("lostpointercapture");n.pointerId=t,n._target=o,e||this.asyncDispatchEvent(n)}},dispatchEvent:function(t){var e=this.getTarget(t);if(e)return e.dispatchEvent(t)},asyncDispatchEvent:function(t){requestAnimationFrame(this.dispatchEvent.bind(this,t))}};u.boundHandler=u.eventHandler.bind(u);var n={shadow:function(t){if(t)return t.shadowRoot||t.webkitShadowRoot},canTarget:function(t){return t&&Boolean(t.elementFromPoint)},targetingShadow:function(t){var e=this.shadow(t);if(this.canTarget(e))return e},olderShadow:function(t){var e=t.olderShadowRoot;if(!e){var o=t.querySelector("shadow");o&&(e=o.olderShadowRoot)}return e},allShadows:function(t){for(var e=[],o=this.shadow(t);o;)e.push(o),o=this.olderShadow(o);return e},searchRoot:function(t,e,o){if(t){var n,i,r=t.elementFromPoint(e,o);for(i=this.targetingShadow(r);i;){if(n=i.elementFromPoint(e,o)){var s=this.targetingShadow(n);return this.searchRoot(s,e,o)||n}i=this.olderShadow(i)}return r}},owner:function(t){for(var e=t;e.parentNode;)e=e.parentNode;return e.nodeType!==Node.DOCUMENT_NODE&&e.nodeType!==Node.DOCUMENT_FRAGMENT_NODE&&(e=document),e},findTarget:function(t){var e=t.clientX,o=t.clientY,n=this.owner(t.target);return n.elementFromPoint(e,o)||(n=document),this.searchRoot(n,e,o)}},h=Array.prototype.forEach.call.bind(Array.prototype.forEach),p=Array.prototype.map.call.bind(Array.prototype.map),_=Array.prototype.slice.call.bind(Array.prototype.slice),d=Array.prototype.filter.call.bind(Array.prototype.filter),g=window.MutationObserver||window.WebKitMutationObserver,f={subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["touch-action"]};function T(t,e,o,n){this.addCallback=t.bind(n),this.removeCallback=e.bind(n),this.changedCallback=o.bind(n),g&&(this.observer=new g(this.mutationWatcher.bind(this)))}function v(t){return"body /shadow-deep/ "+E(t)}function E(t){return'[touch-action="'+t+'"]'}function y(t){return"{ -ms-touch-action: "+t+"; touch-action: "+t+"; }"}T.prototype={watchSubtree:function(t){this.observer&&n.canTarget(t)&&this.observer.observe(t,f)},enableOnSubtree:function(t){this.watchSubtree(t),t===document&&"complete"!==document.readyState?this.installOnLoad():this.installNewSubtree(t)},installNewSubtree:function(t){h(this.findElements(t),this.addElement,this)},findElements:function(t){return t.querySelectorAll?t.querySelectorAll("[touch-action]"):[]},removeElement:function(t){this.removeCallback(t)},addElement:function(t){this.addCallback(t)},elementChanged:function(t,e){this.changedCallback(t,e)},concatLists:function(t,e){return t.concat(_(e))},installOnLoad:function(){document.addEventListener("readystatechange",function(){"complete"===document.readyState&&this.installNewSubtree(document)}.bind(this))},isElement:function(t){return t.nodeType===Node.ELEMENT_NODE},flattenMutationTree:function(t){var e=p(t,this.findElements,this);return e.push(d(t,this.isElement)),e.reduce(this.concatLists,[])},mutationWatcher:function(t){t.forEach(this.mutationHandler,this)},mutationHandler:function(t){if("childList"===t.type){var e=this.flattenMutationTree(t.addedNodes);e.forEach(this.addElement,this);var o=this.flattenMutationTree(t.removedNodes);o.forEach(this.removeElement,this)}else"attributes"===t.type&&this.elementChanged(t.target,t.oldValue)}};var m=["none","auto","pan-x","pan-y",{rule:"pan-x pan-y",selectors:["pan-x pan-y","pan-y pan-x"]}],b="",S=window.PointerEvent||window.MSPointerEvent,I=!window.ShadowDOMPolyfill&&document.head.createShadowRoot,R=u.pointermap,C=[1,4,2,8,16],k=!1;try{k=1===new MouseEvent("test",{buttons:1}).buttons}catch(t){}var O,A={POINTER_ID:1,POINTER_TYPE:"mouse",events:["mousedown","mousemove","mouseup","mouseover","mouseout"],register:function(t){u.listen(t,this.events)},unregister:function(t){u.unlisten(t,this.events)},lastTouches:[],isEventSimulatedFromTouch:function(t){for(var e,o=this.lastTouches,n=t.clientX,i=t.clientY,r=0,s=o.length;r<s&&(e=o[r]);r++){var a=Math.abs(n-e.x),l=Math.abs(i-e.y);if(a<=25&&l<=25)return!0}},prepareEvent:function(t){var e=u.cloneEvent(t),o=e.preventDefault;return e.preventDefault=function(){t.preventDefault(),o()},e.pointerId=this.POINTER_ID,e.isPrimary=!0,e.pointerType=this.POINTER_TYPE,e},prepareButtonsForMove:function(t,e){var o=R.get(this.POINTER_ID);0!==e.which&&o?t.buttons=o.buttons:t.buttons=0,e.buttons=t.buttons},mousedown:function(t){if(!this.isEventSimulatedFromTouch(t)){var e=R.get(this.POINTER_ID),o=this.prepareEvent(t);k||(o.buttons=C[o.button],e&&(o.buttons|=e.buttons),t.buttons=o.buttons),R.set(this.POINTER_ID,t),e&&0!==e.buttons?u.move(o):u.down(o)}},mousemove:function(t){if(!this.isEventSimulatedFromTouch(t)){var e=this.prepareEvent(t);k||this.prepareButtonsForMove(e,t),e.button=-1,R.set(this.POINTER_ID,t),u.move(e)}},mouseup:function(t){if(!this.isEventSimulatedFromTouch(t)){var e=R.get(this.POINTER_ID),o=this.prepareEvent(t);if(!k){var n=C[o.button];o.buttons=e?e.buttons&~n:0,t.buttons=o.buttons}R.set(this.POINTER_ID,t),o.buttons&=~C[o.button],0===o.buttons?u.up(o):u.move(o)}},mouseover:function(t){if(!this.isEventSimulatedFromTouch(t)){var e=this.prepareEvent(t);k||this.prepareButtonsForMove(e,t),e.button=-1,R.set(this.POINTER_ID,t),u.enterOver(e)}},mouseout:function(t){if(!this.isEventSimulatedFromTouch(t)){var e=this.prepareEvent(t);k||this.prepareButtonsForMove(e,t),e.button=-1,u.leaveOut(e)}},cancel:function(t){var e=this.prepareEvent(t);u.cancel(e),this.deactivateMouse()},deactivateMouse:function(){R.delete(this.POINTER_ID)}},D=u.captureInfo,w=n.findTarget.bind(n),N=n.allShadows.bind(n),M=u.pointermap,L="touch-action",P={events:["touchstart","touchmove","touchend","touchcancel"],register:function(t){O.enableOnSubtree(t)},unregister:function(){},elementAdded:function(t){var e=t.getAttribute(L),o=this.touchActionToScrollType(e);o&&(t._scrollType=o,u.listen(t,this.events),N(t).forEach(function(t){t._scrollType=o,u.listen(t,this.events)},this))},elementRemoved:function(t){t._scrollType=void 0,u.unlisten(t,this.events),N(t).forEach(function(t){t._scrollType=void 0,u.unlisten(t,this.events)},this)},elementChanged:function(t,e){var o=t.getAttribute(L),n=this.touchActionToScrollType(o),i=this.touchActionToScrollType(e);n&&i?(t._scrollType=n,N(t).forEach(function(t){t._scrollType=n},this)):i?this.elementRemoved(t):n&&this.elementAdded(t)},scrollTypes:{EMITTER:"none",XSCROLLER:"pan-x",YSCROLLER:"pan-y",SCROLLER:/^(?:pan-x pan-y)|(?:pan-y pan-x)|auto$/},touchActionToScrollType:function(t){var e=t,o=this.scrollTypes;return"none"===e?"none":e===o.XSCROLLER?"X":e===o.YSCROLLER?"Y":o.SCROLLER.exec(e)?"XY":void 0},POINTER_TYPE:"touch",firstTouch:null,isPrimaryTouch:function(t){return this.firstTouch===t.identifier},setPrimaryTouch:function(t){(0===M.size||1===M.size&&M.has(1))&&(this.firstTouch=t.identifier,this.firstXY={X:t.clientX,Y:t.clientY},this.scrolling=!1,this.cancelResetClickCount())},removePrimaryPointer:function(t){t.isPrimary&&(this.firstTouch=null,this.firstXY=null,this.resetClickCount())},clickCount:0,resetId:null,resetClickCount:function(){var t=function(){this.clickCount=0,this.resetId=null}.bind(this);this.resetId=setTimeout(t,200)},cancelResetClickCount:function(){this.resetId&&clearTimeout(this.resetId)},typeToButtons:function(t){var e=0;return"touchstart"!==t&&"touchmove"!==t||(e=1),e},touchToPointer:function(t){var e=this.currentTouchEvent,o=u.cloneEvent(t),n=o.pointerId=t.identifier+2;o.target=D[n]||w(o),o.bubbles=!0,o.cancelable=!0,o.detail=this.clickCount,o.button=0,o.buttons=this.typeToButtons(e.type),o.width=2*(t.radiusX||t.webkitRadiusX||0),o.height=2*(t.radiusY||t.webkitRadiusY||0),o.pressure=t.force||t.webkitForce||.5,o.isPrimary=this.isPrimaryTouch(t),o.pointerType=this.POINTER_TYPE,o.altKey=e.altKey,o.ctrlKey=e.ctrlKey,o.metaKey=e.metaKey,o.shiftKey=e.shiftKey;var i=this;return o.preventDefault=function(){i.scrolling=!1,i.firstXY=null,e.preventDefault()},o},processTouches:function(t,e){var o=t.changedTouches;this.currentTouchEvent=t;for(var n,i=0;i<o.length;i++)n=o[i],e.call(this,this.touchToPointer(n))},shouldScroll:function(t){if(this.firstXY){var e,o=t.currentTarget._scrollType;if("none"===o)e=!1;else if("XY"===o)e=!0;else{var n=t.changedTouches[0],i=o,r="Y"===o?"X":"Y",s=Math.abs(n["client"+i]-this.firstXY[i]),a=Math.abs(n["client"+r]-this.firstXY[r]);e=a<=s}return this.firstXY=null,e}},findTouch:function(t,e){for(var o,n=0,i=t.length;n<i&&(o=t[n]);n++)if(o.identifier===e)return!0},vacuumTouches:function(t){var n=t.touches;if(M.size>=n.length){var i=[];M.forEach(function(t,e){if(1!==e&&!this.findTouch(n,e-2)){var o=t.out;i.push(o)}},this),i.forEach(this.cancelOut,this)}},touchstart:function(t){this.vacuumTouches(t),this.setPrimaryTouch(t.changedTouches[0]),this.dedupSynthMouse(t),this.scrolling||(this.clickCount++,this.processTouches(t,this.overDown))},overDown:function(t){M.set(t.pointerId,{target:t.target,out:t,outTarget:t.target}),u.enterOver(t),u.down(t)},touchmove:function(t){this.scrolling||(this.shouldScroll(t)?(this.scrolling=!0,this.touchcancel(t)):(t.preventDefault(),this.processTouches(t,this.moveOverOut)))},moveOverOut:function(t){var e=t,o=M.get(e.pointerId);if(o){var n=o.out,i=o.outTarget;u.move(e),n&&i!==e.target&&(n.relatedTarget=e.target,e.relatedTarget=i,n.target=i,e.target?(u.leaveOut(n),u.enterOver(e)):(e.target=i,e.relatedTarget=null,this.cancelOut(e))),o.out=e,o.outTarget=e.target}},touchend:function(t){this.dedupSynthMouse(t),this.processTouches(t,this.upOut)},upOut:function(t){this.scrolling||(u.up(t),u.leaveOut(t)),this.cleanUpPointer(t)},touchcancel:function(t){this.processTouches(t,this.cancelOut)},cancelOut:function(t){u.cancel(t),u.leaveOut(t),this.cleanUpPointer(t)},cleanUpPointer:function(t){M.delete(t.pointerId),this.removePrimaryPointer(t)},dedupSynthMouse:function(t){var e=A.lastTouches,o=t.changedTouches[0];if(this.isPrimaryTouch(o)){var n={x:o.clientX,y:o.clientY};e.push(n);var i=function(t,e){var o=t.indexOf(e);-1<o&&t.splice(o,1)}.bind(null,e,n);setTimeout(i,2500)}}};O=new T(P.elementAdded,P.elementRemoved,P.elementChanged,P);var B,x,F,U=u.pointermap,H=window.MSPointerEvent&&"number"==typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE,G={events:["MSPointerDown","MSPointerMove","MSPointerUp","MSPointerOut","MSPointerOver","MSPointerCancel","MSGotPointerCapture","MSLostPointerCapture"],register:function(t){u.listen(t,this.events)},unregister:function(t){u.unlisten(t,this.events)},POINTER_TYPES:["","unavailable","touch","pen","mouse"],prepareEvent:function(t){var e=t;return H&&((e=u.cloneEvent(t)).pointerType=this.POINTER_TYPES[t.pointerType]),e},cleanup:function(t){U.delete(t)},MSPointerDown:function(t){U.set(t.pointerId,t);var e=this.prepareEvent(t);u.down(e)},MSPointerMove:function(t){var e=this.prepareEvent(t);u.move(e)},MSPointerUp:function(t){var e=this.prepareEvent(t);u.up(e),this.cleanup(t.pointerId)},MSPointerOut:function(t){var e=this.prepareEvent(t);u.leaveOut(e)},MSPointerOver:function(t){var e=this.prepareEvent(t);u.enterOver(e)},MSPointerCancel:function(t){var e=this.prepareEvent(t);u.cancel(e),this.cleanup(t.pointerId)},MSLostPointerCapture:function(t){var e=u.makeEvent("lostpointercapture",t);u.dispatchEvent(e)},MSGotPointerCapture:function(t){var e=u.makeEvent("gotpointercapture",t);u.dispatchEvent(e)}};function W(t){if(!u.pointermap.has(t)){var e=new Error("InvalidPointerId");throw e.name="InvalidPointerId",e}}function V(t){for(var e=t.parentNode;e&&e!==t.ownerDocument;)e=e.parentNode;if(!e){var o=new Error("InvalidStateError");throw o.name="InvalidStateError",o}}function X(t){var e=u.pointermap.get(t);return 0!==e.buttons}return x=window.navigator.msPointerEnabled?(B=function(t){W(t),V(this),X(t)&&(u.setCapture(t,this,!0),this.msSetPointerCapture(t))},function(t){W(t),u.releaseCapture(t,!0),this.msReleasePointerCapture(t)}):(B=function(t){W(t),V(this),X(t)&&u.setCapture(t,this)},function(t){W(t),u.releaseCapture(t)}),F=function(t){return!!u.captureInfo[t]},function(){if(S){m.forEach(function(t){String(t)===t?(b+=E(t)+y(t)+"\n",I&&(b+=v(t)+y(t)+"\n")):(b+=t.selectors.map(E)+y(t.rule)+"\n",I&&(b+=t.selectors.map(v)+y(t.rule)+"\n"))});var t=document.createElement("style");t.textContent=b,document.head.appendChild(t)}}(),function(){if(!window.PointerEvent){if(window.PointerEvent=i,window.navigator.msPointerEnabled){var t=window.navigator.msMaxTouchPoints;Object.defineProperty(window.navigator,"maxTouchPoints",{value:t,enumerable:!0}),u.registerSource("ms",G)}else Object.defineProperty(window.navigator,"maxTouchPoints",{value:0,enumerable:!0}),u.registerSource("mouse",A),void 0!==window.ontouchstart&&u.registerSource("touch",P);u.register(document)}}(),window.Element&&!Element.prototype.setPointerCapture&&Object.defineProperties(Element.prototype,{setPointerCapture:{value:B},releasePointerCapture:{value:x},hasPointerCapture:{value:F}}),{dispatcher:u,Installer:T,PointerEvent:i,PointerMap:t,targetFinding:n}}()},630:function(e,t,o){(function(t){(function(){"use strict";var s=this;function c(t){return"string"==typeof t}function n(t,e,o){return t.call.apply(t.bind,arguments)}function i(e,o,t){if(!e)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,n),e.apply(o,t)}}return function(){return e.apply(o,arguments)}}function r(t,e,o){return(r=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?n:i).apply(null,arguments)}function t(t){var r=ot;function e(){}e.prototype=r.prototype,t.G=r.prototype,t.prototype=new e,(t.prototype.constructor=t).F=function(t,e,o){for(var n=Array(arguments.length-2),i=2;i<arguments.length;i++)n[i-2]=arguments[i];return r.prototype[e].apply(t,n)}}var p=String.prototype.trim?function(t){return t.trim()}:function(t){return t.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")};function a(t,e){return-1!=t.indexOf(e)}function _(t,e){return t<e?-1:e<t?1:0}var e,l=Array.prototype.indexOf?function(t,e,o){return Array.prototype.indexOf.call(t,e,o)}:function(t,e,o){if(o=null==o?0:o<0?Math.max(0,t.length+o):o,c(t))return c(e)&&1==e.length?t.indexOf(e,o):-1;for(;o<t.length;o++)if(o in t&&t[o]===e)return o;return-1},u=Array.prototype.forEach?function(t,e,o){Array.prototype.forEach.call(t,e,o)}:function(t,e,o){for(var n=t.length,i=c(t)?t.split(""):t,r=0;r<n;r++)r in i&&e.call(o,i[r],r,t)},h=Array.prototype.filter?function(t,e,o){return Array.prototype.filter.call(t,e,o)}:function(t,e,o){for(var n=t.length,i=[],r=0,s=c(t)?t.split(""):t,a=0;a<n;a++)if(a in s){var l=s[a];e.call(o,l,a,t)&&(i[r++]=l)}return i},d=Array.prototype.reduce?function(t,e,o,n){return n&&(e=r(e,n)),Array.prototype.reduce.call(t,e,o)}:function(o,n,t,i){var r=t;return u(o,function(t,e){r=n.call(i,r,t,e,o)}),r},g=Array.prototype.some?function(t,e,o){return Array.prototype.some.call(t,e,o)}:function(t,e,o){for(var n=t.length,i=c(t)?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(o,i[r],r,t))return!0;return!1};t:{var o=s.navigator;if(o){var f=o.userAgent;if(f){e=f;break t}}e=""}var T,v,E=a(e,"Opera")||a(e,"OPR"),y=a(e,"Trident")||a(e,"MSIE"),m=a(e,"Edge"),b=a(e,"Gecko")&&!(a(e.toLowerCase(),"webkit")&&!a(e,"Edge"))&&!(a(e,"Trident")||a(e,"MSIE"))&&!a(e,"Edge"),S=a(e.toLowerCase(),"webkit")&&!a(e,"Edge");function I(){var t=s.document;return t?t.documentMode:void 0}t:{var R="",C=(v=e,b?/rv\:([^\);]+)(\)|;)/.exec(v):m?/Edge\/([\d\.]+)/.exec(v):y?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(v):S?/WebKit\/(\S+)/.exec(v):E?/(?:Version)[ \/]?(\S+)/.exec(v):void 0);if(C&&(R=C?C[1]:""),y){var k=I();if(null!=k&&k>parseFloat(R)){T=String(k);break t}}T=R}var O={};function A(t){if(!O[t]){for(var e=0,o=p(String(T)).split("."),n=p(String(t)).split("."),i=Math.max(o.length,n.length),r=0;0==e&&r<i;r++){var s=o[r]||"",a=n[r]||"",l=/(\d*)(\D*)/g,c=/(\d*)(\D*)/g;do{var u=l.exec(s)||["","",""],h=c.exec(a)||["","",""];if(0==u[0].length&&0==h[0].length)break;e=_(0==u[1].length?0:parseInt(u[1],10),0==h[1].length?0:parseInt(h[1],10))||_(0==u[2].length,0==h[2].length)||_(u[2],h[2])}while(0==e)}O[t]=0<=e}}var D=s.document,w=D&&y?I()||("CSS1Compat"==D.compatMode?parseInt(T,10):5):void 0,N=y&&!(9<=Number(w)),M=y&&!(8<=Number(w));function L(t,e,o,n){this.a=t,this.nodeName=o,this.nodeValue=n,this.nodeType=2,this.parentNode=this.ownerElement=e}function P(t,e){var o=M&&"href"==e.nodeName?t.getAttribute(e.nodeName,2):e.nodeValue;return new L(e,t,e.nodeName,o)}function B(t){var e=null;if(1==(o=t.nodeType)&&(e=null==(e=null==(e=t.textContent)||null==e?t.innerText:e)||null==e?"":e),"string"!=typeof e)if(N&&"title"==t.nodeName.toLowerCase()&&1==o)e=t.text;else if(9==o||1==o){t=9==o?t.documentElement:t.firstChild;var o=0,n=[];for(e="";t;){for(;1!=t.nodeType&&(e+=t.nodeValue),N&&"title"==t.nodeName.toLowerCase()&&(e+=t.text),t=(n[o++]=t).firstChild;);for(;o&&!(t=n[--o].nextSibling););}}else e=t.nodeValue;return""+e}function x(t,e,o){if(null===e)return!0;try{if(!t.getAttribute)return!1}catch(t){return!1}return M&&"class"==e&&(e="className"),null==o?!!t.getAttribute(e):t.getAttribute(e,2)==o}function F(t,e,o,n,i){return(N?function(t,e,o,n,i){if(t instanceof Dt||8==t.b||o&&null===t.b){var r=e.all;if(!r)return i;if("*"!=(t=G(t))&&!(r=e.getElementsByTagName(t)))return i;if(o){for(var s=[],a=0;e=r[a++];)x(e,o,n)&&s.push(e);r=s}for(a=0;e=r[a++];)"*"==t&&"!"==e.tagName||q(i,e);return i}return H(t,e,o,n,i),i}:function(e,t,o,n,i){return t.getElementsByName&&n&&"name"==o&&!y?(t=t.getElementsByName(n),u(t,function(t){e.a(t)&&q(i,t)})):t.getElementsByClassName&&n&&"class"==o?(t=t.getElementsByClassName(n),u(t,function(t){t.className==n&&e.a(t)&&q(i,t)})):e instanceof mt?H(e,t,o,n,i):t.getElementsByTagName&&(t=t.getElementsByTagName(e.f()),u(t,function(t){x(t,o,n)&&q(i,t)})),i}).call(null,t,e,c(o)?o:null,c(n)?n:null,i||new z)}function U(t,e,o,n,i){for(e=e.firstChild;e;e=e.nextSibling)x(e,o,n)&&t.a(e)&&q(i,e);return i}function H(t,e,o,n,i){for(e=e.firstChild;e;e=e.nextSibling)x(e,o,n)&&t.a(e)&&q(i,e),H(t,e,o,n,i)}function G(t){if(t instanceof mt){if(8==t.b)return"!";if(null===t.b)return"*"}return t.f()}function W(t,e){if(!t||!e)return!1;if(t.contains&&1==e.nodeType)return t==e||t.contains(e);if(void 0!==t.compareDocumentPosition)return t==e||!!(16&t.compareDocumentPosition(e));for(;e&&t!=e;)e=e.parentNode;return e==t}function V(t,e){if(t==e)return 0;if(t.compareDocumentPosition)return 2&t.compareDocumentPosition(e)?1:-1;if(y&&!(9<=Number(w))){if(9==t.nodeType)return-1;if(9==e.nodeType)return 1}if("sourceIndex"in t||t.parentNode&&"sourceIndex"in t.parentNode){var o=1==t.nodeType,n=1==e.nodeType;if(o&&n)return t.sourceIndex-e.sourceIndex;var i=t.parentNode,r=e.parentNode;return i==r?Y(t,e):!o&&W(i,e)?-1*X(t,e):!n&&W(r,t)?X(e,t):(o?t.sourceIndex:i.sourceIndex)-(n?e.sourceIndex:r.sourceIndex)}return(o=(n=9==t.nodeType?t:t.ownerDocument||t.document).createRange()).selectNode(t),o.collapse(!0),(n=n.createRange()).selectNode(e),n.collapse(!0),o.compareBoundaryPoints(s.Range.START_TO_END,n)}function X(t,e){var o=t.parentNode;if(o==e)return-1;for(var n=e;n.parentNode!=o;)n=n.parentNode;return Y(n,t)}function Y(t,e){for(var o=e;o=o.previousSibling;)if(o==t)return-1;return 1}function z(){this.b=this.a=null,this.l=0}function J(t){this.node=t,this.a=this.b=null}function K(t,e){if(!t.a)return e;if(!e.a)return t;for(var o=t.a,n=e.a,i=null,r=null,s=0;o&&n;){r=o.node;var a=n.node;r==a||r instanceof L&&a instanceof L&&r.a==a.a?(o=(r=o).a,n=n.a):0<V(o.node,n.node)?n=(r=n).a:o=(r=o).a,(r.b=i)?i.a=r:t.a=r,i=r,s++}for(r=o||n;r;)i=(r.b=i).a=r,s++,r=r.a;return t.b=i,t.l=s,t}function j(t,e){var o=new J(e);o.a=t.a,t.b?t.a.b=o:t.a=t.b=o,t.a=o,t.l++}function q(t,e){var o=new J(e);o.b=t.b,t.a?t.b.a=o:t.a=t.b=o,t.b=o,t.l++}function Z(t){return(t=t.a)?t.node:null}function Q(t){return(t=Z(t))?B(t):""}function $(t,e){return new tt(t,!!e)}function tt(t,e){this.f=t,this.b=(this.c=e)?t.b:t.a,this.a=null}function et(t){var e=t.b;if(null==e)return null;var o=t.a=e;return t.b=t.c?e.b:e.a,o.node}function ot(t){this.i=t,this.b=this.g=!1,this.f=null}function nt(t){return"\n  "+t.toString().split("\n").join("\n  ")}function it(t,e){t.g=e}function rt(t,e){t.b=e}function st(t,e){var o=t.a(e);return o instanceof z?+Q(o):+o}function at(t,e){var o=t.a(e);return o instanceof z?Q(o):""+o}function lt(t,e){var o=t.a(e);return o instanceof z?!!o.l:!!o}function ct(t,e,o){ot.call(this,t.i),this.c=t,this.h=e,this.o=o,this.g=e.g||o.g,this.b=e.b||o.b,this.c==dt&&(o.b||o.g||4==o.i||0==o.i||!e.f?e.b||e.g||4==e.i||0==e.i||!o.f||(this.f={name:o.f.name,s:e}):this.f={name:e.f.name,s:o})}function ut(t,e,o,n,i){var r;if(e=e.a(n),o=o.a(n),e instanceof z&&o instanceof z){for(n=et(e=$(e));n;n=et(e))for(r=et(i=$(o));r;r=et(i))if(t(B(n),B(r)))return!0;return!1}if(e instanceof z||o instanceof z){for(var s=typeof(n=e instanceof z?(i=e,o):(i=o,e)),a=et(r=$(i));a;a=et(r)){switch(s){case"number":a=+B(a);break;case"boolean":a=!!B(a);break;case"string":a=B(a);break;default:throw Error("Illegal primitive type for comparison.")}if(i==e&&t(a,n)||i==o&&t(n,a))return!0}return!1}return i?"boolean"==typeof e||"boolean"==typeof o?t(!!e,!!o):"number"==typeof e||"number"==typeof o?t(+e,+o):t(e,o):t(+e,+o)}function ht(t,e,o,n){this.a=t,this.w=e,this.i=o,this.m=n}!b&&!y||y&&9<=Number(w)||b&&A("1.9.1"),y&&A("9"),t(ct),ct.prototype.a=function(t){return this.c.m(this.h,this.o,t)},ct.prototype.toString=function(){return"Binary Expression: "+this.c+nt(this.h)+nt(this.o)},ht.prototype.toString=function(){return this.a};var pt={};function _t(t,e,o,n){if(pt.hasOwnProperty(t))throw Error("Binary operator already created: "+t);return t=new ht(t,e,o,n),pt[t.toString()]=t}_t("div",6,1,function(t,e,o){return st(t,o)/st(e,o)}),_t("mod",6,1,function(t,e,o){return st(t,o)%st(e,o)}),_t("*",6,1,function(t,e,o){return st(t,o)*st(e,o)}),_t("+",5,1,function(t,e,o){return st(t,o)+st(e,o)}),_t("-",5,1,function(t,e,o){return st(t,o)-st(e,o)}),_t("<",4,2,function(t,e,o){return ut(function(t,e){return t<e},t,e,o)}),_t(">",4,2,function(t,e,o){return ut(function(t,e){return e<t},t,e,o)}),_t("<=",4,2,function(t,e,o){return ut(function(t,e){return t<=e},t,e,o)}),_t(">=",4,2,function(t,e,o){return ut(function(t,e){return e<=t},t,e,o)});var dt=_t("=",3,2,function(t,e,o){return ut(function(t,e){return t==e},t,e,o,!0)});function gt(t,e,o){this.a=t,this.b=e||1,this.f=o||1}function ft(t,e){if(e.a.length&&4!=t.i)throw Error("Primary expression must evaluate to nodeset if filter has predicate(s).");ot.call(this,t.i),this.c=t,this.h=e,this.g=t.g,this.b=t.b}function Tt(o,t){if(t.length<o.A)throw Error("Function "+o.j+" expects at least"+o.A+" arguments, "+t.length+" given");if(null!==o.v&&t.length>o.v)throw Error("Function "+o.j+" expects at most "+o.v+" arguments, "+t.length+" given");o.B&&u(t,function(t,e){if(4!=t.i)throw Error("Argument "+e+" to function "+o.j+" is not of type Nodeset: "+t)}),ot.call(this,o.i),this.h=o,this.c=t,it(this,o.g||g(t,function(t){return t.g})),rt(this,o.D&&!t.length||o.C&&!!t.length||g(t,function(t){return t.b}))}function vt(t,e,o,n,i,r,s,a,l){this.j=t,this.i=e,this.g=o,this.D=n,this.C=i,this.m=r,this.A=s,this.v=void 0!==a?a:s,this.B=!!l}_t("!=",3,2,function(t,e,o){return ut(function(t,e){return t!=e},t,e,o,!0)}),_t("and",2,2,function(t,e,o){return lt(t,o)&&lt(e,o)}),_t("or",1,2,function(t,e,o){return lt(t,o)||lt(e,o)}),t(ft),ft.prototype.a=function(t){return t=this.c.a(t),Gt(this.h,t)},ft.prototype.toString=function(){return"Filter:"+nt(this.c)+nt(this.h)},t(Tt),Tt.prototype.a=function(t){return this.h.m.apply(null,function(t){return Array.prototype.concat.apply(Array.prototype,arguments)}(t,this.c))},Tt.prototype.toString=function(){var t="Function: "+this.h;if(this.c.length)t=t+nt(d(this.c,function(t,e){return t+nt(e)},"Arguments:"));return t};var Et={};function yt(t,e,o,n,i,r,s,a){if(Et.hasOwnProperty(t))throw Error("Function already created: "+t+".");Et[t]=new vt(t,e,o,n,!1,i,r,s,a)}function mt(t,e){switch(this.h=t,this.c=void 0!==e?e:null,this.b=null,t){case"comment":this.b=8;break;case"text":this.b=3;break;case"processing-instruction":this.b=7;break;case"node":break;default:throw Error("Unexpected argument")}}function bt(t){return"comment"==t||"text"==t||"processing-instruction"==t||"node"==t}function St(t){this.b=t,this.a=0}yt("boolean",2,!(vt.prototype.toString=function(){return this.j}),!1,function(t,e){return lt(e,t)},1),yt("ceiling",1,!1,!1,function(t,e){return Math.ceil(st(e,t))},1),yt("concat",3,!1,!1,function(o,t){return d(function(t,e,o){return arguments.length<=2?Array.prototype.slice.call(t,e):Array.prototype.slice.call(t,e,o)}(arguments,1),function(t,e){return t+at(e,o)},"")},2,null),yt("contains",2,!1,!1,function(t,e,o){return a(at(e,t),at(o,t))},2),yt("count",1,!1,!1,function(t,e){return e.a(t).l},1,1,!0),yt("false",2,!1,!1,function(){return!1},0),yt("floor",1,!1,!1,function(t,e){return Math.floor(st(e,t))},1),yt("id",4,!1,!1,function(t,e){function o(e){if(N){var t=n.all[e];if(t){if(t.nodeType&&e==t.id)return t;if(t.length)return function(t,e){var o;t:{o=t.length;for(var n=c(t)?t.split(""):t,i=0;i<o;i++)if(i in n&&e.call(void 0,n[i],i,t)){o=i;break t}o=-1}return o<0?null:c(t)?t.charAt(o):t[o]}(t,function(t){return e==t.id})}return null}return n.getElementById(e)}var n=9==(i=t.a).nodeType?i:i.ownerDocument,i=at(e,t).split(/\s+/),r=[];u(i,function(t){!(t=o(t))||0<=l(r,t)||r.push(t)}),r.sort(V);var s=new z;return u(r,function(t){q(s,t)}),s},1),yt("lang",2,!1,!1,function(){return!1},1),yt("last",1,!0,!1,function(t){if(1!=arguments.length)throw Error("Function last expects ()");return t.f},0),yt("local-name",3,!1,!0,function(t,e){var o=e?Z(e.a(t)):t.a;return o?o.localName||o.nodeName.toLowerCase():""},0,1,!0),yt("name",3,!1,!0,function(t,e){var o=e?Z(e.a(t)):t.a;return o?o.nodeName.toLowerCase():""},0,1,!0),yt("namespace-uri",3,!0,!1,function(){return""},0,1,!0),yt("normalize-space",3,!1,!0,function(t,e){return(e?at(e,t):B(t.a)).replace(/[\s\xa0]+/g," ").replace(/^\s+|\s+$/g,"")},0,1),yt("not",2,!1,!1,function(t,e){return!lt(e,t)},1),yt("number",1,!1,!0,function(t,e){return e?st(e,t):+B(t.a)},0,1),yt("position",1,!0,!1,function(t){return t.b},0),yt("round",1,!1,!1,function(t,e){return Math.round(st(e,t))},1),yt("starts-with",2,!1,!1,function(t,e,o){return e=at(e,t),t=at(o,t),0==e.lastIndexOf(t,0)},2),yt("string",3,!1,!0,function(t,e){return e?at(e,t):B(t.a)},0,1),yt("string-length",1,!1,!0,function(t,e){return(e?at(e,t):B(t.a)).length},0,1),yt("substring",3,!1,!1,function(t,e,o,n){if(o=st(o,t),isNaN(o)||1/0==o||-1/0==o)return"";if(n=n?st(n,t):1/0,isNaN(n)||-1/0===n)return"";o=Math.round(o)-1;var i=Math.max(o,0);return t=at(e,t),1/0==n?t.substring(i):t.substring(i,o+Math.round(n))},2,3),yt("substring-after",3,!1,!1,function(t,e,o){return e=at(e,t),t=at(o,t),-1==(o=e.indexOf(t))?"":e.substring(o+t.length)},2),yt("substring-before",3,!1,!1,function(t,e,o){return e=at(e,t),t=at(o,t),-1==(t=e.indexOf(t))?"":e.substring(0,t)},2),yt("sum",1,!1,!1,function(t,e){for(var o=$(e.a(t)),n=0,i=et(o);i;i=et(o))n+=+B(i);return n},1,1,!0),yt("translate",3,!1,!1,function(t,e,o,n){e=at(e,t),o=at(o,t);var i=at(n,t);for(t={},n=0;n<o.length;n++){var r=o.charAt(n);r in t||(t[r]=i.charAt(n))}for(o="",n=0;n<e.length;n++)o+=(r=e.charAt(n))in t?t[r]:r;return o},3),yt("true",2,!1,!1,function(){return!0},0),mt.prototype.a=function(t){return null===this.b||this.b==t.nodeType},mt.prototype.f=function(){return this.h},mt.prototype.toString=function(){var t="Kind Test: "+this.h;return null===this.c||(t+=nt(this.c)),t};var It=/\$?(?:(?![0-9-\.])(?:\*|[\w-\.]+):)?(?![0-9-\.])(?:\*|[\w-\.]+)|\/\/|\.\.|::|\d+(?:\.\d*)?|\.\d+|"[^"]*"|'[^']*'|[!<>]=|\s+|./g,Rt=/^\s/;function Ct(t,e){return t.b[t.a+(e||0)]}function kt(t){return t.b[t.a++]}function Ot(t){return t.b.length<=t.a}function At(t){ot.call(this,3),this.c=t.substring(1,t.length-1)}function Dt(t,e){var o;this.j=t.toLowerCase(),o="*"==this.j?"*":"http://www.w3.org/1999/xhtml",this.c=e?e.toLowerCase():o}function wt(t){switch(t.nodeType){case 1:return function(e,t){var o=Array.prototype.slice.call(arguments,1);return function(){var t=o.slice();return t.push.apply(t,arguments),e.apply(this,t)}}(Mt,t);case 9:return wt(t.documentElement);case 11:case 10:case 6:case 12:return Nt;default:return t.parentNode?wt(t.parentNode):Nt}}function Nt(){return null}function Mt(t,e){if(t.prefix==e)return t.namespaceURI||"http://www.w3.org/1999/xhtml";var o=t.getAttributeNode("xmlns:"+e);return o&&o.specified?o.value||null:t.parentNode&&9!=t.parentNode.nodeType?Mt(t.parentNode,e):null}function Lt(t){ot.call(this,1),this.c=t}function Pt(t,e){if(ot.call(this,t.i),this.h=t,this.c=e,this.g=t.g,this.b=t.b,1==this.c.length){var o=this.c[0];o.u||o.c!=zt||"*"!=(o=o.o).f()&&(this.f={name:o.f(),s:null})}}function Bt(){ot.call(this,4)}function xt(){ot.call(this,4)}function Ft(t){return"/"==t||"//"==t}function Ut(t){ot.call(this,4),this.c=t,it(this,g(this.c,function(t){return t.g})),rt(this,g(this.c,function(t){return t.b}))}function Ht(t,e){this.a=t,this.b=!!e}function Gt(t,e,o){for(o=o||0;o<t.a.length;o++)for(var n,i=t.a[o],r=$(e),s=e.l,a=0;n=et(r);a++){var l=t.b?s-a:a+1;if("number"==typeof(n=i.a(new gt(n,l,s))))l=l==n;else if("string"==typeof n||"boolean"==typeof n)l=!!n;else{if(!(n instanceof z))throw Error("Predicate.evaluate returned an unexpected type.");l=0<n.l}if(!l){if(n=(l=r).f,!(u=l.a))throw Error("Next must be called at least once before remove.");var c=u.b,u=u.a;c?c.a=u:n.a=u,u?u.b=c:n.b=c,n.l--,l.a=null}}return e}function Wt(t,e,o,n){ot.call(this,4),this.c=t,this.o=e,this.h=o||new Ht([]),this.u=!!n,e=0<(e=this.h).a.length?e.a[0].f:null,t.b&&e&&(t=e.name,t=N?t.toLowerCase():t,this.f={name:t,s:e.s});t:{for(t=this.h,e=0;e<t.a.length;e++)if((o=t.a[e]).g||1==o.i||0==o.i){t=!0;break t}t=!1}this.g=t}function Vt(t,e,o,n){this.j=t,this.f=e,this.a=o,this.b=n}t(At),At.prototype.a=function(){return this.c},At.prototype.toString=function(){return"Literal: "+this.c},Dt.prototype.a=function(t){var e=t.nodeType;return(1==e||2==e)&&(("*"==this.j||this.j==t.localName.toLowerCase())&&("*"==this.c||this.c==(t.namespaceURI?t.namespaceURI.toLowerCase():"http://www.w3.org/1999/xhtml")))},Dt.prototype.f=function(){return this.j},Dt.prototype.toString=function(){return"Name Test: "+("http://www.w3.org/1999/xhtml"==this.c?"":this.c+":")+this.j},t(Lt),Lt.prototype.a=function(){return this.c},Lt.prototype.toString=function(){return"Number: "+this.c},t(Pt),t(Bt),Bt.prototype.a=function(t){var e=new z;return 9==(t=t.a).nodeType?q(e,t):q(e,t.ownerDocument),e},Bt.prototype.toString=function(){return"Root Helper Expression"},t(xt),xt.prototype.a=function(t){var e=new z;return q(e,t.a),e},xt.prototype.toString=function(){return"Context Helper Expression"},Pt.prototype.a=function(t){var e=this.h.a(t);if(!(e instanceof z))throw Error("Filter expression must evaluate to nodeset.");for(var o=0,n=(t=this.c).length;o<n&&e.l;o++){var i,r=t[o],s=$(e,r.c.a);if(r.g||r.c!=jt)if(r.g||r.c!=Zt)for(i=et(s),e=r.a(new gt(i));null!=(i=et(s));)e=K(e,i=r.a(new gt(i)));else i=et(s),e=r.a(new gt(i));else{for(i=et(s);(e=et(s))&&(!i.contains||i.contains(e))&&8&e.compareDocumentPosition(i);i=e);e=r.a(new gt(i))}}return e},Pt.prototype.toString=function(){var t;(t="Path Expression:"+nt(this.h),this.c.length)&&(t+=nt(d(this.c,function(t,e){return t+nt(e)},"Steps:")));return t},t(Ut),Ut.prototype.a=function(e){var o=new z;return u(this.c,function(t){if(!((t=t.a(e))instanceof z))throw Error("Path expression must evaluate to NodeSet.");o=K(o,t)}),o},Ut.prototype.toString=function(){return d(this.c,function(t,e){return t+nt(e)},"Union Expression:")},Ht.prototype.toString=function(){return d(this.a,function(t,e){return t+nt(e)},"Predicates:")},t(Wt),Wt.prototype.a=function(t){var e=t.a,o=null,n=null,i=null,r=0;if((o=this.f)&&(n=o.name,i=o.s?at(o.s,t):null,r=1),this.u)if(this.g||this.c!=Jt)if(e=et(t=$(new Wt(Kt,new mt("node")).a(t))))for(o=this.m(e,n,i,r);null!=(e=et(t));)o=K(o,this.m(e,n,i,r));else o=new z;else o=F(this.o,e,n,i),o=Gt(this.h,o,r);else o=this.m(t.a,n,i,r);return o},Wt.prototype.m=function(t,e,o,n){return t=this.c.f(this.o,t,e,o),Gt(this.h,t,n)},Wt.prototype.toString=function(){var t;(t="Step:"+nt("Operator: "+(this.u?"//":"/")),this.c.j&&(t+=nt("Axis: "+this.c)),t+=nt(this.o),this.h.a.length)&&(t+=nt(d(this.h.a,function(t,e){return t+nt(e)},"Predicates:")));return t},Vt.prototype.toString=function(){return this.j};var Xt={};function Yt(t,e,o,n){if(Xt.hasOwnProperty(t))throw Error("Axis already created: "+t);return e=new Vt(t,e,o,!!n),Xt[t]=e}Yt("ancestor",function(t,e){for(var o=new z,n=e;n=n.parentNode;)t.a(n)&&j(o,n);return o},!0),Yt("ancestor-or-self",function(t,e){for(var o=new z,n=e;t.a(n)&&j(o,n),n=n.parentNode;);return o},!0);var zt=Yt("attribute",function(t,e){var o=new z;if("style"==(r=t.f())&&e.style&&N)return q(o,new L(e.style,e,"style",e.style.cssText)),o;var n=e.attributes;if(n)if(t instanceof mt&&null===t.b||"*"==r)for(var i,r=0;i=n[r];r++)N?i.nodeValue&&q(o,P(e,i)):q(o,i);else(i=n.getNamedItem(r))&&(N?i.nodeValue&&q(o,P(e,i)):q(o,i));return o},!1),Jt=Yt("child",function(t,e,o,n,i){return(N?function(t,e,o,n,i){var r;if((t instanceof Dt||8==t.b||o&&null===t.b)&&(r=e.childNodes)){var s=G(t);return("*"==s||(r=h(r,function(t){return t.tagName&&t.tagName.toLowerCase()==s})))&&(o&&(r=h(r,function(t){return x(t,o,n)})),u(r,function(t){"*"==s&&("!"==t.tagName||"*"==s&&1!=t.nodeType)||q(i,t)})),i}return U(t,e,o,n,i)}:U).call(null,t,e,c(o)?o:null,c(n)?n:null,i||new z)},!1,!0);Yt("descendant",F,!1,!0);var Kt=Yt("descendant-or-self",function(t,e,o,n){var i=new z;return x(e,o,n)&&t.a(e)&&q(i,e),F(t,e,o,n,i)},!1,!0),jt=Yt("following",function(t,e,o,n){var i=new z;do{for(var r=e;r=r.nextSibling;)x(r,o,n)&&t.a(r)&&q(i,r),i=F(t,r,o,n,i)}while(e=e.parentNode);return i},!1,!0);Yt("following-sibling",function(t,e){for(var o=new z,n=e;n=n.nextSibling;)t.a(n)&&q(o,n);return o},!1),Yt("namespace",function(){return new z},!1);var qt=Yt("parent",function(t,e){var o=new z;if(9==e.nodeType)return o;if(2==e.nodeType)return q(o,e.ownerElement),o;var n=e.parentNode;return t.a(n)&&q(o,n),o},!1),Zt=Yt("preceding",function(t,e,o,n){for(var i=new z,r=[];r.unshift(e),e=e.parentNode;);for(var s=1,a=r.length;s<a;s++){var l=[];for(e=r[s];e=e.previousSibling;)l.unshift(e);for(var c=0,u=l.length;c<u;c++)x(e=l[c],o,n)&&t.a(e)&&q(i,e),i=F(t,e,o,n,i)}return i},!0,!0);Yt("preceding-sibling",function(t,e){for(var o=new z,n=e;n=n.previousSibling;)t.a(n)&&j(o,n);return o},!0);var Qt=Yt("self",function(t,e){var o=new z;return t.a(e)&&q(o,e),o},!1);function $t(t){ot.call(this,1),this.c=t,this.g=t.g,this.b=t.b}function te(t,e){this.a=t,this.b=e}function ee(t){for(var e,o=[];;){oe(t,"Missing right hand side of binary expression."),e=ce(t);var n=kt(t.a);if(!n)break;var i=(n=pt[n]||null)&&n.w;if(!i){t.a.a--;break}for(;o.length&&i<=o[o.length-1].w;)e=new ct(o.pop(),o.pop(),e);o.push(e,n)}for(;o.length;)e=new ct(o.pop(),o.pop(),e);return e}function oe(t,e){if(Ot(t.a))throw Error(e)}function ne(t,e){var o=kt(t.a);if(o!=e)throw Error("Bad token, expected: "+e+" got: "+o)}function ie(t){if(")"!=(t=kt(t.a)))throw Error("Bad token: "+t)}function re(t){if((t=kt(t.a)).length<2)throw Error("Unclosed literal string");return new At(t)}function se(t){var e,o,n=[];if(Ft(Ct(t.a))){if(e=kt(t.a),o=Ct(t.a),"/"==e&&(Ot(t.a)||"."!=o&&".."!=o&&"@"!=o&&"*"!=o&&!/(?![0-9])[\w]/.test(o)))return new Bt;o=new Bt,oe(t,"Missing next location step."),e=ae(t,e),n.push(e)}else{t:{switch(o=(e=Ct(t.a)).charAt(0)){case"$":throw Error("Variable reference not allowed in HTML XPath");case"(":kt(t.a),e=ee(t),oe(t,'unclosed "("'),ne(t,")");break;case'"':case"'":e=re(t);break;default:if(isNaN(+e)){if(bt(e)||!/(?![0-9])[\w]/.test(o)||"("!=Ct(t.a,1)){e=null;break t}for(e=kt(t.a),e=Et[e]||null,kt(t.a),o=[];")"!=Ct(t.a)&&(oe(t,"Missing function argument list."),o.push(ee(t)),","==Ct(t.a));)kt(t.a);oe(t,"Unclosed function argument list."),ie(t),e=new Tt(e,o)}else e=new Lt(+kt(t.a))}"["==Ct(t.a)&&(e=new ft(e,o=new Ht(le(t))))}if(e){if(!Ft(Ct(t.a)))return e;o=e}else e=ae(t,"/"),o=new xt,n.push(e)}for(;Ft(Ct(t.a));)e=kt(t.a),oe(t,"Missing next location step."),e=ae(t,e),n.push(e);return new Pt(o,n)}function ae(t,e){var o,n,i,r;if("/"!=e&&"//"!=e)throw Error('Step op should be "/" or "//"');if("."==Ct(t.a))return n=new Wt(Qt,new mt("node")),kt(t.a),n;if(".."==Ct(t.a))return n=new Wt(qt,new mt("node")),kt(t.a),n;if("@"==Ct(t.a))r=zt,kt(t.a),oe(t,"Missing attribute name");else if("::"==Ct(t.a,1)){if(!/(?![0-9])[\w]/.test(Ct(t.a).charAt(0)))throw Error("Bad token: "+kt(t.a));if(o=kt(t.a),!(r=Xt[o]||null))throw Error("No axis with name: "+o);kt(t.a),oe(t,"Missing node name")}else r=Jt;if(o=Ct(t.a),!/(?![0-9])[\w\*]/.test(o.charAt(0)))throw Error("Bad token: "+kt(t.a));if("("==Ct(t.a,1)){if(!bt(o))throw Error("Invalid node type: "+o);if(!bt(o=kt(t.a)))throw Error("Invalid type name: "+o);ne(t,"("),oe(t,"Bad nodetype");var s=null;'"'!=(i=Ct(t.a).charAt(0))&&"'"!=i||(s=re(t)),oe(t,"Bad nodetype"),ie(t),o=new mt(o,s)}else if(-1==(i=(o=kt(t.a)).indexOf(":")))o=new Dt(o);else{var a;if("*"==(s=o.substring(0,i)))a="*";else if(!(a=t.b(s)))throw Error("Namespace prefix not declared: "+s);o=new Dt(o=o.substr(i+1),a)}return i=new Ht(le(t),r.a),n||new Wt(r,o,i,"//"==e)}function le(t){for(var e=[];"["==Ct(t.a);){kt(t.a),oe(t,"Missing predicate expression.");var o=ee(t);e.push(o),oe(t,"Unclosed predicate expression."),ne(t,"]")}return e}function ce(t){if("-"==Ct(t.a))return kt(t.a),new $t(ce(t));var e=se(t);if("|"!=Ct(t.a))t=e;else{for(e=[e];"|"==kt(t.a);)oe(t,"Missing next union location path."),e.push(se(t));t.a.a--,t=new Ut(e)}return t}function ue(t,e){if(!t.length)throw Error("Empty XPath expression.");var o=function(t){t=t.match(It);for(var e=0;e<t.length;e++)Rt.test(t[e])&&t.splice(e,1);return new St(t)}(t);if(Ot(o))throw Error("Invalid XPath expression.");e?"function"==function(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var o=Object.prototype.toString.call(t);if("[object Window]"==o)return"object";if("[object Array]"==o||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==o||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}(e)||(e=r(e.lookupNamespaceURI,e)):e=function(){return null};var n=ee(new te(o,e));if(!Ot(o))throw Error("Bad token: "+kt(o));this.evaluate=function(t,e){return new he(n.a(new gt(t)),e)}}function he(t,e){if(0==e)if(t instanceof z)e=4;else if("string"==typeof t)e=2;else if("number"==typeof t)e=1;else{if("boolean"!=typeof t)throw Error("Unexpected evaluation result.");e=3}if(2!=e&&1!=e&&3!=e&&!(t instanceof z))throw Error("value could not be converted to the specified type");var o;switch(this.resultType=e){case 2:this.stringValue=t instanceof z?Q(t):""+t;break;case 1:this.numberValue=t instanceof z?+Q(t):+t;break;case 3:this.booleanValue=t instanceof z?0<t.l:!!t;break;case 4:case 5:case 6:case 7:var n=$(t);o=[];for(var i=et(n);i;i=et(n))o.push(i instanceof L?i.a:i);this.snapshotLength=t.l,this.invalidIteratorState=!1;break;case 8:case 9:n=Z(t),this.singleNodeValue=n instanceof L?n.a:n;break;default:throw Error("Unknown XPathResult type.")}var r=0;this.iterateNext=function(){if(4!=e&&5!=e)throw Error("iterateNext called with wrong result type");return r>=o.length?null:o[r++]},this.snapshotItem=function(t){if(6!=e&&7!=e)throw Error("snapshotItem called with wrong result type");return t>=o.length||t<0?null:o[t]}}function pe(t){this.lookupNamespaceURI=wt(t)}function _e(t,e){var o=t||s,n=o.document;n.evaluate&&!e||(o.XPathResult=he,n.evaluate=function(t,e,o,n){return new ue(t,o).evaluate(e,n)},n.createExpression=function(t,e){return new ue(t,e)},n.createNSResolver=function(t){return new pe(t)})}t($t),$t.prototype.a=function(t){return-st(this.c,t)},$t.prototype.toString=function(){return"Unary Expression: -"+nt(this.c)},he.ANY_TYPE=0,he.NUMBER_TYPE=1,he.STRING_TYPE=2,he.BOOLEAN_TYPE=3,he.UNORDERED_NODE_ITERATOR_TYPE=4,he.ORDERED_NODE_ITERATOR_TYPE=5,he.UNORDERED_NODE_SNAPSHOT_TYPE=6,he.ORDERED_NODE_SNAPSHOT_TYPE=7,he.ANY_UNORDERED_NODE_TYPE=8,he.FIRST_ORDERED_NODE_TYPE=9;var de,ge=["wgxpath","install"],fe=s;ge[0]in fe||!fe.execScript||fe.execScript("var "+ge[0]);for(;ge.length&&(de=ge.shift());)ge.length||void 0===_e?fe=fe[de]?fe[de]:fe[de]={}:fe[de]=_e}).call(t),e.exports.install=wgxpath.install,e.exports.XPathResultType={ANY_TYPE:0,NUMBER_TYPE:1,STRING_TYPE:2,BOOLEAN_TYPE:3,UNORDERED_NODE_ITERATOR_TYPE:4,ORDERED_NODE_ITERATOR_TYPE:5,UNORDERED_NODE_SNAPSHOT_TYPE:6,ORDERED_NODE_SNAPSHOT_TYPE:7,ANY_UNORDERED_NODE_TYPE:8,FIRST_ORDERED_NODE_TYPE:9}}).call(this,o(31))},73:function(t,e){var o=t.exports={version:"2.6.9"};"number"==typeof __e&&(__e=o)},75:function(t,e,o){"use strict";var n=o(238);function r(t,e){return e?n(t):encodeURIComponent(t)}e.extract=function(t){return t.split("?")[1]||""},e.parse=function(t){var i=Object.create(null);return"string"!=typeof t||(t=t.trim().replace(/^(\?|#|&)/,""))&&t.split("&").forEach(function(t){var e=t.replace(/\+/g," ").split("="),o=e.shift(),n=0<e.length?e.join("="):void 0;o=decodeURIComponent(o),n=void 0===n?null:decodeURIComponent(n),void 0===i[o]?i[o]=n:Array.isArray(i[o])?i[o].push(n):i[o]=[i[o],n]}),i},e.stringify=function(n,t){var i=!1!==(t=t||{}).strict;return n?Object.keys(n).sort().map(function(e){var t=n[e];if(void 0===t)return"";if(null===t)return e;if(Array.isArray(t)){var o=[];return t.slice().sort().forEach(function(t){void 0!==t&&(null===t?o.push(r(e,i)):o.push(r(e,i)+"="+r(t,i)))}),o.join("&")}return r(e,i)+"="+r(t,i)}).filter(function(t){return 0<t.length}).join("&"):""}},78:function(t,e,o){t.exports=!o(39)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},79:function(t,e,o){var n=o(40),i=o(1130),r=o(257),s=Object.defineProperty;e.f=o(78)?Object.defineProperty:function(t,e,o){if(n(t),e=r(e,!0),n(o),i)try{return s(t,e,o)}catch(t){}if("get"in o||"set"in o)throw TypeError("Accessors not supported!");return"value"in o&&(t[e]=o.value),t}},873:function(t,e,o){var n=o(41),i=o(38).document,r=n(i)&&n(i.createElement);t.exports=function(t){return r?i.createElement(t):{}}},874:function(t,e,o){e.f=o(50)},875:function(t,e,o){var n=o(617)("keys"),i=o(305);t.exports=function(t){return n[t]||(n[t]=i(t))}},876:function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},877:function(t,e,o){var n=o(38).document;t.exports=n&&n.documentElement},878:function(t,e,i){var o=i(41),n=i(40),r=function(t,e){if(n(t),!o(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,o,n){try{(n=i(169)(Function.call,i(172).f(Object.prototype,"__proto__").set,2))(t,[]),o=!(t instanceof Array)}catch(t){o=!0}return function(t,e){return r(t,e),o?t.__proto__=e:n(t,e),t}}({},!1):void 0),check:r}},879:function(t,e){t.exports="\t\n\v\f\r \u2028\u2029\ufeff"},880:function(t,e,o){var r=o(41),s=o(878).set;t.exports=function(t,e,o){var n,i=e.constructor;return i!==o&&"function"==typeof i&&(n=i.prototype)!==o.prototype&&r(n)&&s&&s(t,n),t}},881:function(t,e,o){"use strict";var i=o(171),r=o(204);t.exports=function(t){var e=String(r(this)),o="",n=i(t);if(n<0||n==1/0)throw RangeError("Count can't be negative");for(;0<n;(n>>>=1)&&(e+=e))1&n&&(o+=e);return o}},882:function(t,e){t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},883:function(t,e){var o=Math.expm1;t.exports=!o||22025.465794806718<o(10)||o(10)<22025.465794806718||-2e-17!=o(-2e-17)?function(t){return 0==(t=+t)?t:-1e-6<t&&t<1e-6?t+t*t/2:Math.exp(t)-1}:o},884:function(t,e,o){var l=o(171),c=o(204);t.exports=function(a){return function(t,e){var o,n,i=String(c(t)),r=l(e),s=i.length;return r<0||s<=r?a?"":void 0:(o=i.charCodeAt(r))<55296||56319<o||r+1===s||(n=i.charCodeAt(r+1))<56320||57343<n?a?i.charAt(r):o:a?i.slice(r,r+2):n-56320+(o-55296<<10)+65536}}},885:function(t,e,o){"use strict";var E=o(306),y=o(10),m=o(123),b=o(136),S=o(347),I=o(1144),R=o(345),C=o(311),k=o(50)("iterator"),O=!([].keys&&"next"in[].keys()),A="values",D=function(){return this};t.exports=function(t,e,o,n,i,r,s){I(o,e,n);var a,l,c,u=function(t){if(!O&&t in d)return d[t];switch(t){case"keys":case A:return function(){return new o(this,t)}}return function(){return new o(this,t)}},h=e+" Iterator",p=i==A,_=!1,d=t.prototype,g=d[k]||d["@@iterator"]||i&&d[i],f=g||u(i),T=i?p?u("entries"):f:void 0,v="Array"==e&&d.entries||g;if(v&&(c=C(v.call(new t)))!==Object.prototype&&c.next&&(R(c,h,!0),E||"function"==typeof c[k]||b(c,k,D)),p&&g&&g.name!==A&&(_=!0,f=function(){return g.call(this)}),E&&!s||!O&&!_&&d[k]||b(d,k,f),S[e]=f,S[h]=D,i)if(a={values:p?f:u(A),keys:r?f:u("keys"),entries:T},s)for(l in a)l in d||m(d,l,a[l]);else y(y.P+y.F*(O||_),e,a);return a}},886:function(t,e,o){var n=o(887),i=o(204);t.exports=function(t,e,o){if(n(e))throw TypeError("String#"+o+" doesn't accept regex!");return String(i(t))}},887:function(t,e,o){var n=o(41),i=o(203),r=o(50)("match");t.exports=function(t){var e;return n(t)&&(void 0!==(e=t[r])?!!e:"RegExp"==i(t))}},888:function(t,e,o){var n=o(50)("match");t.exports=function(e){var o=/./;try{"/./"[e](o)}catch(t){try{return o[n]=!1,!"/./"[e](o)}catch(t){}}return!0}},889:function(t,e,o){var n=o(347),i=o(50)("iterator"),r=Array.prototype;t.exports=function(t){return void 0!==t&&(n.Array===t||r[i]===t)}},890:function(t,e,o){"use strict";var n=o(79),i=o(304);t.exports=function(t,e,o){e in t?n.f(t,e,i(0,o)):t[e]=o}},891:function(t,e,o){var n=o(483),i=o(50)("iterator"),r=o(347);t.exports=o(73).getIteratorMethod=function(t){if(null!=t)return t[i]||t["@@iterator"]||r[n(t)]}},892:function(t,e,o){"use strict";var a=o(100),l=o(308),c=o(59);t.exports=function(t){for(var e=a(this),o=c(e.length),n=arguments.length,i=l(1<n?arguments[1]:void 0,o),r=2<n?arguments[2]:void 0,s=void 0===r?o:l(r,o);i<s;)e[i++]=t;return e}},893:function(t,e,o){"use strict";var n=o(312),i=o(1149),r=o(347),s=o(137);t.exports=o(885)(Array,"Array",function(t,e){this._t=s(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,o=this._i++;return!t||o>=t.length?(this._t=void 0,i(1)):i(0,"keys"==e?o:"values"==e?t[o]:[o,t[o]])},"values"),r.Arguments=r.Array,n("keys"),n("values"),n("entries")},894:function(t,e,o){"use strict";var n,i,r=o(622),s=RegExp.prototype.exec,a=String.prototype.replace,l=s,c="lastIndex",u=(n=/a/,i=/b*/g,s.call(n,"a"),s.call(i,"a"),0!==n[c]||0!==i[c]),h=void 0!==/()??/.exec("")[1];(u||h)&&(l=function(t){var e,o,n,i;return h&&(o=new RegExp("^"+this.source+"$(?!\\s)",r.call(this))),u&&(e=this[c]),n=s.call(this,t),u&&n&&(this[c]=this.global?n.index+n[0].length:e),h&&n&&1<n.length&&a.call(n[0],o,function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(n[i]=void 0)}),n}),t.exports=l},895:function(t,e,o){"use strict";var n=o(884)(!0);t.exports=function(t,e,o){return e+(o?n(t,e).length:1)}},896:function(t,e,o){var n,i,r,s=o(169),a=o(1138),l=o(877),c=o(873),u=o(38),h=u.process,p=u.setImmediate,_=u.clearImmediate,d=u.MessageChannel,g=u.Dispatch,f=0,T={},v="onreadystatechange",E=function(){var t=+this;if(T.hasOwnProperty(t)){var e=T[t];delete T[t],e()}},y=function(t){E.call(t.data)};p&&_||(p=function(t){for(var e=[],o=1;arguments.length>o;)e.push(arguments[o++]);return T[++f]=function(){a("function"==typeof t?t:Function(t),e)},n(f),f},_=function(t){delete T[t]},"process"==o(203)(h)?n=function(t){h.nextTick(s(E,t,1))}:g&&g.now?n=function(t){g.now(s(E,t,1))}:d?(r=(i=new d).port2,i.port1.onmessage=y,n=s(r.postMessage,r,1)):u.addEventListener&&"function"==typeof postMessage&&!u.importScripts?(n=function(t){u.postMessage(t+"","*")},u.addEventListener("message",y,!1)):n=v in c("script")?function(t){l.appendChild(c("script"))[v]=function(){l.removeChild(this),E.call(t)}}:function(t){setTimeout(s(E,t,1),0)}),t.exports={set:p,clear:_}},897:function(t,e,o){"use strict";var n=o(38),i=o(78),r=o(306),s=o(628),a=o(136),l=o(350),c=o(39),u=o(349),h=o(171),p=o(59),_=o(1157),d=o(310).f,g=o(79).f,f=o(892),T=o(345),v="ArrayBuffer",E="DataView",y="prototype",m="Wrong index!",b=n[v],S=n[E],I=n.Math,R=n.RangeError,C=n.Infinity,k=b,O=I.abs,A=I.pow,D=I.floor,w=I.log,N=I.LN2,M="byteLength",L="byteOffset",P=i?"_b":"buffer",B=i?"_l":M,x=i?"_o":L;function F(t,e,o){var n,i,r,s=new Array(o),a=8*o-e-1,l=(1<<a)-1,c=l>>1,u=23===e?A(2,-24)-A(2,-77):0,h=0,p=t<0||0===t&&1/t<0?1:0;for((t=O(t))!=t||t===C?(i=t!=t?1:0,n=l):(n=D(w(t)/N),t*(r=A(2,-n))<1&&(n--,r*=2),2<=(t+=1<=n+c?u/r:u*A(2,1-c))*r&&(n++,r/=2),l<=n+c?(i=0,n=l):1<=n+c?(i=(t*r-1)*A(2,e),n+=c):(i=t*A(2,c-1)*A(2,e),n=0));8<=e;s[h++]=255&i,i/=256,e-=8);for(n=n<<e|i,a+=e;0<a;s[h++]=255&n,n/=256,a-=8);return s[--h]|=128*p,s}function U(t,e,o){var n,i=8*o-e-1,r=(1<<i)-1,s=r>>1,a=i-7,l=o-1,c=t[l--],u=127&c;for(c>>=7;0<a;u=256*u+t[l],l--,a-=8);for(n=u&(1<<-a)-1,u>>=-a,a+=e;0<a;n=256*n+t[l],l--,a-=8);if(0===u)u=1-s;else{if(u===r)return n?NaN:c?-C:C;n+=A(2,e),u-=s}return(c?-1:1)*n*A(2,u-e)}function H(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]}function G(t){return[255&t]}function W(t){return[255&t,t>>8&255]}function V(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function X(t){return F(t,52,8)}function Y(t){return F(t,23,4)}function z(t,e,o){g(t[y],e,{get:function(){return this[o]}})}function J(t,e,o,n){var i=_(+o);if(i+e>t[B])throw R(m);var r=t[P]._b,s=i+t[x],a=r.slice(s,s+e);return n?a:a.reverse()}function K(t,e,o,n,i,r){var s=_(+o);if(s+e>t[B])throw R(m);for(var a=t[P]._b,l=s+t[x],c=n(+i),u=0;u<e;u++)a[l+u]=c[r?u:e-u-1]}if(s.ABV){if(!c(function(){b(1)})||!c(function(){new b(-1)})||c(function(){return new b,new b(1.5),new b(NaN),b.name!=v})){for(var j,q=(b=function(t){return u(this,b),new k(_(t))})[y]=k[y],Z=d(k),Q=0;Z.length>Q;)(j=Z[Q++])in b||a(b,j,k[j]);r||(q.constructor=b)}var $=new S(new b(2)),tt=S[y].setInt8;$.setInt8(0,2147483648),$.setInt8(1,2147483649),!$.getInt8(0)&&$.getInt8(1)||l(S[y],{setInt8:function(t,e){tt.call(this,t,e<<24>>24)},setUint8:function(t,e){tt.call(this,t,e<<24>>24)}},!0)}else b=function(t){u(this,b,v);var e=_(t);this._b=f.call(new Array(e),0),this[B]=e},S=function(t,e,o){u(this,S,E),u(t,b,E);var n=t[B],i=h(e);if(i<0||n<i)throw R("Wrong offset!");if(n<i+(o=void 0===o?n-i:p(o)))throw R("Wrong length!");this[P]=t,this[x]=i,this[B]=o},i&&(z(b,M,"_l"),z(S,"buffer","_b"),z(S,M,"_l"),z(S,L,"_o")),l(S[y],{getInt8:function(t){return J(this,1,t)[0]<<24>>24},getUint8:function(t){return J(this,1,t)[0]},getInt16:function(t){var e=J(this,2,t,arguments[1]);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=J(this,2,t,arguments[1]);return e[1]<<8|e[0]},getInt32:function(t){return H(J(this,4,t,arguments[1]))},getUint32:function(t){return H(J(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return U(J(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return U(J(this,8,t,arguments[1]),52,8)},setInt8:function(t,e){K(this,1,t,G,e)},setUint8:function(t,e){K(this,1,t,G,e)},setInt16:function(t,e){K(this,2,t,W,e,arguments[2])},setUint16:function(t,e){K(this,2,t,W,e,arguments[2])},setInt32:function(t,e){K(this,4,t,V,e,arguments[2])},setUint32:function(t,e){K(this,4,t,V,e,arguments[2])},setFloat32:function(t,e){K(this,4,t,Y,e,arguments[2])},setFloat64:function(t,e){K(this,8,t,X,e,arguments[2])}});T(b,v),T(S,E),a(S[y],s.VIEW,!0),e[v]=b,e[E]=S},9:function(t,e){t.exports=$},99:function(t,e,o){t.exports=function(){"use strict";var n=Array.prototype.slice;function t(t,e){e&&(t.prototype=Object.create(e.prototype)),t.prototype.constructor=t}function l(t){return u(t)?t:J(t)}function a(t){return h(t)?t:K(t)}function c(t){return p(t)?t:j(t)}function i(t){return u(t)&&!_(t)?t:q(t)}function u(t){return!(!t||!t[e])}function h(t){return!(!t||!t[o])}function p(t){return!(!t||!t[r])}function _(t){return h(t)||p(t)}function d(t){return!(!t||!t[s])}t(a,l),t(c,l),t(i,l),l.isIterable=u,l.isKeyed=h,l.isIndexed=p,l.isAssociative=_,l.isOrdered=d,l.Keyed=a,l.Indexed=c,l.Set=i;var e="@@__IMMUTABLE_ITERABLE__@@",o="@@__IMMUTABLE_KEYED__@@",r="@@__IMMUTABLE_INDEXED__@@",s="@@__IMMUTABLE_ORDERED__@@",g="delete",E=5,v=1<<E,y=v-1,m={},f={value:!1},T={value:!1};function b(t){return t.value=!1,t}function S(t){t&&(t.value=!0)}function I(){}function R(t,e){e=e||0;for(var o=Math.max(0,t.length-e),n=new Array(o),i=0;i<o;i++)n[i]=t[i+e];return n}function C(t){return void 0===t.size&&(t.size=t.__iterate(O)),t.size}function k(t,e){if("number"!=typeof e){var o=e>>>0;if(""+o!==e||4294967295==o)return NaN;e=o}return e<0?C(t)+e:e}function O(){return!0}function A(t,e,o){return(0===t||void 0!==o&&t<=-o)&&(void 0===e||void 0!==o&&o<=e)}function D(t,e){return N(t,e,0)}function w(t,e){return N(t,e,e)}function N(t,e,o){return void 0===t?o:t<0?Math.max(0,e+t):void 0===e?t:Math.min(e,t)}var M=0,L=1,P=2,B="function"==typeof Symbol&&Symbol.iterator,x="@@iterator",F=B||x;function U(t){this.next=t}function H(t,e,o,n){var i=0===t?e:1===t?o:[e,o];return n?n.value=i:n={value:i,done:!1},n}function G(){return{value:void 0,done:!0}}function W(t){return!!Y(t)}function V(t){return t&&"function"==typeof t.next}function X(t){var e=Y(t);return e&&e.call(t)}function Y(t){var e=t&&(B&&t[B]||t[x]);if("function"==typeof e)return e}function z(t){return t&&"number"==typeof t.length}function J(t){return null==t?st():u(t)?t.toSeq():function(t){var e=ct(t)||"object"==typeof t&&new ot(t);if(e)return e;throw new TypeError("Expected Array or iterable object of values, or keyed object: "+t)}(t)}function K(t){return null==t?st().toKeyedSeq():u(t)?h(t)?t.toSeq():t.fromEntrySeq():at(t)}function j(t){return null==t?st():u(t)?h(t)?t.entrySeq():t.toIndexedSeq():lt(t)}function q(t){return(null==t?st():u(t)?h(t)?t.entrySeq():t:lt(t)).toSetSeq()}U.prototype.toString=function(){return"[Iterator]"},U.KEYS=M,U.VALUES=L,U.ENTRIES=P,U.prototype.inspect=U.prototype.toSource=function(){return this.toString()},U.prototype[F]=function(){return this},t(J,l),J.of=function(){return J(arguments)},J.prototype.toSeq=function(){return this},J.prototype.toString=function(){return this.__toString("Seq {","}")},J.prototype.cacheResult=function(){return!this._cache&&this.__iterateUncached&&(this._cache=this.entrySeq().toArray(),this.size=this._cache.length),this},J.prototype.__iterate=function(t,e){return ut(this,t,e,!0)},J.prototype.__iterator=function(t,e){return ht(this,t,e,!0)},t(K,J),K.prototype.toKeyedSeq=function(){return this},t(j,J),j.of=function(){return j(arguments)},j.prototype.toIndexedSeq=function(){return this},j.prototype.toString=function(){return this.__toString("Seq [","]")},j.prototype.__iterate=function(t,e){return ut(this,t,e,!1)},j.prototype.__iterator=function(t,e){return ht(this,t,e,!1)},t(q,J),q.of=function(){return q(arguments)},q.prototype.toSetSeq=function(){return this},J.isSeq=rt,J.Keyed=K,J.Set=q,J.Indexed=j;var Z,Q,$,tt="@@__IMMUTABLE_SEQ__@@";function et(t){this._array=t,this.size=t.length}function ot(t){var e=Object.keys(t);this._object=t,this._keys=e,this.size=e.length}function nt(t){this._iterable=t,this.size=t.length||t.size}function it(t){this._iterator=t,this._iteratorCache=[]}function rt(t){return!(!t||!t[tt])}function st(){return Z||(Z=new et([]))}function at(t){var e=Array.isArray(t)?new et(t).fromEntrySeq():V(t)?new it(t).fromEntrySeq():W(t)?new nt(t).fromEntrySeq():"object"==typeof t?new ot(t):void 0;if(!e)throw new TypeError("Expected Array or iterable object of [k, v] entries, or keyed object: "+t);return e}function lt(t){var e=ct(t);if(!e)throw new TypeError("Expected Array or iterable object of values: "+t);return e}function ct(t){return z(t)?new et(t):V(t)?new it(t):W(t)?new nt(t):void 0}function ut(t,e,o,n){var i=t._cache;if(i){for(var r=i.length-1,s=0;s<=r;s++){var a=i[o?r-s:s];if(!1===e(a[1],n?a[0]:s,t))return s+1}return s}return t.__iterateUncached(e,o)}function ht(t,e,o,n){var i=t._cache;if(i){var r=i.length-1,s=0;return new U(function(){var t=i[o?r-s:s];return s++>r?G():H(e,n?t[0]:s-1,t[1])})}return t.__iteratorUncached(e,o)}function pt(t,e){return e?function o(n,i,t,e){return Array.isArray(i)?n.call(e,t,j(i).map(function(t,e){return o(n,t,e,i)})):dt(i)?n.call(e,t,K(i).map(function(t,e){return o(n,t,e,i)})):i}(e,t,"",{"":t}):_t(t)}function _t(t){return Array.isArray(t)?j(t).map(_t).toList():dt(t)?K(t).map(_t).toMap():t}function dt(t){return t&&(t.constructor===Object||void 0===t.constructor)}function gt(t,e){if(t===e||t!=t&&e!=e)return!0;if(!t||!e)return!1;if("function"==typeof t.valueOf&&"function"==typeof e.valueOf){if(t=t.valueOf(),e=e.valueOf(),t===e||t!=t&&e!=e)return!0;if(!t||!e)return!1}return!("function"!=typeof t.equals||"function"!=typeof e.equals||!t.equals(e))}function ft(o,t){if(o===t)return!0;if(!u(t)||void 0!==o.size&&void 0!==t.size&&o.size!==t.size||void 0!==o.__hash&&void 0!==t.__hash&&o.__hash!==t.__hash||h(o)!==h(t)||p(o)!==p(t)||d(o)!==d(t))return!1;if(0===o.size&&0===t.size)return!0;var n=!_(o);if(d(o)){var i=o.entries();return t.every(function(t,e){var o=i.next().value;return o&&gt(o[1],t)&&(n||gt(o[0],e))})&&i.next().done}var r=!1;if(void 0===o.size)if(void 0===t.size)"function"==typeof o.cacheResult&&o.cacheResult();else{r=!0;var e=o;o=t,t=e}var s=!0,a=t.__iterate(function(t,e){if(n?!o.has(t):r?!gt(t,o.get(e,m)):!gt(o.get(e,m),t))return s=!1});return s&&o.size===a}function Tt(t,e){if(!(this instanceof Tt))return new Tt(t,e);if(this._value=t,this.size=void 0===e?1/0:Math.max(0,e),0===this.size){if(Q)return Q;Q=this}}function vt(t,e){if(!t)throw new Error(e)}function Et(t,e,o){if(!(this instanceof Et))return new Et(t,e,o);if(vt(0!==o,"Cannot step a Range by 0"),t=t||0,void 0===e&&(e=1/0),o=void 0===o?1:Math.abs(o),e<t&&(o=-o),this._start=t,this._end=e,this._step=o,this.size=Math.max(0,Math.ceil((e-t)/o-1)+1),0===this.size){if($)return $;$=this}}function yt(){throw TypeError("Abstract")}function mt(){}function bt(){}function St(){}J.prototype[tt]=!0,t(et,j),et.prototype.get=function(t,e){return this.has(t)?this._array[k(this,t)]:e},et.prototype.__iterate=function(t,e){for(var o=this._array,n=o.length-1,i=0;i<=n;i++)if(!1===t(o[e?n-i:i],i,this))return i+1;return i},et.prototype.__iterator=function(t,e){var o=this._array,n=o.length-1,i=0;return new U(function(){return n<i?G():H(t,i,o[e?n-i++:i++])})},t(ot,K),ot.prototype.get=function(t,e){return void 0===e||this.has(t)?this._object[t]:e},ot.prototype.has=function(t){return this._object.hasOwnProperty(t)},ot.prototype.__iterate=function(t,e){for(var o=this._object,n=this._keys,i=n.length-1,r=0;r<=i;r++){var s=n[e?i-r:r];if(!1===t(o[s],s,this))return r+1}return r},ot.prototype.__iterator=function(e,o){var n=this._object,i=this._keys,r=i.length-1,s=0;return new U(function(){var t=i[o?r-s:s];return s++>r?G():H(e,t,n[t])})},ot.prototype[s]=!0,t(nt,j),nt.prototype.__iterateUncached=function(t,e){if(e)return this.cacheResult().__iterate(t,e);var o=this._iterable,n=X(o),i=0;if(V(n))for(var r;!(r=n.next()).done&&!1!==t(r.value,i++,this););return i},nt.prototype.__iteratorUncached=function(e,t){if(t)return this.cacheResult().__iterator(e,t);var o=this._iterable,n=X(o);if(!V(n))return new U(G);var i=0;return new U(function(){var t=n.next();return t.done?t:H(e,i++,t.value)})},t(it,j),it.prototype.__iterateUncached=function(t,e){if(e)return this.cacheResult().__iterate(t,e);for(var o,n=this._iterator,i=this._iteratorCache,r=0;r<i.length;)if(!1===t(i[r],r++,this))return r;for(;!(o=n.next()).done;){var s=o.value;if(i[r]=s,!1===t(s,r++,this))break}return r},it.prototype.__iteratorUncached=function(e,t){if(t)return this.cacheResult().__iterator(e,t);var o=this._iterator,n=this._iteratorCache,i=0;return new U(function(){if(i>=n.length){var t=o.next();if(t.done)return t;n[i]=t.value}return H(e,i,n[i++])})},t(Tt,j),Tt.prototype.toString=function(){return 0===this.size?"Repeat []":"Repeat [ "+this._value+" "+this.size+" times ]"},Tt.prototype.get=function(t,e){return this.has(t)?this._value:e},Tt.prototype.includes=function(t){return gt(this._value,t)},Tt.prototype.slice=function(t,e){var o=this.size;return A(t,e,o)?this:new Tt(this._value,w(e,o)-D(t,o))},Tt.prototype.reverse=function(){return this},Tt.prototype.indexOf=function(t){return gt(this._value,t)?0:-1},Tt.prototype.lastIndexOf=function(t){return gt(this._value,t)?this.size:-1},Tt.prototype.__iterate=function(t,e){for(var o=0;o<this.size;o++)if(!1===t(this._value,o,this))return o+1;return o},Tt.prototype.__iterator=function(t,e){var o=this,n=0;return new U(function(){return n<o.size?H(t,n++,o._value):G()})},Tt.prototype.equals=function(t){return t instanceof Tt?gt(this._value,t._value):ft(t)},t(Et,j),Et.prototype.toString=function(){return 0===this.size?"Range []":"Range [ "+this._start+"..."+this._end+(1!==this._step?" by "+this._step:"")+" ]"},Et.prototype.get=function(t,e){return this.has(t)?this._start+k(this,t)*this._step:e},Et.prototype.includes=function(t){var e=(t-this._start)/this._step;return 0<=e&&e<this.size&&e===Math.floor(e)},Et.prototype.slice=function(t,e){return A(t,e,this.size)?this:(t=D(t,this.size),(e=w(e,this.size))<=t?new Et(0,0):new Et(this.get(t,this._end),this.get(e,this._end),this._step))},Et.prototype.indexOf=function(t){var e=t-this._start;if(e%this._step==0){var o=e/this._step;if(0<=o&&o<this.size)return o}return-1},Et.prototype.lastIndexOf=function(t){return this.indexOf(t)},Et.prototype.__iterate=function(t,e){for(var o=this.size-1,n=this._step,i=e?this._start+o*n:this._start,r=0;r<=o;r++){if(!1===t(i,r,this))return r+1;i+=e?-n:n}return r},Et.prototype.__iterator=function(e,o){var n=this.size-1,i=this._step,r=o?this._start+n*i:this._start,s=0;return new U(function(){var t=r;return r+=o?-i:i,n<s?G():H(e,s++,t)})},Et.prototype.equals=function(t){return t instanceof Et?this._start===t._start&&this._end===t._end&&this._step===t._step:ft(this,t)},t(yt,l),t(mt,yt),t(bt,yt),t(St,yt),yt.Keyed=mt,yt.Indexed=bt,yt.Set=St;var It="function"==typeof Math.imul&&-2===Math.imul(4294967295,2)?Math.imul:function(t,e){var o=65535&(t|=0),n=65535&(e|=0);return o*n+((t>>>16)*n+o*(e>>>16)<<16>>>0)|0};function Rt(t){return t>>>1&1073741824|3221225471&t}function Ct(t){if(!1===t||null==t)return 0;if("function"==typeof t.valueOf&&(!1===(t=t.valueOf())||null==t))return 0;if(!0===t)return 1;var e=typeof t;if("number"==e){if(t!=t||t===1/0)return 0;var o=0|t;for(o!==t&&(o^=4294967295*t);4294967295<t;)o^=t/=4294967295;return Rt(o)}if("string"==e)return t.length>Lt?function(t){var e=xt[t];return void 0===e&&(e=kt(t),Bt===Pt&&(Bt=0,xt={}),Bt++,xt[t]=e),e}(t):kt(t);if("function"==typeof t.hashCode)return t.hashCode();if("object"==e)return function(t){var e;if(wt&&void 0!==(e=Ot.get(t)))return e;if(void 0!==(e=t[Mt]))return e;if(!Dt){if(void 0!==(e=t.propertyIsEnumerable&&t.propertyIsEnumerable[Mt]))return e;if(void 0!==(e=function(t){if(t&&0<t.nodeType)switch(t.nodeType){case 1:return t.uniqueID;case 9:return t.documentElement&&t.documentElement.uniqueID}}(t)))return e}if(e=++Nt,1073741824&Nt&&(Nt=0),wt)Ot.set(t,e);else{if(void 0!==At&&!1===At(t))throw new Error("Non-extensible objects are not allowed as keys.");if(Dt)Object.defineProperty(t,Mt,{enumerable:!1,configurable:!1,writable:!1,value:e});else if(void 0!==t.propertyIsEnumerable&&t.propertyIsEnumerable===t.constructor.prototype.propertyIsEnumerable)t.propertyIsEnumerable=function(){return this.constructor.prototype.propertyIsEnumerable.apply(this,arguments)},t.propertyIsEnumerable[Mt]=e;else{if(void 0===t.nodeType)throw new Error("Unable to set a non-enumerable property on object.");t[Mt]=e}}return e}(t);if("function"==typeof t.toString)return kt(t.toString());throw new Error("Value type "+e+" cannot be hashed.")}function kt(t){for(var e=0,o=0;o<t.length;o++)e=31*e+t.charCodeAt(o)|0;return Rt(e)}var Ot,At=Object.isExtensible,Dt=function(){try{return Object.defineProperty({},"@",{}),!0}catch(t){return!1}}(),wt="function"==typeof WeakMap;wt&&(Ot=new WeakMap);var Nt=0,Mt="__immutablehash__";"function"==typeof Symbol&&(Mt=Symbol(Mt));var Lt=16,Pt=255,Bt=0,xt={};function Ft(t){vt(t!==1/0,"Cannot perform this action with an infinite size.")}function Ut(e){return null==e?$t():Ht(e)&&!d(e)?e:$t().withMutations(function(o){var t=a(e);Ft(t.size),t.forEach(function(t,e){return o.set(e,t)})})}function Ht(t){return!(!t||!t[Wt])}t(Ut,mt),Ut.of=function(){var o=n.call(arguments,0);return $t().withMutations(function(t){for(var e=0;e<o.length;e+=2){if(e+1>=o.length)throw new Error("Missing value for key: "+o[e]);t.set(o[e],o[e+1])}})},Ut.prototype.toString=function(){return this.__toString("Map {","}")},Ut.prototype.get=function(t,e){return this._root?this._root.get(0,void 0,t,e):e},Ut.prototype.set=function(t,e){return te(this,t,e)},Ut.prototype.setIn=function(t,e){return this.updateIn(t,m,function(){return e})},Ut.prototype.remove=function(t){return te(this,t,m)},Ut.prototype.deleteIn=function(t){return this.updateIn(t,function(){return m})},Ut.prototype.update=function(t,e,o){return 1===arguments.length?t(this):this.updateIn([t],e,o)},Ut.prototype.updateIn=function(t,e,o){o||(o=e,e=void 0);var n=function t(e,o,n,i){var r=e===m,s=o.next();if(s.done){var a=r?n:e,l=i(a);return l===a?e:l}vt(r||e&&e.set,"invalid keyPath");var c=s.value,u=r?m:e.get(c,m),h=t(u,o,n,i);return h===u?e:h===m?e.remove(c):(r?$t():e).set(c,h)}(this,no(t),e,o);return n===m?void 0:n},Ut.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._root=null,this.__hash=void 0,this.__altered=!0,this):$t()},Ut.prototype.merge=function(){return ie(this,void 0,arguments)},Ut.prototype.mergeWith=function(t){var e=n.call(arguments,1);return ie(this,t,e)},Ut.prototype.mergeIn=function(t){var e=n.call(arguments,1);return this.updateIn(t,$t(),function(t){return"function"==typeof t.merge?t.merge.apply(t,e):e[e.length-1]})},Ut.prototype.mergeDeep=function(){return ie(this,re,arguments)},Ut.prototype.mergeDeepWith=function(t){var e=n.call(arguments,1);return ie(this,se(t),e)},Ut.prototype.mergeDeepIn=function(t){var e=n.call(arguments,1);return this.updateIn(t,$t(),function(t){return"function"==typeof t.mergeDeep?t.mergeDeep.apply(t,e):e[e.length-1]})},Ut.prototype.sort=function(t){return De(ze(this,t))},Ut.prototype.sortBy=function(t,e){return De(ze(this,e,t))},Ut.prototype.withMutations=function(t){var e=this.asMutable();return t(e),e.wasAltered()?e.__ensureOwner(this.__ownerID):this},Ut.prototype.asMutable=function(){return this.__ownerID?this:this.__ensureOwner(new I)},Ut.prototype.asImmutable=function(){return this.__ensureOwner()},Ut.prototype.wasAltered=function(){return this.__altered},Ut.prototype.__iterator=function(t,e){return new jt(this,t,e)},Ut.prototype.__iterate=function(e,t){var o=this,n=0;return this._root&&this._root.iterate(function(t){return n++,e(t[1],t[0],o)},t),n},Ut.prototype.__ensureOwner=function(t){return t===this.__ownerID?this:t?Qt(this.size,this._root,t,this.__hash):(this.__ownerID=t,this.__altered=!1,this)},Ut.isMap=Ht;var Gt,Wt="@@__IMMUTABLE_MAP__@@",Vt=Ut.prototype;function Xt(t,e){this.ownerID=t,this.entries=e}function Yt(t,e,o){this.ownerID=t,this.bitmap=e,this.nodes=o}function zt(t,e,o){this.ownerID=t,this.count=e,this.nodes=o}function Jt(t,e,o){this.ownerID=t,this.keyHash=e,this.entries=o}function Kt(t,e,o){this.ownerID=t,this.keyHash=e,this.entry=o}function jt(t,e,o){this._type=e,this._reverse=o,this._stack=t._root&&Zt(t._root)}function qt(t,e){return H(t,e[0],e[1])}function Zt(t,e){return{node:t,index:0,__prev:e}}function Qt(t,e,o,n){var i=Object.create(Vt);return i.size=t,i._root=e,i.__ownerID=o,i.__hash=n,i.__altered=!1,i}function $t(){return Gt||(Gt=Qt(0))}function te(t,e,o){var n,i;if(t._root){var r=b(f),s=b(T);if(n=ee(t._root,t.__ownerID,0,void 0,e,o,r,s),!s.value)return t;i=t.size+(r.value?o===m?-1:1:0)}else{if(o===m)return t;i=1,n=new Xt(t.__ownerID,[[e,o]])}return t.__ownerID?(t.size=i,t._root=n,t.__hash=void 0,t.__altered=!0,t):n?Qt(i,n):$t()}function ee(t,e,o,n,i,r,s,a){return t?t.update(e,o,n,i,r,s,a):r===m?t:(S(a),S(s),new Kt(e,n,[i,r]))}function oe(t){return t.constructor===Kt||t.constructor===Jt}function ne(t,e,o,n,i){if(t.keyHash===n)return new Jt(e,n,[t.entry,i]);var r,s=(0===o?t.keyHash:t.keyHash>>>o)&y,a=(0===o?n:n>>>o)&y,l=s==a?[ne(t,e,o+E,n,i)]:(r=new Kt(e,n,i),s<a?[t,r]:[r,t]);return new Yt(e,1<<s|1<<a,l)}function ie(t,e,o){for(var n=[],i=0;i<o.length;i++){var r=o[i],s=a(r);u(r)||(s=s.map(function(t){return pt(t)})),n.push(s)}return ae(t,e,n)}function re(t,e,o){return t&&t.mergeDeep&&u(e)?t.mergeDeep(e):gt(t,e)?t:e}function se(i){return function(t,e,o){if(t&&t.mergeDeepWith&&u(e))return t.mergeDeepWith(i,e);var n=i(t,e,o);return gt(t,n)?t:n}}function ae(t,i,o){return 0===(o=o.filter(function(t){return 0!==t.size})).length?t:0!==t.size||t.__ownerID||1!==o.length?t.withMutations(function(n){for(var t=i?function(e,o){n.update(o,m,function(t){return t===m?e:i(t,e,o)})}:function(t,e){n.set(e,t)},e=0;e<o.length;e++)o[e].forEach(t)}):t.constructor(o[0])}function le(t){return t=(t=(858993459&(t-=t>>1&1431655765))+(t>>2&858993459))+(t>>4)&252645135,t+=t>>8,127&(t+=t>>16)}function ce(t,e,o,n){var i=n?t:R(t);return i[e]=o,i}Vt[Wt]=!0,Vt[g]=Vt.remove,Vt.removeIn=Vt.deleteIn,Xt.prototype.get=function(t,e,o,n){for(var i=this.entries,r=0,s=i.length;r<s;r++)if(gt(o,i[r][0]))return i[r][1];return n},Xt.prototype.update=function(t,e,o,n,i,r,s){for(var a=i===m,l=this.entries,c=0,u=l.length;c<u&&!gt(n,l[c][0]);c++);var h=c<u;if(h?l[c][1]===i:a)return this;if(S(s),(a||!h)&&S(r),!a||1!==l.length){if(!h&&!a&&l.length>=ue)return function(t,e,o,n){t||(t=new I);for(var i=new Kt(t,Ct(o),[o,n]),r=0;r<e.length;r++){var s=e[r];i=i.update(t,0,void 0,s[0],s[1])}return i}(t,l,n,i);var p=t&&t===this.ownerID,_=p?l:R(l);return h?a?c===u-1?_.pop():_[c]=_.pop():_[c]=[n,i]:_.push([n,i]),p?(this.entries=_,this):new Xt(t,_)}},Yt.prototype.get=function(t,e,o,n){void 0===e&&(e=Ct(o));var i=1<<((0===t?e:e>>>t)&y),r=this.bitmap;return 0==(r&i)?n:this.nodes[le(r&i-1)].get(t+E,e,o,n)},Yt.prototype.update=function(t,e,o,n,i,r,s){void 0===o&&(o=Ct(n));var a=(0===e?o:o>>>e)&y,l=1<<a,c=this.bitmap,u=0!=(c&l);if(!u&&i===m)return this;var h=le(c&l-1),p=this.nodes,_=u?p[h]:void 0,d=ee(_,t,e+E,o,n,i,r,s);if(d===_)return this;if(!u&&d&&p.length>=he)return function(t,e,o,n,i){for(var r=0,s=new Array(v),a=0;0!==o;a++,o>>>=1)s[a]=1&o?e[r++]:void 0;return s[n]=i,new zt(t,r+1,s)}(t,p,c,a,d);if(u&&!d&&2===p.length&&oe(p[1^h]))return p[1^h];if(u&&d&&1===p.length&&oe(d))return d;var g=t&&t===this.ownerID,f=u?d?c:c^l:c|l,T=u?d?ce(p,h,d,g):function(t,e,o){var n=t.length-1;if(o&&e===n)return t.pop(),t;for(var i=new Array(n),r=0,s=0;s<n;s++)s===e&&(r=1),i[s]=t[s+r];return i}(p,h,g):function(t,e,o,n){var i=t.length+1;if(n&&e+1===i)return t[e]=o,t;for(var r=new Array(i),s=0,a=0;a<i;a++)a===e?(r[a]=o,s=-1):r[a]=t[a+s];return r}(p,h,d,g);return g?(this.bitmap=f,this.nodes=T,this):new Yt(t,f,T)},zt.prototype.get=function(t,e,o,n){void 0===e&&(e=Ct(o));var i=(0===t?e:e>>>t)&y,r=this.nodes[i];return r?r.get(t+E,e,o,n):n},zt.prototype.update=function(t,e,o,n,i,r,s){void 0===o&&(o=Ct(n));var a=(0===e?o:o>>>e)&y,l=i===m,c=this.nodes,u=c[a];if(l&&!u)return this;var h=ee(u,t,e+E,o,n,i,r,s);if(h===u)return this;var p=this.count;if(u){if(!h&&--p<pe)return function(t,e,o,n){for(var i=0,r=0,s=new Array(o),a=0,l=1,c=e.length;a<c;a++,l<<=1){var u=e[a];void 0!==u&&a!==n&&(i|=l,s[r++]=u)}return new Yt(t,i,s)}(t,c,p,a)}else p++;var _=t&&t===this.ownerID,d=ce(c,a,h,_);return _?(this.count=p,this.nodes=d,this):new zt(t,p,d)},Jt.prototype.get=function(t,e,o,n){for(var i=this.entries,r=0,s=i.length;r<s;r++)if(gt(o,i[r][0]))return i[r][1];return n},Jt.prototype.update=function(t,e,o,n,i,r,s){void 0===o&&(o=Ct(n));var a=i===m;if(o!==this.keyHash)return a?this:(S(s),S(r),ne(this,t,e,o,[n,i]));for(var l=this.entries,c=0,u=l.length;c<u&&!gt(n,l[c][0]);c++);var h=c<u;if(h?l[c][1]===i:a)return this;if(S(s),(a||!h)&&S(r),a&&2===u)return new Kt(t,this.keyHash,l[1^c]);var p=t&&t===this.ownerID,_=p?l:R(l);return h?a?c===u-1?_.pop():_[c]=_.pop():_[c]=[n,i]:_.push([n,i]),p?(this.entries=_,this):new Jt(t,this.keyHash,_)},Kt.prototype.get=function(t,e,o,n){return gt(o,this.entry[0])?this.entry[1]:n},Kt.prototype.update=function(t,e,o,n,i,r,s){var a=i===m,l=gt(n,this.entry[0]);return(l?i===this.entry[1]:a)?this:(S(s),a?void S(r):l?t&&t===this.ownerID?(this.entry[1]=i,this):new Kt(t,this.keyHash,[n,i]):(S(r),ne(this,t,e,Ct(n),[n,i])))},Xt.prototype.iterate=Jt.prototype.iterate=function(t,e){for(var o=this.entries,n=0,i=o.length-1;n<=i;n++)if(!1===t(o[e?i-n:n]))return!1},Yt.prototype.iterate=zt.prototype.iterate=function(t,e){for(var o=this.nodes,n=0,i=o.length-1;n<=i;n++){var r=o[e?i-n:n];if(r&&!1===r.iterate(t,e))return!1}},Kt.prototype.iterate=function(t,e){return t(this.entry)},t(jt,U),jt.prototype.next=function(){for(var t=this._type,e=this._stack;e;){var o,n=e.node,i=e.index++;if(n.entry){if(0==i)return qt(t,n.entry)}else if(n.entries){if(o=n.entries.length-1,i<=o)return qt(t,n.entries[this._reverse?o-i:i])}else if(o=n.nodes.length-1,i<=o){var r=n.nodes[this._reverse?o-i:i];if(r){if(r.entry)return qt(t,r.entry);e=this._stack=Zt(r,e)}continue}e=this._stack=this._stack.__prev}return G()};var ue=v/4,he=v/2,pe=v/4;function _e(t){var e=Se();if(null==t)return e;if(de(t))return t;var n=c(t),i=n.size;return 0===i?e:(Ft(i),0<i&&i<v?be(0,i,E,null,new Te(n.toArray())):e.withMutations(function(o){o.setSize(i),n.forEach(function(t,e){return o.set(e,t)})}))}function de(t){return!(!t||!t[ge])}t(_e,bt),_e.of=function(){return this(arguments)},_e.prototype.toString=function(){return this.__toString("List [","]")},_e.prototype.get=function(t,e){if(0<=(t=k(this,t))&&t<this.size){var o=Ce(this,t+=this._origin);return o&&o.array[t&y]}return e},_e.prototype.set=function(t,e){return function(t,e,o){if((e=k(t,e))!=e)return t;if(e>=t.size||e<0)return t.withMutations(function(t){e<0?ke(t,e).set(0,o):ke(t,0,e+1).set(e,o)});e+=t._origin;var n=t._tail,i=t._root,r=b(T);return e>=Ae(t._capacity)?n=Ie(n,t.__ownerID,0,e,o,r):i=Ie(i,t.__ownerID,t._level,e,o,r),r.value?t.__ownerID?(t._root=i,t._tail=n,t.__hash=void 0,t.__altered=!0,t):be(t._origin,t._capacity,t._level,i,n):t}(this,t,e)},_e.prototype.remove=function(t){return this.has(t)?0===t?this.shift():t===this.size-1?this.pop():this.splice(t,1):this},_e.prototype.insert=function(t,e){return this.splice(t,0,e)},_e.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=this._origin=this._capacity=0,this._level=E,this._root=this._tail=null,this.__hash=void 0,this.__altered=!0,this):Se()},_e.prototype.push=function(){var o=arguments,n=this.size;return this.withMutations(function(t){ke(t,0,n+o.length);for(var e=0;e<o.length;e++)t.set(n+e,o[e])})},_e.prototype.pop=function(){return ke(this,0,-1)},_e.prototype.unshift=function(){var o=arguments;return this.withMutations(function(t){ke(t,-o.length);for(var e=0;e<o.length;e++)t.set(e,o[e])})},_e.prototype.shift=function(){return ke(this,1)},_e.prototype.merge=function(){return Oe(this,void 0,arguments)},_e.prototype.mergeWith=function(t){var e=n.call(arguments,1);return Oe(this,t,e)},_e.prototype.mergeDeep=function(){return Oe(this,re,arguments)},_e.prototype.mergeDeepWith=function(t){var e=n.call(arguments,1);return Oe(this,se(t),e)},_e.prototype.setSize=function(t){return ke(this,0,t)},_e.prototype.slice=function(t,e){var o=this.size;return A(t,e,o)?this:ke(this,D(t,o),w(e,o))},_e.prototype.__iterator=function(e,t){var o=0,n=me(this,t);return new U(function(){var t=n();return t===ye?G():H(e,o++,t)})},_e.prototype.__iterate=function(t,e){for(var o,n=0,i=me(this,e);(o=i())!==ye&&!1!==t(o,n++,this););return n},_e.prototype.__ensureOwner=function(t){return t===this.__ownerID?this:t?be(this._origin,this._capacity,this._level,this._root,this._tail,t,this.__hash):(this.__ownerID=t,this)},_e.isList=de;var ge="@@__IMMUTABLE_LIST__@@",fe=_e.prototype;function Te(t,e){this.array=t,this.ownerID=e}fe[ge]=!0,fe[g]=fe.remove,fe.setIn=Vt.setIn,fe.deleteIn=fe.removeIn=Vt.removeIn,fe.update=Vt.update,fe.updateIn=Vt.updateIn,fe.mergeIn=Vt.mergeIn,fe.mergeDeepIn=Vt.mergeDeepIn,fe.withMutations=Vt.withMutations,fe.asMutable=Vt.asMutable,fe.asImmutable=Vt.asImmutable,fe.wasAltered=Vt.wasAltered,Te.prototype.removeBefore=function(t,e,o){if(o===e?1<<e:0===this.array.length)return this;var n=o>>>e&y;if(n>=this.array.length)return new Te([],t);var i,r=0==n;if(0<e){var s=this.array[n];if((i=s&&s.removeBefore(t,e-E,o))===s&&r)return this}if(r&&!i)return this;var a=Re(this,t);if(!r)for(var l=0;l<n;l++)a.array[l]=void 0;return i&&(a.array[n]=i),a},Te.prototype.removeAfter=function(t,e,o){if(o===(e?1<<e:0)||0===this.array.length)return this;var n,i=o-1>>>e&y;if(i>=this.array.length)return this;if(0<e){var r=this.array[i];if((n=r&&r.removeAfter(t,e-E,o))===r&&i==this.array.length-1)return this}var s=Re(this,t);return s.array.splice(1+i),n&&(s.array[i]=n),s};var ve,Ee,ye={};function me(t,l){var c=t._origin,u=t._capacity,r=Ae(u),s=t._tail;return h(t._root,t._level,0);function h(t,e,o){return 0===e?function(t,e){var o=e===r?s&&s.array:t&&t.array,n=c<e?0:c-e,i=u-e;return v<i&&(i=v),function(){if(n===i)return ye;var t=l?--i:n++;return o&&o[t]}}(t,o):function(t,o,n){var i,r=t&&t.array,s=c<n?0:c-n>>o,a=1+(u-n>>o);return v<a&&(a=v),function(){for(;;){if(i){var t=i();if(t!==ye)return t;i=null}if(s===a)return ye;var e=l?--a:s++;i=h(r&&r[e],o-E,n+(e<<o))}}}(t,e,o)}}function be(t,e,o,n,i,r,s){var a=Object.create(fe);return a.size=e-t,a._origin=t,a._capacity=e,a._level=o,a._root=n,a._tail=i,a.__ownerID=r,a.__hash=s,a.__altered=!1,a}function Se(){return ve||(ve=be(0,0,E))}function Ie(t,e,o,n,i,r){var s,a=n>>>o&y,l=t&&a<t.array.length;if(!l&&void 0===i)return t;if(0<o){var c=t&&t.array[a],u=Ie(c,e,o-E,n,i,r);return u===c?t:((s=Re(t,e)).array[a]=u,s)}return l&&t.array[a]===i?t:(S(r),s=Re(t,e),void 0===i&&a==s.array.length-1?s.array.pop():s.array[a]=i,s)}function Re(t,e){return e&&t&&e===t.ownerID?t:new Te(t?t.array.slice():[],e)}function Ce(t,e){if(e>=Ae(t._capacity))return t._tail;if(e<1<<t._level+E){for(var o=t._root,n=t._level;o&&0<n;)o=o.array[e>>>n&y],n-=E;return o}}function ke(t,e,o){void 0!==e&&(e|=0),void 0!==o&&(o|=0);var n=t.__ownerID||new I,i=t._origin,r=t._capacity,s=i+e,a=void 0===o?r:o<0?r+o:i+o;if(s===i&&a===r)return t;if(a<=s)return t.clear();for(var l=t._level,c=t._root,u=0;s+u<0;)c=new Te(c&&c.array.length?[void 0,c]:[],n),u+=1<<(l+=E);u&&(s+=u,i+=u,a+=u,r+=u);for(var h=Ae(r),p=Ae(a);1<<l+E<=p;)c=new Te(c&&c.array.length?[c]:[],n),l+=E;var _=t._tail,d=p<h?Ce(t,a-1):h<p?new Te([],n):_;if(_&&h<p&&s<r&&_.array.length){for(var g=c=Re(c,n),f=l;E<f;f-=E){var T=h>>>f&y;g=g.array[T]=Re(g.array[T],n)}g.array[h>>>E&y]=_}if(a<r&&(d=d&&d.removeAfter(n,0,a)),p<=s)s-=p,a-=p,l=E,c=null,d=d&&d.removeBefore(n,0,s);else if(i<s||p<h){for(u=0;c;){var v=s>>>l&y;if(v!=p>>>l&y)break;v&&(u+=(1<<l)*v),l-=E,c=c.array[v]}c&&i<s&&(c=c.removeBefore(n,l,s-u)),c&&p<h&&(c=c.removeAfter(n,l,p-u)),u&&(s-=u,a-=u)}return t.__ownerID?(t.size=a-s,t._origin=s,t._capacity=a,t._level=l,t._root=c,t._tail=d,t.__hash=void 0,t.__altered=!0,t):be(s,a,l,c,d)}function Oe(t,e,o){for(var n=[],i=0,r=0;r<o.length;r++){var s=o[r],a=c(s);a.size>i&&(i=a.size),u(s)||(a=a.map(function(t){return pt(t)})),n.push(a)}return i>t.size&&(t=t.setSize(i)),ae(t,e,n)}function Ae(t){return t<v?0:t-1>>>E<<E}function De(e){return null==e?Me():we(e)?e:Me().withMutations(function(o){var t=a(e);Ft(t.size),t.forEach(function(t,e){return o.set(e,t)})})}function we(t){return Ht(t)&&d(t)}function Ne(t,e,o,n){var i=Object.create(De.prototype);return i.size=t?t.size:0,i._map=t,i._list=e,i.__ownerID=o,i.__hash=n,i}function Me(){return Ee||(Ee=Ne($t(),Se()))}function Le(t,e,o){var n,i,r=t._map,s=t._list,a=r.get(e),l=void 0!==a;if(o===m){if(!l)return t;s.size>=v&&s.size>=2*r.size?(i=s.filter(function(t,e){return void 0!==t&&a!==e}),n=i.toKeyedSeq().map(function(t){return t[0]}).flip().toMap(),t.__ownerID&&(n.__ownerID=i.__ownerID=t.__ownerID)):(n=r.remove(e),i=a===s.size-1?s.pop():s.set(a,void 0))}else if(l){if(o===s.get(a)[1])return t;n=r,i=s.set(a,[e,o])}else n=r.set(e,s.size),i=s.set(s.size,[e,o]);return t.__ownerID?(t.size=n.size,t._map=n,t._list=i,t.__hash=void 0,t):Ne(n,i)}function Pe(t,e){this._iter=t,this._useKeys=e,this.size=t.size}function Be(t){this._iter=t,this.size=t.size}function xe(t){this._iter=t,this.size=t.size}function Fe(t){this._iter=t,this.size=t.size}function Ue(i){var t=to(i);return t._iter=i,t.size=i.size,t.flip=function(){return i},t.reverse=function(){var t=i.reverse.apply(this);return t.flip=function(){return i.reverse()},t},t.has=function(t){return i.includes(t)},t.includes=function(t){return i.has(t)},t.cacheResult=eo,t.__iterateUncached=function(o,t){var n=this;return i.__iterate(function(t,e){return!1!==o(e,t,n)},t)},t.__iteratorUncached=function(t,e){if(t!==P)return i.__iterator(t===L?M:L,e);var o=i.__iterator(t,e);return new U(function(){var t=o.next();if(!t.done){var e=t.value[0];t.value[0]=t.value[1],t.value[1]=e}return t})},t}function He(r,s,a){var t=to(r);return t.size=r.size,t.has=function(t){return r.has(t)},t.get=function(t,e){var o=r.get(t,m);return o===m?e:s.call(a,o,t,r)},t.__iterateUncached=function(n,t){var i=this;return r.__iterate(function(t,e,o){return!1!==n(s.call(a,t,e,o),e,i)},t)},t.__iteratorUncached=function(n,t){var i=r.__iterator(P,t);return new U(function(){var t=i.next();if(t.done)return t;var e=t.value,o=e[0];return H(n,o,s.call(a,e[1],o,r),t)})},t}function Ge(i,o){var t=to(i);return t._iter=i,t.size=i.size,t.reverse=function(){return i},i.flip&&(t.flip=function(){var t=Ue(i);return t.reverse=function(){return i.flip()},t}),t.get=function(t,e){return i.get(o?t:-1-t,e)},t.has=function(t){return i.has(o?t:-1-t)},t.includes=function(t){return i.includes(t)},t.cacheResult=eo,t.__iterate=function(o,t){var n=this;return i.__iterate(function(t,e){return o(t,e,n)},!t)},t.__iterator=function(t,e){return i.__iterator(t,!e)},t}function We(a,l,c,u){var t=to(a);return u&&(t.has=function(t){var e=a.get(t,m);return e!==m&&!!l.call(c,e,t,a)},t.get=function(t,e){var o=a.get(t,m);return o!==m&&l.call(c,o,t,a)?o:e}),t.__iterateUncached=function(n,t){var i=this,r=0;return a.__iterate(function(t,e,o){if(l.call(c,t,e,o))return r++,n(t,u?e:r-1,i)},t),r},t.__iteratorUncached=function(i,t){var r=a.__iterator(P,t),s=0;return new U(function(){for(;;){var t=r.next();if(t.done)return t;var e=t.value,o=e[0],n=e[1];if(l.call(c,n,o,a))return H(i,u?o:s++,n,t)}})},t}function Ve(a,t,e,l){var o=a.size;if(void 0!==t&&(t|=0),void 0!==e&&(e===1/0?e=o:e|=0),A(t,e,o))return a;var c=D(t,o),n=w(e,o);if(c!=c||n!=n)return Ve(a.toSeq().cacheResult(),t,e,l);var u,i=n-c;i==i&&(u=i<0?0:i);var r=to(a);return r.size=0===u?u:a.size&&u||void 0,!l&&rt(a)&&0<=u&&(r.get=function(t,e){return 0<=(t=k(this,t))&&t<u?a.get(t+c,e):e}),r.__iterateUncached=function(o,t){var n=this;if(0===u)return 0;if(t)return this.cacheResult().__iterate(o,t);var i=0,r=!0,s=0;return a.__iterate(function(t,e){if(!r||!(r=i++<c))return s++,!1!==o(t,l?e:s-1,n)&&s!==u}),s},r.__iteratorUncached=function(e,t){if(0!==u&&t)return this.cacheResult().__iterator(e,t);var o=0!==u&&a.__iterator(e,t),n=0,i=0;return new U(function(){for(;n++<c;)o.next();if(++i>u)return G();var t=o.next();return l||e===L?t:H(e,i-1,e===M?void 0:t.value[1],t)})},r}function Xe(e,c,u,h){var t=to(e);return t.__iterateUncached=function(n,t){var i=this;if(t)return this.cacheResult().__iterate(n,t);var r=!0,s=0;return e.__iterate(function(t,e,o){if(!r||!(r=c.call(u,t,e,o)))return s++,n(t,h?e:s-1,i)}),s},t.__iteratorUncached=function(i,t){var r=this;if(t)return this.cacheResult().__iterator(i,t);var s=e.__iterator(P,t),a=!0,l=0;return new U(function(){var t,e,o;do{if((t=s.next()).done)return h||i===L?t:H(i,l++,i===M?void 0:t.value[1],t);var n=t.value;e=n[0],o=n[1],a&&(a=c.call(u,o,e,r))}while(a);return i===P?t:H(i,e,o,t)})},t}function Ye(t,l,c){var e=to(t);return e.__iterateUncached=function(r,e){var s=0,a=!1;return function o(t,n){var i=this;t.__iterate(function(t,e){return(!l||n<l)&&u(t)?o(t,n+1):!1===r(t,c?e:s++,i)&&(a=!0),!a},e)}(t,0),s},e.__iteratorUncached=function(o,n){var i=t.__iterator(o,n),r=[],s=0;return new U(function(){for(;i;){var t=i.next();if(!1===t.done){var e=t.value;if(o===P&&(e=e[1]),l&&!(r.length<l)||!u(e))return c?t:H(o,s++,e,t);r.push(i),i=e.__iterator(o,n)}else i=r.pop()}return G()})},e}function ze(o,n,i){n||(n=oo);var t=h(o),r=0,s=o.toSeq().map(function(t,e){return[e,t,r++,i?i(t,e,o):t]}).toArray();return s.sort(function(t,e){return n(t[3],e[3])||t[2]-e[2]}).forEach(t?function(t,e){s[e].length=2}:function(t,e){s[e]=t[1]}),t?K(s):p(o)?j(s):q(s)}function Je(o,n,i){if(n||(n=oo),i){var t=o.toSeq().map(function(t,e){return[t,i(t,e,o)]}).reduce(function(t,e){return Ke(n,t[1],e[1])?e:t});return t&&t[0]}return o.reduce(function(t,e){return Ke(n,t,e)?e:t})}function Ke(t,e,o){var n=t(o,e);return 0===n&&o!==e&&(null==o||o!=o)||0<n}function je(t,s,a){var e=to(t);return e.size=new et(a).map(function(t){return t.size}).min(),e.__iterate=function(t,e){for(var o,n=this.__iterator(L,e),i=0;!(o=n.next()).done&&!1!==t(o.value,i++,this););return i},e.__iteratorUncached=function(e,o){var n=a.map(function(t){return t=l(t),X(o?t.reverse():t)}),i=0,r=!1;return new U(function(){var t;return r||(t=n.map(function(t){return t.next()}),r=t.some(function(t){return t.done})),r?G():H(e,i++,s.apply(null,t.map(function(t){return t.value})))})},e}function qe(t,e){return rt(t)?e:t.constructor(e)}function Ze(t){if(t!==Object(t))throw new TypeError("Expected [K, V] tuple: "+t)}function Qe(t){return Ft(t.size),C(t)}function $e(t){return h(t)?a:p(t)?c:i}function to(t){return Object.create((h(t)?K:p(t)?j:q).prototype)}function eo(){return this._iter.cacheResult?(this._iter.cacheResult(),this.size=this._iter.size,this):J.prototype.cacheResult.call(this)}function oo(t,e){return e<t?1:t<e?-1:0}function no(t){var e=X(t);if(!e){if(!z(t))throw new TypeError("Expected iterable or array-like: "+t);e=X(l(t))}return e}function io(o,n){var i,r=function(t){if(t instanceof r)return t;if(!(this instanceof r))return new r(t);if(!i){i=!0;var e=Object.keys(o);!function(t,e){try{e.forEach(function(t,e){Object.defineProperty(t,e,{get:function(){return this.get(e)},set:function(t){vt(this.__ownerID,"Cannot set on an immutable record."),this.set(e,t)}})}.bind(void 0,t))}catch(t){}}(s,e),s.size=e.length,s._name=n,s._keys=e,s._defaultValues=o}this._map=Ut(t)},s=r.prototype=Object.create(ro);return s.constructor=r}t(De,Ut),De.of=function(){return this(arguments)},De.prototype.toString=function(){return this.__toString("OrderedMap {","}")},De.prototype.get=function(t,e){var o=this._map.get(t);return void 0!==o?this._list.get(o)[1]:e},De.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._map.clear(),this._list.clear(),this):Me()},De.prototype.set=function(t,e){return Le(this,t,e)},De.prototype.remove=function(t){return Le(this,t,m)},De.prototype.wasAltered=function(){return this._map.wasAltered()||this._list.wasAltered()},De.prototype.__iterate=function(e,t){var o=this;return this._list.__iterate(function(t){return t&&e(t[1],t[0],o)},t)},De.prototype.__iterator=function(t,e){return this._list.fromEntrySeq().__iterator(t,e)},De.prototype.__ensureOwner=function(t){if(t===this.__ownerID)return this;var e=this._map.__ensureOwner(t),o=this._list.__ensureOwner(t);return t?Ne(e,o,t,this.__hash):(this.__ownerID=t,this._map=e,this._list=o,this)},De.isOrderedMap=we,De.prototype[s]=!0,De.prototype[g]=De.prototype.remove,t(Pe,K),Pe.prototype.get=function(t,e){return this._iter.get(t,e)},Pe.prototype.has=function(t){return this._iter.has(t)},Pe.prototype.valueSeq=function(){return this._iter.valueSeq()},Pe.prototype.reverse=function(){var t=this,e=Ge(this,!0);return this._useKeys||(e.valueSeq=function(){return t._iter.toSeq().reverse()}),e},Pe.prototype.map=function(t,e){var o=this,n=He(this,t,e);return this._useKeys||(n.valueSeq=function(){return o._iter.toSeq().map(t,e)}),n},Pe.prototype.__iterate=function(o,e){var n,i=this;return this._iter.__iterate(this._useKeys?function(t,e){return o(t,e,i)}:(n=e?Qe(this):0,function(t){return o(t,e?--n:n++,i)}),e)},Pe.prototype.__iterator=function(e,o){if(this._useKeys)return this._iter.__iterator(e,o);var n=this._iter.__iterator(L,o),i=o?Qe(this):0;return new U(function(){var t=n.next();return t.done?t:H(e,o?--i:i++,t.value,t)})},Pe.prototype[s]=!0,t(Be,j),Be.prototype.includes=function(t){return this._iter.includes(t)},Be.prototype.__iterate=function(e,t){var o=this,n=0;return this._iter.__iterate(function(t){return e(t,n++,o)},t)},Be.prototype.__iterator=function(e,t){var o=this._iter.__iterator(L,t),n=0;return new U(function(){var t=o.next();return t.done?t:H(e,n++,t.value,t)})},t(xe,q),xe.prototype.has=function(t){return this._iter.includes(t)},xe.prototype.__iterate=function(e,t){var o=this;return this._iter.__iterate(function(t){return e(t,t,o)},t)},xe.prototype.__iterator=function(e,t){var o=this._iter.__iterator(L,t);return new U(function(){var t=o.next();return t.done?t:H(e,t.value,t.value,t)})},t(Fe,K),Fe.prototype.entrySeq=function(){return this._iter.toSeq()},Fe.prototype.__iterate=function(o,t){var n=this;return this._iter.__iterate(function(t){if(t){Ze(t);var e=u(t);return o(e?t.get(1):t[1],e?t.get(0):t[0],n)}},t)},Fe.prototype.__iterator=function(n,t){var i=this._iter.__iterator(L,t);return new U(function(){for(;;){var t=i.next();if(t.done)return t;var e=t.value;if(e){Ze(e);var o=u(e);return H(n,o?e.get(0):e[0],o?e.get(1):e[1],t)}}})},Be.prototype.cacheResult=Pe.prototype.cacheResult=xe.prototype.cacheResult=Fe.prototype.cacheResult=eo,t(io,mt),io.prototype.toString=function(){return this.__toString(ao(this)+" {","}")},io.prototype.has=function(t){return this._defaultValues.hasOwnProperty(t)},io.prototype.get=function(t,e){if(!this.has(t))return e;var o=this._defaultValues[t];return this._map?this._map.get(t,o):o},io.prototype.clear=function(){if(this.__ownerID)return this._map&&this._map.clear(),this;var t=this.constructor;return t._empty||(t._empty=so(this,$t()))},io.prototype.set=function(t,e){if(!this.has(t))throw new Error('Cannot set unknown key "'+t+'" on '+ao(this));if(this._map&&!this._map.has(t)){var o=this._defaultValues[t];if(e===o)return this}var n=this._map&&this._map.set(t,e);return this.__ownerID||n===this._map?this:so(this,n)},io.prototype.remove=function(t){if(!this.has(t))return this;var e=this._map&&this._map.remove(t);return this.__ownerID||e===this._map?this:so(this,e)},io.prototype.wasAltered=function(){return this._map.wasAltered()},io.prototype.__iterator=function(t,e){var o=this;return a(this._defaultValues).map(function(t,e){return o.get(e)}).__iterator(t,e)},io.prototype.__iterate=function(t,e){var o=this;return a(this._defaultValues).map(function(t,e){return o.get(e)}).__iterate(t,e)},io.prototype.__ensureOwner=function(t){if(t===this.__ownerID)return this;var e=this._map&&this._map.__ensureOwner(t);return t?so(this,e,t):(this.__ownerID=t,this._map=e,this)};var ro=io.prototype;function so(t,e,o){var n=Object.create(Object.getPrototypeOf(t));return n._map=e,n.__ownerID=o,n}function ao(t){return t._name||t.constructor.name||"Record"}function lo(o){return null==o?fo():co(o)&&!d(o)?o:fo().withMutations(function(e){var t=i(o);Ft(t.size),t.forEach(function(t){return e.add(t)})})}function co(t){return!(!t||!t[ho])}ro[g]=ro.remove,ro.deleteIn=ro.removeIn=Vt.removeIn,ro.merge=Vt.merge,ro.mergeWith=Vt.mergeWith,ro.mergeIn=Vt.mergeIn,ro.mergeDeep=Vt.mergeDeep,ro.mergeDeepWith=Vt.mergeDeepWith,ro.mergeDeepIn=Vt.mergeDeepIn,ro.setIn=Vt.setIn,ro.update=Vt.update,ro.updateIn=Vt.updateIn,ro.withMutations=Vt.withMutations,ro.asMutable=Vt.asMutable,ro.asImmutable=Vt.asImmutable,t(lo,St),lo.of=function(){return this(arguments)},lo.fromKeys=function(t){return this(a(t).keySeq())},lo.prototype.toString=function(){return this.__toString("Set {","}")},lo.prototype.has=function(t){return this._map.has(t)},lo.prototype.add=function(t){return _o(this,this._map.set(t,!0))},lo.prototype.remove=function(t){return _o(this,this._map.remove(t))},lo.prototype.clear=function(){return _o(this,this._map.clear())},lo.prototype.union=function(){var o=n.call(arguments,0);return 0===(o=o.filter(function(t){return 0!==t.size})).length?this:0!==this.size||this.__ownerID||1!==o.length?this.withMutations(function(e){for(var t=0;t<o.length;t++)i(o[t]).forEach(function(t){return e.add(t)})}):this.constructor(o[0])},lo.prototype.intersect=function(){var o=n.call(arguments,0);if(0===o.length)return this;o=o.map(function(t){return i(t)});var e=this;return this.withMutations(function(t){e.forEach(function(e){o.every(function(t){return t.includes(e)})||t.remove(e)})})},lo.prototype.subtract=function(){var o=n.call(arguments,0);if(0===o.length)return this;o=o.map(function(t){return i(t)});var e=this;return this.withMutations(function(t){e.forEach(function(e){o.some(function(t){return t.includes(e)})&&t.remove(e)})})},lo.prototype.merge=function(){return this.union.apply(this,arguments)},lo.prototype.mergeWith=function(t){var e=n.call(arguments,1);return this.union.apply(this,e)},lo.prototype.sort=function(t){return To(ze(this,t))},lo.prototype.sortBy=function(t,e){return To(ze(this,e,t))},lo.prototype.wasAltered=function(){return this._map.wasAltered()},lo.prototype.__iterate=function(o,t){var n=this;return this._map.__iterate(function(t,e){return o(e,e,n)},t)},lo.prototype.__iterator=function(t,e){return this._map.map(function(t,e){return e}).__iterator(t,e)},lo.prototype.__ensureOwner=function(t){if(t===this.__ownerID)return this;var e=this._map.__ensureOwner(t);return t?this.__make(e,t):(this.__ownerID=t,this._map=e,this)},lo.isSet=co;var uo,ho="@@__IMMUTABLE_SET__@@",po=lo.prototype;function _o(t,e){return t.__ownerID?(t.size=e.size,t._map=e,t):e===t._map?t:0===e.size?t.__empty():t.__make(e)}function go(t,e){var o=Object.create(po);return o.size=t?t.size:0,o._map=t,o.__ownerID=e,o}function fo(){return uo||(uo=go($t()))}function To(o){return null==o?bo():vo(o)?o:bo().withMutations(function(e){var t=i(o);Ft(t.size),t.forEach(function(t){return e.add(t)})})}function vo(t){return co(t)&&d(t)}po[ho]=!0,po[g]=po.remove,po.mergeDeep=po.merge,po.mergeDeepWith=po.mergeWith,po.withMutations=Vt.withMutations,po.asMutable=Vt.asMutable,po.asImmutable=Vt.asImmutable,po.__empty=fo,po.__make=go,t(To,lo),To.of=function(){return this(arguments)},To.fromKeys=function(t){return this(a(t).keySeq())},To.prototype.toString=function(){return this.__toString("OrderedSet {","}")},To.isOrderedSet=vo;var Eo,yo=To.prototype;function mo(t,e){var o=Object.create(yo);return o.size=t?t.size:0,o._map=t,o.__ownerID=e,o}function bo(){return Eo||(Eo=mo(Me()))}function So(t){return null==t?Ao():Io(t)?t:Ao().unshiftAll(t)}function Io(t){return!(!t||!t[Co])}yo[s]=!0,yo.__empty=bo,yo.__make=mo,t(So,bt),So.of=function(){return this(arguments)},So.prototype.toString=function(){return this.__toString("Stack [","]")},So.prototype.get=function(t,e){var o=this._head;for(t=k(this,t);o&&t--;)o=o.next;return o?o.value:e},So.prototype.peek=function(){return this._head&&this._head.value},So.prototype.push=function(){if(0===arguments.length)return this;for(var t=this.size+arguments.length,e=this._head,o=arguments.length-1;0<=o;o--)e={value:arguments[o],next:e};return this.__ownerID?(this.size=t,this._head=e,this.__hash=void 0,this.__altered=!0,this):Oo(t,e)},So.prototype.pushAll=function(t){if(0===(t=c(t)).size)return this;Ft(t.size);var e=this.size,o=this._head;return t.reverse().forEach(function(t){e++,o={value:t,next:o}}),this.__ownerID?(this.size=e,this._head=o,this.__hash=void 0,this.__altered=!0,this):Oo(e,o)},So.prototype.pop=function(){return this.slice(1)},So.prototype.unshift=function(){return this.push.apply(this,arguments)},So.prototype.unshiftAll=function(t){return this.pushAll(t)},So.prototype.shift=function(){return this.pop.apply(this,arguments)},So.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._head=void 0,this.__hash=void 0,this.__altered=!0,this):Ao()},So.prototype.slice=function(t,e){if(A(t,e,this.size))return this;var o=D(t,this.size),n=w(e,this.size);if(n!==this.size)return bt.prototype.slice.call(this,t,e);for(var i=this.size-o,r=this._head;o--;)r=r.next;return this.__ownerID?(this.size=i,this._head=r,this.__hash=void 0,this.__altered=!0,this):Oo(i,r)},So.prototype.__ensureOwner=function(t){return t===this.__ownerID?this:t?Oo(this.size,this._head,t,this.__hash):(this.__ownerID=t,this.__altered=!1,this)},So.prototype.__iterate=function(t,e){if(e)return this.reverse().__iterate(t);for(var o=0,n=this._head;n&&!1!==t(n.value,o++,this);)n=n.next;return o},So.prototype.__iterator=function(e,t){if(t)return this.reverse().__iterator(e);var o=0,n=this._head;return new U(function(){if(n){var t=n.value;return n=n.next,H(e,o++,t)}return G()})},So.isStack=Io;var Ro,Co="@@__IMMUTABLE_STACK__@@",ko=So.prototype;function Oo(t,e,o,n){var i=Object.create(ko);return i.size=t,i._head=e,i.__ownerID=o,i.__hash=n,i.__altered=!1,i}function Ao(){return Ro||(Ro=Oo(0))}function Do(e,o){var t=function(t){e.prototype[t]=o[t]};return Object.keys(o).forEach(t),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(o).forEach(t),e}ko[Co]=!0,ko.withMutations=Vt.withMutations,ko.asMutable=Vt.asMutable,ko.asImmutable=Vt.asImmutable,ko.wasAltered=Vt.wasAltered,l.Iterator=U,Do(l,{toArray:function(){Ft(this.size);var o=new Array(this.size||0);return this.valueSeq().__iterate(function(t,e){o[e]=t}),o},toIndexedSeq:function(){return new Be(this)},toJS:function(){return this.toSeq().map(function(t){return t&&"function"==typeof t.toJS?t.toJS():t}).__toJS()},toJSON:function(){return this.toSeq().map(function(t){return t&&"function"==typeof t.toJSON?t.toJSON():t}).__toJS()},toKeyedSeq:function(){return new Pe(this,!0)},toMap:function(){return Ut(this.toKeyedSeq())},toObject:function(){Ft(this.size);var o={};return this.__iterate(function(t,e){o[e]=t}),o},toOrderedMap:function(){return De(this.toKeyedSeq())},toOrderedSet:function(){return To(h(this)?this.valueSeq():this)},toSet:function(){return lo(h(this)?this.valueSeq():this)},toSetSeq:function(){return new xe(this)},toSeq:function(){return p(this)?this.toIndexedSeq():h(this)?this.toKeyedSeq():this.toSetSeq()},toStack:function(){return So(h(this)?this.valueSeq():this)},toList:function(){return _e(h(this)?this.valueSeq():this)},toString:function(){return"[Iterable]"},__toString:function(t,e){return 0===this.size?t+e:t+" "+this.toSeq().map(this.__toStringMapper).join(", ")+" "+e},concat:function(){var t=n.call(arguments,0);return qe(this,function(t,e){var o=h(t),n=[t].concat(e).map(function(t){return u(t)?o&&(t=a(t)):t=o?at(t):lt(Array.isArray(t)?t:[t]),t}).filter(function(t){return 0!==t.size});if(0===n.length)return t;if(1===n.length){var i=n[0];if(i===t||o&&h(i)||p(t)&&p(i))return i}var r=new et(n);return o?r=r.toKeyedSeq():p(t)||(r=r.toSetSeq()),(r=r.flatten(!0)).size=n.reduce(function(t,e){if(void 0!==t){var o=e.size;if(void 0!==o)return t+o}},0),r}(this,t))},includes:function(e){return this.some(function(t){return gt(t,e)})},entries:function(){return this.__iterator(P)},every:function(n,i){Ft(this.size);var r=!0;return this.__iterate(function(t,e,o){if(!n.call(i,t,e,o))return r=!1}),r},filter:function(t,e){return qe(this,We(this,t,e,!0))},find:function(t,e,o){var n=this.findEntry(t,e);return n?n[1]:o},forEach:function(t,e){return Ft(this.size),this.__iterate(e?t.bind(e):t)},join:function(e){Ft(this.size),e=void 0!==e?""+e:",";var o="",n=!0;return this.__iterate(function(t){n?n=!1:o+=e,o+=null!=t?t.toString():""}),o},keys:function(){return this.__iterator(M)},map:function(t,e){return qe(this,He(this,t,e))},reduce:function(n,t,i){var r,s;return Ft(this.size),arguments.length<2?s=!0:r=t,this.__iterate(function(t,e,o){r=s?(s=!1,t):n.call(i,r,t,e,o)}),r},reduceRight:function(t,e,o){var n=this.toKeyedSeq().reverse();return n.reduce.apply(n,arguments)},reverse:function(){return qe(this,Ge(this,!0))},slice:function(t,e){return qe(this,Ve(this,t,e,!0))},some:function(t,e){return!this.every(Po(t),e)},sort:function(t){return qe(this,ze(this,t))},values:function(){return this.__iterator(L)},butLast:function(){return this.slice(0,-1)},isEmpty:function(){return void 0!==this.size?0===this.size:!this.some(function(){return!0})},count:function(t,e){return C(t?this.toSeq().filter(t,e):this)},countBy:function(t,e){return function(o,n,i){var r=Ut().asMutable();return o.__iterate(function(t,e){r.update(n.call(i,t,e,o),0,function(t){return t+1})}),r.asImmutable()}(this,t,e)},equals:function(t){return ft(this,t)},entrySeq:function(){var t=this;if(t._cache)return new et(t._cache);var e=t.toSeq().map(Lo).toIndexedSeq();return e.fromEntrySeq=function(){return t.toSeq()},e},filterNot:function(t,e){return this.filter(Po(t),e)},findEntry:function(n,i,t){var r=t;return this.__iterate(function(t,e,o){if(n.call(i,t,e,o))return!(r=[e,t])}),r},findKey:function(t,e){var o=this.findEntry(t,e);return o&&o[0]},findLast:function(t,e,o){return this.toKeyedSeq().reverse().find(t,e,o)},findLastEntry:function(t,e,o){return this.toKeyedSeq().reverse().findEntry(t,e,o)},findLastKey:function(t,e){return this.toKeyedSeq().reverse().findKey(t,e)},first:function(){return this.find(O)},flatMap:function(t,e){return qe(this,function(o,n,i){var r=$e(o);return o.toSeq().map(function(t,e){return r(n.call(i,t,e,o))}).flatten(!0)}(this,t,e))},flatten:function(t){return qe(this,Ye(this,t,!0))},fromEntrySeq:function(){return new Fe(this)},get:function(o,t){return this.find(function(t,e){return gt(e,o)},void 0,t)},getIn:function(t,e){for(var o,n=this,i=no(t);!(o=i.next()).done;){var r=o.value;if((n=n&&n.get?n.get(r,m):m)===m)return e}return n},groupBy:function(t,e){return function(n,t,i){var r=h(n),s=(d(n)?De():Ut()).asMutable();n.__iterate(function(e,o){s.update(t.call(i,e,o,n),function(t){return(t=t||[]).push(r?[o,e]:e),t})});var e=$e(n);return s.map(function(t){return qe(n,e(t))})}(this,t,e)},has:function(t){return this.get(t,m)!==m},hasIn:function(t){return this.getIn(t,m)!==m},isSubset:function(e){return e="function"==typeof e.includes?e:l(e),this.every(function(t){return e.includes(t)})},isSuperset:function(t){return(t="function"==typeof t.isSubset?t:l(t)).isSubset(this)},keyOf:function(e){return this.findKey(function(t){return gt(t,e)})},keySeq:function(){return this.toSeq().map(Mo).toIndexedSeq()},last:function(){return this.toSeq().reverse().first()},lastKeyOf:function(t){return this.toKeyedSeq().reverse().keyOf(t)},max:function(t){return Je(this,t)},maxBy:function(t,e){return Je(this,e,t)},min:function(t){return Je(this,t?Bo(t):Uo)},minBy:function(t,e){return Je(this,e?Bo(e):Uo,t)},rest:function(){return this.slice(1)},skip:function(t){return this.slice(Math.max(0,t))},skipLast:function(t){return qe(this,this.toSeq().reverse().skip(t).reverse())},skipWhile:function(t,e){return qe(this,Xe(this,t,e,!0))},skipUntil:function(t,e){return this.skipWhile(Po(t),e)},sortBy:function(t,e){return qe(this,ze(this,e,t))},take:function(t){return this.slice(0,Math.max(0,t))},takeLast:function(t){return qe(this,this.toSeq().reverse().take(t).reverse())},takeWhile:function(t,e){return qe(this,function(e,l,c){var t=to(e);return t.__iterateUncached=function(n,t){var i=this;if(t)return this.cacheResult().__iterate(n,t);var r=0;return e.__iterate(function(t,e,o){return l.call(c,t,e,o)&&++r&&n(t,e,i)}),r},t.__iteratorUncached=function(i,t){var r=this;if(t)return this.cacheResult().__iterator(i,t);var s=e.__iterator(P,t),a=!0;return new U(function(){if(!a)return G();var t=s.next();if(t.done)return t;var e=t.value,o=e[0],n=e[1];return l.call(c,n,o,r)?i===P?t:H(i,o,n,t):(a=!1,G())})},t}(this,t,e))},takeUntil:function(t,e){return this.takeWhile(Po(t),e)},valueSeq:function(){return this.toIndexedSeq()},hashCode:function(){return this.__hash||(this.__hash=function(t){if(t.size===1/0)return 0;var e=d(t),o=h(t),n=e?1:0;return function(t,e){return e=It(e,3432918353),e=It(e<<15|e>>>-15,461845907),e=It(e<<13|e>>>-13,5),e=It((e=(e+3864292196|0)^t)^e>>>16,2246822507),e=Rt((e=It(e^e>>>13,3266489909))^e>>>16)}(t.__iterate(o?e?function(t,e){n=31*n+Ho(Ct(t),Ct(e))|0}:function(t,e){n=n+Ho(Ct(t),Ct(e))|0}:e?function(t){n=31*n+Ct(t)|0}:function(t){n=n+Ct(t)|0}),n)}(this))}});var wo=l.prototype;wo[e]=!0,wo[F]=wo.values,wo.__toJS=wo.toArray,wo.__toStringMapper=xo,wo.inspect=wo.toSource=function(){return this.toString()},wo.chain=wo.flatMap,wo.contains=wo.includes,Do(a,{flip:function(){return qe(this,Ue(this))},mapEntries:function(o,n){var i=this,r=0;return qe(this,this.toSeq().map(function(t,e){return o.call(n,[e,t],r++,i)}).fromEntrySeq())},mapKeys:function(o,n){var i=this;return qe(this,this.toSeq().flip().map(function(t,e){return o.call(n,t,e,i)}).flip())}});var No=a.prototype;function Mo(t,e){return e}function Lo(t,e){return[e,t]}function Po(t){return function(){return!t.apply(this,arguments)}}function Bo(t){return function(){return-t.apply(this,arguments)}}function xo(t){return"string"==typeof t?JSON.stringify(t):String(t)}function Fo(){return R(arguments)}function Uo(t,e){return t<e?1:e<t?-1:0}function Ho(t,e){return t^e+2654435769+(t<<6)+(t>>2)|0}return No[o]=!0,No[F]=wo.entries,No.__toJS=wo.toObject,No.__toStringMapper=function(t,e){return JSON.stringify(e)+": "+xo(t)},Do(c,{toKeyedSeq:function(){return new Pe(this,!1)},filter:function(t,e){return qe(this,We(this,t,e,!1))},findIndex:function(t,e){var o=this.findEntry(t,e);return o?o[0]:-1},indexOf:function(t){var e=this.keyOf(t);return void 0===e?-1:e},lastIndexOf:function(t){var e=this.lastKeyOf(t);return void 0===e?-1:e},reverse:function(){return qe(this,Ge(this,!1))},slice:function(t,e){return qe(this,Ve(this,t,e,!1))},splice:function(t,e){var o=arguments.length;if(e=Math.max(0|e,0),0===o||2===o&&!e)return this;t=D(t,t<0?this.count():this.size);var n=this.slice(0,t);return qe(this,1===o?n:n.concat(R(arguments,2),this.slice(t+e)))},findLastIndex:function(t,e){var o=this.findLastEntry(t,e);return o?o[0]:-1},first:function(){return this.get(0)},flatten:function(t){return qe(this,Ye(this,t,!1))},get:function(o,t){return(o=k(this,o))<0||this.size===1/0||void 0!==this.size&&o>this.size?t:this.find(function(t,e){return e===o},void 0,t)},has:function(t){return 0<=(t=k(this,t))&&(void 0!==this.size?this.size===1/0||t<this.size:-1!==this.indexOf(t))},interpose:function(t){return qe(this,function(r,s){var t=to(r);return t.size=r.size&&2*r.size-1,t.__iterateUncached=function(o,t){var n=this,i=0;return r.__iterate(function(t,e){return(!i||!1!==o(s,i++,n))&&!1!==o(t,i++,n)},t),i},t.__iteratorUncached=function(t,e){var o,n=r.__iterator(L,e),i=0;return new U(function(){return(!o||i%2)&&(o=n.next()).done?o:i%2?H(t,i++,s):H(t,i++,o.value,o)})},t}(this,t))},interleave:function(){var t=[this].concat(R(arguments)),e=je(this.toSeq(),j.of,t),o=e.flatten(!0);return e.size&&(o.size=e.size*t.length),qe(this,o)},keySeq:function(){return Et(0,this.size)},last:function(){return this.get(-1)},skipWhile:function(t,e){return qe(this,Xe(this,t,e,!1))},zip:function(){var t=[this].concat(R(arguments));return qe(this,je(this,Fo,t))},zipWith:function(t){var e=R(arguments);return qe(e[0]=this,je(this,t,e))}}),c.prototype[r]=!0,c.prototype[s]=!0,Do(i,{get:function(t,e){return this.has(t)?t:e},includes:function(t){return this.has(t)},keySeq:function(){return this.valueSeq()}}),i.prototype.has=wo.includes,i.prototype.contains=i.prototype.includes,Do(K,a.prototype),Do(j,c.prototype),Do(q,i.prototype),Do(mt,a.prototype),Do(bt,c.prototype),Do(St,i.prototype),{Iterable:l,Seq:J,Collection:yt,Map:Ut,OrderedMap:De,List:_e,Stack:So,Set:lo,OrderedSet:To,Record:io,Range:Et,Repeat:Tt,is:gt,fromJS:pt}}()}},[[4597,0]]]);
